System.register(["jimu-core","jimu-for-builder","jimu-ui","jimu-ui/advanced/setting-components","jimu-ui/advanced/utility-selector","jimu-ui/basic/item-selector"],(function(e,t){var a={},l={},s={},i={},n={},r={};return{setters:[function(e){a.Immutable=e.Immutable,a.React=e.React,a.ReactRedux=e.ReactRedux,a.ServiceManager=e.ServiceManager,a.SessionManager=e.SessionManager,a.UtilityManager=e.UtilityManager,a.classNames=e.classNames,a.css=e.css,a.hooks=e.hooks,a.jsx=e.jsx,a.lodash=e.lodash,a.polished=e.polished,a.portalUrlUtils=e.portalUrlUtils,a.serviceUrlUtils=e.serviceUrlUtils},function(e){l.getAppConfigAction=e.getAppConfigAction},function(e){s.Button=e.Button,s.Checkbox=e.Checkbox,s.Dropdown=e.Dropdown,s.DropdownButton=e.DropdownButton,s.DropdownItem=e.DropdownItem,s.DropdownMenu=e.DropdownMenu,s.Icon=e.Icon,s.Label=e.Label,s.Link=e.Link,s.Loading=e.Loading,s.LoadingType=e.LoadingType,s.Modal=e.Modal,s.ModalBody=e.ModalBody,s.ModalFooter=e.ModalFooter,s.ModalHeader=e.ModalHeader,s.Tab=e.Tab,s.Tabs=e.Tabs,s.TextInput=e.TextInput,s.Tooltip=e.Tooltip,s.defaultMessages=e.defaultMessages},function(e){i.SidePopper=e.SidePopper},function(e){n.AddUtilityTabs=e.AddUtilityTabs,n.UtilityIcon=e.UtilityIcon},function(e){r.DataBadge=e.DataBadge,r.ItemDetail=e.ItemDetail}],execute:function(){e((()=>{var e={2185:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M2 0a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2V4a2 2 0 0 1 2-2h8a2 2 0 0 0-2-2z"></path><path fill="#000" fill-rule="evenodd" d="M6 4a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm5.489 2.938Q10.31 5.759 8.66 6.062a.402.402 0 0 0-.212.68l1.619 1.618a.4.4 0 0 1 0 .569l-1.138 1.138a.4.4 0 0 1-.569 0L6.742 8.448a.402.402 0 0 0-.68.212q-.303 1.65.876 2.829a3.22 3.22 0 0 0 3.532.688l1.588 1.587a.805.805 0 0 0 1.137 0l.57-.569a.805.805 0 0 0 0-1.137l-1.588-1.588a3.22 3.22 0 0 0-.688-3.532" clip-rule="evenodd"></path></svg>'},5007:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M3 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4.751a2 2 0 0 0-.495-1.317L12.098.683A2 2 0 0 0 10.592 0zm3.325 3.077Q8.388 2.7 9.861 4.172a4.02 4.02 0 0 1 .86 4.416l1.985 1.984c.392.393.392 1.03 0 1.422l-.712.712a1.006 1.006 0 0 1-1.422 0L8.588 10.72a4.02 4.02 0 0 1-4.416-.86Q2.7 8.388 3.077 6.325a.503.503 0 0 1 .85-.265L5.95 8.083a.503.503 0 0 0 .711 0l1.422-1.422a.503.503 0 0 0 0-.71L6.06 3.926a.503.503 0 0 1 .265-.85" clip-rule="evenodd"></path></svg>'},3549:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M6.667 4.667 11.333 0 16 4.667l-4.667 4.666zM0 1.333V8h6.667V1.333zM6.667 16H0V9.333h6.667zM8 16V9.333h6.667V16z" clip-rule="evenodd"></path></svg>'},9524:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M7.5 1.5a.5.5 0 0 1 1 0v2.8a.5.5 0 0 1-1 0zm6.028.874a.5.5 0 0 1 .062.705l-1.414 1.685a.5.5 0 1 1-.766-.643l1.414-1.685a.5.5 0 0 1 .704-.062m-10.352.062a.5.5 0 1 0-.766.643l1.414 1.685a.5.5 0 0 0 .766-.643zM6.244 10.6H5.43zM.961 9.8h4.88c.211 0 .359.19.359.4q0 .207.045.4a1.8 1.8 0 0 0 3.51 0h.814a2.6 2.6 0 0 1-5.139 0H.8v3.6h14.4v-3.6H9.755q.045-.194.045-.4c0-.21.148-.4.358-.4h4.881l-2.267-3.4H3.228zm11.81-4.2a.8.8 0 0 1 .666.356l2.429 3.642a.8.8 0 0 1 .134.444V14.2a.8.8 0 0 1-.8.8H.8a.8.8 0 0 1-.8-.8v-4.158a.8.8 0 0 1 .134-.444l2.429-3.642a.8.8 0 0 1 .665-.356z" clip-rule="evenodd"></path></svg>'},6572:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M15.29 6.208 8 1 .71 6.208a.5.5 0 1 0 .58.813L2 6.515V15h12V6.514l.71.507a.5.5 0 0 0 .58-.813M13 5.8 8 2.229 3 5.8V14h3v-4h4v4h3zM9 14H7v-3h2z" clip-rule="evenodd"></path></svg>'},4109:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M3.154 3.154a.527.527 0 0 1 .746 0l1.317 1.317A8.6 8.6 0 0 1 8 4c2.667 0 5.667 1.333 7 4-.696 1.393-1.847 2.422-3.168 3.087l1.014 1.013a.527.527 0 1 1-.746.746l-1.317-1.317A8.6 8.6 0 0 1 8 12c-2.667 0-5.667-1.333-7-4 .696-1.393 1.847-2.422 3.168-3.087L3.154 3.9a.527.527 0 0 1 0-.746m1.698 2.443C3.726 6.087 2.782 6.882 2 8c1.422 2.033 3.382 3 6 3a8.7 8.7 0 0 0 2.03-.225l-.675-.674A2.5 2.5 0 0 1 5.9 6.644zm6.296 4.805C12.275 9.913 13.218 9.119 14 8c-1.422-2.033-3.382-3-6-3q-1.088 0-2.03.225l.675.674a2.5 2.5 0 0 1 3.457 3.456zM6.5 8c0-.221.048-.431.134-.62l1.987 1.986A1.5 1.5 0 0 1 6.5 8m.88-1.366 1.986 1.987a1.5 1.5 0 0 0-1.987-1.987" clip-rule="evenodd"></path></svg>'},4651:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2m5 1a1 1 0 1 1 2 0 1 1 0 0 1-2 0m6 0a1 1 0 1 1 2 0 1 1 0 0 1-2 0" clip-rule="evenodd"></path></svg>'},3529:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 12c-2.667 0-5.667-1.333-7-4 1.333-2.667 4.333-4 7-4s5.667 1.333 7 4c-1.333 2.667-4.333 4-7 4m0-7c-2.618 0-4.578.967-6 3 1.422 2.033 3.382 3 6 3s4.578-.967 6-3c-1.422-2.033-3.382-3-6-3m0 5.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5m0-1a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3" clip-rule="evenodd"></path></svg>'},3662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M7.5 0a.5.5 0 0 0-.5.5V7H.5a.5.5 0 0 0 0 1H7v6.5a.5.5 0 0 0 1 0V8h6.5a.5.5 0 0 0 0-1H8V.5a.5.5 0 0 0-.5-.5"></path></svg>'},170:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0m-1.27 4.936a6.5 6.5 0 1 1 .707-.707l4.136 4.137a.5.5 0 1 1-.707.707z" clip-rule="evenodd"></path></svg>'},5508:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14" clip-rule="evenodd"></path></svg>'},8996:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2.125 14.334 14H1.667zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47zM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},9244:e=>{"use strict";e.exports=a},4108:e=>{"use strict";e.exports=l},4321:e=>{"use strict";e.exports=s},9298:e=>{"use strict";e.exports=i},1371:e=>{"use strict";e.exports=n},6340:e=>{"use strict";e.exports=r}},t={};function o(a){var l=t[a];if(void 0!==l)return l.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,o),s.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="";var c={};return o.p=window.jimuConfig.baseUrl,(()=>{"use strict";o.r(c),o.d(c,{__set_webpack_public_path__:()=>ke,default:()=>we});var e=o(9244),t=o(3662),a=o.n(t),l=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(e);s<l.length;s++)t.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(e,l[s])&&(a[l[s]]=e[l[s]])}return a};const s=t=>{const s=window.SVG,{className:i}=t,n=l(t,["className"]),r=(0,e.classNames)("jimu-icon jimu-icon-component",i);return s?e.React.createElement(s,Object.assign({className:r,src:a()},n)):e.React.createElement("svg",Object.assign({className:r},n))};var i=o(170),n=o.n(i),r=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(e);s<l.length;s++)t.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(e,l[s])&&(a[l[s]]=e[l[s]])}return a};const u=t=>{const a=window.SVG,{className:l}=t,s=r(t,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",l);return a?e.React.createElement(a,Object.assign({className:i,src:n()},s)):e.React.createElement("svg",Object.assign({className:i},s))};var d=o(9524),m=o.n(d),p=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(e);s<l.length;s++)t.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(e,l[s])&&(a[l[s]]=e[l[s]])}return a};const g=t=>{const a=window.SVG,{className:l}=t,s=p(t,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",l);return a?e.React.createElement(a,Object.assign({className:i,src:m()},s)):e.React.createElement("svg",Object.assign({className:i},s))};var v=o(4321),f=o(4108),x=o(9298),y=o(1371);const b={utilityService:"Utility service",noUtilityTip:"No utility in the experience.<br/>Please add at least one utility.",removeUtility:"Remove utility",removeUtilityTitle:"You are removing utility:",breakTip:"This utility is used in the following widgets and removing it may break them.",breakDesc:"Select the widgets you want to delete alongside the utility. Be aware they will be removed from all devices views. The unselected widgets will be kept and you can reconfigure them later."};var h=o(3549),j=o.n(h),w=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(e);s<l.length;s++)t.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(e,l[s])&&(a[l[s]]=e[l[s]])}return a};const k=t=>{const a=window.SVG,{className:l}=t,s=w(t,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",l);return a?e.React.createElement(a,Object.assign({className:i,src:j()},s)):e.React.createElement("svg",Object.assign({className:i},s))};var N=o(6340),R=o(4651),O=o.n(R),I=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(e);s<l.length;s++)t.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(e,l[s])&&(a[l[s]]=e[l[s]])}return a};const S=t=>{const a=window.SVG,{className:l}=t,s=I(t,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",l);return a?e.React.createElement(a,Object.assign({className:i,src:O()},s)):e.React.createElement("svg",Object.assign({className:i},s))};function C(t){const{widgetId:a,className:l=""}=t,s=e.ReactRedux.useSelector((e=>{var t,l,s;const i=(null===(l=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===l?void 0:l.widgets)[a];return i?"string"==typeof i.icon?i.icon:null===(s=i.icon)||void 0===s?void 0:s.svg:null})),i=e.ReactRedux.useSelector((e=>{var t,l,s;return null===(s=(null===(l=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===l?void 0:l.widgets)[a])||void 0===s?void 0:s.label}));return(0,e.jsx)("div",{className:`d-flex align-items-center ${l}`},(0,e.jsx)(v.Icon,{icon:s,size:16}),(0,e.jsx)("span",{className:"ml-1"},i))}function U(t){const{utilityId:a,label:l,relatedWidgetIds:s,onCancel:i,beforeRemove:n,afterRemove:r}=t,[o,c]=e.React.useState((0,e.Immutable)({})),u=e.hooks.useTranslation(v.defaultMessages,b),d=e.React.useCallback(((e,t)=>{c(o.set(e,t))}),[o]),m=e.React.useCallback((()=>{const e=(0,f.getAppConfigAction)(),t=Object.keys(o).filter((e=>o[e])),l=s.filter((e=>!o[e]));t.forEach((t=>{e.removeWidget(t)})),l.forEach((t=>{const l=e.appConfig.widgets[t].useUtilities.filter((e=>e.utilityId!==a));e.editWidgetProperty(t,"useUtilities",l)})),null==n||n(),e.removeUtility(a),e.exec(),r()}),[o,s,a,n,r]);return(0,e.jsx)(v.Modal,{isOpen:!0,className:"bg-default d-flex justify-content-between",role:"dialog","aria-label":u("removeUtility"),"aria-describedby":`${a}_desc`},(0,e.jsx)(v.ModalHeader,{className:"d-flex justify-content-between border-color-gray-300 py-4 font-16 font-dark-600",title:u("removeUtility"),toggle:i},u("removeUtility")),(0,e.jsx)(v.ModalBody,{id:`${a}_desc`},(0,e.jsx)("div",{className:"px-2 py-0"},(0,e.jsx)("p",{className:"font-13 font-dark-600"},u("removeUtilityTitle")),(0,e.jsx)("p",{className:"font-14 font-dark-800 mt-4"},l),(0,e.jsx)("p",{className:"font-13 font-dark-600 mt-4"},u("breakTip")),(0,e.jsx)("div",{role:"group","aria-label":u("relatedWidgets")},(0,e.jsx)("p",{className:"font-14 font-dark-400 mt-4"},u("relatedWidgets")),(0,e.jsx)("div",{className:"related-widgets px-2 py-4"},(0,e.jsx)("div",null,s.map((t=>{var a;return(0,e.jsx)(v.Label,{key:t,className:"d-flex align-items-center"},(0,e.jsx)(v.Checkbox,{className:"mr-2 font-13",onChange:(e,a)=>{d(t,a)},checked:null!==(a=o[t])&&void 0!==a&&a}),(0,e.jsx)(C,{widgetId:t}))}))))),(0,e.jsx)("p",{className:"font-13 font-dark-600 mt-2 mb-0"},u("breakDesc")))),(0,e.jsx)(v.ModalFooter,null,(0,e.jsx)("div",{className:"d-flex justify-content-end mt10"},(0,e.jsx)(v.Button,{type:"primary",className:"mr-2",onClick:m,"aria-label":u("removeUtility")},u("removeUtility")),(0,e.jsx)(v.Button,{type:"default",onClick:i,"aria-label":u("cancel")},u("cancel")))))}function M(t){const{onRename:a,beforeRemove:l,utilityId:s,label:i,relatedWidgetIds:n,showRemove:r=!0}=t,[o,c]=e.React.useState(!1),u=e.hooks.useTranslation(b),d=e.React.useCallback((()=>{if((null==n?void 0:n.length)>0)return void c(!0);null==l||l();const e=(0,f.getAppConfigAction)();e.removeUtility(s),e.exec()}),[n,s,l]),m=e.hooks.useEventCallback((()=>{c(!1)}));return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(v.Dropdown,{className:"utility-more",direction:"down",size:"sm"},(0,e.jsx)(v.DropdownButton,{icon:!0,size:"sm","aria-label":u("more"),type:"tertiary",arrow:!1},(0,e.jsx)(S,{className:"align-baseline",size:"m"})),(0,e.jsx)(v.DropdownMenu,null,(0,e.jsx)(v.DropdownItem,{header:!1,"aria-label":u("rename"),onClick:a,a11yFocusBack:!1},u("rename")),r&&(0,e.jsx)(v.DropdownItem,{header:!1,"aria-label":u("remove"),onClick:d},u("remove")))),o&&(0,e.jsx)(U,{utilityId:s,label:i,relatedWidgetIds:n,onCancel:m,beforeRemove:l,afterRemove:m}))}function E(t){const{text:a,isEditing:l,className:s,onChange:i}=t,[n,r]=e.React.useState(null!=a?a:""),o=e.React.useRef();e.React.useEffect((()=>{l||a===n||r(a)}),[a,n,l]),e.React.useEffect((()=>{l&&o.current&&e.lodash.defer((()=>{o.current.focus()}))}),[l]);const c=e.React.useCallback((e=>{const t=e.target.value;i(t)}),[i]),u=e.hooks.useEventCallback((e=>{r(e.target.value)})),d=e.hooks.useEventCallback((e=>{e.stopPropagation()}));return l?e.React.createElement(v.TextInput,{className:(0,e.classNames)(s,"text-truncate p-1"),onBlur:c,onKeyUp:c,onChange:u,value:n,onClick:d,ref:o}):e.React.createElement("div",{className:s},n)}var B=o(2185),z=o.n(B),P=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(e);s<l.length;s++)t.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(e,l[s])&&(a[l[s]]=e[l[s]])}return a};const T=t=>{const a=window.SVG,{className:l}=t,s=P(t,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",l);return a?e.React.createElement(a,Object.assign({className:i,src:z()},s)):e.React.createElement("svg",Object.assign({className:i},s))};var L=o(5007),$=o.n(L),A=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(e);s<l.length;s++)t.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(e,l[s])&&(a[l[s]]=e[l[s]])}return a};const V=t=>{const a=window.SVG,{className:l}=t,s=A(t,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",l);return a?e.React.createElement(a,Object.assign({className:i,src:$()},s)):e.React.createElement("svg",Object.assign({className:i},s))};function D(t,a){const l=e.ReactRedux.useSelector((e=>{var l,s;const i=[],n=null===(s=null===(l=e.appStateInBuilder)||void 0===l?void 0:l.appConfig)||void 0===s?void 0:s.widgets;return Object.keys(null!=n?n:{}).forEach((e=>{var l;(null===(l=n[e].useUtilities)||void 0===l?void 0:l.some((e=>null!=a?e.utilityId===t&&e.task===a:e.utilityId===t)))&&i.push(e)})),i.sort(),i.join(",")}));return e.React.useMemo((()=>l.length>0?l.split(","):[]),[l])}function W(t,a){var l,s;if(t){return`${e.portalUrlUtils.getHomeIndexUrl(a.portalUrl).replace("index.html","item.html")}?id=${a.itemId}`}if(!!(null===(l=e.ServiceManager.getInstance().getServerInfoByServiceUrl(a.url))||void 0===l?void 0:l.owningSystemUrl)){const t=null===(s=e.SessionManager.getInstance().getSessionByUrl(a.url))||void 0===s?void 0:s.token;return t?`${a.url}?token=${t}`:a.url}return a.url}function _(t,a){var l,s;if(!!(null===(l=e.ServiceManager.getInstance().getServerInfoByServiceUrl(a.url))||void 0===l?void 0:l.owningSystemUrl)){const l=null===(s=e.SessionManager.getInstance().getSessionByUrl(a.url))||void 0===s?void 0:s.token;return l?`${a.url}/${t}?token=${l}`:a.url}return`${a.url}/${t}`}var H=o(5508),G=o.n(H),F=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(e);s<l.length;s++)t.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(e,l[s])&&(a[l[s]]=e[l[s]])}return a};const q=t=>{const a=window.SVG,{className:l}=t,s=F(t,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",l);return a?e.React.createElement(a,Object.assign({className:i,src:G()},s)):e.React.createElement("svg",Object.assign({className:i},s))};var Q=o(8996),J=o.n(Q),K=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(e);s<l.length;s++)t.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(e,l[s])&&(a[l[s]]=e[l[s]])}return a};const Y=t=>{const a=window.SVG,{className:l}=t,s=K(t,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",l);return a?e.React.createElement(a,Object.assign({className:i,src:J()},s)):e.React.createElement("svg",Object.assign({className:i},s))},X=e.css`
  .loading-container{
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
  }
  .utility-more{
    margin-right: ${e.polished.rem(-8)};
  }
  .warning-icon, .warning-icon>*{
    color: var(--sys-color-error-dark);
    fill: var(--sys-color-error-dark);
  }
`;function Z(t){var a,l,s,i,n,r,o;const{utilityId:c,filter:u,total:d,onClick:m}=t,p=D(c),[g,x]=e.React.useState(!1),[b,h]=e.React.useState(!1),[j,w]=e.React.useState(null),R=e.hooks.useTranslation(v.defaultMessages),O=e.ReactRedux.useSelector((e=>e.appStateInBuilder.appConfig.utilities[c])),I=function(t,a,l){const s=e.SessionManager.getInstance().getNoPermissionResourceInfoList()||{},i=Object.keys(s).find((e=>t.includes(e)||(null==l?void 0:l.includes(e))||e.includes(a)));return i?{url:i,info:s[i]}:null}(O.url,O.itemId,O.portalUrl),S=e.ReactRedux.useSelector((e=>{var t,a,l;const s=null===(a=null===(t=e.appStateInBuilder.appRuntimeInfo)||void 0===t?void 0:t.utilityStates)||void 0===a?void 0:a[c];return null===(l=null==s?void 0:s.success)||void 0===l||l})),C=e.ReactRedux.useSelector((t=>{var a;const l=t.appStateInBuilder.resourceSessions;if(!l)return null;const s=O.url&&(null===(a=e.ServiceManager.getInstance().getServerInfoByServiceUrl(O.url))||void 0===a?void 0:a.owningSystemUrl),i=O.url&&e.serviceUrlUtils.getServerRootUrl(O.url),n=e.portalUrlUtils.getStandardPortalUrl(s||i);return n?l[n]:null})),U=e.ReactRedux.useSelector((t=>{const a=t.appStateInBuilder.resourceSessions;if(!a)return null;const l=O.portalUrl&&e.portalUrlUtils.getPlatformUrlByOrgUrl(O.portalUrl),s=e.portalUrlUtils.getStandardPortalUrl(l);return s?a[s]:null})),B=e.React.useRef(C),z=e.React.useRef(U),P=e.React.useCallback((()=>{var e,t;return null!==(t=null===(e=null==I?void 0:I.info)||void 0===e?void 0:e.allowSignIn)&&void 0!==t&&t}),[I]),L=null!==(l=null!==(a=O.label)&&void 0!==a?a:O.name)&&void 0!==l?l:O.sourceLabel,$=P(),A=e.React.useCallback((()=>{h(!0);const t=e.UtilityManager.getInstance().getUtilityJson(c);let a=!1;e.UtilityManager.getInstance().getUtility(c).then((e=>{if(t.portalUrl&&t.itemId)return a=!0,w(e.itemInfo),e.itemInfo})).then((a=>{if(a)return e.UtilityManager.getInstance().getUrlOfItem(t.portalUrl,t.itemId)})).then((l=>{if(a&&(null==l||l!==t.url))throw new Error("service url is not match");return e.UtilityManager.getServiceInfo(t.url)})).then((t=>{if(!t)throw new Error("service is not available");e.UtilityManager.getInstance().reportUtilityState(c,!0)})).catch((t=>{console.error(t),e.UtilityManager.getInstance().reportUtilityState(c,!1)})).finally((()=>{h(!1)}))}),[c]);e.hooks.useEffectOnce((()=>{A()})),e.React.useEffect((()=>{B.current===C&&z.current===U||(B.current!==C&&e.ServiceManager.getInstance().clearServiceInfo(O.url),A()),B.current=C,z.current=U}),[O.url,A,C,U]);const _=e.React.useMemo((()=>W(j,O)),[j,O]),H=e.React.useCallback((t=>{const a=(0,f.getAppConfigAction)();let l=a.appConfig.utilities;l=l.setIn([O.id,"label"],t),a.updateUtilities(l).exec(),e.lodash.defer((()=>{x(!1)}))}),[O]),G=e.hooks.useEventCallback((()=>{x(!0)})),F=e.React.useCallback((()=>{e.SessionManager.getInstance().signInByResourceUrl(O.url,I.info.owningSystemUrl,!0)}),[O.url,I]),Q=e.React.useCallback((t=>{S&&(O.itemId&&j||!O.itemId)&&m(c,t,j),!S&&$&&e.SessionManager.getInstance().signInByResourceUrl(O.url,I.info.owningSystemUrl,!0)}),[m,S,$,c,O,j,I]),J=e.React.useCallback((()=>{g||Q(0)}),[g,Q]),K=e.React.useCallback((e=>{e.stopPropagation(),Q(0)}),[Q]),Z=e.React.useCallback((e=>{e.stopPropagation(),Q(1)}),[Q]);return(0,e.jsx)("div",{className:(0,e.classNames)("utility-card mt-4 mx-4",{"d-none":""!==u&&!L.toLowerCase().includes(u.toLowerCase()),"not-availble":!S}),css:e.css`${X}; order: ${S?"unset":d}`},b&&(0,e.jsx)("div",{className:"loading-container"},(0,e.jsx)(v.Loading,{type:v.LoadingType.Bar})),(0,e.jsx)("div",{className:"d-flex align-items-center utility-card-header"},(0,e.jsx)("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 utility-thumbnail"},(null===(s=O.tasks)||void 0===s?void 0:s.length)>0?(0,e.jsx)(T,{size:"s",color:"var(--black)"}):(0,e.jsx)(y.UtilityIcon,{type:O.type,size:"s",color:"var(--black)"})),(0,e.jsx)("div",{className:"flex-grow-1 text-truncate pl-2 utility-type flex-shrink-1 text-truncate utility-type-name"},O.type),(0,e.jsx)("div",{className:"ml-auto flex-shrink-0"},(0,e.jsx)(N.DataBadge,{portalUrl:O.portalUrl,itemId:O.itemId,url:O.itemId?null:O.url})),!S&&(0,e.jsx)("div",{className:"ml-auto flex-shrink-0"},(0,e.jsx)(v.Tooltip,{title:$?R("signInErrorEnterCredential"):(null==I?void 0:I.info)?R("signInErrorCannotEnterCredential"):R("serviceNotAvailable"),placement:"bottom"},(0,e.jsx)(v.Button,{size:"sm",icon:!0,type:"tertiary",className:"cursor-default p-0 jimu-outline-inside",onClick:$?F:null},(0,e.jsx)(Y,{size:"m",color:"var(--warning-600)"})))),(0,e.jsx)("div",{className:"d-flex flex-shrink-0"},(0,e.jsx)(M,{utilityId:O.id,label:null!==(i=O.label)&&void 0!==i?i:O.sourceLabel,relatedWidgetIds:p,onRename:G}))),(0,e.jsx)("div",{className:"utility-card-body",css:e.css`cursor: ${g?"default":"pointer"};`,onClick:J},(0,e.jsx)(E,{text:null!==(r=null!==(n=O.label)&&void 0!==n?n:null==j?void 0:j.title)&&void 0!==r?r:O.sourceLabel,isEditing:g,onChange:H,className:g?"flex-grow-1 utility-label utility-label-input":"flex-grow-1 two-line-truncate utility-label text-left"})),(0,e.jsx)("div",{className:"utility-card-footer",css:e.css`cursor: ${g?"default":"pointer"};`,onClick:J},(null===(o=O.tasks)||void 0===o?void 0:o.length)>0&&(0,e.jsx)("div",{className:"d-flex align-items-center mr-4",title:R("containUtilitiesWithNum",{utilityNum:O.tasks.length})},(0,e.jsx)(v.Button,{type:"tertiary",size:"sm",className:"p-0 utility-tasks",disabled:!S,onClick:K},(0,e.jsx)(V,{className:"mr-1",size:"m"})),(0,e.jsx)("div",{className:"number"},O.tasks.length)),(0,e.jsx)("div",{className:"d-flex align-items-center",title:R("relatedWidgetsWithDirectlyNum",{num:p.length})},(0,e.jsx)(v.Button,{type:"tertiary",size:"sm",className:"p-0 utility-related-widgets",title:R("relatedWidgetsWithDirectlyNum",{num:p.length}),"aria-label":R("relatedWidgetsWithDirectlyNum",{num:p.length}),disabled:!S,onClick:Z},(0,e.jsx)(k,{className:"mr-1",size:"m"})),(0,e.jsx)("div",{className:"number"},p.length)),(0,e.jsx)(v.Link,{to:b?null:_,className:"p-0 utility-label-link ml-auto utility-preview",target:"_blank"},(0,e.jsx)(v.Button,{type:"tertiary",size:"sm",disabled:!S},(0,e.jsx)(q,{className:"mr-0",size:"m"})))))}const ee=e.css`
  .title{
    padding: 18px 16px 2px 16px !important;
    font-size: 1rem;
    font-weight: 500;
    color: var(--ref-palette-neutral-1000);
    .search-icon{
      cursor: pointer;
      width: 30px;
    }
  }

  .add-utility{
    height: ${e.polished.rem(30)};
    line-height: ${e.polished.rem(30)};
    width: 228px;
    padding: 0;
    border-radius: 2px;
    cursor: pointer;
    .add-utility-label{
      max-width: 85%;
    }
  }
  button.add-utility:hover{
    color: var(--ref-palette-black) !important;
  }
`;function te(t){const{onCardClick:a}=t,l=e.React.useRef(),[i,n]=e.React.useState(!1),[r,o]=e.React.useState(!1),[c,d]=e.React.useState(""),m=e.React.useRef(),p=e.hooks.useTranslation(v.defaultMessages,b),h=e.ReactRedux.useSelector((e=>{var t,a;return null===(a=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===a?void 0:a.utilities})),j=e.ReactRedux.useSelector((e=>{var t,a,l;return null===(l=null===(a=null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.sectionNavInfos)||void 0===a?void 0:a["opts-section"])||void 0===l?void 0:l.currentViewId}));e.React.useEffect((()=>{"utility"!==j&&n(!1)}),[j]),e.React.useEffect((()=>{r&&m.current.focus()}),[r]);const w=e.React.useMemo((()=>Object.keys(null!=h?h:{}).filter((e=>"org"!==h[e].source))),[h]),k=e.React.useCallback((()=>{n(!i)}),[i]),N=e.hooks.useEventCallback((e=>{(0,f.getAppConfigAction)().updateUtilities(e).exec()})),R=e.React.useCallback(((e,t,l)=>{a(e,t,l)}),[a]),O=e.React.useCallback((()=>{r&&d(""),o(!r)}),[r]),I=e.hooks.useEventCallback((e=>{d(e.target.value)}));return(0,e.jsx)("div",{css:ee,className:"jimu-widget widget-utility-setting setting-pane bg-default",ref:l},(0,e.jsx)("div",{className:"h-100"},(0,e.jsx)("div",{className:"jimu-builder-panel--header title d-flex flex-row text-data-600 title justify-content-between"},(0,e.jsx)("div",{className:"mb-0 text-truncate text-left",title:p("utilityService")},p("utilityService")),(0,e.jsx)("div",{className:"search-icon d-flex align-items-start justify-content-end"},(0,e.jsx)(v.Button,{size:"sm",icon:!0,type:"tertiary",title:p("search"),"aria-label":p("search"),onClick:O},(0,e.jsx)(u,{size:"m"})))),r&&(0,e.jsx)("div",{className:"mt-2 w-100 px-4"},(0,e.jsx)(v.TextInput,{className:"w-100",allowClear:!0,placeholder:p("search"),value:c,ref:m,onChange:I})),(0,e.jsx)("div",{className:"d-flex mx-4 mb-1 mt-4"},(0,e.jsx)(v.Button,{type:"primary",className:"flex-grow-1 text-center add-utility",onClick:k,title:p("addUtility"),"aria-label":p("addUtility")},(0,e.jsx)("div",{className:"w-100 px-2 d-flex align-items-center justify-content-center"},(0,e.jsx)(s,{size:"m",className:"mr-2"}),(0,e.jsx)("div",{className:"add-utility-label text-truncate"},p("addUtility"))))),0===w.length&&(0,e.jsx)("div",{className:"empty-placeholder w-100"},(0,e.jsx)("div",{className:"empty-placeholder-icon"},(0,e.jsx)(g,{size:48})),(0,e.jsx)("div",{className:"empty-placeholder-text",dangerouslySetInnerHTML:{__html:p("noUtilityTip")}})),(0,e.jsx)("div",{className:"d-flex flex-column",css:e.css`height: calc(100% - 100px); overflow: auto;`},w.map((t=>(0,e.jsx)(Z,{key:t,total:w.length,filter:c,utilityId:t,onClick:R}))))),(0,e.jsx)(x.SidePopper,{title:p("addUtility"),position:"left",isOpen:i,toggle:k,trigger:l.current},(0,e.jsx)(y.AddUtilityTabs,{utilities:h,onChange:N})))}var ae=o(6572),le=o.n(ae),se=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(e);s<l.length;s++)t.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(e,l[s])&&(a[l[s]]=e[l[s]])}return a};const ie=t=>{const a=window.SVG,{className:l}=t,s=se(t,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",l);return a?e.React.createElement(a,Object.assign({className:i,src:le()},s)):e.React.createElement("svg",Object.assign({className:i},s))};function ne(t){const{widgetIdList:a,isInTab:l=!1}=t,s=e.hooks.useTranslation(v.defaultMessages);return 0===a.length?(0,e.jsx)("div",{className:"empty-placeholder w-100"},(0,e.jsx)("div",{className:"empty-placeholder-icon"},(0,e.jsx)(g,{size:48})),(0,e.jsx)("div",{className:"empty-placeholder-text"},s("noRelatedWidget"))):(0,e.jsx)("div",{className:(0,e.classNames)("related-widgets px-4",{"pt-4":!l})},!l&&(0,e.jsx)("div",{css:e.css`font-size: 14px; line-height: 19px;`},s("relatedWidgets")),t.widgetIdList.map((t=>(0,e.jsx)(C,{key:t,widgetId:t,className:"mt-2 p-1"}))))}var re=o(3529),oe=o.n(re),ce=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(e);s<l.length;s++)t.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(e,l[s])&&(a[l[s]]=e[l[s]])}return a};const ue=t=>{const a=window.SVG,{className:l}=t,s=ce(t,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",l);return a?e.React.createElement(a,Object.assign({className:i,src:oe()},s)):e.React.createElement("svg",Object.assign({className:i},s))};var de=o(4109),me=o.n(de),pe=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(e);s<l.length;s++)t.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(e,l[s])&&(a[l[s]]=e[l[s]])}return a};const ge=t=>{const a=window.SVG,{className:l}=t,s=pe(t,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",l);return a?e.React.createElement(a,Object.assign({className:i,src:me()},s)):e.React.createElement("svg",Object.assign({className:i},s))},ve=e.css`
  &:not(.not-availble):hover{
    background-color: var(--ref-palette-neutral-600);
  }
`;function fe(t){const{utilityId:a,taskName:l,inUse:s=!1,total:i,onClick:n}=t,r=D(a,l),o=e.hooks.useTranslation(v.defaultMessages),c=e.ReactRedux.useSelector((e=>e.appStateInBuilder.appConfig.utilities[a])),u=e.React.useMemo((()=>_(l,c)),[l,c]),d=e.React.useMemo((()=>{const e=c.tasks.findIndex((e=>e.name===l));return c.tasks[e].label}),[c,l]),m=e.ReactRedux.useSelector((e=>{var t;return null===(t=e.appStateInBuilder.appConfig.utilities[c.id].tasks.find((e=>e.name===l)).visible)||void 0===t||t})),p=e.React.useCallback((()=>{const e=(0,f.getAppConfigAction)(),t=e.appConfig.utilities[c.id],a=[];t.tasks.forEach((e=>{e.name===l?a.push(e.set("visible",null!=e.visible&&!e.visible)):a.push(e)}));const s=e.appConfig.utilities.setIn([c.id,"tasks"],a);e.updateUtilities(s).exec()}),[c.id,l]),g=e.React.useCallback((()=>{n(l,r)}),[l,n,r]);return s&&0===r.length||!s&&r.length>0?null:(0,e.jsx)("div",{className:(0,e.classNames)("utility-card mt-4",{"not-availble":!m}),css:e.css`
        ${ve};
        order: ${m?"initial":i+2}
      `},(0,e.jsx)("div",{className:"d-flex align-items-center utility-card-header"},(0,e.jsx)("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 utility-thumbnail"},(0,e.jsx)(y.UtilityIcon,{type:c.type,size:"s",color:m?"var(--black)":"var(--dark-400)"})),(0,e.jsx)("div",{className:"flex-grow-1 text-truncate pl-2 utility-type flex-shrink-1 text-truncate utility-type-name"},o("geoprocessingTask")),0===r.length&&(0,e.jsx)(v.Button,{type:"tertiary",title:o(m?"invisible":"visible"),"aria-label":o(m?"invisible":"visible"),className:"p-0 ml-auto utility-tasks align-items-center",onClick:p},m?(0,e.jsx)(ue,{className:"mr-0",size:"m"}):(0,e.jsx)(ge,{className:"mr-0",size:"m"}))),(0,e.jsx)("div",{className:"utility-card-body two-line-truncate",onClick:g},null!=d?d:l),(0,e.jsx)("div",{className:"utility-card-footer",onClick:g},(0,e.jsx)("div",{className:"d-flex align-items-center",title:o("relatedWidgetsWithDirectlyNum",{num:r.length})},(0,e.jsx)(v.Button,{type:"tertiary",size:"sm",className:"p-0 utility-related-widgets",title:o("relatedWidgetsWithDirectlyNum",{num:r.length}),"aria-label":o("relatedWidgetsWithDirectlyNum",{num:r.length})},(0,e.jsx)(k,{className:"mr-1",size:"m",color:m?null:"var(--dark-200)"})),(0,e.jsx)("div",{className:"number"},r.length)),(0,e.jsx)(v.Link,{to:u,className:"p-0 utility-label-link ml-auto utility-preview",target:"_blank"},(0,e.jsx)(v.Button,{type:"tertiary",size:"sm",disabled:!m},(0,e.jsx)(q,{className:"mr-0",size:"m"})))))}const xe=e.css`
  .utility-detail-header {
    display: flex;
  }
  .max-width-1{
    max-width: ${e.polished.rem(190)};
  }
  .max-width-2{
    max-width: ${e.polished.rem(90)};
  }
`;function ye(t){const{utilityId:a,taskName:l,relatedWidgets:s}=t,[i,n]=e.React.useState(!1),r=e.ReactRedux.useSelector((e=>e.appStateInBuilder.appConfig.utilities[a])),o=e.React.useMemo((()=>{const e=r.tasks.findIndex((e=>e.name===l));return r.tasks[e].label}),[r,l]),[c,u]=e.React.useState(null!=o?o:l),d=e.hooks.useTranslation(v.defaultMessages),m=e.React.useMemo((()=>_(l,r)),[l,r]),p=e.hooks.useEventCallback((()=>{n(!0)})),g=e.React.useCallback((t=>{const s=(0,f.getAppConfigAction)();let i=s.appConfig.utilities,o=r.tasks;const c=o.findIndex((e=>e.name===l));o=e.Immutable.set(o,c,o[c].set("label",t)),i=i.set(a,r.set("tasks",o)),s.updateUtilities(i).exec(),n(!1),u(t)}),[a,r,l]);return(0,e.jsx)("div",{className:"card-detail",css:xe},(0,e.jsx)("div",{className:"px-4 pt-2 justify-content-between align-items-center utility-detail-header"},(0,e.jsx)("div",{className:"d-flex align-items-center w-100"},(0,e.jsx)("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 utility-thumbnail"},(0,e.jsx)(y.UtilityIcon,{type:r.type,size:"s",color:"var(--black)"})),(0,e.jsx)("div",{className:"flex-grow-1 text-truncate pl-2 utility-type"},(0,e.jsx)("div",{className:"text-truncate utility-type-name"},d("geoprocessingTask")))),(0,e.jsx)("div",{className:"d-flex"},(0,e.jsx)(M,{utilityId:"",label:"",relatedWidgetIds:null,onRename:p,showRemove:!1}))),(0,e.jsx)("div",{className:"utility-detail-body"},(0,e.jsx)(v.Link,{to:i?null:m,className:(0,e.classNames)("utility-label-link d-flex",{"text-decoration-none":i}),target:"_blank"},(0,e.jsx)(E,{text:c,isEditing:i,onChange:g,className:i?"flex-grow-1 m-2 utility-label utility-label-input":"flex-grow-1 m-2 two-line-truncate utility-label text-left"})),(0,e.jsx)(ne,{widgetIdList:s})))}const be=e.css`
  & > .nav {
    border-bottom: 1px solid var(--ref-palette-neutral-700);
    padding: 10px;
  }
  .utility-detail-header {
    display: flex;
  }
  .utility-detail-body{
    height: calc(100% - 80px);
  }
  .utility-relations {
    border-top: 1px solid var(--ref-palette-neutral-700);
  }
  .max-width-1{
    max-width: ${e.polished.rem(190)};
  }
  .max-width-2{
    max-width: ${e.polished.rem(90)};
  }
  .task-group {
    overflow: auto;
    height: 100%;

    .task-group-title {
      font-size: ${e.polished.rem(14)};
      color: var(--ref-palette-neutral-1000);
      font-weight: 600;
      display: none;
    }

    .task-group-title:has(+ .utility-card) {
      display: block;
    }

    .task-group-title.others:not(:last-child) {
      display: block;
    }

    .placeholder + .task-group-title.in-use {
      display: block;
    }

    .task-group-title + .task-group-title {
      display: none !important;
    }
  }
`;function he(t){var a,l,s,i;const{utilityId:n,item:r,onNavBack:o,defaultTab:c=0}=t,u=e.ReactRedux.useSelector((e=>e.appStateInBuilder.appConfig.utilities[n])),[d,m]=e.React.useState(!1),[p,g]=e.React.useState(!1),[b,h]=e.React.useState(!1),[j,w]=e.React.useState(null!==(a=u.label)&&void 0!==a?a:u.sourceLabel),k=e.React.useRef(),R=e.React.useRef(),O=D(n),I=e.hooks.useTranslation(v.defaultMessages),S=e.React.useMemo((()=>W(r,u)),[r,u]),C=e.ReactRedux.useSelector((e=>{var t,a,l;return null===(l=null===(a=null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.sectionNavInfos)||void 0===a?void 0:a["opts-section"])||void 0===l?void 0:l.currentViewId}));e.React.useEffect((()=>{"utility"!==C&&g(!1)}),[C]);const U=e.hooks.useEventCallback((()=>{m(!0)})),B=e.React.useCallback((e=>{const t=(0,f.getAppConfigAction)();let a=t.appConfig.utilities;a=a.setIn([u.id,"label"],e),t.updateUtilities(a).exec(),m(!1),w(e)}),[u]),z=e.React.useCallback((()=>{g(!p)}),[p]),P=e.React.useCallback(((e,t)=>{h(!0);const a=(0,f.getAppConfigAction)().appConfig.utilities[n],l=a.tasks.findIndex((t=>t.name===e)),s=a.tasks[l].label;R.current={taskName:e,taskLabel:s,widgets:t}}),[n]),L=e.React.useCallback((()=>{h(!1),R.current=null}),[]);return(0,e.jsx)("div",{className:"card-detail h-100",css:be,ref:k},(0,e.jsx)("div",{className:"nav d-flex align-items-center"},(0,e.jsx)(v.Button,{icon:!0,size:"sm",type:"link",onClick:o,title:I("back"),"aria-label":I("back")},(0,e.jsx)(ie,null)),"/",b?(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(v.Link,{title:j,onClick:L,role:"button",className:"text-left text-truncate max-width-2"},j),"/",(0,e.jsx)("span",{className:"pl-1 text-left text-truncate max-width-2"},null!==(l=R.current.taskLabel)&&void 0!==l?l:R.current.taskName)):(0,e.jsx)("span",{className:"pl-1 text-left text-truncate max-width-1"},j)),(0,e.jsx)("div",{className:(0,e.classNames)("px-4 pt-2 justify-content-between align-items-center utility-detail-header",{"d-none":b})},(0,e.jsx)("div",{className:"d-flex align-items-center w-100"},(0,e.jsx)("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 utility-thumbnail"},(null===(s=u.tasks)||void 0===s?void 0:s.length)>1?(0,e.jsx)(T,{size:"s",color:"var(--black)"}):(0,e.jsx)(y.UtilityIcon,{type:u.type,size:"s",color:"var(--black)"})),(0,e.jsx)("div",{className:"flex-grow-1 text-truncate pl-2 utility-type"},(0,e.jsx)("div",{className:"text-truncate utility-type-name"},u.type))),(0,e.jsx)("div",{className:"d-flex"},r&&(0,e.jsx)(v.Button,{icon:!0,size:"sm",type:"tertiary",onClick:z,title:I("details"),"aria-label":I("details")},(0,e.jsx)(q,null)),(0,e.jsx)(M,{utilityId:u.id,label:j,relatedWidgetIds:O,onRename:U,beforeRemove:o}))),(0,e.jsx)("div",{className:(0,e.classNames)("utility-detail-body",{"d-none":b})},(0,e.jsx)(v.Link,{to:d?null:S,className:(0,e.classNames)("utility-label-link d-flex",{"text-decoration-none":d}),target:"_blank"},(0,e.jsx)(E,{text:j,isEditing:d,onChange:B,className:d?"flex-grow-1 m-2 utility-label utility-label-input":"flex-grow-1 m-2 two-line-truncate utility-label text-left"})),(null===(i=u.tasks)||void 0===i?void 0:i.length)>0&&(0,e.jsx)("div",{className:"pt-2",css:e.css`height: calc(100% - 50px); .tab-nav{margin:0 1rem;}`},(0,e.jsx)(v.Tabs,{className:"h-100",type:"pills",fill:!0,defaultValue:0===c?"tasks":"widgets"},(0,e.jsx)(v.Tab,{id:"tasks",title:I("tasks")},(0,e.jsx)("div",{className:"task-group px-4 d-flex flex-column"},O.length>0&&(0,e.jsx)("div",{className:"d-none placeholder"}),(0,e.jsx)("div",{className:"task-group-title in-use mt-4"},I("inUse")),[...u.tasks].map((t=>(0,e.jsx)(fe,{key:t.name,total:u.tasks.length,inUse:!0,utilityId:n,taskName:t.name,onClick:P}))),(0,e.jsx)("div",{className:"task-group-title others mt-4"},I("others")),[...u.tasks].map((t=>(0,e.jsx)(fe,{key:t.name,total:u.tasks.length,utilityId:n,taskName:t.name,onClick:P}))))),(0,e.jsx)(v.Tab,{id:"widgets",title:I("widgets")},(0,e.jsx)(ne,{widgetIdList:O,isInTab:!0})))),(null==u.tasks||0===u.tasks.length)&&(0,e.jsx)("div",{className:"utility-relations"},(0,e.jsx)(ne,{widgetIdList:O}))),b&&(0,e.jsx)(ye,{utilityId:n,taskName:R.current.taskName,relatedWidgets:R.current.widgets}),r&&(0,e.jsx)(x.SidePopper,{title:j,position:"left",isOpen:p&&!b,toggle:z,trigger:k.current},(0,e.jsx)(N.ItemDetail,{item:r,portalUrl:u.portalUrl})))}const je=t=>e.css`
  .utility-card {
    &.not-availble {
      background-color: var(--ref-palette-neutral-500);
      .utility-thumbnail{
        background-color: var(--ref-palette-neutral-700);
      }
      .utility-card-header{
        background-color: var(--ref-palette-neutral-500);
      }
      .utility-type, .utility-card-body, .utility-card-footer, .number{
        color: var(--ref-palette-neutral-900);
      }
    }
    &:not(.not-availble):hover {
      background-color: ${e.polished.rgba(null==t?void 0:t.ref.palette.neutral[600],.8)};
    }

    background-color: var(--ref-palette-neutral-500);
    font-size: ${e.polished.rem(12)};
    border-radius: 2px;
    padding: 0;
    position: relative;
    cursor: pointer;
    .utility-card-header{
      width: 100%;
      height: ${e.polished.rem(38)};
      padding: 0 10px;
      background-color: var(--ref-palette-neutral-600);
    }
    .utility-card-body{
      max-height: 3rem;
      padding: 12px 12px 0 10px;
    }
    .two-line-truncate{
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      word-break: break-word;
      word-wrap: break-word;
    }
    .utility-card-footer {
      padding: 1rem 10px 10px;
      display: flex;
      line-height: 1;
      align-items: center;
      .utility-label-link {
        line-height: 1;
      }
      .number {
        padding-top: 3px;
        text-align: center;
        color: var(--ref-palette-neutral-1000);
      }
      .jimu-btn {
        border-width: 0;
      }
    }
    .utility-label{
      font-size: ${e.polished.rem(14)};
      color: currentColor;
    }
    .utility-type{
      font-size: ${e.polished.rem(13)};
      color: currentColor;
      max-width: ${e.polished.rem(160)};
    }
    .utility-related-widgets, .utility-child-dss{
      font-size: ${e.polished.rem(13)};
    }
    .utility-thumbnail{
      width:  ${e.polished.rem(18)};
      height:  ${e.polished.rem(18)};
      background-color: var(--sys-color-info-main);
    }
  }
  .empty-placeholder{
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    .empty-placeholder-text, .empty-placeholder-icon{
      display: table;
      margin: 0 auto;
    }
    .empty-placeholder-text{
      color: var(--ref-palette-neutral-900);
      font-size: ${e.polished.rem(14)};
      margin-top: 16px;
      text-align: center;
    }
    .empty-placeholder-icon{
      color: var(--sys-color-action-disabled-text);
    }
  }
`;function we(t){const[a,l]=e.React.useState(0),[s,i]=e.React.useState(0),[n,r]=e.React.useState(null),o=e.React.useCallback(((e,t,a)=>{r({utilityId:e,item:a}),i(t),l(1)}),[]),c=e.hooks.useEventCallback((()=>{l(0)}));return(0,e.jsx)("div",{css:je(t.theme),className:"jimu-widget widget-utility-setting setting-pane bg-default"},(0,e.jsx)("div",{className:(0,e.classNames)("w-100 h-100",{"d-none":0!==a})},(0,e.jsx)(te,{onCardClick:o})),1===a&&(0,e.jsx)(he,{utilityId:n.utilityId,item:n.item,onNavBack:c,defaultTab:s}))}function ke(e){o.p=e}})(),c})())}}}));