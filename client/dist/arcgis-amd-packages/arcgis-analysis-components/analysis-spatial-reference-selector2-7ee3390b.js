define(["exports","./index-60d8a971","./index2-31657c04","./utils-c381fe27","./analysis-tree2-ccbef938","./debounce-c1955a21"],(function(e,t,s,a,i,r){"use strict";const l=t.proxyCustomElement(class extends t.H{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.analysisSpatialReferenceValueChange=t.createEvent(this,"analysisSpatialReferenceValueChange",7),this.analysisSpatialReferenceSelectorDismissed=t.createEvent(this,"analysisSpatialReferenceSelectorDismissed",7),this.searchText="",this.performantFilterSpatialReferences=r.debounce((e=>{this.updateSearchResults(e)}),250,{leading:!1,trailing:!0}),this.autoFilterToDefault=!1,this.defaultWkid=4326,this.value=void 0,this.hideCategories=void 0,this.hideDone=!1,this.searchResults=void 0}onAutoFilterToDefaultChange(){this.autoFilterSpatialReferences()}onDefaultWkidChange(){this.autoFilterSpatialReferences()}async getSRDescription(){return void 0!==this.value?.latestWkid?Promise.resolve(s.getSpatialReferenceDescription(this.value?.latestWkid)):Promise.resolve(void 0)}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await s.fetchComponentLocaleStrings(this.hostElement,t.getAssetPath("."))),this.value=this.value??{latestWkid:this.defaultWkid};const e=this.filterSrCategories(s.srCategories);this.visibleSrCategories=this.translateSrCategories(e)}componentDidLoad(){this.autoFilterSpatialReferences()}translateSrCategories(e){const t={};return this.recursiveTranslate(e,t),t}recursiveTranslate(e,t){Object.keys(e).forEach((s=>{const a=this.getTranslatedKey(s);"object"==typeof e[s]?(t[a]={},this.recursiveTranslate(e[s],t[a])):t[a]=e[s]}))}getTranslatedKey(e){return e in this.strings?this.strings[e]:e}filterSrCategories(e){const t={};return Object.keys(e).forEach((s=>{void 0!==this.hideCategories&&!1!==this.hideCategories?.includes(s)||("object"==typeof e[s]?t[s]=this.filterSrCategories(e[s]):t[s]=e[s])})),t}setSpatialRef(e){this.value={latestWkid:Number(e)},this.analysisSpatialReferenceValueChange.emit(this.value)}inputKeyDown(e){"Enter"===e.key&&this.selectFirstChild(!0)}selectFirstChild(e){const t=this.treeElement,s=t?.shadowRoot?.querySelector("calcite-tree-item:not([has-children]):not([data-key='placeholder'])")||void 0;void 0!==t&&void 0!==s&&(s.selected=!0,this.setSpatialRef(s.dataset.key??""),e&&s.focus())}updateSearchResults(e){this.searchResults=s.filterSpatialReferences(e)}searchSpatialReferences(e){null!==e.target&&this.setSearchText(e.target.value??"")}setSearchText(e){this.searchText=e,this.searchText.length>1?this.performantFilterSpatialReferences(this.searchText):this.searchResults=void 0}autoFilterSpatialReferences(){this.autoFilterToDefault&&!1===s.isEmptyDataItem(this.defaultWkid)&&void 0!==this.searchInput&&(this.searchInput.value=this.defaultWkid.toString(),this.setSearchText(this.searchInput.value))}render(){const e=s.formatMessage(this.strings.noMatchesFound,{searchTerm:this.searchText??""});return t.h(t.Host,{key:"51572ef241c26e14702932ecaa936d3db3832d43",dir:this.dir},t.h("calcite-panel",{key:"9d779d77cc12560a57112e4c350dea9c2e77dbb1",closable:!1,closed:!1,onCalcitePanelClose:()=>this.analysisSpatialReferenceSelectorDismissed.emit(this.value)},t.h("calcite-input",{key:"5e86a1959b3db5dd541b62652b559d963efbaaf1",onCalciteInputInput:e=>this.searchSpatialReferences(e),onKeyDown:e=>this.inputKeyDown(e),placeholder:this.strings.searchPlaceholder,scale:a.UIDefaults.Scale,type:"search",icon:!0,autofocus:!0,ref:e=>this.searchInput=e}),this.searchText.length>1&&s.isEmptyDataItem(this.searchResults)&&t.h("p",{key:"c0a39a0282a2ece27ac03c650e7cf806a7f607ba",class:"no-matches-found-msg"},e),t.h("analysis-tree",{key:"tree",ref:e=>this.treeElement=e,data:void 0!==this.searchResults&&this.searchText.length>0?this.searchResults:this.visibleSrCategories,value:this.value&&`${this.value?.latestWkid}`,onAnalysisTreeValueChange:()=>{this.setSpatialRef(this.treeElement.value)}}),this.hideDone?void 0:t.h("calcite-button",{appearance:"solid",scale:a.UIDefaults.Scale,width:"full",slot:"footer-actions",onClick:()=>this.analysisSpatialReferenceSelectorDismissed.emit(this.value)},this.strings.done)))}static get assetsDirs(){return["t9n"]}get hostElement(){return this}static get watchers(){return{autoFilterToDefault:["onAutoFilterToDefaultChange"],defaultWkid:["onDefaultWkidChange"]}}static get style(){return":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:#d4d4d4;--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh}:host{overflow-y:hidden;display:flex;flex-direction:column;--calcite-color-border-input:var(--analysis-ui-border-input);height:var(--analysis-popover-content-height);min-width:20rem;max-width:27rem}.no-matches-found-msg{margin:var(--analysis-half-spacing);font-size:var(--calcite-font-size--2)}analysis-tree{flex:1}"}},[1,"analysis-spatial-reference-selector",{autoFilterToDefault:[4,"auto-filter-to-default"],defaultWkid:[514,"default-wkid"],value:[1040],hideCategories:[16],hideDone:[4,"hide-done"],searchResults:[32],getSRDescription:[64]},void 0,{autoFilterToDefault:["onAutoFilterToDefaultChange"],defaultWkid:["onDefaultWkidChange"]}]);function n(){"undefined"!=typeof customElements&&["analysis-spatial-reference-selector","analysis-tree"].forEach((e=>{switch(e){case"analysis-spatial-reference-selector":customElements.get(e)||customElements.define(e,l);break;case"analysis-tree":customElements.get(e)||i.defineCustomElement()}}))}n(),e.AnalysisSpatialReferenceSelector=l,e.defineCustomElement=n}));