define(["exports","./index2-672b5477","./index3-09fcd769","./popover-utils-293df12e","./store-f238135f"],(function(e,t,s,i,l){"use strict";const r=t.proxyCustomElement(class extends t.H{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.handleAnalysisHelpClick=async({helpId:e,heading:t,referenceElement:l})=>{const r=await s.getOutputRasterHelpTemplate(e);this.toolHelpPopover=i.showHelp(this.toolHelpPopover,{helpSrcdoc:r,helpId:e,heading:t,referenceElement:l,learnMoreBaseUrl:this.portal?.sourceJSON?.helpBase,offsetDistance:20,offsetSkidding:0}),this.toolHelpPopover.addEventListener("analysisHelpPopoverClose",(()=>{i.removeOpenableDomElement(this.toolHelpPopover)}))},this.outputParameters=void 0,this.portal=void 0,this.rfxName=void 0,this.rfxTitle=void 0}async componentWillLoad(){({strings:this.strings}=await t.fetchComponentLocaleStrings(this.hostElement,t.getAssetPath("."))),!1===t.isEmptyDataItem(this.outputParameters)&&(this.outputParametersObj=JSON.parse(this.outputParameters))}async getOutputParameters(){const e=t.formatMessage(this.strings?.outputDescriptionRFT,{rfxName:this.rfxTitle})??"";return Promise.resolve({serviceProperties:{name:this.outputNameInputElement?.value,capabilities:!0===l.state.portal?.isPortal||this.resultTypeInputElement?.value===s.RESULT_TYPE.DYNAMIC?"Image":"Image, TilesOnly"},itemProperties:{description:e,snippet:e,folderId:this.folderInputElement?.value}})}async resetRFxOutputParameters(){return this.outputNameInputElement.value="",this.resultTypeInputElement.value=s.RESULT_TYPE.TILED,Promise.resolve()}async validateRFxOutput(){const e=[];return void 0!==this.outputNameInputElement&&null!==this.outputNameInputElement&&e.push(this.outputNameInputElement.checkValidity()),void 0!==this.resultTypeInputElement&&null!==this.resultTypeInputElement&&e.push(this.resultTypeInputElement.checkValidity()),{valid:!(await Promise.all(e)).some((e=>!1===e)),errorKeys:[t.DEFAULT_ERROR_KEY]}}render(){const{user:e}=this.portal??{},i=e?.privileges?.includes("portal:publisher:publishTiledImagery")&&!e?.privileges?.includes("portal:publisher:publishDynamicImagery"),r=e?.privileges?.includes("portal:publisher:publishDynamicImagery")&&!e?.privileges?.includes("portal:publisher:publishTiledImagery");return t.h("analysis-block",{key:"5dc13366425e7d0e6cb476ac759f305b96e967e8",label:this.strings.resultLayer,summaryText:this.strings.summaryText},t.h("analysis-string-input",{key:"8e378d3a14e31de890425c15e69ea3fb4ad1bdbe",label:this.strings.outputName,required:!0,selectionMode:"single",placeholderText:this.strings.outputNamePlaceHolder,value:this.outputParametersObj?.serviceProperties?.name,ref:e=>{this.outputNameInputElement=e},onAnalysisHelpClick:()=>this.handleAnalysisHelpClick({helpId:"outputName",heading:this.strings.outputName,referenceElement:this.outputNameInputElement})}),!0!==l.state.portal?.isPortal?t.h("analysis-string-input",{label:this.strings.resultType,choiceList:r?[s.RESULT_TYPE.DYNAMIC]:i?[s.RESULT_TYPE.TILED]:[s.RESULT_TYPE.TILED,s.RESULT_TYPE.DYNAMIC],choiceListIcons:r?{DYNAMIC_IMAGERY_LAYER:"image-layer"}:i?{TILED_IMAGERY_LAYER:"tiled-imagery-layer"}:{TILED_IMAGERY_LAYER:"tiled-imagery-layer",DYNAMIC_IMAGERY_LAYER:"image-layer"},choiceListLabels:r?{DYNAMIC_IMAGERY_LAYER:this.strings.dynamicLayer}:i?{TILED_IMAGERY_LAYER:this.strings.tileImagery}:{TILED_IMAGERY_LAYER:this.strings.tileImagery,DYNAMIC_IMAGERY_LAYER:this.strings.dynamicLayer},value:"Image"===this.outputParametersObj?.serviceProperties?.capabilities&&!r&&!i||r?s.RESULT_TYPE.DYNAMIC:s.RESULT_TYPE.TILED,ref:e=>{this.resultTypeInputElement=e},onAnalysisHelpClick:()=>this.handleAnalysisHelpClick({helpId:"resultType",heading:this.strings.resultType,referenceElement:this.resultTypeInputElement})}):null,t.h("analysis-folder-input",{key:"035811b6b92979031b7f83633a4bacb7fe3fc42b",label:this.strings.saveFolder,user:e,value:this.outputParametersObj?.itemProperties?.folderId,ref:e=>{this.folderInputElement=e},onAnalysisHelpClick:()=>this.handleAnalysisHelpClick({helpId:"saveResultIn",heading:this.strings.saveFolder,referenceElement:this.folderInputElement})}))}static get assetsDirs(){return["t9n"]}get hostElement(){return this}},[1,"analysis-rfx-output",{outputParameters:[1,"output-parameters"],portal:[16],rfxName:[1,"rfx-name"],rfxTitle:[513,"rfx-title"],getOutputParameters:[64],resetRFxOutputParameters:[64],validateRFxOutput:[64]}]);function a(){"undefined"!=typeof customElements&&["analysis-rfx-output"].forEach((e=>{"analysis-rfx-output"===e&&(customElements.get(e)||customElements.define(e,r))}))}a(),e.AnalysisRFxOutput=r,e.defineCustomElement=a}));