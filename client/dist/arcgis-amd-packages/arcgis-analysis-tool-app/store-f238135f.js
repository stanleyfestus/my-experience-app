define(["exports","./index2-672b5477","./shared-components-01868776"],(function(e,t,n){"use strict";const o=e=>!("isConnected"in e)||e.isConnected,s=(()=>{let e;return(...t)=>{e&&clearTimeout(e),e=setTimeout((()=>{e=0,(e=>{for(let t of e.keys())e.set(t,e.get(t).filter(o))})(...t)}),2e3)}})(),i=e=>"function"==typeof e?e():e,r=t.getLocaleInfo().locale,a=(e=>{const n=((e,t=(e,t)=>e!==t)=>{const n=i(e);let o=new Map(Object.entries(null!=n?n:{}));const s={dispose:[],get:[],set:[],reset:[]},r=()=>{var t;o=new Map(Object.entries(null!==(t=i(e))&&void 0!==t?t:{})),s.reset.forEach((e=>e()))},a=e=>(s.get.forEach((t=>t(e))),o.get(e)),c=(e,n)=>{const i=o.get(e);t(n,i,e)&&(o.set(e,n),s.set.forEach((t=>t(e,n,i))))},l="undefined"==typeof Proxy?{}:new Proxy(n,{get:(e,t)=>a(t),ownKeys:e=>Array.from(o.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>o.has(t),set:(e,t,n)=>(c(t,n),!0)}),p=(e,t)=>(s[e].push(t),()=>{((e,t)=>{const n=e.indexOf(t);n>=0&&(e[n]=e[e.length-1],e.length--)})(s[e],t)});return{state:l,get:a,set:c,on:p,onChange:(t,n)=>{const o=p("set",((e,o)=>{e===t&&n(o)})),s=p("reset",(()=>n(i(e)[t])));return()=>{o(),s()}},use:(...e)=>{const t=e.reduce(((e,t)=>(t.set&&e.push(p("set",t.set)),t.get&&e.push(p("get",t.get)),t.reset&&e.push(p("reset",t.reset)),t.dispose&&e.push(p("dispose",t.dispose)),e)),[]);return()=>t.forEach((e=>e()))},dispose:()=>{s.dispose.forEach((e=>e())),r()},reset:r,forceUpdate:e=>{const t=o.get(e);s.set.forEach((n=>n(e,t,t)))}}})(e,void 0);return n.use((()=>{if("function"!=typeof t.getRenderingRef)return{};const e=new Map;return{dispose:()=>e.clear(),get:n=>{const o=t.getRenderingRef();o&&((e,t,n)=>{const o=e.get(t);o?o.includes(n)||o.push(n):e.set(t,[n])})(e,n,o)},set:n=>{const o=e.get(n);o&&e.set(n,o.filter(t.forceUpdate)),s(e)},reset:()=>{e.forEach((e=>e.forEach(t.forceUpdate))),s(e)}}})()),n})({analysisToolRef:void 0,context:{},creditUsageSettings:{askConfirmation:!0,creditThreshold:100},mapLevelContext:{},settingsSelectedExtentOption:n.ExtentOptions.Default,settingsSelectedOutSpatialRefOption:n.OutSROptions.SameAsInput,mapLayers:[],mapView:void 0,portal:void 0,portalHelpMap:void 0,locale:r}),c=a.state;a.onChange("settingsSelectedOutSpatialRefOption",(()=>{delete c.context.outSR,c.context={...c.context}})),a.onChange("settingsSelectedExtentOption",(e=>{switch(e){case n.ExtentOptions.Default:case n.ExtentOptions.Layer:case n.ExtentOptions.Coordinates:delete c.context.extent,c.context={...c.context};break;case n.ExtentOptions.MapExtent:c.context.extent=n.ExtentOptions.MapExtent,c.context={...c.context}}})),a.onChange("context",(()=>{void 0!==c.analysisToolRef&&(c.analysisToolRef.environmentSettings=c.context)})),e.DEFAULT_CREDIT_THRESHOLD=100,e.addContextToJobParams=function(e,o,s,i){const r={...c.context};r.extent===n.ExtentOptions.MapExtent&&void 0!==c.mapView?.extent&&(r.extent=t.getContextExtent(c.mapView?.extent)),void 0!==i&&i?.length>0&&i.forEach((e=>{delete r[e]}));const a=t.isEmptyDataItem(r)?e:{...e,context:r},l=a.context;if("Sample"===o){const e={...l,processAsMultidimensional:s?.processMultidimension};a.context=e}else if("FindOutliers"===o){const e=`${s?.randomGenerator} MERSENNE_TWISTER`,t={...l,randomGenerator:e};a.context=t}return a},e.getEnvSettingsLayerForStorage=function(e){let n;return n="layerDefinition"in e&&void 0!==e.layerDefinition?t.getFeatureCollectionValueForStorage(e):"url"in e&&void 0!==e.url?{url:t.sanitizeUrl(e.url)}:e,n},e.state=c}));