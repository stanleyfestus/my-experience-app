define(["exports","./index2-672b5477","./shared-components-01868776","./store-f238135f","./analysis-tool-context-f3d1c605"],(function(t,e,n,a,s){"use strict";const i="object"==typeof global&&global&&global.Object===Object&&global;var r="object"==typeof self&&self&&self.Object===Object&&self;const o=i||r||Function("return this")(),l=o.Symbol;var c=Object.prototype,p=c.hasOwnProperty,h=c.toString,u=l?l.toStringTag:void 0,d=Object.prototype.toString,y="[object Null]",f="[object Undefined]",g=l?l.toStringTag:void 0;function m(t){return null==t?void 0===t?f:y:g&&g in Object(t)?function(t){var e=p.call(t,u),n=t[u];try{t[u]=void 0;var a=!0}catch(t){}var s=h.call(t);return a&&(e?t[u]=n:delete t[u]),s}(t):function(t){return d.call(t)}(t)}function v(t){return null!=t&&"object"==typeof t}var x="[object Symbol]";function b(t){return"symbol"==typeof t||v(t)&&m(t)==x}const S=Array.isArray;var O=1/0,C=l?l.prototype:void 0,L=C?C.toString:void 0;function _(t){if("string"==typeof t)return t;if(S(t))return function(t,e){for(var n=-1,a=null==t?0:t.length,s=Array(a);++n<a;)s[n]=e(t[n],n,t);return s}(t,_)+"";if(b(t))return L?L.call(t):"";var e=t+"";return"0"==e&&1/t==-O?"-0":e}function E(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var R="[object AsyncFunction]",T="[object Function]",w="[object GeneratorFunction]",j="[object Proxy]";function k(t){if(!E(t))return!1;var e=m(t);return e==T||e==w||e==R||e==j}const I=o["__core-js_shared__"];var A,P=(A=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||""))?"Symbol(src)_1."+A:"",G=Function.prototype.toString;function D(t){if(null!=t){try{return G.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var $=/^\[object .+?Constructor\]$/,q=Function.prototype,H=Object.prototype,V=q.toString,F=H.hasOwnProperty,M=RegExp("^"+V.call(F).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function z(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!E(t)||(e=t,P&&P in e))&&(k(t)?M:$).test(D(t));var e}(n)?n:void 0}var N=function(){try{var t=z(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();const U=N;var W=9007199254740991,B=/^(?:0|[1-9]\d*)$/;function K(t,e){var n=typeof t;return!!(e=null==e?W:e)&&("number"==n||"symbol"!=n&&B.test(t))&&t>-1&&t%1==0&&t<e}function J(t,e,n){"__proto__"==e&&U?U(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Q(t,e){return t===e||t!=t&&e!=e}var X=Object.prototype.hasOwnProperty;function Y(t,e,n){var a=t[e];X.call(t,e)&&Q(a,n)&&(void 0!==n||e in t)||J(t,e,n)}var Z=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,tt=/^\w*$/;const et=z(Object,"create");var nt=Object.prototype.hasOwnProperty,at=Object.prototype.hasOwnProperty;function st(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var a=t[e];this.set(a[0],a[1])}}function it(t,e){for(var n=t.length;n--;)if(Q(t[n][0],e))return n;return-1}st.prototype.clear=function(){this.__data__=et?et(null):{},this.size=0},st.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},st.prototype.get=function(t){var e=this.__data__;if(et){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return nt.call(e,t)?e[t]:void 0},st.prototype.has=function(t){var e=this.__data__;return et?void 0!==e[t]:at.call(e,t)},st.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=et&&void 0===e?"__lodash_hash_undefined__":e,this};var rt=Array.prototype.splice;function ot(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var a=t[e];this.set(a[0],a[1])}}ot.prototype.clear=function(){this.__data__=[],this.size=0},ot.prototype.delete=function(t){var e=this.__data__,n=it(e,t);return!(n<0||(n==e.length-1?e.pop():rt.call(e,n,1),--this.size,0))},ot.prototype.get=function(t){var e=this.__data__,n=it(e,t);return n<0?void 0:e[n][1]},ot.prototype.has=function(t){return it(this.__data__,t)>-1},ot.prototype.set=function(t,e){var n=this.__data__,a=it(n,t);return a<0?(++this.size,n.push([t,e])):n[a][1]=e,this};const lt=z(o,"Map");function ct(t,e){var n,a,s=t.__data__;return("string"==(a=typeof(n=e))||"number"==a||"symbol"==a||"boolean"==a?"__proto__"!==n:null===n)?s["string"==typeof e?"string":"hash"]:s.map}function pt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var a=t[e];this.set(a[0],a[1])}}pt.prototype.clear=function(){this.size=0,this.__data__={hash:new st,map:new(lt||ot),string:new st}},pt.prototype.delete=function(t){var e=ct(this,t).delete(t);return this.size-=e?1:0,e},pt.prototype.get=function(t){return ct(this,t).get(t)},pt.prototype.has=function(t){return ct(this,t).has(t)},pt.prototype.set=function(t,e){var n=ct(this,t),a=n.size;return n.set(t,e),this.size+=n.size==a?0:1,this};function ht(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var a=arguments,s=e?e.apply(this,a):a[0],i=n.cache;if(i.has(s))return i.get(s);var r=t.apply(this,a);return n.cache=i.set(s,r)||i,r};return n.cache=new(ht.Cache||pt),n}ht.Cache=pt;var ut,dt,yt,ft=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gt=/\\(\\)?/g,mt=(ut=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ft,(function(t,n,a,s){e.push(a?s.replace(gt,"$1"):n||t)})),e},dt=ht(ut,(function(t){return 500===yt.size&&yt.clear(),t})),yt=dt.cache,dt);const vt=mt;function xt(t,e){return S(t)?t:function(t,e){if(S(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!b(t))||tt.test(t)||!Z.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:vt(function(t){return null==t?"":_(t)}(t))}var bt=1/0;function St(t){if("string"==typeof t||b(t))return t;var e=t+"";return"0"==e&&1/t==-bt?"-0":e}function Ot(t,e,n,a){if(!E(t))return t;for(var s=-1,i=(e=xt(e,t)).length,r=i-1,o=t;null!=o&&++s<i;){var l=St(e[s]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(s!=r){var p=o[l];void 0===(c=a?a(p,l,o):void 0)&&(c=E(p)?p:K(e[s+1])?[]:{})}Y(o,l,c),o=o[l]}return t}function Ct(t,e,n){return null==t?t:Ot(t,e,n)}const Lt=e.proxyCustomElement(class extends e.H{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.analysisToolStandardSettingsHelpClick=e.createEvent(this,"analysisToolStandardSettingsHelpClick",7),this.mapExtentInputs=[],this.stateContextChanged=!1,this.setIncomingLayerObjects=async()=>{const t={};a.state.settingsSelectedExtentOption===n.ExtentOptions.Layer&&void 0!==a.state.mapLevelContext.extentLayer&&(t.extentLayer=await e.getLayer(a.state.mapLevelContext.extentLayer,a.state.mapLayers)),a.state.settingsSelectedOutSpatialRefOption===n.OutSROptions.SameAsLayer&&void 0!==a.state.mapLevelContext.spatialRefLayer&&(t.spatialRefLayer=await e.getLayer(a.state.mapLevelContext.spatialRefLayer,a.state.mapLayers)),this.incomingLayerObjects=t},this.handleExtentChange=(t,n)=>{Ct(a.state.context,["extent",t],n);const s=a.state.context.extent;void 0!==a.state.mapView?.spatialReference&&(s.spatialReference=a.state.mapView.spatialReference,a.state.context.extent=e.getContextExtent(s)),a.state.context={...a.state.context}},this.handleCalciteListChange=async t=>{const[e]=(await(t.target?.getSelectedItems())).values();a.state.settingsSelectedExtentOption=e.value,this.incomingLayerObjects.extentLayer=void 0,this.extentPopover?.remove()},this.setMapExtent=()=>{void 0!==a.state.mapView&&(a.state.context.extent=e.getContextExtent(a.state.mapView.extent)),a.state.context={...a.state.context},this.stateContextChanged=!0},this.handleLayerInputClose=t=>{"extent"===t?(delete a.state.context.extent,this.incomingLayerObjects.extentLayer=void 0):"spatialReference"===t&&(delete a.state.context.outSR,this.incomingLayerObjects.spatialRefLayer=void 0),this.incomingLayerObjects={...this.incomingLayerObjects},a.state.context={...a.state.context}},this.handleLayerInputChange=(t,n)=>{const s=t.target?.selectedLayers;if("extent"===n&&void 0!==s?.fullExtent)a.state.context.extent=e.getContextExtent(s.fullExtent);else if(void 0!==s&&"spatialReference"in s){const{wkid:t,latestWkid:n,wkt:i}=s?.spatialReference;e.isEmptyDataItem(t)||Ct(a.state.context,"outSR.wkid",t),e.isEmptyDataItem(n)||Ct(a.state.context,"outSR.latestWkid",n),e.isEmptyDataItem(i)||Ct(a.state.context,"outSR.wkt",i)}a.state.context={...a.state.context}},this.createExtentPopover=t=>{this.extentPopover?.remove(),this.extentPopover=document.createElement("calcite-popover");const e={autoClose:!0,dir:this.dir,focusTrapDisabled:!0,heading:this.strings.processingExtent,closable:!0,open:!0,referenceElement:t.target};Object.assign(this.extentPopover,e),this.extentPopover.addEventListener("calcitePopoverClose",this.extentPopover?.remove);const s=document.createElement("calcite-pick-list");s.addEventListener("calciteListChange",this.handleCalciteListChange);const i=[{label:this.strings.default,description:this.strings.defaultText,value:n.ExtentOptions.Default},{label:this.strings.coordinates,description:this.strings.coordinatesText,value:n.ExtentOptions.Coordinates},{label:this.strings.mapExtent,description:this.strings.mapExtentText,value:n.ExtentOptions.MapExtent},{label:this.strings.layer,description:this.strings.layerText,value:n.ExtentOptions.Layer}].map((t=>{const e=document.createElement("calcite-pick-list-item");return Object.assign(e,t),e.selected=e.value===a.state.settingsSelectedExtentOption,e}));s.append(...i),this.extentPopover.append(s),document.body.append(this.extentPopover),setTimeout((()=>requestAnimationFrame((()=>{this.extentPopover.open=!0,this.extentPopover?.setFocus()}))),1)},this.handleSpatialReferenceChange=t=>{a.state.context.outSR={latestWkid:t.detail.latestWkid}},this.getGeographicTransformationsChoiceList=()=>{const t=this.datumTransformationOptions,n=this.selectedGeographicTransformationOptions;if(!e.isEmptyDataItem(n))for(let e=n.length-1;e>=0;--e){const n=this.selectedGeographicTransformationOptions[e];t.splice(t.indexOf(n),1),t.unshift(n)}return t},this.handleGeographicTransformationInputChange=t=>{this.selectedGeographicTransformationOptions=t.target?.value,a.state.context.geographicTransformations=e.isEmptyDataItem(this.selectedGeographicTransformationOptions)?void 0:this.selectedGeographicTransformationOptions.join(";")},this.selectedGeographicTransformationOptions=void 0,this.hideOutSR=!1,this.hideGeographicTransformations=!1,this.hideCategories=["Vertical Coordinate Systems"],this.hideExtent=!1,this.incomingLayerObjects={}}async resetLayerDefaults(){return this.setIncomingLayerObjects(),Promise.resolve()}async validateStandardSettings(){let t=!0,e=!0;switch(a.state.settingsSelectedExtentOption){case n.ExtentOptions.Layer:const e=this.hostElement.shadowRoot?.querySelector(".extent");null!=e&&(t=await e.checkValidity());break;case n.ExtentOptions.Coordinates:const a=this.hostElement.shadowRoot?.querySelectorAll("analysis-number-input"),s=[];null!=a&&(a.forEach((t=>{s.push(t.checkValidity())})),t=!(await Promise.all(s)).some((t=>!1===t)))}switch(a.state.settingsSelectedOutSpatialRefOption){case n.OutSROptions.SameAsLayer:const t=this.hostElement.shadowRoot?.querySelector(".spatialReference");null!=t&&(e=await t.checkValidity());break;case n.OutSROptions.BrowseCS:const a=this.hostElement.shadowRoot?.querySelector("analysis-spatial-reference-input");null!=a&&(e=await a.checkValidity())}return Promise.resolve(e&&t)}async componentWillLoad(){this.setIncomingLayerObjects(),({strings:this.strings,dir:this.dir}=await e.fetchComponentLocaleStrings(this.hostElement,e.getAssetPath(".")));const t=Object.values(e.datumTransformations);this.datumTransformationOptions=[...new Set(t)]}componentDidRender(){this.stateContextChanged&&(setTimeout((()=>requestAnimationFrame((()=>this.mapExtentInputs?.forEach((t=>t?.checkValidity()))))),1),this.stateContextChanged=!1)}disconnectedCallback(){this.extentPopover?.remove(),this.coordinateSystemPopover?.remove()}renderCoordinateConfig(){const{strings:t}=this,{extent:s}=a.state.context;return e.h("div",null,e.h("calcite-button",{class:n.SharedHTMLClasses.controlSpacing,scale:n.UIDefaults.Scale,appearance:"outline",kind:"neutral",width:"full",onClick:this.setMapExtent},t.setCoordinates),e.h("calcite-label",null,t.top,e.h("analysis-number-input",{ref:t=>{this.mapExtentInputs.push(t)},required:!0,label:"",value:s?.ymax,scale:n.UIDefaults.Scale,onAnalysisNumberInputChange:t=>this.handleExtentChange("ymax",t.target?.value)})),e.h("calcite-label",null,t.bottom,e.h("analysis-number-input",{ref:t=>{this.mapExtentInputs.push(t)},required:!0,label:"",value:s?.ymin,scale:n.UIDefaults.Scale,onAnalysisNumberInputChange:t=>this.handleExtentChange("ymin",t.target?.value)})),e.h("calcite-label",null,t.left,e.h("analysis-number-input",{ref:t=>{this.mapExtentInputs.push(t)},required:!0,label:"",value:s?.xmin,scale:n.UIDefaults.Scale,onAnalysisNumberInputChange:t=>this.handleExtentChange("xmin",t.target?.value)})),e.h("calcite-label",null,t.right,e.h("analysis-number-input",{ref:t=>{this.mapExtentInputs.push(t)},required:!0,label:"",value:s?.xmax,scale:n.UIDefaults.Scale,onAnalysisNumberInputChange:t=>this.handleExtentChange("xmax",t.target?.value)})))}renderLayerInput(t){let n;const i=a.state.mapLayers;"extent"===t?n=this.incomingLayerObjects?.extentLayer:"spatialReference"===t&&(n=this.incomingLayerObjects?.spatialRefLayer);const r=void 0!==i.find((t=>t.id===n?.id));if(void 0!==n&&!1===r){let t;if(!1===e.isEmptyDataItem(n.url)){const e="layerId"in n?n.layerId:0;t=`${n.url}/${e}`}else t=n.title;void 0===e.findExistingLayer(t,a.state.mapLayers)&&i.push(n)}return e.h("analysis-layer-input",{class:t,required:!0,descriptionDisplay:"spatialReference",mapLayers:i,layerFilterType:[s.LayerFilterType.Imagery_All,s.LayerFilterType.Feature_All],selectedLayers:n,user:a.state.portal?.user,mapView:a.state.mapView,onAnalysisLayerInputClose:()=>this.handleLayerInputClose(t),onAnalysisLayerInputChange:e=>this.handleLayerInputChange(e,t)})}renderChooseSpatialReference(){const t=a.state.context.outSR?.latestWkid??a.state.context.outSR?.wkid;return e.h("analysis-spatial-reference-input",{errorMessage:void 0!==a.state.context.outSR?.wkt&&void 0===t?this.strings.unableToRepopulateOutSR:void 0,dir:this.dir,required:!0,onAnalysisSpatialReferenceInputChange:t=>this.handleSpatialReferenceChange(t),value:void 0!==t?{latestWkid:t}:void 0,hideCategories:this.hideCategories})}renderOutSR(){const{strings:t}=this;return e.h("div",null,e.h("analysis-label",{label:t.outputCS,onAnalysisLabelHelpActionClick:e=>this.analysisToolStandardSettingsHelpClick.emit({key:s.AnalysisToolContextKeys.OutSR,parameterName:t.outputCS,refElement:e.target})}),e.h("calcite-dropdown",{class:`display-block ${n.SharedHTMLClasses.controlSpacing}`,placement:"bottom",scale:n.UIDefaults.Scale},e.h("calcite-button",{class:n.SharedHTMLClasses.analysisBorder,alignment:"space-between",appearance:"transparent",kind:"neutral","icon-end":"chevron-down",scale:n.UIDefaults.Scale,slot:"trigger",width:"full"},t[a.state.settingsSelectedOutSpatialRefOption]),e.h("calcite-dropdown-group",null,e.h("calcite-dropdown-item",{onClick:()=>{a.state.settingsSelectedOutSpatialRefOption=n.OutSROptions.SameAsInput,this.incomingLayerObjects.spatialRefLayer=void 0}},t.sameAsInput),e.h("calcite-dropdown-item",{onClick:()=>{a.state.settingsSelectedOutSpatialRefOption=n.OutSROptions.BrowseCS,this.incomingLayerObjects.spatialRefLayer=void 0}},t.browseCS),e.h("calcite-dropdown-item",{onClick:()=>{a.state.settingsSelectedOutSpatialRefOption=n.OutSROptions.SameAsLayer,this.incomingLayerObjects.spatialRefLayer=void 0}},t.sameAsLayer))),a.state.settingsSelectedOutSpatialRefOption===n.OutSROptions.SameAsLayer&&this.renderLayerInput("spatialReference"),a.state.settingsSelectedOutSpatialRefOption===n.OutSROptions.BrowseCS&&this.renderChooseSpatialReference())}renderGeographicTransformation(){const t=a.state.context.geographicTransformations;void 0!==t&&(this.selectedGeographicTransformationOptions=t.split(";"));const{strings:n}=this;return e.h("analysis-string-input",{allowCustomValues:!1,choiceList:this.getGeographicTransformationsChoiceList(),label:n.geographicTransformations,placeholderText:n.geographicTransformationsPlaceholderText,required:!1,selectionMode:"multi",value:this.selectedGeographicTransformationOptions,onAnalysisStringInputChange:t=>this.handleGeographicTransformationInputChange(t),onAnalysisHelpClick:t=>this.analysisToolStandardSettingsHelpClick.emit({key:s.AnalysisToolContextKeys.GeographicTransformations,parameterName:n.geographicTransformations,refElement:t.target})})}renderExtent(){const{strings:t}=this,{settingsSelectedExtentOption:i}=a.state;return e.h("div",null,e.h("analysis-label",{label:t.processingExtent,onAnalysisLabelHelpActionClick:e=>this.analysisToolStandardSettingsHelpClick.emit({key:s.AnalysisToolContextKeys.Extent,parameterName:t.processingExtent,refElement:e.target})}),e.h("calcite-value-list-item",{class:[n.SharedHTMLClasses.controlSpacing,n.SharedHTMLClasses.analysisBorder].join(" "),label:t[i],description:t[`${i}Text`],value:i,onClick:t=>this.createExtentPopover(t)},e.h("calcite-action",{slot:"actions-end",icon:"chevron-down",text:""})),i===n.ExtentOptions.Coordinates&&this.renderCoordinateConfig(),i===n.ExtentOptions.Layer&&this.renderLayerInput("extent"))}render(){return e.h(e.Host,{key:"c001f34c437317182b1b050f2b1ad5352f9368cd"},!this.hideOutSR&&this.renderOutSR(),!this.hideOutSR&&!this.hideGeographicTransformations&&this.renderGeographicTransformation(),!this.hideExtent&&this.renderExtent())}static get assetsDirs(){return["t9n"]}get hostElement(){return this}static get style(){return":root{display:flex}.control-spacing{margin-bottom:var(--analysis-three-quarter-spacing)}.label-container{display:flex;margin-bottom:var(--analysis-quarter-spacing);gap:var(--analysis-quarter-spacing)}.analysis-border{border:1px solid var(--analysis-ui-border-input)}.notice-margin-global{margin:var(--analysis-full-spacing) var(--analysis-three-quarter-spacing)}:host{display:flex;flex-direction:column}.control-spacing{width:100%}.display-block{display:block}"}},[1,"analysis-tool-standard-settings",{hideOutSR:[516,"hide-out-s-r"],hideGeographicTransformations:[516,"hide-geographic-transformations"],hideCategories:[16],hideExtent:[516,"hide-extent"],selectedGeographicTransformationOptions:[32],incomingLayerObjects:[32],resetLayerDefaults:[64],validateStandardSettings:[64]}]);function _t(){"undefined"!=typeof customElements&&["analysis-tool-standard-settings"].forEach((t=>{"analysis-tool-standard-settings"===t&&(customElements.get(t)||customElements.define(t,Lt))}))}_t(),t.AnalysisToolStandardSettings=Lt,t.ListCache=ot,t.Map$1=lt,t.MapCache=pt,t.Symbol$1=l,t.assignValue=Y,t.baseAssignValue=J,t.baseGetTag=m,t.baseSet=Ot,t.castPath=xt,t.defineCustomElement=_t,t.defineProperty$1=U,t.eq=Q,t.freeGlobal$1=i,t.getNative=z,t.isArray$1=S,t.isFunction=k,t.isIndex=K,t.isObject=E,t.isObjectLike=v,t.root$1=o,t.toKey=St,t.toSource=D}));