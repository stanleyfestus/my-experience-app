System.register(["jimu-core","jimu-ui","esri/rest/query","esri/rest/support/Query","esri/geometry/SpatialReference"],(function(e,t){var r={},s={},o={},i={},n={};return{setters:[function(e){r.AllDataSourceTypes=e.AllDataSourceTypes,r.DataSourceComponent=e.DataSourceComponent,r.DataSourceManager=e.DataSourceManager,r.DataSourceStatus=e.DataSourceStatus,r.Immutable=e.Immutable,r.React=e.React,r.SessionManager=e.SessionManager,r.css=e.css,r.getAppStore=e.getAppStore,r.jsx=e.jsx,r.moduleLoader=e.moduleLoader,r.portalUrlUtils=e.portalUrlUtils,r.semver=e.semver},function(e){s.WidgetPlaceholder=e.WidgetPlaceholder},function(e){o.default=e.default},function(e){i.default=e.default},function(e){n.default=e.default}],execute:function(){e((()=>{var e={51705:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" d="M10.227 13.694 7.211 10.55c-.294-.307-.28-.818.03-1.143.312-.324.802-.339 1.096-.032l2.66 2.774 4.695-4.896c.311-.324.802-.339 1.095-.032.294.306.28.817-.03 1.142l-5.113 5.33a.974.974 0 0 1-1.418 0"></path><path fill="#000" fill-rule="evenodd" d="M20 2c0-1.105-.948-2-2.118-2H4.118C2.948 0 2 .895 2 2v2H1a1 1 0 0 0 0 2h1v3H1a1 1 0 1 0 0 2h1v3H1a1 1 0 1 0 0 2h1v2c0 1.105.948 2 2.118 2h13.764c1.17 0 2.118-.895 2.118-2zM3 16v2c0 .552.478 1 1.067 1h13.866c.59 0 1.067-.448 1.067-1V2c0-.552-.478-1-1.067-1H4.067C3.477 1 3 1.448 3 2v2h1a1 1 0 0 1 0 2H3v3h1a1 1 0 1 1 0 2H3v3h1a1 1 0 1 1 0 2z" clip-rule="evenodd"></path></svg>'},53205:e=>{"use strict";e.exports=n},61222:e=>{"use strict";e.exports=o},36510:e=>{"use strict";e.exports=i},79244:e=>{"use strict";e.exports=r},14321:e=>{"use strict";e.exports=s}},t={};function a(r){var s=t[r];if(void 0!==s)return s.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,a),o.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="";var l={};return a.p=window.jimuConfig.baseUrl,(()=>{"use strict";a.r(l),a.d(l,{__set_webpack_public_path__:()=>p,default:()=>h});var e=a(79244),t=a(14321);const r=new class{setQueryObject(e){const t=e?e.survey123:"",r=t?decodeURIComponent(t+""):"",s=this._urlParamToJson(r);this.queryObj=s}getSurveyHostUrlFromPortal(e){if(e=e||"https://www.arcgis.com",this.surveyUrlFromPortal||null===this.surveyUrlFromPortal)return Promise.resolve(this.surveyUrlFromPortal);const t=window.esriGeowConfig;if(t&&t.surveyUrl)return this.surveyUrlFromPortal=t.surveyUrl,Promise.resolve(this.surveyUrlFromPortal);let r="";e.endsWith("/")||(e+="/"),r=e+"home/js/arcgisonline/config.js";const s=document.createElement("script");s.type="text/javascript",s.src=r;const o=document.documentElement,i=o.getAttribute("dir");return new Promise(((e,t)=>{s.onload=()=>{o.getAttribute("dir")!==i&&o.setAttribute("dir",i);const t=window.esriGeowConfig;t&&t.surveyUrl?(this.surveyUrlFromPortal=t.surveyUrl,e(t.surveyUrl)):(this.surveyUrlFromPortal=null,e(null))},s.onerror=()=>{o.getAttribute("dir")!==i&&o.setAttribute("dir",i),console.log("Failed to get survey url from portal's config.js, will fallback to use the default survey123 url."),this.surveyUrlFromPortal=null,e(null)},document.getElementsByTagName("head")[0].appendChild(s)}))}getSurvey123HostUrl(){let e="https://survey123.arcgis.com";this.surveyUrlFromPortal&&(e=this.surveyUrlFromPortal);let t=window.jimuConfig.hostEnv;if(this.queryObj&&this.queryObj.env&&(t=this.queryObj.env+"",t.startsWith("http://")||t.startsWith("https://")))return t;let r=!0;if("https://survey123.arcgis.com"!==e){const t=e.match(/https:\/\/survey123(\.[^\.]*)\.arcgis\.com/);r=!(!t||!t.length)}return t&&"prd"!==t&&"prod"!==t&&r&&(e=`https://survey123${t}.arcgis.com`),e}getSurvey123HostAPIUrl(){let e=this.getSurvey123HostUrl()+"/api/jsapi/3.20/";return this.queryObj&&this.queryObj.jsapi&&(e=this.getSurvey123HostUrl()+"/api/jsapi/"+this.queryObj.jsapi),e}createSurvey(e,t,r,s){return s=Object.assign({snippet:""},s||{}),Promise.resolve(!0).then((()=>{if(!(e&&r&&r.token&&r.username))throw new Error("missing title, tags, username or token")})).then((()=>{const o=`${this.getSurvey123HostUrl()}/api/survey/create`,i={title:e,tags:t&&Array.isArray(t)?t.join(","):t||null,snippet:s.snippet,thumbnailUrl:s.thumbnailUrl,token:r.token,username:r.username,portalUrl:r.portalUrl||"https://www.arcgis.com"};return fetch(o,{mode:"cors",method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(i)}).then((e=>{if(e.ok)return e.json();throw e}))}))}isPortal(e){return!["www.arcgis.com","devext.arcgis.com","qaext.arcgis.com"].find(((t,r)=>e.includes(t)))}querySurvey(e,t){return t=Object.assign({isPublished:!1,isSearchAll:!0,surveyClientAPI:null},t||{}),Promise.resolve(!0).then((()=>{if(!e||!e.token||!e.username)throw new Error("missing token or username")})).then((()=>{const r={isPublished:t.isPublished,isSearchAll:t.isSearchAll,token:e.token,username:e.username,portalUrl:e.portalUrl||"https://www.arcgis.com"};return t.searchSurveyType&&(r.searchSurveyType=t.searchSurveyType),t.surveyClientAPI?t.surveyClientAPI.survey123.searchSurvey(r).then((e=>{if(e&&e.results)return e.results;throw e})):(console.log("Survey client api is not provided."),null)}))}queryOthersSurvey(e,t){return Promise.resolve(!0).then((()=>{if(!e||!e.token||!e.username)throw new Error("missing token or username")})).then((()=>{e.token;const r=e.username,s=e.portalUrl||"https://www.arcgis.com",o=t.orgId;let i=null;const n=`${s}/sharing/rest/search`,a={q:`((type:Form AND (typekeywords:xForm OR typekeywords:Form)) OR (type:'Code Sample' AND typekeywords:XForms AND tags:'xform')) AND (NOT owner:${r}) AND (access:shared OR access:org OR (access:public AND orgid:${o}) OR access:private)`};return this.searchAGO(n,a,e).then((t=>{if(i=t,t.results=(t.results||[]).map((t=>this.convertItemToSurveyInfo(t,e))),-1===t.nextStart)return i;const r=[];let s=Math.floor(t.total/t.num);t.total%t.num>0&&(s+=1);for(let o=1;o<s;o++){const s=Object.assign({},a,{start:o*t.num+1});s.start<=t.total&&r.push(this.searchAGO(n,s,e))}return Promise.all(r).then((r=>{if(!r)throw new Error("something wrong when searchAll");let s=t.results||[],o=-1;return r.forEach(((t,i)=>{const n=t.results.map((t=>this.convertItemToSurveyInfo(t,e)));s=s.concat(n),i===r.length-1&&(o=t.nextStart)})),i.nextStart=o,i.results=s,i}))}))})).then((e=>e&&e.results||[]))}searchAGO(e,t,r){t=Object.assign({num:100,start:1,sortField:"title",sortOrder:"asc"},t);const s=Object.assign({},{f:"json",token:r.token},t),o=`${e}?${Object.keys(s).map((e=>e+"="+s[e])).join("&")}`;return fetch(o,{mode:"cors",method:"GET"}).then((e=>{if(e.ok)return e.json();throw e}))}convertItemToSurveyInfo(e,t){return{created:e.created,featureService:null,form:null,formItemInfo:e,id:e.id,owner:e.owner,report:null,snippet:e.snippet,tags:e.tags,thumbnail:`${t.portalUrl}/sharing/rest/content/items/${e.id}/info/${e.thumbnail}?token=${t.token}`,title:e.title}}getSurvey123DesignerUrl(e,t){t=Object.assign({},t||{});let r=`${this.getSurvey123HostUrl()}/surveys/${e}/design?embed=exb`;return t.portalUrl&&"https://www.arcgis.com"!==t.portalUrl&&(r+=`&portalUrl=${t.portalUrl}`),"https://survey123dev.arcgis.com"!==this.getSurvey123HostUrl()||t.portalUrl&&"https://www.arcgis.com"!==t.portalUrl||(r+=`&portalUrl=${t.portalUrl}`),r}getSurvey123WebformUrl(e,t){t=Object.assign({queryParams:[]},t||{});let r=`${this.getSurvey123HostUrl()}/share/${e}`;return t.queryParams.length>0&&(r+=`?${t.queryParams.join("&")}`),r}flatQuestions(e){let t=[];return e.forEach((e=>{e.questions?"esriQuestionTypeRepeat"!==e.type&&("esriQuestionTypeAddress"===e.type&&t.push(e),t=t.concat(this.flatQuestions(e.questions))):t.push(e)})),t}getSurveyQuestionFields(e,t){return Promise.resolve(!0).then((()=>{if(!e||!t||!t.token)throw new Error("missing surveyItemId or token")})).then((()=>{let r=`${this.getSurvey123HostUrl()}/api/survey/${e}/form`;const s={token:t.token,portalUrl:t.portalUrl};return r=`${r}?${Object.keys(s).map((e=>e+"="+s[e])).join("&")}`,fetch(r,{mode:"cors",method:"GET"}).then((e=>{if(e.ok)return e.json();throw e}))}))}getQuesLabelString(e,t){var r;if(t=Object.assign({locales:[],currentLocale:"en"},t||{}),!e||!e.label)return"";let s=e.label;if("object"==typeof s){let o=Object.keys(t.locales||[]).find((e=>e.isDefault+""=="true"));o&&(o=o.code||"en");const i=null===(r=t.locales)||void 0===r?void 0:r.map((e=>(e.code+"").trim())),n=this._findMatchedLocale(t.currentLocale,i)||o;if(n&&n in e.label)s=e.label[n];else{const t=Object.keys(e.label)[0];s=t?e.label[t]:""}}return s}_urlParamToJson(e){if(!e)return null;const t=(e+="").split(";");if(t.length<2&&e.split(":").length<2)return e.split(",").length>1?e.split(","):e;{const e={};return t.forEach((t=>{const r=(t+"").split(":");if(r.length>1){const t=r[0];let s=(Array.isArray(r.slice(1))?r.slice(1):[]).join(":");s.length&&"{"===s[0]&&(s=this._stringToJson(s)),"string"==typeof s&&s.split(",").length>1&&(s=s.split(",")),e[t]=s}})),e}}_findMatchedLocale(e,t){if(!t||!t.length||!e)return null;if(t.indexOf(e)>=0)return e;const r=e.split("-")[0];return t.indexOf(r)>=0?r:t.find((e=>e.startsWith(`${r}-`)))}_stringToJson(e){let t=e;try{t=JSON.parse(e)}catch(r){t=e}return t}};const s="Survey";var o=a(51705),i=a.n(o),n=a(61222),u=a(36510),c=a(53205);class d extends e.React.PureComponent{constructor(t){super(t),this.API={Survey123WebForm:null},this.webappStatus="normal",this.state={featureLayerViewDS:null},this._dsManager=e.DataSourceManager.getInstance(),this._isMapViewAddedClickEvent=!1,this.prepare=()=>{const t=this.props.config.portalUrl||this.props.portalUrl||"https://www.arcgis.com",s=!e.portalUrlUtils.isAGOLDomain(t);return Promise.resolve(!0).then((()=>!s||r.getSurveyHostUrlFromPortal(t))).then((()=>this.loadSurveyAPI()))},this.loadSurveyAPI=()=>{const t=r.getSurvey123HostAPIUrl();return this.API.Survey123WebForm?Promise.resolve(this.API.Survey123WebForm):e.moduleLoader.loadModule(t).then((e=>(e&&e.Survey123WebForm?this.API=e:this.API.Survey123WebForm=e,this.API.Survey123WebForm)))},this.updateDomId=()=>{const e=(1e6*Math.random()|0).toString();return this.domId="survey_container_"+this.props.id+"_"+e,this.domId},this.isDsConfigured=()=>{const e=this.props.config.mode||"new";return!(!this.props.useDataSources||1!==this.props.useDataSources.length||!this.props.config.activeLinkData&&"edit"!==e&&"view"!==e)},this.doQuery=t=>{const r={geometry:t,spatialRelationship:"intersects",returnGeometry:!0};this.getUsedDataSource().getStatus()!==e.DataSourceStatus.Loading&&this.getUsedDataSource().load(r)},this.checkWebformOptionChanged=e=>{const t=this._formOption;return!Object.is(t,e)&&(!(t||!e)||(t.itemId!==e.itemId||t.surveyItemId!==e.surveyItemId||t.portalUrl!==e.portalUrl||t.token!==e.token||t.surveyStatusCode!==e.surveyStatusCode||(t.mode||"new")!==(e.mode||"new")||("edit"===e.mode||"view"===e.mode)&&this._cachedUniqueId!==this._currentGlobalId||(t.hideElements?t.hideElements.asMutable():[]).sort().join(",")!==(e.hideElements?e.hideElements.asMutable():[]).sort().join(",")))},this.updateStyle=()=>{if("safari"===(window.jimuUA.browser?(window.jimuUA.browser.name+"").toLowerCase():"")){const e=document.querySelector("#"+this.domId);e.style.cssText="overflow-y: auto;";e.closest(".widget-content").style.cssText="position: absolute;"}},this.getSelectedDsRecord=e=>{var t;if(!e)return Promise.resolve(null);const r=e.getSelectedRecords();if(!r||!r.length||!r[0].feature)return Promise.resolve(null);const s=r[0].feature;let o=!1;const i=this.props.config.mode||"new";let a=[];if("new"===i&&this.props.config.activeLinkData&&this.props.config.fieldQuestionMapping)this.props.config.fieldQuestionMapping.forEach((e=>{a.push(e.field)}));else if("view"===i||"edit"===i){const e=this.getUniqueFieldName();a=e?[e]:[]}if(s.attributes){const e=Object.keys(s.attributes);o=a.find((t=>!e.includes(t)))}if(!o){let e=null===(t=s.geometry)||void 0===t?void 0:t.spatialReference;if(!e)return Promise.resolve(s);if(e=new c.default("function"==typeof e.toJSON?e.toJSON():e),e.isWGS84)return Promise.resolve(s);if((s.geometry.longitude||0===s.geometry.longitude)&&(s.geometry.latitude||0===s.geometry.latitude))return Promise.resolve(s)}if(!e.url)return Promise.resolve(s);const l=e.getIdField()||"objectid",d=new u.default({where:`${l} = ${s.attributes[l]}`,outFields:["*"],returnGeometry:!0,outSpatialReference:new c.default({wkid:4326})});return n.default.executeQueryJSON(e.url,d).then((e=>e.features&&e.features[0]?e.features[0]:s))},this.onDataSourceCreated=()=>{},this.onDataSourceInfoChange=()=>{const t=this._dsManager.getDataSource(this.props.useDataSources[0].dataSourceId);if(t){const r=t.getSelectedRecords();if(r&&r.length){const s=r[0].feature,o=this.props.config.mode||"new",i=this.getFeatureUniqueId(s,"new"===o);if(!i||i!==this._cachedUniqueId){t.type===e.AllDataSourceTypes.SceneLayer?this.featureLayerViewHandler(s):this.getSelectedDsRecord(t).then((e=>{this.featureLayerViewHandler(e)}))}}else{const e=this.props.config.mode||"new";"new"===e&&this.props.config.activeLinkData&&this.props.config.fieldQuestionMapping?this._cachedUniqueId&&(this.renderDS(!0),this._cachedUniqueId=""):"view"!==e&&"edit"!==e||this._cachedUniqueId&&(this._currentGlobalId="",this.renderDS(!0),this._cachedUniqueId="")}}},this.getClientId(),this.listenSurvey123WebformEvent()}componentDidMount(){r.setQueryObject(this.props.queryObject),this.prepare()}getUsedDataSource(){const e=this.props.useDataSources;let t=null;if(e&&e.length>0){const r=e[0].dataSourceId;t=this._dsManager.getDataSource(r)}return t}getUniqueFieldName(e){const t=this.getUsedDataSource(),r=t?t.getLayerDefinition():null;if(!r)return"";const s=r.globalIdField,o=r.objectIdField;return s||(e?o:void 0)}mapViewHandler(e){if(e&&e.view&&!this._isMapViewAddedClickEvent){const t=e.view;t.on("click",(e=>{const r=t.toMap({x:e.x,y:e.y});if(r){const e=r.latitude,t=r.longitude;this.postMessageToSurvey123Webform({event:"survey123:onDrawEnd",data:{x:t,y:e}})}})),this._isMapViewAddedClickEvent=!0}}featureLayerViewHandler(e,t){return Promise.resolve(!0).then((()=>e||(t&&t.getSelectedRecords()?this.getSelectedDsRecord(t):void 0))).then((e=>{if(!e)return;const t=this.props.config.mode||"new";if("new"===t&&this.props.config.activeLinkData&&this.props.config.fieldQuestionMapping){const t=e.attributes||{},r={};this.props.config.fieldQuestionMapping.forEach((s=>{var o;const i=s.field,n=s.question;if("geometry"===i){const t=e.geometry;!t||!t.y&&0!==t.y||!t.x&&0!==t.x?(t&&t.paths&&t.paths.length||t&&t.rings&&t.rings.length)&&(r[n]=t):(r[n]=t,!t.longitude&&0!==t.longitude||!t.latitude&&0!==t.latitude||(r[n]={x:t.longitude,y:t.latitude})),(null===(o=r[n])||void 0===o?void 0:o.toJSON)&&(r[n]=r[n].toJSON())}else{const e=t[i];r[n]=e||""}})),this.sendValueFromMapToSurvey(r);const s=this.getFeatureUniqueId(e,!0);s&&(this._cachedUniqueId=s)}else if("view"===t||"edit"===t){this._currentGlobalId="";const t=this.getFeatureUniqueId(e);if(!t)return void console.log("The global id field is not existing in the source layer");this._currentGlobalId=t,this.renderDS(),this._cachedUniqueId=this._currentGlobalId}}))}sendValueFromMapToSurvey(e){if("loading"===this.webappStatus);else if("normal"===this.webappStatus){if(!this.webform)return;e&&this.webform.setQuestionValue(e)}else if("thankyouScreen"===this.webappStatus){const t=this.buildWebFormConfig({setQuestionValue:e});this.createWebForm(t)}}listenSurvey123WebformEvent(){const e=e=>{if(e&&e.data){let t;try{t="string"==typeof e.data?JSON.parse(e.data):e.data&&e.data.payload?"string"==typeof e.data.payload?JSON.parse(e.data.payload):e.data.payload:e.data}catch(e){console.error(e)}const r=t.event,s=t.data;"survey123:onDrawPoint"===r&&this.onDrawPoint(s),"survey123:onFormLoaded"===r&&"survey123:onFormLoaded"===r&&t.contentHeight,"survey123:onSubmitted"===r&&console.log("survey123:onSubmitted!",s)}};window.addEventListener?window.addEventListener("message",e,!1):window.attachEvent("onmessage",e)}getClientId(){var t,r;const s=e.SessionManager.getInstance().getMainSession();this._clientId="",s&&s.clientId?this._clientId=s.clientId:(null===(r=null===(t=(0,e.getAppStore)().getState().appConfig)||void 0===t?void 0:t.attributes)||void 0===r?void 0:r.clientId)&&(this._clientId=(0,e.getAppStore)().getState().appConfig.attributes.clientId)}onDrawPoint(e){console.log("start draw point"),this._mapViewDSFromFeatureLayerView&&this.mapViewHandler(this._mapViewDSFromFeatureLayerView)}postMessageToSurvey123Webform(e){this.survey123webform&&this.survey123webform.contentWindow?this.survey123webform.contentWindow.postMessage(JSON.stringify(e),"*"):console.log("cannot find survey123webform iframe contentWindow!")}getFeatureUniqueId(e,t){if(!e)return null;const r=e.attributes||{},s=this.getUniqueFieldName(t);return s?r[s]:null}createWebForm(e){document.querySelector("#"+this.domId)&&(document.querySelector("#"+this.domId).innerHTML="",this.webform=null),this.webappStatus="loading",this.webform=new this.API.Survey123WebForm(e)}buildWebFormConfig(t){var r;const s=this.props.config,o={clientId:this._clientId||"survey123hub",container:this.domId||this.updateDomId(),itemId:s.surveyItemId,isDebugMode:!1},i=s.portalUrl||this.props.portalUrl||"https://www.arcgis.com";o.portalUrl=i;const n=null===(r=e.SessionManager.getInstance().getMainSession())||void 0===r?void 0:r.token;n&&(o.portalUrl=i,o.token=n);const a=(0,e.getAppStore)().getState().appConfig.originExbVersion;e.semver.lt(a,window.jimuConfig.isInPortal?"1.8.0":"1.9.0")&&(o.autoRefresh=3);const l=s.hides||(0,e.Immutable)(["navbar","header","description","footer","theme"]);l.length>0&&(o.hideElements=l);const u=s.defaultValue;u&&"object"==typeof u&&null!=u&&(o.defaultValue=u),"edit"!==s.mode&&"view"!==s.mode||(o.mode=s.mode,o.globalId=this._currentGlobalId||"");const c=this.props.stateProps?this.props.stateProps.surveyStatusCode:0;return c&&(o.surveyStatusCode=c),o.onFormLoaded=e=>{if(this.webappStatus="normal",t)this.sendValueFromMapToSurvey(t.setQuestionValue);else if("normal"===this.webappStatus){const e=this.getUsedDataSource();e&&this.featureLayerViewHandler(null,e)}},o.onFormSubmitted=e=>{this.webappStatus="thankyouScreen";const t=this.getUsedDataSource();t&&t.addVersion()},o.onFormFailed=e=>{this.webappStatus="error"},o}getWebformUrl(){var t;const s=this.props.config,o=s.surveyItemId,i=s.portalUrl||this.props.portalUrl||"https://www.arcgis.com";let n=null;if(o){const a=[];"https://www.arcgis.com"!==i&&a.push(`portalUrl=${i}`),"https://survey123dev.arcgis.com"===r.getSurvey123HostUrl()&&"https://www.arcgis.com"===i&&a.push(`portalUrl=${i}`);let l=s.embeds||[];l.includes("jsapi")||(l=l.concat(["jsapi"])),l.includes("onSubmitted")||(l=l.concat(["onSubmitted"])),l.length>0&&a.push(`embed=${l.join(",")}`);const u=s.hides||["navbar","header","description","footer","theme"];u.length>0&&a.push(`hide=${u.join(",")}`);const c=s.defaultValue;c&&"object"==typeof c&&null!=c&&Object.keys(c).forEach((e=>{a.push(`field:${e}=${c[e]}`)}));const d=s.open||"web";d&&"web"!==d&&["web","menu","native"].includes(d)&&a.push(`open=${d}`);const h=null===(t=e.SessionManager.getInstance().getMainSession())||void 0===t?void 0:t.token;h&&a.push(`token=${h}`),a.push("autoRefresh=3"),n=r.getSurvey123WebformUrl(o,{queryParams:a})}return n}renderDS(t){const{id:r}=this.props;let s=null,o=null,i=null;const n=this.buildWebFormConfig();this.isDsConfigured()&&(o=this.props.useDataSources[0].dataSourceId,i=this.props.useDataSources[0].rootDataSourceId,s=this.props.useDataSources[0]);const a=!!t||this.checkWebformOptionChanged(n);this._formOption=n;const l=this.getWebformUrl();return this.prepare().then((()=>{if(l&&(!this.webform||a))return this.createWebForm(n),this.updateStyle(),!0})),o&&i&&this.isDsConfigured()?(0,e.jsx)(e.DataSourceComponent,{widgetId:r,useDataSource:(0,e.Immutable)(s),onDataSourceCreated:this.onDataSourceCreated,onDataSourceInfoChange:this.onDataSourceInfoChange}):(0,e.jsx)("div",null)}render(){r.setQueryObject(this.props.queryObject);let o;return this.getWebformUrl()?(this.domId||this.updateDomId(),o=(0,e.jsx)("div",{className:"survey123__webform"},(0,e.jsx)("div",{className:"embed-container",id:this.domId}))):o=(0,e.jsx)("div",{className:"survey123__noSurvey"},(0,e.jsx)(t.WidgetPlaceholder,{icon:i(),message:this.props.intl.formatMessage({id:"_widgetLabel",defaultMessage:s}),widgetId:""})),(0,e.jsx)("div",{css:(this.props.theme,e.css`
    &.survey123{
        width: 100%;
        height: 100%;
        overflow: auto;

        .title{
            font-weight: bold;
        }

        .survey123__noSurvey{
            width:100%;
            height:100%;
            text-align:center;
        }

        .survey123__webform{
            width:100%;
            height:100%;

            .embed-container {
                position: relative;
                height: 100%;
                // padding-bottom:80%;
                width: 100%;
            }

            .embed-container iframe,
            .embed-container object,
            .embed-container iframe{
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                border: 0px;
            }
            small{
                position: absolute;
                z-index: 40;
                bottom: 0;
                margin-bottom: -15px;
            }
        }
    }
  `),className:"survey123"},o,this.renderDS())}}d.mapExtraStateProps=e=>({queryObject:e.queryObject});const h=d;function p(e){a.p=e}})(),l})())}}}));