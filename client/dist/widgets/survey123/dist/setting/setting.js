System.register(["jimu-core","jimu-for-builder","jimu-for-builder/service","jimu-ui/advanced/setting-components","jimu-arcgis","jimu-ui","jimu-ui/advanced/data-source-selector"],(function(e,t){var s={},i={},r={},a={},n={},o={},l={};return{setters:[function(e){s.AllDataSourceTypes=e.AllDataSourceTypes,s.DataSourceManager=e.DataSourceManager,s.Immutable=e.Immutable,s.React=e.React,s.SessionManager=e.SessionManager,s.classNames=e.classNames,s.css=e.css,s.getAppStore=e.getAppStore,s.jsx=e.jsx,s.moduleLoader=e.moduleLoader,s.portalUrlUtils=e.portalUrlUtils,s.semver=e.semver},function(e){i.builderAppSync=e.builderAppSync},function(e){r.appServices=e.appServices},function(e){a.SettingRow=e.SettingRow,a.SettingSection=e.SettingSection},function(e){n.ArcGISDataSourceTypes=e.ArcGISDataSourceTypes},function(e){o.AdvancedSelect=e.AdvancedSelect,o.AlertPopup=e.AlertPopup,o.Button=e.Button,o.Label=e.Label,o.Modal=e.Modal,o.Radio=e.Radio,o.Select=e.Select,o.Switch=e.Switch,o.TagInput=e.TagInput,o.TextArea=e.TextArea,o.TextInput=e.TextInput},function(e){l.DataSourceSelector=e.DataSourceSelector}],execute:function(){e((()=>{var e={24186:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M4 4h2.5v1H4a3 3 0 0 0 0 6h2.5v1H4a4 4 0 1 1 0-8M12 11H9.5v1H12a4 4 0 1 0 0-8H9.5v1H12a3 3 0 0 1 0 6"></path><path fill="#000" d="M5.5 7.5a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1z"></path></svg>'},62838:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746z"></path></svg>'},9044:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M6 6.5a.5.5 0 0 1 1 0v6a.5.5 0 0 1-1 0zM9.5 6a.5.5 0 0 0-.5.5v6a.5.5 0 0 0 1 0v-6a.5.5 0 0 0-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M11 0H5a1 1 0 0 0-1 1v2H.5a.5.5 0 0 0 0 1h1.6l.81 11.1a1 1 0 0 0 .995.9h8.19a1 1 0 0 0 .995-.9L13.9 4h1.6a.5.5 0 0 0 0-1H12V1a1 1 0 0 0-1-1m0 3V1H5v2zm1.895 1h-9.79l.8 11h8.19z" clip-rule="evenodd"></path></svg>'},62686:e=>{"use strict";e.exports=n},79244:e=>{"use strict";e.exports=s},4108:e=>{"use strict";e.exports=i},79860:e=>{"use strict";e.exports=r},14321:e=>{"use strict";e.exports=o},13089:e=>{"use strict";e.exports=l},79298:e=>{"use strict";e.exports=a}},t={};function u(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,u),r.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var s in t)u.o(t,s)&&!u.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var d={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(d),u.d(d,{__set_webpack_public_path__:()=>I,default:()=>T});var e=u(79244),t=u(4108),s=u(79860),i=u(79298),r=u(62686),a=u(14321),n=u(13089);const o=new class{setQueryObject(e){const t=e?e.survey123:"",s=t?decodeURIComponent(t+""):"",i=this._urlParamToJson(s);this.queryObj=i}getSurveyHostUrlFromPortal(e){if(e=e||"https://www.arcgis.com",this.surveyUrlFromPortal||null===this.surveyUrlFromPortal)return Promise.resolve(this.surveyUrlFromPortal);const t=window.esriGeowConfig;if(t&&t.surveyUrl)return this.surveyUrlFromPortal=t.surveyUrl,Promise.resolve(this.surveyUrlFromPortal);let s="";e.endsWith("/")||(e+="/"),s=e+"home/js/arcgisonline/config.js";const i=document.createElement("script");i.type="text/javascript",i.src=s;const r=document.documentElement,a=r.getAttribute("dir");return new Promise(((e,t)=>{i.onload=()=>{r.getAttribute("dir")!==a&&r.setAttribute("dir",a);const t=window.esriGeowConfig;t&&t.surveyUrl?(this.surveyUrlFromPortal=t.surveyUrl,e(t.surveyUrl)):(this.surveyUrlFromPortal=null,e(null))},i.onerror=()=>{r.getAttribute("dir")!==a&&r.setAttribute("dir",a),console.log("Failed to get survey url from portal's config.js, will fallback to use the default survey123 url."),this.surveyUrlFromPortal=null,e(null)},document.getElementsByTagName("head")[0].appendChild(i)}))}getSurvey123HostUrl(){let e="https://survey123.arcgis.com";this.surveyUrlFromPortal&&(e=this.surveyUrlFromPortal);let t=window.jimuConfig.hostEnv;if(this.queryObj&&this.queryObj.env&&(t=this.queryObj.env+"",t.startsWith("http://")||t.startsWith("https://")))return t;let s=!0;if("https://survey123.arcgis.com"!==e){const t=e.match(/https:\/\/survey123(\.[^\.]*)\.arcgis\.com/);s=!(!t||!t.length)}return t&&"prd"!==t&&"prod"!==t&&s&&(e=`https://survey123${t}.arcgis.com`),e}getSurvey123HostAPIUrl(){let e=this.getSurvey123HostUrl()+"/api/jsapi/3.20/";return this.queryObj&&this.queryObj.jsapi&&(e=this.getSurvey123HostUrl()+"/api/jsapi/"+this.queryObj.jsapi),e}createSurvey(e,t,s,i){return i=Object.assign({snippet:""},i||{}),Promise.resolve(!0).then((()=>{if(!(e&&s&&s.token&&s.username))throw new Error("missing title, tags, username or token")})).then((()=>{const r=`${this.getSurvey123HostUrl()}/api/survey/create`,a={title:e,tags:t&&Array.isArray(t)?t.join(","):t||null,snippet:i.snippet,thumbnailUrl:i.thumbnailUrl,token:s.token,username:s.username,portalUrl:s.portalUrl||"https://www.arcgis.com"};return fetch(r,{mode:"cors",method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(a)}).then((e=>{if(e.ok)return e.json();throw e}))}))}isPortal(e){return!["www.arcgis.com","devext.arcgis.com","qaext.arcgis.com"].find(((t,s)=>e.includes(t)))}querySurvey(e,t){return t=Object.assign({isPublished:!1,isSearchAll:!0,surveyClientAPI:null},t||{}),Promise.resolve(!0).then((()=>{if(!e||!e.token||!e.username)throw new Error("missing token or username")})).then((()=>{const s={isPublished:t.isPublished,isSearchAll:t.isSearchAll,token:e.token,username:e.username,portalUrl:e.portalUrl||"https://www.arcgis.com"};return t.searchSurveyType&&(s.searchSurveyType=t.searchSurveyType),t.surveyClientAPI?t.surveyClientAPI.survey123.searchSurvey(s).then((e=>{if(e&&e.results)return e.results;throw e})):(console.log("Survey client api is not provided."),null)}))}queryOthersSurvey(e,t){return Promise.resolve(!0).then((()=>{if(!e||!e.token||!e.username)throw new Error("missing token or username")})).then((()=>{e.token;const s=e.username,i=e.portalUrl||"https://www.arcgis.com",r=t.orgId;let a=null;const n=`${i}/sharing/rest/search`,o={q:`((type:Form AND (typekeywords:xForm OR typekeywords:Form)) OR (type:'Code Sample' AND typekeywords:XForms AND tags:'xform')) AND (NOT owner:${s}) AND (access:shared OR access:org OR (access:public AND orgid:${r}) OR access:private)`};return this.searchAGO(n,o,e).then((t=>{if(a=t,t.results=(t.results||[]).map((t=>this.convertItemToSurveyInfo(t,e))),-1===t.nextStart)return a;const s=[];let i=Math.floor(t.total/t.num);t.total%t.num>0&&(i+=1);for(let r=1;r<i;r++){const i=Object.assign({},o,{start:r*t.num+1});i.start<=t.total&&s.push(this.searchAGO(n,i,e))}return Promise.all(s).then((s=>{if(!s)throw new Error("something wrong when searchAll");let i=t.results||[],r=-1;return s.forEach(((t,a)=>{const n=t.results.map((t=>this.convertItemToSurveyInfo(t,e)));i=i.concat(n),a===s.length-1&&(r=t.nextStart)})),a.nextStart=r,a.results=i,a}))}))})).then((e=>e&&e.results||[]))}searchAGO(e,t,s){t=Object.assign({num:100,start:1,sortField:"title",sortOrder:"asc"},t);const i=Object.assign({},{f:"json",token:s.token},t),r=`${e}?${Object.keys(i).map((e=>e+"="+i[e])).join("&")}`;return fetch(r,{mode:"cors",method:"GET"}).then((e=>{if(e.ok)return e.json();throw e}))}convertItemToSurveyInfo(e,t){return{created:e.created,featureService:null,form:null,formItemInfo:e,id:e.id,owner:e.owner,report:null,snippet:e.snippet,tags:e.tags,thumbnail:`${t.portalUrl}/sharing/rest/content/items/${e.id}/info/${e.thumbnail}?token=${t.token}`,title:e.title}}getSurvey123DesignerUrl(e,t){t=Object.assign({},t||{});let s=`${this.getSurvey123HostUrl()}/surveys/${e}/design?embed=exb`;return t.portalUrl&&"https://www.arcgis.com"!==t.portalUrl&&(s+=`&portalUrl=${t.portalUrl}`),"https://survey123dev.arcgis.com"!==this.getSurvey123HostUrl()||t.portalUrl&&"https://www.arcgis.com"!==t.portalUrl||(s+=`&portalUrl=${t.portalUrl}`),s}getSurvey123WebformUrl(e,t){t=Object.assign({queryParams:[]},t||{});let s=`${this.getSurvey123HostUrl()}/share/${e}`;return t.queryParams.length>0&&(s+=`?${t.queryParams.join("&")}`),s}flatQuestions(e){let t=[];return e.forEach((e=>{e.questions?"esriQuestionTypeRepeat"!==e.type&&("esriQuestionTypeAddress"===e.type&&t.push(e),t=t.concat(this.flatQuestions(e.questions))):t.push(e)})),t}getSurveyQuestionFields(e,t){return Promise.resolve(!0).then((()=>{if(!e||!t||!t.token)throw new Error("missing surveyItemId or token")})).then((()=>{let s=`${this.getSurvey123HostUrl()}/api/survey/${e}/form`;const i={token:t.token,portalUrl:t.portalUrl};return s=`${s}?${Object.keys(i).map((e=>e+"="+i[e])).join("&")}`,fetch(s,{mode:"cors",method:"GET"}).then((e=>{if(e.ok)return e.json();throw e}))}))}getQuesLabelString(e,t){var s;if(t=Object.assign({locales:[],currentLocale:"en"},t||{}),!e||!e.label)return"";let i=e.label;if("object"==typeof i){let r=Object.keys(t.locales||[]).find((e=>e.isDefault+""=="true"));r&&(r=r.code||"en");const a=null===(s=t.locales)||void 0===s?void 0:s.map((e=>(e.code+"").trim())),n=this._findMatchedLocale(t.currentLocale,a)||r;if(n&&n in e.label)i=e.label[n];else{const t=Object.keys(e.label)[0];i=t?e.label[t]:""}}return i}_urlParamToJson(e){if(!e)return null;const t=(e+="").split(";");if(t.length<2&&e.split(":").length<2)return e.split(",").length>1?e.split(","):e;{const e={};return t.forEach((t=>{const s=(t+"").split(":");if(s.length>1){const t=s[0];let i=(Array.isArray(s.slice(1))?s.slice(1):[]).join(":");i.length&&"{"===i[0]&&(i=this._stringToJson(i)),"string"==typeof i&&i.split(",").length>1&&(i=i.split(",")),e[t]=i}})),e}}_findMatchedLocale(e,t){if(!t||!t.length||!e)return null;if(t.indexOf(e)>=0)return e;const s=e.split("-")[0];return t.indexOf(s)>=0?s:t.find((e=>e.startsWith(`${s}-`)))}_stringToJson(e){let t=e;try{t=JSON.parse(e)}catch(s){t=e}return t}},l={errLoadS123JSAPI:"Failed to load Survey123 JavaScript API from {S123JSAPIURL}. Please check if this URL is available to you.",chooseSurvey:"Select which survey to run in the widget:",createNewSurveyLabel:"Create new survey",chooseSurveyLabel1:"Select my own survey",chooseSurveyLabel2:"Select others' survey",draftSurveyPostfix:" (draft)",previewDraftSurveyMsg:"This survey is not published yet. Edit and publish the survey to preview the content here.",selectSurveyTip:"Please select",noExistingSurvey:"There is no available survey to this account.",surveySearchHint:"Search",surveyDetailLabel:"Survey Details:",currentSurveyLabel:"Current survey",resetSurveyLabel:"Reset survey",summaryLabel:"Summary",insertLabel:"Insert",surveyTitleLabel:"Name",surveyTitleRequiredMsg:"The name of the survey is required.",surveyTitleDuplicateMsg:"A survey with this name already exists, please use a different name.",surveyTagLabel:"Tags",surveyTagHint:"Separate tags with commas",surveyTagsRequiredMsg:"One or more tags are required.",surveySummaryLabel:"Summary",createSurveyBtn:"Create",createSurveyErrDuplicateTitle:"A survey with this name already exists, please choose a different name.",createSurveyDisabled1:"You do not have permission to perform this action. Required privileges: publish hosted feature layers",editSurveyBtn:"Edit survey",editSurveyBtnDisabledTip1:'You do not have enough privileges for this operation. Required privileges: "admin" or "update" control to both form and source feature layer items.',appearanceTitle:"Appearance",showOptionsBarLabel:"Show options bar",showOptionsHeaderLabel:"Show survey header",showOptionsDesLabel:"Show survey description",showOptionsFooterLabel:"Show survey footer",useSurveyTheme:"Enable survey theme",resetSurveyTip:"Reset survey will remove all settings to this survey widget.",confirmResetSurveyTip:"Are you sure you want to continue?",surveyModeTitle:"Mode",surveyModeNew:"Submit a new record",surveyModeEdit:"Edit an existing record",surveyModeView:"View an existing record",chooseExistDataTitle:"Load data to this survey",chooseExistDataEditDesc:"Load existing survey data from the source layer when a feature is selected in related widgets. Submit the survey updates the selected feature.",chooseExistDataViewDesc:"Load existing survey data from the source layer when a feature is selected in related widgets. The survey is read-only.",selectSurveyLayerTip:"Please select a layer that contains at least one existing survey record.",sendDataToSurveyTitle:"Send data to this survey",sendDataToSurveyDesc:"Attributes and geometry of a feature in the source layer can be sent to survey questions when the feature is selected in related widgets.",sourceLayer:"Source layer",addConnTitle:"Field/question connections",addConnSelectField:"Select a field",addConnSelectQuestion:"Select a survey question",addConnFailed1:"The survey question type is not compatible with the field type.",addConnBtn:"Add connection",geometryLabel:"*Shape",geometryTypePoint:"Point",geometryTypeMultiPoint:"MultiPoint",geometryTypePolyline:"Polyline",geometryTypePolygon:"Polygon",errmsgGeneralLoading:"An error occurred while loading.",errmsgGeneralCreatingNewSvy:"An error occurred while creating the new survey. Pleasey try again later.",msgUnsavedBeforeLeaving:"Changes you made may not be saved."};function c(t){var s;const i=null===(s=null==t?void 0:t.components)||void 0===s?void 0:s.input;return e.css`
    &.survey123{
      input:-webkit-autofill {
        -webkit-box-shadow: 0 0 0px 1000px ${i.bg} inset;
        -webkit-text-fill-color: ${i.color};
      }
      .survey123__section {
        .choose-survey-label {
          margin-bottom: 0;
        }
        input + span {
          // margin-left:5px;
        }
        .jimu-widget-setting--section-header.row >h6 {
          font-size: 0.875rem;
          color: ${t.ref.palette.neutral[1e3]};
        }

        .survey-list-msg {
          padding: 0 5px;
        }
        .survey-list-loading-outter {
          position: relative;
          top: -18px;
        }
        .survey123__section-createSurvey {
          >.container >.w-100.setting-header {
            padding-bottom: 1rem!important;
            >div:first-of-type {
              padding-bottom: 0.5rem;
            }
            >.jimu-input span.input-wrapper {
              height: 1.625rem;
            }
            .summary{
              height: auto;
              textarea {
                resize: none;
              }
            }
          }
        }

        .survey123__section-createSurvey, .select-survey-section {
          .error-message {
            color: ${t.sys.color.error.main};
            word-break: break-word;
          }
          .no-survey-message {
            color: ${t.ref.palette.neutral[900]};
          }
          .newSurvey-msg {
            color: ${t.sys.color.error.main};
            marginTop: '10px';
            word-break: break-word;
          }
        }
        .select-survey-section {
          hr.split-line {
            display: none;
          }
        }
        .create-survey-container {
          .jimu-widget-setting--row.items {
            margin-top: 1.2rem;
            display: block;
            h6 {
              color: ${t.ref.palette.neutral[1e3]};
            }
            div.w-100 {
              font-size: 0.8125rem;
              line-height: 1.1875rem;
              margin-top: 0.3125rem;

            }
          }
          .jimu-widget-setting--row >label {
            font-size: 0.875rem;
            font-weight: 400;
            +p.w-100 {
              font-size: 0.8125rem;
              line-height: 1.1875rem;
              margin-top: 0.3125rem;
            }
          }
        }

        .appearance, .section-title {
          display: flex;
          justify-content: space-between;
          width:100%;
          h6 {
            margin-bottom: 0;
          }
        }

        .select{
          select {
            width: 100%;
          }
        }

        .mapping-container {
          padding: 0.615em;
          background: ${t.sys.color.secondary.main};
          border-radius: 2px;
          margin: 0.6em 0;
          position: relative;
          >select {
            height: 26px;
            vertical-align: middle;
            font-size: 1em;
            line-height: 26px;
            padding: 0 22px 0 6px;
            &:first-of-type {
              margin-bottom: 8px;
            }
          }
          .btn-group {
            width: 100%;
            overflow: hidden;
            .icon-remove-mapping {
              padding: 0 0.25em;
              margin-left: 0;
              margin-right: 0;
              cursor: pointer;
              .remove-mapping {
                margin-right: 0;
                margin-left: 0;
              }
            }
            button {
              margin: 8px 0 8px 8px;
              height: 26px;
              line-height: 26px;
              padding: 0;
              padding: 0px 14px;
            }
          }
          >.link-info {
            > p {
              margin-bottom: 0;
              line-height: 2em;
            }
            > div.center-line {
              width: 96%;
              height: 1px;
              background: ${t.sys.color.secondary.dark};
              text-align: center;
              margin: 0.5em 2% 0.5em 2%;
              >.connect {
                display: inline-block;
                width: 26px;
                height: 20px;
                background: ${t.sys.color.secondary.main};
                position: relative;
                top: -10px;
              }
            }
            > div.delete-connect {
              display: none;
              position: absolute;
              right: 0;
              top: 0;
              cursor: pointer;
              background: ${t.sys.color.secondary.main};
              text-align: center;
              width: 24px;
              height: 24px;
            }
            &:hover > div.delete-connect {
              display: block;
            }
          }

        }

        .setting-row {
          margin: 0.5rem 0 0 0;
          display: flex;
          flex-flow: row wrap;
          align-items: center;
        }

        .section-title h5{
          display: inline-block;
          font-weight: 500;
        }

        .section-title h6{
          word-break: break-word;
        }

        .fea-layer-outter {
          flex-wrap:wrap;
          >div {
            width: 100%;
          }
        }

        .use-feature-layer-setting {
          width: 100%;
          margin-top: 0.92em;
        }
        .feature-layer-dropdown {
          width: 100%;
          margin: 0.5rem 0 0 0;
        }
        &-resetSurvey {
          position:relative;
          // top: -8px;
          height: 26px;
          float:right;
          line-height: 8px;

          svg {
            margin:0px !important;
          }
        }

        .cursor-pointer{
          &:hover{
            cursor:pointer;
          }
        }
        .select-survey-label {
          padding: 0 8px;
        }

        &-surveyMenu {}

        &-selectExistingSurvey {}

        &-createSurvey {
          overflow-y: hidden;

          span.isRequired{
            position:relative;
            /* left:-180px; */
            color: ${t.sys.color.error.main};
            top: 4px;
            left: 4px;
          }
        }

        &-surveySettings {

        }
      }
    }
  `}function p(t){var s,i,r,a;return e.css`
    &.survey123__desinger_modal {
      z-index: 100000;
      overflow: hidden;
      max-width: 100% !important;
      .modal-content{
        width: 100%;
        height: 100%;
        .survey123__desinger {
          width: 100%;
          height: 80px;
          padding: 23px 60px 23px 30px;
          color: ${null===(s=t.comp)||void 0===s?void 0:s.Header.root.vars.color};
          background-color: ${null===(i=t.comp)||void 0===i?void 0:i.Header.root.vars.bg};

          >p {
            font-size: 24px;
            margin-bottom: 0;
            line-height: 33px;
          }
          >button {
            position: absolute;
            top: 28px;
            right: 30px;
            background-color: ${null===(r=t.comp)||void 0===r?void 0:r.Header.root.vars.bg};
            color: ${null===(a=t.comp)||void 0===a?void 0:a.Header.root.vars.color};
            border: none;
            cursor: pointer;
            padding: 0;
          }
        }
        >iframe {
          height: calc(100% - 90px);
          width: 100%;
          border: none;
        }
      }
    }

  `}var h=u(62838),g=u.n(h),y=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(s[i[r]]=e[i[r]])}return s};const v=t=>{const s=window.SVG,{className:i}=t,r=y(t,["className"]),a=(0,e.classNames)("jimu-icon jimu-icon-component",i);return s?e.React.createElement(s,Object.assign({className:a,src:g()},r)):e.React.createElement("svg",Object.assign({className:a},r))};var m=u(24186),S=u.n(m),f=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(s[i[r]]=e[i[r]])}return s};const w=t=>{const s=window.SVG,{className:i}=t,r=f(t,["className"]),a=(0,e.classNames)("jimu-icon jimu-icon-component",i);return s?e.React.createElement(s,Object.assign({className:a,src:S()},r)):e.React.createElement("svg",Object.assign({className:a},r))};var x=u(9044),b=u.n(x),M=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(s[i[r]]=e[i[r]])}return s};const j=t=>{const s=window.SVG,{className:i}=t,r=M(t,["className"]),a=(0,e.classNames)("jimu-icon jimu-icon-component",i);return s?e.React.createElement(s,Object.assign({className:a,src:b()},r)):e.React.createElement("svg",Object.assign({className:a},r))};class T extends e.React.PureComponent{constructor(i){super(i),this.supportedMapTypes=(0,e.Immutable)([r.ArcGISDataSourceTypes.WebMap]),this.supportedLayerTypes=(0,e.Immutable)([e.AllDataSourceTypes.FeatureLayer,e.AllDataSourceTypes.SceneLayer,e.AllDataSourceTypes.SubtypeGroupLayer,e.AllDataSourceTypes.SubtypeSublayer]),this.dsManager=e.DataSourceManager.getInstance(),this.state={userTags:[],canCreateSurvey:!0,loadApiFailed:!1,newSurveyTitle:null,newSurveyTags:[],newSurveyTitleDirty:!1,newSurveyTagsDirty:!1,newSurveySnippet:null,newSurveyItemId:null,newSurveyThumbnailUrls:["https://survey123.arcgis.com/assets/img/default-thumbnails/Image01.png","https://survey123.arcgis.com/assets/img/default-thumbnails/Image02.png","https://survey123.arcgis.com/assets/img/default-thumbnails/Image03.png"],newSurveyMsg:null,newSurveyLoading:!1,existSurveyMsg:null,existSharedSurveyMsg:null,existSurveys:[],existSharedSurveys:[],selectedSurvey:null,selectedMyOwnSurvey:null,selectedSharedSurvey:null,currentActiveSurvey:null,modalIsOpen:!1,mode:"none",isCheckedSurveyItemId:!1,isShowSurveyQuestionField:!1,surveyQuestionFields:[],selectedQuestionField:null,createSurveyErrorMsg:null,surveyStatusCode:0,isShowCloseDesignerAlert:!1,surveyChanged:!1,dsMapView:null,dsFeatureLayer:null,dsFeatureLayerFields:[],addMapping:null,editMapping:null,layerViewInfoInNewMode:null,layerViewInfoInEditMode:null,layerViewInfoInViewMode:null},this.newDefaultValue={key:"",value:""},this.API={survey123:null,Survey123WebForm:null},this.isPortal=!1,this.isOrgAdmin=!1,this.isTagRequired=!1,this.setDefaultVal=()=>{var e,t;this.props.config.surveyItemId&&!this.props.config.mode&&this.setMode("new");const s=this.props.config.mode||"new";let i=this.props.config.layerViewInfo||null;if(i){const s=this.dsManager.getDataSource(i.dataSourceId);i={dataSourceId:i.dataSourceId,mainDataSourceId:i.mainDataSourceId?i.mainDataSourceId:null===(e=s.getMainDataSource())||void 0===e?void 0:e.id,rootDataSourceId:i.rootDataSourceId?i.rootDataSourceId:null===(t=s.getRootDataSource())||void 0===t?void 0:t.id}}"new"===s?this.setState({layerViewInfoInNewMode:i}):"edit"===s?this.setState({layerViewInfoInEditMode:i}):"view"===s&&this.setState({layerViewInfoInViewMode:i})},this.prepare=()=>Promise.resolve(!0).then((()=>{if(this.isPortal){const e=this.props.config.portalUrl||this.props.portalUrl;return o.getSurveyHostUrlFromPortal(e)}return!0})).then((()=>this.loadSurveyAPI())),this.componentDidMount=()=>{this.checkPrivilige();const t=this.props.useDataSources,s=t&&t.length?t[0].dataSourceId:null;if(s){const e=this.dsManager.getDataSource(s),t=e?e.getLayerDefinition():null;this.setState({dsFeatureLayer:t,dsFeatureLayerFields:this.getLayerFields(t)})}const i=this.props.user;this.isOrgAdmin=!(!i||"org_admin"!==i.role),this.isPortal=!e.portalUrlUtils.isAGOLDomain(this.props.config.portalUrl||this.props.portalUrl),this.checkTagRequired(),this.getUserTags()},this.loadSurveyAPI=()=>{const t=o.getSurvey123HostAPIUrl();return this.API.survey123?Promise.resolve(this.API.survey123):e.moduleLoader.loadModule(t).then((e=>{if(this.API=e,!e){const e=this.props.intl.formatMessage({id:"errLoadS123JSAPI",defaultMessage:l.errLoadS123JSAPI},{S123JSAPIURL:t});throw this.setState({loadApiFailed:!0}),new Error(e)}return this.setState({loadApiFailed:!1,existSurveyMsg:"",existSharedSurveyMsg:"",newSurveyMsg:""}),e}))},this.checkPrivilige=()=>{const t=(0,e.getAppStore)().getState().user.privileges||[],s=t.includes("portal:user:createItem")&&t.includes("portal:publisher:publishFeatures");this.setState({canCreateSurvey:s})},this.checkTagRequired=()=>{let t=this.props.portalSelf?this.props.portalSelf.currentVersion:null;if(this.isTagRequired=!1,t&&this.isPortal){(t+"").split(".").length<3&&(t+=".0");try{this.isTagRequired=e.semver.lt(t,"9.2.0")}catch(e){}}return this.isTagRequired},this.getUserTags=()=>{if(window.jimuConfig.isDevEdition)return!1;const t=(0,e.getAppStore)().getState().user.username;s.appServices.getUserTags(t).then((e=>{var t;const s=null===(t=null==e?void 0:e.tags)||void 0===t?void 0:t.map((e=>e.tag));this.setState({userTags:s||[]})}))},this.getLayerFields=e=>{if(!e)return[];const t=[].concat(e.fields||[]);if("feature"!==e.type&&"Feature Layer"!==e.type)return t;if((t||[]).find((e=>"geometry"===e.name)))return t;let s=e.geometryType||"";s.startsWith("esriGeometry")&&(s=s.replace("esriGeometry","").toLowerCase());const i=this.nls("geometryType"+s.substr(0,1).toUpperCase()+s.substr(1));return t.push({alias:`${this.nls("geometryLabel")}(${i})`,name:"geometry"}),t},this.onValueChanged=e=>{const t=e.currentTarget;this.props.onSettingChange({id:this.props.id,config:this.props.config.set(t.name,t.value)})},this.nls=(e,t)=>this.props.intl.formatMessage({id:e,defaultMessage:l[e]},t),this.addDefaultValue=e=>{this.newDefaultValue.key&&this.newDefaultValue.value&&(this.newDefaultValue={key:"",value:""})},this.addDesigerHandler=()=>{window.addEventListener("message",(e=>{if(e.data){let s=e.data;try{"string"==typeof e.data&&(s=JSON.parse(e.data)||{})}catch(e){}if("survey123:design:onFormPublished"===s.event&&s.data){let e=this.state.surveyStatusCode||0;e++,t.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:this.props.id,propKey:"surveyStatusCode",value:e}),this.setState({surveyStatusCode:e}),this.handleCloseModal()}else"survey123:design:onFormUnsaved"===s.event&&s.data?this.setState({surveyChanged:!0}):"survey123:design:onFormSaved"===s.event&&s.data&&this.setState({surveyChanged:!1})}}))},this.getFielAlias=e=>{const t=(this.state.dsFeatureLayerFields||[]).find((t=>t.name===e));return t?t.alias||t.name:e},this.getQuestionLabel=e=>{const t=(this.state.surveyQuestionFields||[]).find((t=>t.name===e));return t?t.label||t.name:e},this.onNewSurveyValueChanged=(e,t)=>{const s=e.currentTarget;t&&this.setState({[t]:s.value}),"newSurveyTags"===t&&this.setState({newSurveyTagsDirty:!0}),"newSurveyTitle"===t&&this.setState({newSurveyTitleDirty:!0})},this.onSurveySourceTypeChange=e=>{this.setState({mode:e,currentActiveSurvey:"survey-selectExistingSharedSurvey"===e?this.state.selectedSharedSurvey:this.state.selectedMyOwnSurvey,selectedSurvey:"survey-selectExistingSharedSurvey"===e?this.state.selectedSharedSurvey:this.state.selectedMyOwnSurvey})},this.onExistSurveyChanged=e=>{e&&e.length?(this.setState({selectedSurvey:e[0],currentActiveSurvey:e[0]}),"survey-selectExistingSharedSurvey"===this.state.mode?this.setState({selectedSharedSurvey:e[0]}):this.setState({selectedMyOwnSurvey:e[0]})):(this.setState({selectedSurvey:null,currentActiveSurvey:null}),"survey-selectExistingSharedSurvey"===this.state.mode?this.setState({selectedSharedSurvey:null}):this.setState({selectedMyOwnSurvey:null}))},this.createSurvey=()=>{if(!this.state.canCreateSurvey)return;const t=this.state.newSurveyTitle?this.state.newSurveyTitle.trim():"";let s=null;this.state.newSurveyTags&&this.state.newSurveyTags.length&&(s=this.state.newSurveyTags.map((e=>e.trim())));const i=this.state.newSurveySnippet;return t||this.setState({newSurveyTitleDirty:!0}),this.isTagRequired&&(this.state.newSurveyTags&&this.state.newSurveyTags.length||this.setState({newSurveyTagsDirty:!0})),t&&(!this.isTagRequired||s&&s.length)?Promise.resolve(!0).then((()=>{var r;this.setState({newSurveyMsg:"",newSurveyLoading:!0});const a=parseInt(10*Math.random()+"")%3,n=this.state.newSurveyThumbnailUrls[a],o={title:t,tags:s,token:null===(r=e.SessionManager.getInstance().getMainSession())||void 0===r?void 0:r.token,thumbnailUrl:n,snippet:i,portalUrl:this.props.config.portalUrl||this.props.portalUrl};return this.API.survey123.createSurvey(o)})).then((e=>{if(e&&e.id)return this.setState({createSurveyErrorMsg:null,newSurveyItemId:e.id,selectedSurvey:e,newSurveyLoading:!1}),e.id;throw e})).then((e=>{e&&(this.props.onSettingChange({id:this.props.id,config:this.props.config.set("hides",["navbar","header","description","footer","theme"])}),this.showSurvey123DesignerModal(e))})).catch((e=>{if(e){const s=e.error?e.error:e;let i=s.message?s.message:"string"==typeof s?e:"";s.details&&s.details.length&&s.details.forEach((e=>{i+=" "+e})),"survey123_create14"===s.messageCode&&(i=this.nls("createSurveyErrDuplicateTitle",{folderName:`'${t}'`})||i),this.setState({newSurveyMsg:i||"Create survey failed.",newSurveyLoading:!1})}console.error(e)})):void 0},this.querySurvey=t=>(t=t||{},Promise.resolve(!0).then((()=>{var s,i;if(this.props.config.surveyItemId&&this.props.config.selectedSurvey){const r=this.props.config.selectedSurvey;setTimeout((()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("surveyItemId",r.id)}),this.setState({existSurveyMsg:null,mode:"settings",selectedSurvey:r})}),0);const a={isPublished:Object.assign({isPublished:!1},t||{}).isPublished,surveyClientAPI:this.API};return o.querySurvey({username:null===(s=this.props.user)||void 0===s?void 0:s.username,token:null===(i=e.SessionManager.getInstance().getMainSession())||void 0===i?void 0:i.token,portalUrl:this.props.config.portalUrl||this.props.portalUrl},a).then((e=>{const t=this.getSurveyItems(e);this.setState({existSurveys:t})}))}})).then((()=>{var s;"none"===this.state.mode&&this.setState({mode:"survey-createSurvey"}),this.setState({existSurveyMsg:'<div class="survey-list-loading-outter"><div class="jimu-secondary-loading"></div></div>'});const i={isPublished:Object.assign({isPublished:!1},t||{}).isPublished,surveyClientAPI:this.API};return o.querySurvey({username:this.props.user.username,token:null===(s=e.SessionManager.getInstance().getMainSession())||void 0===s?void 0:s.token,portalUrl:this.props.config.portalUrl||this.props.portalUrl},i)})).then((e=>{const t=this.getSurveyItems(e);this.setState({existSurveyMsg:null,existSurveys:t}),e&&e.length||this.setState({existSurveyMsg:`<p class="no-survey-message">${this.props.intl.formatMessage({id:"noExistingSurvey",defaultMessage:l.noExistingSurvey})}</p>`})})).then((()=>{var t;return this.setState({existSharedSurveyMsg:'<div class="survey-list-loading-outter"><div class="jimu-secondary-loading"></div></div>'}),o.queryOthersSurvey({username:this.props.user.username,token:null===(t=e.SessionManager.getInstance().getMainSession())||void 0===t?void 0:t.token,portalUrl:this.props.config.portalUrl||this.props.portalUrl},{orgId:this.props.portalSelf?this.props.portalSelf.id:null})})).then((e=>{const t=this.getSurveyItems(e);this.setState({existSharedSurveyMsg:null,existSharedSurveys:t}),e&&e.length||this.setState({existSharedSurveyMsg:`<p class="no-survey-message">${this.props.intl.formatMessage({id:"noExistingSurvey",defaultMessage:l.noExistingSurvey})}</p>`})})).then((()=>{const e=this.props.config.surveyItemId;if(e){const t=this.state.existSurveys.find((t=>t.id===e)),s=this.state.existSharedSurveys.find((t=>t.id===e)),i=t||s;i&&(this.setState({selectedSurvey:i}),this.props.onSettingChange({id:this.props.id,config:this.props.config.set("selectedSurvey",i)}))}})).catch((e=>{this.setState({mode:"survey-createSurvey",existSurveyMsg:`<p class="error-message">${this.props.intl.formatMessage({id:"errmsgGeneralLoading",defaultMessage:l.errmsgGeneralLoading})}</p>`}),console.log(e)}))),this.getSurveyItems=t=>((t||[]).forEach((t=>{t.value=t.id,t.label=t.title,t.render=()=>(0,e.jsx)("div",{css:e.css`width: 178px;text-overflow: ellipsis; white-space: nowrap;overflow: hidden;`,title:t.title},(0,e.jsx)("span",null,t.title))})),t),this.getSurveyQuestionFields=()=>{const t=this.props.config.surveyItemId;return Promise.resolve(!0).then((()=>{var s,i;if(t&&(null===(s=e.SessionManager.getInstance().getMainSession())||void 0===s?void 0:s.token)&&this.API.getForm){const s={itemId:t,token:null===(i=e.SessionManager.getInstance().getMainSession())||void 0===i?void 0:i.token,portalUrl:this.props.config.portalUrl||this.props.portalUrl||"https://www.arcgis.com"};return this.API.getForm(s)}return null})).then((s=>{const i=[],r=(0,e.getAppStore)().getState().appContext.locale||"en";if(s&&s.questions&&s.questions.length>0){o.flatQuestions(s.questions).forEach((e=>{const t=(e.type+"").replace("esriQuestionType","");(e.fieldName||["geopoint","polyline","polygon"].includes(t.toLowerCase()))&&i.push({name:e.fieldName||e.name,label:o.getQuesLabelString(e,{locales:s.locales,currentLocale:r})})}))}return s.error&&s.error.message&&console.warn("Cannot get survey question fields for survey: "+t,s.error.message),this.setState({surveyQuestionFields:i}),i}))},this.showSettingPage=()=>{this.setState({mode:"settings"}),this.getSurveyQuestionFields()},this.handleCloseModal=()=>{if(this.state.surveyChanged)return void this.setState({isShowCloseDesignerAlert:!0});this.setState({modalIsOpen:!1}),this.setState({surveyChanged:!1}),this.showSettingPage();const e=this.state.newSurveyItemId||this.props.config.surveyItemId;e&&this.props.onSettingChange({id:this.props.id,config:this.props.config.set("surveyItemId",e).set("timestamp",Date.now()).set("mode","new")}),this.querySurvey()},this.handleCloseDesignerAlert=e=>{this.setState({isShowCloseDesignerAlert:!1}),e&&(this.setState({surveyChanged:!1}),setTimeout((()=>{this.handleCloseModal()}),0))},this.onTagInputChange=e=>{this.setState({newSurveyTags:e})},this.getThumbnailUrl=()=>{var t;const s=this.props.config.portalUrl||this.props.portalUrl||"https://www.arcgis.com",i=this.state.selectedSurvey.id,r=this.state.selectedSurvey.thumbnail;return(r+"").startsWith("http://")||(r+"").startsWith("https://")?r:`${s}/sharing/rest/content/items/${i}/info/${r}?token=${null===(t=e.SessionManager.getInstance().getMainSession())||void 0===t?void 0:t.token}`},this.setSurveyItemId=()=>{const e=this.state.selectedSurvey;e&&e.id&&(this.props.onSettingChange({id:this.props.id,config:this.props.config.set("surveyItemId",e.id).set("hides",["navbar","header","description","footer","theme"]).set("mode","new")}),this.setState({mode:"settings"}))},this.editSurvey=()=>{this.showSurvey123DesignerModal()},this.setAppearance=(e,t)=>{const s=[].concat(this.props.config.hides||[]);if(e&&s.indexOf(t)>=0){const e=s.indexOf(t);s.splice(e,1)}else s.push(t);this.props.onSettingChange({id:this.props.id,config:this.props.config.set("hides",s)})},this.setMode=e=>{this.props.config.mode!==e&&this.props.onSettingChange({id:this.props.id,config:this.props.config.set("mode",e)})},this.handleUseDataSourceChange=e=>{let t;t=e&&e.length?e[0].dataSourceId:null,this.props.onSettingChange({id:this.props.id,useDataSources:t?[{dataSourceId:t,mainDataSourceId:e[0].mainDataSourceId,rootDataSourceId:e[0].rootDataSourceId}]:null,config:this.props.config.set("layerViewInfo",e[0]).set("fieldQuestionMapping",null)});const s=this.dsManager.getDataSource(t),i=s?s.getLayerDefinition():null,r=this.props.config.mode||"new";"new"===r?(t&&s&&i||this.clearMapping(),this.setState({layerViewInfoInNewMode:e[0],dsFeatureLayer:i,dsFeatureLayerFields:this.getLayerFields(i)})):"edit"===r?this.setState({layerViewInfoInEditMode:e[0]}):"view"===r&&this.setState({layerViewInfoInViewMode:e[0]})},this.activeLinkDataChange=e=>{const t=e.currentTarget.checked;this.props.onSettingChange({id:this.props.id,config:this.props.config.set("activeLinkData",t)})},this.addMapppingChange=(e,t)=>{const s=t.currentTarget.value;let i=this.state.addMapping?this.state.addMapping.field:null,r=this.state.addMapping?this.state.addMapping.question:null;"field"===e?i=s:r=s,this.setState({addMapping:{field:i,question:r}})},this.clearMapping=()=>{},this.showEditMappingPanel=(e,t)=>{if((this.state.editMapping||{}).index===e)return;let s=this.props.config.fieldQuestionMapping||[];s=e>=0&&e<s.length?s[e]:null;const i=Object.assign({},s);i.index=e,this.setState({editMapping:i,addMapping:null})},this.changeEditMapping=(e,t)=>{const s=t.currentTarget.value,i=Object.assign({},this.state.editMapping||{});"field"===e?i.field=s:i.question=s,this.setState({editMapping:i})},this.editMapping=e=>{const t=[].concat(this.props.config.fieldQuestionMapping||[]),s=this.state.editMapping||{};e>=0&&e<t.length&&(t[e]={field:s.field,question:s.question}),this.props.onSettingChange({id:this.props.id,config:this.props.config.set("fieldQuestionMapping",t)})},this.activeAddFieldQuestionConnPanel=()=>{this.setState({addMapping:{field:null,question:null},editMapping:null})},this.deactiveAddFieldQuestionConnPanel=()=>{this.setState({addMapping:null})},this.deleteConnection=(e,t)=>{t&&t.stopPropagation();const s=[].concat(this.props.config.fieldQuestionMapping||[]);e>=0&&e<s.length&&s.splice(e,1),this.props.onSettingChange({id:this.props.id,config:this.props.config.set("fieldQuestionMapping",s)})},this.addFieldQuestionConn=e=>{const t=this.state.addMapping.field,s=this.state.addMapping.question;if(!t||!s)return void console.log("Please ensure field/question is not null.");const i=[].concat(this.props.config.fieldQuestionMapping||[]);i.push({field:t,question:s}),this.props.onSettingChange({id:this.props.id,config:this.props.config.set("fieldQuestionMapping",i)}),this.deactiveAddFieldQuestionConnPanel()},this.onSurveyQuestionFieldChanged=e=>{const t=e.currentTarget.value;t&&"null"!==t&&this.props.onSettingChange({id:this.props.id,config:this.props.config.set("selectedSurveyQuestionFields",[t])})},this.isDsConfigured=()=>!(!this.props.useDataSources||1!==this.props.useDataSources.length),this.resetSurvey=()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("surveyItemId",null).set("hides",[]).set("embeds",["fullScreen","onSubmitted"]).set("selectedSurveyQuestionFields",[]).set("fieldQuestionMapping",[]).set("activeLinkData",!1).set("dsType",null).set("selectedSurvey",null).set("mode","new")}),this.setState({mode:"survey-createSurvey",selectedSurvey:null,selectedMyOwnSurvey:null,selectedSharedSurvey:null,currentActiveSurvey:null,isCheckedSurveyItemId:!1,surveyQuestionFields:[],dsMapView:null,dsFeatureLayer:null,dsFeatureLayerFields:[]})},o.setQueryObject(this.props.queryObject),this.isPortal=!e.portalUrlUtils.isAGOLDomain(this.props.config.portalUrl||this.props.portalUrl),this.checkTagRequired();const a=this.props.user;this.isOrgAdmin=!(!a||"org_admin"!==a.role),this.prepare().then((()=>{this.setDefaultVal(),this.querySurvey(),this.addDesigerHandler()})).catch((e=>{setTimeout((()=>{this.state.loadApiFailed&&this.setState({existSurveyMsg:`<p class="error-message">${e.message||""}</p>`,existSharedSurveyMsg:`<p class="error-message">${e.message||""}</p>`,mode:"survey-createSurvey",newSurveyMsg:e.message||"",loadApiFailed:!0})}),0)}))}showSurvey123DesignerModal(t){t=t||this.props.config.surveyItemId;const s=e.SessionManager.getInstance(),i=this.props.config.portalUrl||this.props.portalUrl;if(!t)throw new Error("cannot get survey item id to open survey123 designer");let r=o.getSurvey123DesignerUrl(t,{portalUrl:i});const a=s.getMainSession();a&&a.token&&a.username&&a.tokenDuration&&(r+=`#access_token=${a.token}&username=${a.username}&expires_in=${a.tokenDuration}`),this.setState({modalIsOpen:!0,newSurveyMsg:null});const n=this;let l=0;const u=setInterval((()=>{n.state.modalIsOpen||n.setState({modalIsOpen:!0}),l++;const e=document.getElementById("survey123-designer");(e||l>100)&&(clearInterval(u),e.src=r)}),50)}render(){var t,s,r,o,u,d,h,g,y,m,S,f,x;return this.state.selectedSurvey&&this.props.config.surveyItemId&&!1===this.state.isCheckedSurveyItemId&&(this.setState({isCheckedSurveyItemId:!0}),this.showSettingPage()),(0,e.jsx)("div",{css:c(this.props.theme),className:"jimu-widget-setting survey123"},(0,e.jsx)("div",{className:"survey123__section",style:-1!==this.state.mode.indexOf("survey-")?{display:"block"}:{display:"none"}},(0,e.jsx)(i.SettingSection,{role:"radiogroup","aria-label":this.nls("chooseSurvey")},(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("p",{className:"choose-survey-label"},this.props.intl.formatMessage({id:"chooseSurvey",defaultMessage:l.chooseSurvey}))),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(a.Radio,{name:"survey-survey",className:"cursor-pointer",id:"survey-survey-createNewSurvey",checked:"survey-createSurvey"===this.state.mode,onChange:()=>{this.setState({mode:"survey-createSurvey"})}}),(0,e.jsx)(a.Label,{for:"survey-survey-createNewSurvey",className:"cursor-pointer select-survey-label"},this.props.intl.formatMessage({id:"createNewSurveyLabel",defaultMessage:l.createNewSurveyLabel}))),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(a.Radio,{name:"survey-survey",className:"cursor-pointer",id:"survey-survey-chooseExistingSurvey",checked:"survey-selectExistingSurvey"===this.state.mode,onChange:()=>{this.onSurveySourceTypeChange("survey-selectExistingSurvey")}}),(0,e.jsx)(a.Label,{for:"survey-survey-chooseExistingSurvey",className:"cursor-pointer select-survey-label"},this.props.intl.formatMessage({id:"chooseSurveyLabel1",defaultMessage:l.chooseSurveyLabel1}))),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(a.Radio,{name:"survey-survey",className:"cursor-pointer",id:"survey-survey-chooseExistingSharedSurvey",checked:"survey-selectExistingSharedSurvey"===this.state.mode,onChange:()=>{this.onSurveySourceTypeChange("survey-selectExistingSharedSurvey")}}),(0,e.jsx)(a.Label,{for:"survey-survey-chooseExistingSharedSurvey",className:"cursor-pointer select-survey-label"},this.props.intl.formatMessage({id:"chooseSurveyLabel2",defaultMessage:l.chooseSurveyLabel2})))),(0,e.jsx)("div",{className:"survey123__section-selectExistingSurvey",role:"group","aria-label":this.nls("chooseSurveyLabel1"),style:"survey-selectExistingSurvey"===this.state.mode||"survey-selectExistingSharedSurvey"===this.state.mode?{display:"block"}:{display:"none"}},"survey-selectExistingSurvey"===this.state.mode?(0,e.jsx)(i.SettingSection,{className:"select-survey-section"},(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(a.AdvancedSelect,{size:"sm",className:"survey-dropdown",fluid:!0,staticValues:this.state.existSurveys,selectedValues:this.state.selectedMyOwnSurvey?[this.state.selectedMyOwnSurvey]:[],allTag:this.props.intl.formatMessage({id:"selectSurveyTip",defaultMessage:l.selectSurveyTip}),onChange:this.onExistSurveyChanged,placeholder:this.props.intl.formatMessage({id:"selectSurveyTip",defaultMessage:l.selectSurveyTip})})),(0,e.jsx)("div",{className:"survey-list-msg",dangerouslySetInnerHTML:{__html:this.state.existSurveyMsg}})):(0,e.jsx)(i.SettingSection,{className:"select-survey-section"},(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(a.AdvancedSelect,{size:"sm",className:"survey-dropdown",fluid:!0,staticValues:this.state.existSharedSurveys,selectedValues:this.state.selectedSharedSurvey?[this.state.selectedSharedSurvey]:[],allTag:this.props.intl.formatMessage({id:"selectSurveyTip",defaultMessage:l.selectSurveyTip}),onChange:this.onExistSurveyChanged,placeholder:this.props.intl.formatMessage({id:"selectSurveyTip",defaultMessage:l.selectSurveyTip})})),(0,e.jsx)("div",{className:"survey-list-msg",dangerouslySetInnerHTML:{__html:this.state.existSharedSurveyMsg}})),(0,e.jsx)("div",{style:{display:this.state.currentActiveSurvey?"block":"none"}},(0,e.jsx)(i.SettingSection,{title:this.nls("surveyDetailLabel"),className:"create-survey-container"},this.state.currentActiveSurvey?[(0,e.jsx)(i.SettingRow,{key:"surveyThumnail"},(0,e.jsx)("img",{src:this.state.currentActiveSurvey.thumbnail,style:{width:"100%",height:"auto"}})),(0,e.jsx)(i.SettingRow,{key:"surveyTitle"},(0,e.jsx)("span",{style:{wordBreak:"break-word",fontSize:"0.8125rem",color:"#FFFFFF"}},this.state.currentActiveSurvey.title)),(0,e.jsx)(i.SettingRow,{className:"items",key:"surveyAuthor"},(0,e.jsx)("div",{className:"w-100"},this.nls("ownerIs",{ownerName:this.state.currentActiveSurvey.owner||""}))),(0,e.jsx)(i.SettingRow,{className:"items",key:"surveyCreationDate"},(0,e.jsx)("div",{className:"w-100"},this.nls("updatedOn",{updatedDate:"number"==typeof this.state.currentActiveSurvey.formItemInfo.modified?this.props.intl.formatDate(new Date(this.state.currentActiveSurvey.formItemInfo.modified)):""}))),this.state.currentActiveSurvey.snippet?(0,e.jsx)(i.SettingRow,{className:"items",key:"surveySnippet"},(0,e.jsx)("h6",null,this.nls("summaryLabel")),(0,e.jsx)("div",{className:"w-100"},this.state.currentActiveSurvey.snippet)):null,(0,e.jsx)(i.SettingRow,{key:"surveyInsertBtn"},(0,e.jsx)(a.Button,{type:"primary",className:"w-100",onClick:this.setSurveyItemId},this.props.intl.formatMessage({id:"insertLabel",defaultMessage:l.insertLabel})))]:null))),(0,e.jsx)("div",{className:"survey123__section-createSurvey",role:"group","aria-label":this.nls("createNewSurveyLabel"),style:"survey-createSurvey"===this.state.mode?{display:"block"}:{display:"none"}},(0,e.jsx)(i.SettingSection,null,(0,e.jsx)("div",{className:"w-100 d-flex flex-wrap align-items-center justify-content-between setting-header setting-title pb-2"},(0,e.jsx)("div",null,this.nls("surveyTitleLabel"),(0,e.jsx)("span",{className:"isRequired"},"*")),(0,e.jsx)(a.TextInput,{"aria-label":this.nls("surveyTitleLabel"),"aria-required":"true",required:!0,className:"w-100",value:this.state.newSurveyTitle||"",onChange:e=>{this.onNewSurveyValueChanged(e,"newSurveyTitle")}}),this.state.newSurveyTitle&&this.state.newSurveyTitle.trim()||!this.state.newSurveyTitleDirty?"":(0,e.jsx)("div",{className:"error-message"},this.props.intl.formatMessage({id:"surveyTitleRequiredMsg",defaultMessage:l.surveyTitleRequiredMsg})),this.state.createSurveyErrorMsg&&!this.state.newSurveyTitleDirty?(0,e.jsx)("div",{className:"error-message"},this.props.intl.formatMessage({id:"surveyTitleDuplicateMsg",defaultMessage:l.surveyTitleDuplicateMsg})):""),(0,e.jsx)("div",{className:"w-100 d-flex flex-wrap align-items-center justify-content-between setting-header setting-title pb-2"},(0,e.jsx)("div",null,this.nls("surveyTagLabel"),this.isTagRequired?(0,e.jsx)("span",{className:"isRequired"},"*"):""),(0,e.jsx)(a.TagInput,{"aria-label":this.nls("surveyTagLabel"),data:this.state.newSurveyTags,selectListData:this.state.userTags,onChange:this.onTagInputChange,name:this.nls("surveyTagLabel"),menuProps:{maxHeight:80}}),this.state.newSurveyTags&&this.state.newSurveyTags.length||!this.state.newSurveyTagsDirty||!this.isTagRequired?"":(0,e.jsx)("div",{className:"error-message"},this.props.intl.formatMessage({id:"surveyTagsRequiredMsg",defaultMessage:l.surveyTagsRequiredMsg}))),(0,e.jsx)("div",{className:"w-100 d-flex flex-wrap align-items-center justify-content-between setting-header setting-title pb-2"},(0,e.jsx)("div",null,this.nls("surveySummaryLabel")),(0,e.jsx)(a.TextArea,{"aria-label":this.nls("surveySummaryLabel"),className:"w-100 summary",height:80,value:this.state.newSurveySnippet||"",onChange:e=>{this.onNewSurveyValueChanged(e,"newSurveySnippet")}})),(0,e.jsx)(i.SettingRow,{flow:"wrap"},(0,e.jsx)(a.Button,{type:"primary",className:"w-100",disabled:!0===this.state.newSurveyLoading||!this.state.canCreateSurvey||this.state.loadApiFailed,onClick:this.createSurvey},this.props.intl.formatMessage({id:"createSurveyBtn",defaultMessage:l.createSurveyBtn})),(0,e.jsx)("span",{className:"newSurvey-msg"},this.state.canCreateSurvey?this.state.newSurveyMsg:this.nls("createSurveyDisabled1")),(0,e.jsx)("div",{className:"w-100",style:{position:"relative",display:"block",marginTop:"50px"}},(0,e.jsx)("div",{className:"jimu-secondary-loading",style:!0===this.state.newSurveyLoading?{display:"block"}:{display:"none"}})))))),(0,e.jsx)("div",{className:"survey123__section",style:-1!==this.state.mode.indexOf("settings")?{display:"block"}:{display:"none"}},(0,e.jsx)(i.SettingSection,null,(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"section-title"},(0,e.jsx)("h6",null,this.state.selectedSurvey?this.state.selectedSurvey.title:""),(0,e.jsx)(a.Button,{"aria-label":this.nls("remove"),"aria-description":this.state.selectedSurvey?this.state.selectedSurvey.title:"",className:"survey123__section-resetSurvey",onClick:()=>{this.setState({mode:"confirmResetSurvey"})}},(0,e.jsx)(v,{size:8})))),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(a.Button,{"aria-description":this.state.selectedSurvey?this.state.selectedSurvey.title:"",className:"w-100",color:"primary",type:"primary",onClick:this.editSurvey},this.props.intl.formatMessage({id:"editSurveyBtn",defaultMessage:l.editSurveyBtn})))),(0,e.jsx)(i.SettingSection,{role:"group","aria-label":this.nls("appearanceTitle"),title:this.nls("appearanceTitle")},(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"appearance"},(0,e.jsx)("span",null,this.props.intl.formatMessage({id:"showOptionsBarLabel",defaultMessage:l.showOptionsBarLabel})),(0,e.jsx)(a.Switch,{"aria-label":this.nls("showOptionsBarLabel"),className:"can-x-switch",checked:!this.props.config.hides.includes("navbar"),onChange:e=>{this.setAppearance(e.target.checked,"navbar")}}))),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"appearance"},(0,e.jsx)("span",null,this.props.intl.formatMessage({id:"showOptionsHeaderLabel",defaultMessage:l.showOptionsHeaderLabel})),(0,e.jsx)(a.Switch,{"aria-label":this.nls("showOptionsHeaderLabel"),className:"can-x-switch",checked:!this.props.config.hides.includes("header"),onChange:e=>{this.setAppearance(e.target.checked,"header")}}))),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"appearance"},(0,e.jsx)("span",null,this.props.intl.formatMessage({id:"showOptionsDesLabel",defaultMessage:l.showOptionsDesLabel})),(0,e.jsx)(a.Switch,{"aria-label":this.nls("showOptionsDesLabel"),className:"can-x-switch",checked:!this.props.config.hides.includes("description"),onChange:e=>{this.setAppearance(e.target.checked,"description")}}))),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"appearance"},(0,e.jsx)("span",null,this.props.intl.formatMessage({id:"showOptionsFooterLabel",defaultMessage:l.showOptionsFooterLabel})),(0,e.jsx)(a.Switch,{"aria-label":this.nls("showOptionsFooterLabel"),className:"can-x-switch",checked:!this.props.config.hides.includes("footer"),onChange:e=>{this.setAppearance(e.target.checked,"footer")}}))),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"appearance"},(0,e.jsx)("span",null,this.props.intl.formatMessage({id:"useSurveyTheme",defaultMessage:l.useSurveyTheme})),(0,e.jsx)(a.Switch,{"aria-label":this.nls("useSurveyTheme"),className:"can-x-switch",checked:!this.props.config.hides.includes("theme"),onChange:e=>{this.setAppearance(e.target.checked,"theme")}})))),(0,e.jsx)(i.SettingSection,{role:"radiogroup","aria-label":this.nls("surveyModeTitle"),title:this.nls("surveyModeTitle")},(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"d-flex justify-content-between w-100 align-items-center"},(0,e.jsx)("div",{className:"align-items-center d-flex"},(0,e.jsx)(a.Radio,{style:{cursor:"pointer"},onChange:()=>{this.setMode("new")},checked:"new"===this.props.config.mode,title:this.props.intl.formatMessage({id:"surveyModeNew",defaultMessage:l.surveyModeNew})}),(0,e.jsx)("label",{className:"m-0 ml-2",style:{cursor:"pointer"},onClick:()=>{this.setMode("new")},title:this.props.intl.formatMessage({id:"surveyModeNew",defaultMessage:l.surveyModeNew})},this.props.intl.formatMessage({id:"surveyModeNew",defaultMessage:l.surveyModeNew}))))),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"d-flex justify-content-between w-100 align-items-center"},(0,e.jsx)("div",{className:"align-items-center d-flex"},(0,e.jsx)(a.Radio,{style:{cursor:"pointer"},onChange:()=>{this.setMode("edit")},checked:"edit"===this.props.config.mode,title:this.props.intl.formatMessage({id:"surveyModeEdit",defaultMessage:l.surveyModeEdit})}),(0,e.jsx)("label",{className:"m-0 ml-2",style:{cursor:"pointer"},onClick:()=>{this.setMode("edit")},title:this.props.intl.formatMessage({id:"surveyModeEdit",defaultMessage:l.surveyModeEdit})},this.props.intl.formatMessage({id:"surveyModeEdit",defaultMessage:l.surveyModeEdit}))))),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"d-flex justify-content-between w-100 align-items-center"},(0,e.jsx)("div",{className:"align-items-center d-flex"},(0,e.jsx)(a.Radio,{style:{cursor:"pointer"},onChange:()=>{this.setMode("view")},checked:"view"===this.props.config.mode,title:this.props.intl.formatMessage({id:"surveyModeView",defaultMessage:l.surveyModeView})}),(0,e.jsx)("label",{className:"m-0 ml-2",style:{cursor:"pointer"},onClick:()=>{this.setMode("view")},title:this.props.intl.formatMessage({id:"surveyModeView",defaultMessage:l.surveyModeView})},this.props.intl.formatMessage({id:"surveyModeView",defaultMessage:l.surveyModeView}))))),"new"===this.props.config.mode&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"section-title"},(0,e.jsx)("h6",null,this.nls("sendDataToSurveyTitle")),(0,e.jsx)(a.Switch,{"aria-label":this.nls("sendDataToSurveyTitle"),"aria-describedby":this.props.config.activeLinkData?`survey_${this.props.id}_sendDataToSurveyDesc`:"",className:"can-x-switch",checked:this.props.config.activeLinkData,onChange:this.activeLinkDataChange}))),this.props.config.activeLinkData&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("span",{id:`survey_${this.props.id}_sendDataToSurveyDesc`,className:"w-100"},this.nls("sendDataToSurveyDesc"))),(0,e.jsx)(i.SettingRow,{className:"fea-layer-outter"},(0,e.jsx)(i.SettingRow,{className:"use-feature-layer-setting"},(0,e.jsx)("span",null,this.nls("sourceLayer"))),(0,e.jsx)("div",{className:"feature-layer-dropdown"},(0,e.jsx)(n.DataSourceSelector,{isMultiple:!1,hideDataView:!0,"aria-label":this.nls("sourceLayer"),"aria-describedby":"",mustUseDataSource:!0,closeDataSourceListOnChange:!0,hideTypeDropdown:!0,types:this.supportedLayerTypes,useDataSources:(null===(t=this.state)||void 0===t?void 0:t.layerViewInfoInNewMode)?(0,e.Immutable)([null===(s=this.state)||void 0===s?void 0:s.layerViewInfoInNewMode]):null,onChange:this.handleUseDataSourceChange,widgetId:null===(r=this.props)||void 0===r?void 0:r.id}))),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{role:"group","aria-owns":`survey_${this.props.id}_addNewMapping survey_${this.props.id}_addMappingBtn`,"aria-label":this.nls("addConnTitle")},(0,e.jsx)("span",null,this.nls("addConnTitle")))),(null===(o=this.state)||void 0===o?void 0:o.layerViewInfoInNewMode)&&(null===(u=this.state)||void 0===u?void 0:u.layerViewInfoInNewMode.dataSourceId)?(0,e.jsx)(e.React.Fragment,null,this.props.config.fieldQuestionMapping&&this.props.config.fieldQuestionMapping.length>0?(0,e.jsx)("div",null,this.props.config.fieldQuestionMapping.asMutable().map(((t,s)=>{const i=t.field,r=t.question;return(0,e.jsx)("div",{key:i+"_"+r+"_"+s,className:"mapping-container"},this.state.editMapping&&this.state.editMapping.index===s?(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(a.Select,{value:this.state.editMapping.field||"",style:{marginBottom:"8px"},onChange:e=>{this.changeEditMapping("field",e)}},this.state.dsFeatureLayerFields.map((t=>(0,e.jsx)("option",{key:"edit_"+t.name+"_"+s,value:t.name},t.alias||t.name)))),(0,e.jsx)(a.Select,{value:this.state.editMapping.question||"",onChange:e=>{this.changeEditMapping("question",e)}},this.state.surveyQuestionFields.length>0&&this.state.surveyQuestionFields.map((t=>(0,e.jsx)("option",{key:"edit_"+t.name+"_"+s,value:t.name},t.label)))),(0,e.jsx)("div",{className:"btn-group"},(0,e.jsx)(a.Button,{className:"float-left icon-remove-mapping",type:"primary",color:"primary",onClick:()=>{this.deleteConnection(s),this.setState({editMapping:null})}},(0,e.jsx)(j,{className:"remove-mapping"})),(0,e.jsx)(a.Button,{className:"float-right",type:"secondary",onClick:()=>{this.setState({editMapping:null})}},this.nls("cancel")),(0,e.jsx)(a.Button,{className:"float-right",type:"primary",color:"primary",onClick:()=>{this.editMapping(s),this.setState({editMapping:null})}},this.nls("ok")))):(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)("div",{className:"link-info",onClick:e=>{this.showEditMappingPanel(s,e)}},(0,e.jsx)("p",null,this.getFielAlias(i)),(0,e.jsx)("div",{className:"center-line"},(0,e.jsx)("div",{className:"connect"},(0,e.jsx)(w,null))),(0,e.jsx)("p",null,this.getQuestionLabel(r)),(0,e.jsx)("div",{className:"delete-connect",onClick:e=>{this.deleteConnection(s,e)}},(0,e.jsx)(j,{size:"s"})))))}))):"",this.state.addMapping&&this.state.dsFeatureLayer&&this.state.dsFeatureLayerFields&&this.state.dsFeatureLayerFields.length>0&&(0,e.jsx)("div",{className:"mapping-container",id:`survey_${this.props.id}_addNewMapping`},(0,e.jsx)(a.Select,{"aria-label":this.nls("addConnSelectField"),value:this.state.addMapping.field||"null",style:{marginBottom:"8px"},onChange:e=>{this.addMapppingChange("field",e)}},(0,e.jsx)("option",{key:"add_field_default",value:"null"},this.nls("addConnSelectField")),this.state.dsFeatureLayerFields.map((t=>(0,e.jsx)("option",{key:"add_"+t.name,value:t.name},t.alias||t.name)))),(0,e.jsx)(a.Select,{"aria-label":this.nls("addConnSelectQuestion"),value:this.state.addMapping.question||"null",onChange:e=>{this.addMapppingChange("question",e)}},(0,e.jsx)("option",{key:"add_question_default",value:"null"},this.nls("addConnSelectQuestion")),this.state.surveyQuestionFields.length>0&&this.state.surveyQuestionFields.map((t=>(0,e.jsx)("option",{key:"add_"+t.name,value:t.name},t.label)))),(0,e.jsx)("div",{className:"btn-group"},(0,e.jsx)(a.Button,{className:"float-right",type:"secondary",onClick:this.deactiveAddFieldQuestionConnPanel},this.nls("cancel")),(0,e.jsx)(a.Button,{className:"float-right",type:"primary",disabled:!this.state.addMapping.field||"null"===this.state.addMapping.field||!this.state.addMapping.question||"null"===this.state.addMapping.question,onClick:this.addFieldQuestionConn},this.nls("ok"))))):"",(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(a.Button,{className:"w-100",type:"primary",id:`survey_${this.props.id}_addMappingBtn`,disabled:null!==this.state.addMapping||null!==this.state.editMapping||!((null===(d=this.state)||void 0===d?void 0:d.layerViewInfoInNewMode)&&(null===(h=this.state)||void 0===h?void 0:h.layerViewInfoInNewMode.dataSourceId)),onClick:this.activeAddFieldQuestionConnPanel},this.nls("addConnBtn"))))),"edit"===this.props.config.mode&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingRow,{className:"section-title"},(0,e.jsx)("div",{role:"group","aria-describedby":`survey_${this.props.id}_chooseExistDataEditDesc`,"aria-label":this.nls("chooseExistDataTitle"),"aria-owns":`survey_${this.props.id}_selectSurveyLayerForEditMode`},(0,e.jsx)("h6",null,this.nls("chooseExistDataTitle")))),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("span",{id:`survey_${this.props.id}_chooseExistDataEditDesc`,className:"w-100"},this.nls("chooseExistDataEditDesc"))),(0,e.jsx)(i.SettingRow,{className:"fea-layer-outter"},(0,e.jsx)("div",{id:`survey_${this.props.id}_selectSurveyLayerForEditMode`},(0,e.jsx)(i.SettingRow,{className:"use-feature-layer-setting"},(0,e.jsx)("span",{title:this.nls("selectSurveyLayerTip")},this.nls("sourceLayer"))),(0,e.jsx)("div",{className:"feature-layer-dropdown",title:this.nls("selectSurveyLayerTip")},(0,e.jsx)(n.DataSourceSelector,{isMultiple:!1,hideDataView:!0,"aria-label":this.nls("sourceLayer"),"aria-describedby":"",mustUseDataSource:!0,closeDataSourceListOnChange:!0,hideTypeDropdown:!0,types:this.supportedLayerTypes,useDataSources:(null===(g=this.state)||void 0===g?void 0:g.layerViewInfoInEditMode)?(0,e.Immutable)([null===(y=this.state)||void 0===y?void 0:y.layerViewInfoInEditMode]):null,onChange:this.handleUseDataSourceChange,widgetId:null===(m=this.props)||void 0===m?void 0:m.id}))))),"view"===this.props.config.mode&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{role:"group",className:"section-title","aria-describedby":`survey_${this.props.id}_chooseExistDataViewDesc`,"aria-label":this.nls("chooseExistDataTitle"),"aria-owns":`survey_${this.props.id}_selectMapForVIewMode`},(0,e.jsx)("h6",null,this.nls("chooseExistDataTitle")))),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("span",{id:`survey_${this.props.id}_chooseExistDataViewDesc`,className:"w-100"},this.nls("chooseExistDataViewDesc"))),(0,e.jsx)(i.SettingRow,{className:"fea-layer-outter"},(0,e.jsx)("div",{id:`survey_${this.props.id}_selectMapForVIewMode`},(0,e.jsx)(i.SettingRow,{className:"use-feature-layer-setting"},(0,e.jsx)("span",{title:this.nls("selectSurveyLayerTip")},this.nls("sourceLayer"))),(0,e.jsx)("div",{className:"feature-layer-dropdown",title:this.nls("selectSurveyLayerTip")},(0,e.jsx)(n.DataSourceSelector,{isMultiple:!1,hideDataView:!0,"aria-label":this.nls("sourceLayer"),"aria-describedby":"",mustUseDataSource:!0,closeDataSourceListOnChange:!0,hideTypeDropdown:!0,types:this.supportedLayerTypes,useDataSources:(null===(S=this.state)||void 0===S?void 0:S.layerViewInfoInViewMode)?(0,e.Immutable)([null===(f=this.state)||void 0===f?void 0:f.layerViewInfoInViewMode]):null,onChange:this.handleUseDataSourceChange,widgetId:null===(x=this.props)||void 0===x?void 0:x.id}))))))),(0,e.jsx)("div",{className:"survey123__section",role:"group","aria-label":this.nls("resetSurveyLabel"),style:-1!==this.state.mode.indexOf("confirmResetSurvey")?{display:"block"}:{display:"none"}},(0,e.jsx)(i.SettingSection,{title:this.nls("resetSurveyLabel")},(0,e.jsx)(i.SettingRow,null,this.props.intl.formatMessage({id:"resetSurveyTip",defaultMessage:l.resetSurveyTip})),this.props.intl.formatMessage({id:"confirmResetSurveyTip",defaultMessage:l.confirmResetSurveyTip}),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(a.Button,{"aria-description":this.props.intl.formatMessage({id:"resetSurveyTip",defaultMessage:l.resetSurveyTip}),type:"primary",onClick:()=>{this.resetSurvey()}},this.nls("yes")),(0,e.jsx)(a.Button,{onClick:()=>{this.showSettingPage()}},this.nls("no"))))),(0,e.jsx)(a.Modal,{isOpen:this.state.modalIsOpen,className:"w-100 h-100 p-0 m-0 survey123__desinger_modal",css:p(this.props.theme)},(0,e.jsx)("div",{className:"survey123__desinger"},(0,e.jsx)("p",null,this.props.intl.formatMessage({id:"editSurveyBtn",defaultMessage:l.editSurveyBtn})),(0,e.jsx)("button",{color:"primary",onClick:this.handleCloseModal},(0,e.jsx)(v,{size:24}))),(0,e.jsx)("iframe",{id:"survey123-designer",width:"100%"}),(0,e.jsx)(a.AlertPopup,{isOpen:this.state.isShowCloseDesignerAlert,okLabel:this.nls("ok"),title:this.props.label,toggle:this.handleCloseDesignerAlert},(0,e.jsx)("div",{style:{fontSize:"1rem"}},this.nls("msgUnsavedBeforeLeaving")))))}}function I(e){u.p=e}})(),d})())}}}));