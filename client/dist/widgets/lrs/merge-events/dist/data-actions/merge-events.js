System.register(["jimu-core","widgets/shared-code/lrs"],(function(e,t){var r={},o={};return{setters:[function(e){r.AbstractDataAction=e.AbstractDataAction,r.DataLevel=e.DataLevel,r.DataSourceStatus=e.DataSourceStatus,r.DataSourceTypes=e.DataSourceTypes,r.Immutable=e.Immutable,r.MutableStoreManager=e.MutableStoreManager,r.getAppStore=e.getAppStore},function(e){o.LrsLayerType=e.LrsLayerType,o.isDefined=e.isDefined}],execute:function(){e((()=>{"use strict";var e={79244:e=>{e.exports=r},47626:e=>{e.exports=o}},t={};function a(r){var o=t[r];if(void 0!==o)return o.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,a),n.exports}a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};a.r(n),a.d(n,{default:()=>d});var i=a(79244),u=a(47626),s=function(e,t,r,o){return new(r||(r=Promise))((function(a,n){function i(e){try{s(o.next(e))}catch(e){n(e)}}function u(e){try{s(o.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,u)}s((o=o.apply(e,t||[])).next())}))};class d extends i.AbstractDataAction{isSupported(e,t){return s(this,void 0,void 0,(function*(){var r;if(e.length>1)return!1;const o=e[0];if(o.records.length<2)return!1;const{dataSource:a,records:n}=o,s=a.type===i.DataSourceTypes.FeatureLayer||a.type===i.DataSourceTypes.SceneLayer,d=a.isDataSourceSet(),l=t!==i.DataLevel.Records,p=o.dataSource,f=(null==p?void 0:p.supportSpatialInfo)&&(null==p?void 0:p.supportSpatialInfo()),v=t===i.DataLevel.Records&&0===(null==n?void 0:n.length),S=!a.isInAppConfig()&&!s;if(d||l||v||S||!f)return!1;if(!a||a.getStatus()===i.DataSourceStatus.NotReady)return!1;const y=a;if(!(0,u.isDefined)(y))return!1;const g=c();let D;return(null===(r=null==g?void 0:g.widgets)||void 0===r?void 0:r[this.widgetId]).config.lrsLayers.forEach((e=>{e.id===y.id&&(D=e)})),!(!(0,u.isDefined)(D)||D.layerType!==u.LrsLayerType.event)}))}onExecute(e,t){return s(this,void 0,void 0,(function*(){var t;const r=e[0].dataSource,o=c();let a;return(null===(t=null==o?void 0:o.widgets)||void 0===t?void 0:t[this.widgetId]).config.lrsLayers.forEach((e=>{e.id===r.id&&(a=e)})),setTimeout((()=>{i.MutableStoreManager.getInstance().updateStateValue(this.widgetId,"selectedEventLyr",(0,i.Immutable)(a))}),1e3),!0}))}}function c(){var e,t,r;return window.jimuConfig.isBuilder?null===(t=null===(e=(0,i.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig:null===(r=(0,i.getAppStore)().getState())||void 0===r?void 0:r.appConfig}return n})())}}}));