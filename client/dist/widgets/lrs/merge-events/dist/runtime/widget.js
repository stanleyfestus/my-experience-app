System.register(["jimu-core","widgets/shared-code/lrs","jimu-ui","jimu-arcgis","jimu-core/react","jimu-ui/basic/list-tree","calcite-components","esri/layers/GraphicsLayer","esri/widgets/Sketch/SketchViewModel","esri/Graphic"],(function(e,t){var n={},a={},o={},s={},r={},i={},l={},c={},u={},d={};return{setters:[function(e){n.DataRecordSetChangeMessage=e.DataRecordSetChangeMessage,n.DataSourceComponent=e.DataSourceComponent,n.DataSourceManager=e.DataSourceManager,n.DataSourceSelectionMode=e.DataSourceSelectionMode,n.DataSourceStatus=e.DataSourceStatus,n.Immutable=e.Immutable,n.MessageManager=e.MessageManager,n.React=e.React,n.RecordSetChangeType=e.RecordSetChangeType,n.SessionManager=e.SessionManager,n.WidgetState=e.WidgetState,n.css=e.css,n.esri=e.esri,n.getAppStore=e.getAppStore,n.hooks=e.hooks,n.jsx=e.jsx},function(e){a.AttributeTable=e.AttributeTable,a.GetUnits=e.GetUnits,a.LockAction=e.LockAction,a.LockManagerComponent=e.LockManagerComponent,a.LrsLayerType=e.LrsLayerType,a.flash=e.flash,a.formatMessage=e.formatMessage,a.getCalciteBasicTheme=e.getCalciteBasicTheme,a.getDateToUTC=e.getDateToUTC,a.getDateWithTZOffset=e.getDateWithTZOffset,a.getDateWithoutTZOffset=e.getDateWithoutTZOffset,a.getGeometryGraphic=e.getGeometryGraphic,a.getInitialRouteInfoState=e.getInitialRouteInfoState,a.getIntialLocksInfo=e.getIntialLocksInfo,a.getNetworkOutFields=e.getNetworkOutFields,a.getSimpleLineGraphic=e.getSimpleLineGraphic,a.getSimplePointGraphic=e.getSimplePointGraphic,a.isDate=e.isDate,a.isDefined=e.isDefined,a.isInWidgetController=e.isInWidgetController,a.isNumber=e.isNumber,a.queryEventsByEventObjectIds=e.queryEventsByEventObjectIds,a.queryRouteId=e.queryRouteId,a.queryRouteIds=e.queryRouteIds,a.tryReleaseLockOnDefault=e.tryReleaseLockOnDefault,a.validateField=e.validateField,a.validateRangeDomain=e.validateRangeDomain},function(e){o.Alert=e.Alert,o.Button=e.Button,o.Checkbox=e.Checkbox,o.Label=e.Label,o.Select=e.Select,o.Tooltip=e.Tooltip,o.WidgetPlaceholder=e.WidgetPlaceholder,o.defaultMessages=e.defaultMessages},function(e){s.JimuMapViewComponent=e.JimuMapViewComponent,s.LayerTypes=e.LayerTypes,s.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules},function(e){r.useImperativeHandle=e.useImperativeHandle},function(e){i.List=e.List,i.TreeItemActionType=e.TreeItemActionType},function(e){l.CalciteInputDatePicker=e.CalciteInputDatePicker},function(e){c.default=e.default},function(e){u.default=e.default},function(e){d.default=e.default}],execute:function(){e((()=>{var e={40828:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" d="M2 1h8a1 1 0 0 1 1 1h1a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h4.5v-1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1M11 12h-1v3h7v2h1v-3h-7z"></path><path fill="#000" d="M7.5 6H9v2h1V5H7.5zM4.5 5H3V3H2v3h2.5zM5.5 2v7h1V2zM11 4.5h3A1.5 1.5 0 0 1 15.5 6v2.293l-1.646-1.647-.707.708L16 10.207l2.854-2.853-.707-.708L16.5 8.293V6A2.5 2.5 0 0 0 14 3.5h-3z"></path><path fill="#000" d="M19 11a1 1 0 0 0-.81-.982l.771-.772A2 2 0 0 1 20 11v7a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3l1 1h-4a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1z"></path></svg>'},62838:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746z"></path></svg>'},99037:e=>{"use strict";e.exports=l},22089:e=>{"use strict";e.exports=d},59620:e=>{"use strict";e.exports=c},10624:e=>{"use strict";e.exports=u},62686:e=>{"use strict";e.exports=s},79244:e=>{"use strict";e.exports=n},68972:e=>{"use strict";e.exports=r},14321:e=>{"use strict";e.exports=o},98640:e=>{"use strict";e.exports=i},47626:e=>{"use strict";e.exports=a}},t={};function f(n){var a=t[n];if(void 0!==a)return a.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,f),o.exports}f.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return f.d(t,{a:t}),t},f.d=(e,t)=>{for(var n in t)f.o(t,n)&&!f.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},f.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),f.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},f.p="";var v={};return f.p=window.jimuConfig.baseUrl,(()=>{"use strict";f.r(v),f.d(v,{__set_webpack_public_path__:()=>xa,default:()=>Ta});var e=f(79244),t=f(47626),n=function(e,t,n,a){return new(n||(n=Promise))((function(o,s){function r(e){try{l(a.next(e))}catch(e){s(e)}}function i(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}l((a=a.apply(e,t||[])).next())}))};function a(e,a,o,s,r,i,l,c,u,d){return n(this,void 0,void 0,(function*(){let n;if(1===a.length)n=o("selectAtLeastTwoEvents");else if(a.length>0)if(s.eventInfo.canSpanRoutes){const l=[];for(let e=0;e<a.length;e++){const t=a[e].attributes[s.eventInfo.routeIdFieldName];l.push(t);const n=a[e].attributes[s.eventInfo.toRouteIdFieldName];l.push(n)}const c={};yield(0,t.queryRouteIds)(l,r.networkInfo,i).then((i=>{if((0,t.isDefined)(i)){let l;const u=(0,t.getNetworkOutFields)(r.networkInfo);for(let e=0;e<i.features.length;e++){const a=i.features[e].attributes[u.lineIdFieldName],s=i.features[e].attributes[u.lineOrderFieldName],r=i.features[e].attributes[u.routeIdFieldName];if(c[r]=s,(0,t.isDefined)(l)){if(l!==a){n=o("eventsNotOnSameLine");break}}else l=a}e&&(a.forEach((e=>{e.attributes.fromLineOrder=c[e.attributes[s.eventInfo.routeIdFieldName]],e.attributes.toLineOrder=c[e.attributes[s.eventInfo.toRouteIdFieldName]]})),a.sort(((e,t)=>e.attributes.fromLineOrder-t.attributes.fromLineOrder||e.attributes.toLineOrder-t.attributes.toLineOrder||e.attributes[s.eventInfo.fromMeasureFieldName]-t.attributes[s.eventInfo.fromMeasureFieldName])))}}))}else{let r;for(let e=0;e<a.length;e++){const i=a[e].attributes[s.eventInfo.routeIdFieldName];if((0,t.isDefined)(r)){if(r!==i){n=o("eventsNotOnSameRoute");break}}else r=i}e&&a.sort(((e,t)=>e.attributes[s.eventInfo.fromMeasureFieldName]-t.attributes[s.eventInfo.fromMeasureFieldName]))}return!((0,t.isDefined)(n)&&n.length>0&&"success"!==l)||(c("error"),u(n),d(!0),setTimeout((()=>{d(!1)}),5e3),!1)}))}const o={_widgetLabel:"Merge Events",eventLabel:"Event",eventListLabel:"Events to Merge *",preserveLabel:" (preserve)",selectButtonLabel:"Change event selection",fromMeasureWithUnits:"From Measure ({units})",toMeasureWithUnits:"To Measure ({units})",startDateLabel:"Start Date",endDateLabel:"End Date",useStartDateLabel:"Use route start date",useEndDateLabel:"Use route end date",mergeLabel:"Merge",eventMerged:"Event Merged",invalidFromDateBefore:"From date is before route's from date",invalidFromDateAfter:"From date is after route's to date",invalidToDateBefore:"To date is before route's from date",invalidToDateAfter:"To date is after route's to date",invalidDatesOrder:"Selected from date is greater than selected to date",invalidDatesSameDay:"From and to dates cannot be the same",fieldInfo:"Name: {name}\nAlias: {alias}\nType: {type}\nNullable: {nullable}\nDefault Value: {default}\nEditable: {editable}",mergedEventAttributesLabel:"Merged Event Attributes",eventsNotCoincident:"Unable to merge non-coincident events.",eventNotOverlapMergeDates:"The following event object ID(s) must overlap between Merge Dates:\n{objectIds}",eventsNotOnSameRoute:"The selected events are not on the same route.",eventsNotOnSameLine:"The selected events are not on the same line.",selectAtLeastTwoEvents:"Select at least two events to merge.",eventsToDateNotNull:"The following event object ID(s) must have null in To Date:\n{objectIds}",eventsNotActiveToday:"The following event object ID(s) must be active today:\n{objectIds}",chooseEventsFromMap:"(Choose events from map)",invalidContingentValues:"Attribute do not satisfy a required Contingent Value: {groupNames}",contingentValueError:"Invalid contingent value in the field"};var s=f(14321),r=f(40828),i=f.n(r),l=f(62686);function c(){const t=e.hooks.useTranslation(o);return(0,e.jsx)("div",{className:"merge-events-form-header"},(0,e.jsx)("div",{className:"merge-events-form-header__header pt-3 px-3 align-items-center"},(0,e.jsx)("div",{className:"merge-events_title d-flex align-items-center text-truncate",css:e.css`font-weight: 500; font-size: 14px;`},(0,e.jsx)("div",{className:"text-truncate"},t("_widgetLabel")))))}const u=function(){this.__data__=[],this.size=0};const d=function(e,t){return e===t||e!=e&&t!=t};const h=function(e,t){for(var n=e.length;n--;)if(d(e[n][0],t))return n;return-1};var p=Array.prototype.splice;const m=function(e){var t=this.__data__,n=h(t,e);return!(n<0)&&(n==t.length-1?t.pop():p.call(t,n,1),--this.size,!0)};const y=function(e){var t=this.__data__,n=h(t,e);return n<0?void 0:t[n][1]};const g=function(e){return h(this.__data__,e)>-1};const b=function(e,t){var n=this.__data__,a=h(n,e);return a<0?(++this.size,n.push([e,t])):n[a][1]=t,this};function D(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}D.prototype.clear=u,D.prototype.delete=m,D.prototype.get=y,D.prototype.has=g,D.prototype.set=b;const I=D;const S=function(){this.__data__=new I,this.size=0};const w=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};const j=function(e){return this.__data__.get(e)};const k=function(e){return this.__data__.has(e)};const L="object"==typeof global&&global&&global.Object===Object&&global;var T="object"==typeof self&&self&&self.Object===Object&&self;const x=L||T||Function("return this")();const R=x.Symbol;var F=Object.prototype,M=F.hasOwnProperty,N=F.toString,E=R?R.toStringTag:void 0;const A=function(e){var t=M.call(e,E),n=e[E];try{e[E]=void 0;var a=!0}catch(e){}var o=N.call(e);return a&&(t?e[E]=n:delete e[E]),o};var O=Object.prototype.toString;const _=function(e){return O.call(e)};var C=R?R.toStringTag:void 0;const U=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":C&&C in Object(e)?A(e):_(e)};const P=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};const G=function(e){if(!P(e))return!1;var t=U(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};const V=x["__core-js_shared__"];var B,q=(B=/[^.]+$/.exec(V&&V.keys&&V.keys.IE_PROTO||""))?"Symbol(src)_1."+B:"";const W=function(e){return!!q&&q in e};var z=Function.prototype.toString;const H=function(e){if(null!=e){try{return z.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var J=/^\[object .+?Constructor\]$/,Q=Function.prototype,Z=Object.prototype,$=Q.toString,Y=Z.hasOwnProperty,K=RegExp("^"+$.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const X=function(e){return!(!P(e)||W(e))&&(G(e)?K:J).test(H(e))};const ee=function(e,t){return null==e?void 0:e[t]};const te=function(e,t){var n=ee(e,t);return X(n)?n:void 0};const ne=te(x,"Map");const ae=te(Object,"create");const oe=function(){this.__data__=ae?ae(null):{},this.size=0};const se=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t};var re=Object.prototype.hasOwnProperty;const ie=function(e){var t=this.__data__;if(ae){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return re.call(t,e)?t[e]:void 0};var le=Object.prototype.hasOwnProperty;const ce=function(e){var t=this.__data__;return ae?void 0!==t[e]:le.call(t,e)};const ue=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ae&&void 0===t?"__lodash_hash_undefined__":t,this};function de(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}de.prototype.clear=oe,de.prototype.delete=se,de.prototype.get=ie,de.prototype.has=ce,de.prototype.set=ue;const fe=de;const ve=function(){this.size=0,this.__data__={hash:new fe,map:new(ne||I),string:new fe}};const he=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};const pe=function(e,t){var n=e.__data__;return he(t)?n["string"==typeof t?"string":"hash"]:n.map};const me=function(e){var t=pe(this,e).delete(e);return this.size-=t?1:0,t};const ye=function(e){return pe(this,e).get(e)};const ge=function(e){return pe(this,e).has(e)};const be=function(e,t){var n=pe(this,e),a=n.size;return n.set(e,t),this.size+=n.size==a?0:1,this};function De(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}De.prototype.clear=ve,De.prototype.delete=me,De.prototype.get=ye,De.prototype.has=ge,De.prototype.set=be;const Ie=De;const Se=function(e,t){var n=this.__data__;if(n instanceof I){var a=n.__data__;if(!ne||a.length<199)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new Ie(a)}return n.set(e,t),this.size=n.size,this};function we(e){var t=this.__data__=new I(e);this.size=t.size}we.prototype.clear=S,we.prototype.delete=w,we.prototype.get=j,we.prototype.has=k,we.prototype.set=Se;const je=we;const ke=function(e,t){for(var n=-1,a=null==e?0:e.length;++n<a&&!1!==t(e[n],n,e););return e};const Le=function(){try{var e=te(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();const Te=function(e,t,n){"__proto__"==t&&Le?Le(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n};var xe=Object.prototype.hasOwnProperty;const Re=function(e,t,n){var a=e[t];xe.call(e,t)&&d(a,n)&&(void 0!==n||t in e)||Te(e,t,n)};const Fe=function(e,t,n,a){var o=!n;n||(n={});for(var s=-1,r=t.length;++s<r;){var i=t[s],l=a?a(n[i],e[i],i,n,e):void 0;void 0===l&&(l=e[i]),o?Te(n,i,l):Re(n,i,l)}return n};const Me=function(e,t){for(var n=-1,a=Array(e);++n<e;)a[n]=t(n);return a};const Ne=function(e){return null!=e&&"object"==typeof e};const Ee=function(e){return Ne(e)&&"[object Arguments]"==U(e)};var Ae=Object.prototype,Oe=Ae.hasOwnProperty,_e=Ae.propertyIsEnumerable,Ce=Ee(function(){return arguments}())?Ee:function(e){return Ne(e)&&Oe.call(e,"callee")&&!_e.call(e,"callee")};const Ue=Ce;const Pe=Array.isArray;const Ge=function(){return!1};var Ve="object"==typeof exports&&exports&&!exports.nodeType&&exports,Be=Ve&&"object"==typeof module&&module&&!module.nodeType&&module,qe=Be&&Be.exports===Ve?x.Buffer:void 0;const We=(qe?qe.isBuffer:void 0)||Ge;var ze=/^(?:0|[1-9]\d*)$/;const He=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&ze.test(e))&&e>-1&&e%1==0&&e<t};const Je=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var Qe={};Qe["[object Float32Array]"]=Qe["[object Float64Array]"]=Qe["[object Int8Array]"]=Qe["[object Int16Array]"]=Qe["[object Int32Array]"]=Qe["[object Uint8Array]"]=Qe["[object Uint8ClampedArray]"]=Qe["[object Uint16Array]"]=Qe["[object Uint32Array]"]=!0,Qe["[object Arguments]"]=Qe["[object Array]"]=Qe["[object ArrayBuffer]"]=Qe["[object Boolean]"]=Qe["[object DataView]"]=Qe["[object Date]"]=Qe["[object Error]"]=Qe["[object Function]"]=Qe["[object Map]"]=Qe["[object Number]"]=Qe["[object Object]"]=Qe["[object RegExp]"]=Qe["[object Set]"]=Qe["[object String]"]=Qe["[object WeakMap]"]=!1;const Ze=function(e){return Ne(e)&&Je(e.length)&&!!Qe[U(e)]};const $e=function(e){return function(t){return e(t)}};var Ye="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ke=Ye&&"object"==typeof module&&module&&!module.nodeType&&module,Xe=Ke&&Ke.exports===Ye&&L.process;const et=function(){try{var e=Ke&&Ke.require&&Ke.require("util").types;return e||Xe&&Xe.binding&&Xe.binding("util")}catch(e){}}();var tt=et&&et.isTypedArray;const nt=tt?$e(tt):Ze;var at=Object.prototype.hasOwnProperty;const ot=function(e,t){var n=Pe(e),a=!n&&Ue(e),o=!n&&!a&&We(e),s=!n&&!a&&!o&&nt(e),r=n||a||o||s,i=r?Me(e.length,String):[],l=i.length;for(var c in e)!t&&!at.call(e,c)||r&&("length"==c||o&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||He(c,l))||i.push(c);return i};var st=Object.prototype;const rt=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||st)};const it=function(e,t){return function(n){return e(t(n))}};const lt=it(Object.keys,Object);var ct=Object.prototype.hasOwnProperty;const ut=function(e){if(!rt(e))return lt(e);var t=[];for(var n in Object(e))ct.call(e,n)&&"constructor"!=n&&t.push(n);return t};const dt=function(e){return null!=e&&Je(e.length)&&!G(e)};const ft=function(e){return dt(e)?ot(e):ut(e)};const vt=function(e,t){return e&&Fe(t,ft(t),e)};const ht=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t};var pt=Object.prototype.hasOwnProperty;const mt=function(e){if(!P(e))return ht(e);var t=rt(e),n=[];for(var a in e)("constructor"!=a||!t&&pt.call(e,a))&&n.push(a);return n};const yt=function(e){return dt(e)?ot(e,!0):mt(e)};const gt=function(e,t){return e&&Fe(t,yt(t),e)};var bt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Dt=bt&&"object"==typeof module&&module&&!module.nodeType&&module,It=Dt&&Dt.exports===bt?x.Buffer:void 0,St=It?It.allocUnsafe:void 0;const wt=function(e,t){if(t)return e.slice();var n=e.length,a=St?St(n):new e.constructor(n);return e.copy(a),a};const jt=function(e,t){var n=-1,a=e.length;for(t||(t=Array(a));++n<a;)t[n]=e[n];return t};const kt=function(e,t){for(var n=-1,a=null==e?0:e.length,o=0,s=[];++n<a;){var r=e[n];t(r,n,e)&&(s[o++]=r)}return s};const Lt=function(){return[]};var Tt=Object.prototype.propertyIsEnumerable,xt=Object.getOwnPropertySymbols;const Rt=xt?function(e){return null==e?[]:(e=Object(e),kt(xt(e),(function(t){return Tt.call(e,t)})))}:Lt;const Ft=function(e,t){return Fe(e,Rt(e),t)};const Mt=function(e,t){for(var n=-1,a=t.length,o=e.length;++n<a;)e[o+n]=t[n];return e};const Nt=it(Object.getPrototypeOf,Object);const Et=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Mt(t,Rt(e)),e=Nt(e);return t}:Lt;const At=function(e,t){return Fe(e,Et(e),t)};const Ot=function(e,t,n){var a=t(e);return Pe(e)?a:Mt(a,n(e))};const _t=function(e){return Ot(e,ft,Rt)};const Ct=function(e){return Ot(e,yt,Et)};const Ut=te(x,"DataView");const Pt=te(x,"Promise");const Gt=te(x,"Set");const Vt=te(x,"WeakMap");var Bt="[object Map]",qt="[object Promise]",Wt="[object Set]",zt="[object WeakMap]",Ht="[object DataView]",Jt=H(Ut),Qt=H(ne),Zt=H(Pt),$t=H(Gt),Yt=H(Vt),Kt=U;(Ut&&Kt(new Ut(new ArrayBuffer(1)))!=Ht||ne&&Kt(new ne)!=Bt||Pt&&Kt(Pt.resolve())!=qt||Gt&&Kt(new Gt)!=Wt||Vt&&Kt(new Vt)!=zt)&&(Kt=function(e){var t=U(e),n="[object Object]"==t?e.constructor:void 0,a=n?H(n):"";if(a)switch(a){case Jt:return Ht;case Qt:return Bt;case Zt:return qt;case $t:return Wt;case Yt:return zt}return t});const Xt=Kt;var en=Object.prototype.hasOwnProperty;const tn=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&en.call(e,"index")&&(n.index=e.index,n.input=e.input),n};const nn=x.Uint8Array;const an=function(e){var t=new e.constructor(e.byteLength);return new nn(t).set(new nn(e)),t};const on=function(e,t){var n=t?an(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)};var sn=/\w*$/;const rn=function(e){var t=new e.constructor(e.source,sn.exec(e));return t.lastIndex=e.lastIndex,t};var ln=R?R.prototype:void 0,cn=ln?ln.valueOf:void 0;const un=function(e){return cn?Object(cn.call(e)):{}};const dn=function(e,t){var n=t?an(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};const fn=function(e,t,n){var a=e.constructor;switch(t){case"[object ArrayBuffer]":return an(e);case"[object Boolean]":case"[object Date]":return new a(+e);case"[object DataView]":return on(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return dn(e,n);case"[object Map]":case"[object Set]":return new a;case"[object Number]":case"[object String]":return new a(e);case"[object RegExp]":return rn(e);case"[object Symbol]":return un(e)}};var vn=Object.create;const hn=function(){function e(){}return function(t){if(!P(t))return{};if(vn)return vn(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();const pn=function(e){return"function"!=typeof e.constructor||rt(e)?{}:hn(Nt(e))};const mn=function(e){return Ne(e)&&"[object Map]"==Xt(e)};var yn=et&&et.isMap;const gn=yn?$e(yn):mn;const bn=function(e){return Ne(e)&&"[object Set]"==Xt(e)};var Dn=et&&et.isSet;const In=Dn?$e(Dn):bn;var Sn="[object Arguments]",wn="[object Function]",jn="[object Object]",kn={};kn[Sn]=kn["[object Array]"]=kn["[object ArrayBuffer]"]=kn["[object DataView]"]=kn["[object Boolean]"]=kn["[object Date]"]=kn["[object Float32Array]"]=kn["[object Float64Array]"]=kn["[object Int8Array]"]=kn["[object Int16Array]"]=kn["[object Int32Array]"]=kn["[object Map]"]=kn["[object Number]"]=kn[jn]=kn["[object RegExp]"]=kn["[object Set]"]=kn["[object String]"]=kn["[object Symbol]"]=kn["[object Uint8Array]"]=kn["[object Uint8ClampedArray]"]=kn["[object Uint16Array]"]=kn["[object Uint32Array]"]=!0,kn["[object Error]"]=kn[wn]=kn["[object WeakMap]"]=!1;const Ln=function e(t,n,a,o,s,r){var i,l=1&n,c=2&n,u=4&n;if(a&&(i=s?a(t,o,s,r):a(t)),void 0!==i)return i;if(!P(t))return t;var d=Pe(t);if(d){if(i=tn(t),!l)return jt(t,i)}else{var f=Xt(t),v=f==wn||"[object GeneratorFunction]"==f;if(We(t))return wt(t,l);if(f==jn||f==Sn||v&&!s){if(i=c||v?{}:pn(t),!l)return c?At(t,gt(i,t)):Ft(t,vt(i,t))}else{if(!kn[f])return s?t:{};i=fn(t,f,l)}}r||(r=new je);var h=r.get(t);if(h)return h;r.set(t,i),In(t)?t.forEach((function(o){i.add(e(o,n,a,o,t,r))})):gn(t)&&t.forEach((function(o,s){i.set(s,e(o,n,a,s,t,r))}));var p=d?void 0:(u?c?Ct:_t:c?yt:ft)(t);return ke(p||t,(function(o,s){p&&(o=t[s=o]),Re(i,s,e(o,n,a,s,t,r))})),i};const Tn=function(e){return Ln(e,5)};var xn=/\s/;const Rn=function(e){for(var t=e.length;t--&&xn.test(e.charAt(t)););return t};var Fn=/^\s+/;const Mn=function(e){return e?e.slice(0,Rn(e)+1).replace(Fn,""):e};const Nn=function(e){return"symbol"==typeof e||Ne(e)&&"[object Symbol]"==U(e)};var En=/^[-+]0x[0-9a-f]+$/i,An=/^0b[01]+$/i,On=/^0o[0-7]+$/i,_n=parseInt;const Cn=function(e){if("number"==typeof e)return e;if(Nn(e))return NaN;if(P(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=P(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Mn(e);var n=An.test(e);return n||On.test(e)?_n(e.slice(2),n?2:8):En.test(e)?NaN:+e};var Un=1/0;const Pn=function(e){return e?(e=Cn(e))===Un||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};const Gn=function(e){var t=Pn(e),n=t%1;return t==t?n?t-n:t:0};const Vn=function(e,t){for(var n=-1,a=null==e?0:e.length,o=Array(a);++n<a;)o[n]=t(e[n],n,e);return o};var Bn=R?R.prototype:void 0,qn=Bn?Bn.toString:void 0;const Wn=function e(t){if("string"==typeof t)return t;if(Pe(t))return Vn(t,e)+"";if(Nn(t))return qn?qn.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n};const zn=function(e){return null==e?"":Wn(e)};var Hn=x.isFinite,Jn=Math.min;const Qn=function(e){var t=Math[e];return function(e,n){if(e=Cn(e),(n=null==n?0:Jn(Gn(n),292))&&Hn(e)){var a=(zn(e)+"e").split("e"),o=t(a[0]+"e"+(+a[1]+n));return+((a=(zn(o)+"e").split("e"))[0]+"e"+(+a[1]-n))}return t(e)}}("round");var Zn=function(e,t,n,a){return new(n||(n=Promise))((function(o,s){function r(e){try{l(a.next(e))}catch(e){s(e)}}function i(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}l((a=a.apply(e,t||[])).next())}))};function $n(n,a,o,s){return Zn(this,void 0,void 0,(function*(){const s=a.lrsUrl,r=`${s}/applyEdits`,i=yield e.SessionManager.getInstance().getSessionByUrl(s).getToken(s),l=[],c={id:a.serviceId,mergeEvents:{objectIds:o.objectIds,objectIdToPreserve:o.objectIdToPreserve,fromDate:o.fromDate?(0,t.getDateToUTC)(o.fromDate):null,toDate:o.toDate?(0,t.getDateToUTC)(o.toDate):null,attributes:o.attributes}};l.push(c);let u=n.getGDBVersion();u||(u="");return function(t){return Zn(this,void 0,void 0,(function*(){return new Promise((function(n,a){const o={params:t.params,httpMethod:t.method};e.esri.restRequest.request(t.url,o).then((e=>{n(e)})).catch((e=>{n(e)}))}))}))}({method:"GET",url:r,params:{f:"json",token:i,gdbVersion:u,edits:l}}).then((e=>Zn(this,void 0,void 0,(function*(){const t={success:!1,editResults:[],code:0,message:"",details:""};return e.hasOwnProperty("success")?(t.success=!0,t.editResults=e.editResults):(t.success=!1,t.code=e.code,t.message=e.message),t}))))}))}const Yn="#00FFFF",Kn="#008000";var Xn=f(68972);var ea;!function(e){e.Blob="esriFieldTypeBlob",e.Date="esriFieldTypeDate",e.Double="esriFieldTypeDouble",e.Geometry="esriFieldTypeGeometry",e.GlobalID="esriFieldTypeGlobalID",e.GUID="esriFieldTypeGUID",e.Integer="esriFieldTypeInteger",e.OID="esriFieldTypeOID",e.Raster="esriFieldTypeRaster",e.Single="esriFieldTypeSingle",e.SmallInteger="esriFieldTypeSmallInteger",e.String="esriFieldTypeString",e.XML="esriFieldTypeXML"}(ea||(ea={}));Object.assign({},{eventRequiredLabel:"Event *",networkRequiredLabel:"Network *",routeIdRequiredLabel:"Route ID *",routeNameRequiredLabel:"Route Name *",startDateRequiredLabel:"Start Date *",nullLabel:"null",fieldInfo:"Name: {name}\nAlias: {alias}\nType: {type}\nNullable: {nullable}\nDefault Value: {default}\nEditable: {editable}",fieldInfoWithError:"Name: {name}\nAlias: {alias}\nType: {type}\nNullable: {nullable}\nDefault Value: {default}\nEditable: {editable}\nError: {error}",fieldTypeWithLength:"{fieldType} ({length})",attributeError:"{fieldValue}: {message}",nonNullable:"Value cannot be null.",invalidShort:"Invalid value for short data type.",invalidInteger:"Invalid value for long data type.",invalidSingle:"Invalid value for float data type.",invalidDouble:"Invalid value for double data type.",invalidString:"Value exceeds maximum length of field",invalidDate:"Invalid date.",invalidRange:"Value exceeds min or max values of range.",contingentValueError:"Invalid contingent value in the field",selectRouteLabel:"Select Route",routePicker:"Route Picker",routeNameLabel:"Route Name",routeIdLabel:"Route ID",fromRouteNameLabel:"From Route Name",fromRouteIdLabel:"From Route ID",toRouteNameLabel:"To Route Name",toRouteIdLabel:"To Route ID",fromDateLabel:"From Date",toDateLabel:"To Date",measureLabel:"Measure",fromMeasureLabel:"From Measure",toMeasureLabel:"To Measure",noResult:"No Results",copyAttributes:"Copy Attributes",noLrsLayersTips:"No LRS layers are present in the selected map. Select a map with LRS Network and Event layers present in the webmap.",multipleServicesTips:"Map contains layers from more than one feature service. Select a map with LRS Network and Event layers coming from a single feature service.",noNetworkLayersTips:"No LRS Network layers are present in the selected map. Select a map with at least one LRS network layer present in the web map.",noMapSelectedTips:"Select a map.",displaySettings:"Display Settings",hideNetwork:"Hide Network",hideEvent:"Hide Event",hideMethod:"Hide Method",hideRoute:"Hide Route in Search by Line",hideType:"Hide Type",hideAttributeSet:"Hide Attribute Set",hideMeasures:"Hide Measures",hideDates:"Hide Dates",useRoutesStartEndDates:"Use Routes Start and End Dates",useRoutesStartEndDatesTooltip:"Routes start/end dates will be used for new events. If disabled, the current date will be used.",selectMap:"Select Map",loadLayers:"Load layers",clearLayers:"Clear layers",removeLayer:"Remove",missingParentNetwork:"Parent network is missing",inches:"Inches (US Survey)",feet:"Feet (US Survey)",yards:"Yards (US Survey)",miles:"Miles (US Survey)",nauticalMiles:"Nautical miles (US Survey)",points:"Points",millimeters:"Millimeters",centimeters:"Centimeters",meters:"Meters",kilometers:"Kilometers",decimalDegrees:"Decimal degrees",decimeters:"Decimeters",intFeet:"Feet (International)",esriUnknownUnits:"esriUnknownUnits",invalidRouteField:"Route could not be found with provided value",CannotAcquireLockUserAndVersion:"Cannot acquire lock because {user} has the lock in version {version}.",UnavailableLockOnLine:"Line {nameOrId} ({networkName}) is already locked by {lockUser} in version {version}.",UnavailableLockOnRoute:"Route {nameOrId} ({networkName}) is already locked by {lockUser} in version {version}.",UnavailableLockOnLineWithoutVersion:"Line {nameOrId} ({networkName}) is already locked by {lockUser} in a different service.",UnavailableLockOnRouteWithoutVersion:"Route {nameOrId} ({networkName}) is already locked by {lockUser} in a different service.",YouAcquiredLockOnLine:"You have acquired a lock on line {nameOrId} ({networkName}) in version {version}.",YouAcquiredLockOnRoute:"You have acquired a lock on route {nameOrId} ({networkName}) in version {version}.",ReconcileRequired:"The default version has changed. Reconcile this version with the default version in order to acquire locks."},s.defaultMessages);function ta(e){return null!=e}var na=function(e,t,n,a){return new(n||(n=Promise))((function(o,s){function r(e){try{l(a.next(e))}catch(e){s(e)}}function i(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}l((a=a.apply(e,t||[])).next())}))};let aa=[];const oa=e.React.forwardRef(((n,r)=>{const i=e.hooks.useTranslation(o),{widgetId:c,jimuMapView:u,network:d,eventDS:f,networkDS:v,eventLayer:h,networkLayer:p,routeInfo:m,reset:y,eventFeatures:g,preservedEventIndex:b,flashGraphic:D,onSubmit:I,toastMsgType:S,onUpdateToastMsgType:w,onUpdateToastMsg:j,onUpdateToastOpen:k,onUpdateStopQuery:L,onValidationChanged:T,intl:x,lockAquired:R,conflictPreventionEnabled:F}=n,[M,N]=e.React.useState(),[E,A]=e.React.useState(!1),[O,_]=e.React.useState(),[C,U]=e.React.useState(),[P,G]=e.React.useState(!1);(0,Xn.useImperativeHandle)(r,(()=>({onSubmitClicked:$}))),e.React.useEffect((()=>{b>-1&&g.length>0&&V()}),[b]),e.React.useEffect((()=>{(y||0===g.length)&&N(B())}),[y,g]),e.React.useEffect((()=>{N(B()),G(!1)}),[f,h]),e.React.useEffect((()=>{if(F){const e=Object.assign({},O);(0,t.isDefined)(d)&&(e.networkId=[d.networkInfo.lrsNetworkId]),(0,t.isDefined)(h)&&(e.eventServiceLayerIds=[h.serviceId]),(0,t.isDefined)(m)&&(e.routeInfo=m),_(e)}}),[v,d,h,m]);const V=()=>{const e=[];if((0,t.isDefined)(h)&&(0,t.isDefined)(f)&&(0,t.isDefined)(h.eventInfo)&&(0,t.isDefined)(h.eventInfo.attributeFields)){const n=f,a=(null==n?void 0:n.layer).fields;h.eventInfo.attributeFields.forEach((n=>{if(n.enabled){const o=a.find((e=>e.name===n.field.name));if(o&&o.editable){let a,s=g[b].attributes[o.name];(0,t.isDate)(o.type)&&(0,t.isDefined)(s)?s=new Date(s):a=(0,t.isDate)(o.type)?(0,t.isDefined)(o.defaultValue)?new Date(o.defaultValue):null:o.defaultValue;const r={index:e.length,name:o.name,alias:o.alias,type:o.type,hasDomain:(0,t.isDefined)(o.domain),value:s,error:"",nullable:o.nullable,default:"number"==typeof a?Number(a).toString():a,length:o.length,editable:n.editable};e.push(r)}}}))}setTimeout((()=>{N(e)}),500)},B=()=>{const e=[];if((0,t.isDefined)(h)&&(0,t.isDefined)(f)&&(0,t.isDefined)(h.eventInfo)&&(0,t.isDefined)(h.eventInfo.attributeFields)){const n=f,a=(null==n?void 0:n.layer).fields;h.eventInfo.attributeFields.forEach((n=>{if(n.enabled){const o=a.find((e=>e.name===n.field.name));if(o){let a;a=(0,t.isDate)(o.type)?(0,t.isDefined)(o.defaultValue)?new Date(o.defaultValue):null:o.defaultValue;const s={index:e.length,name:o.name,alias:o.alias,type:o.type,hasDomain:(0,t.isDefined)(o.domain),value:a,error:"",nullable:o.nullable,default:"number"==typeof a?Number(a).toString():a,length:o.length,editable:n.editable};e.push(s)}}}))}return e},q=e=>e.findIndex((e=>e.error.length>0))>-1,W=e=>{const t=Tn(e);N(t),A(q(t))},z=e=>{let n=!0;const a=e.attributes[h.eventInfo.fromDateFieldName],o=(0,t.getDateToUTC)(m.selectedFromDate),s=(0,t.getDateToUTC)(m.selectedToDate);return(0,t.isDefined)(m.selectedFromDate)&&!(0,t.isDefined)(m.selectedToDate)&&(0,t.isDefined)(a)&&(n=n&&o>=a),!(0,t.isDefined)(m.selectedFromDate)&&(0,t.isDefined)(m.selectedToDate)&&(0,t.isDefined)(a)&&(n=n&&s>a),(0,t.isDefined)(m.selectedFromDate)&&(0,t.isDefined)(m.selectedToDate)&&(n=n&&o<s,(0,t.isDefined)(a)&&(n=n&&(o>=a||s>a))),n},H=()=>{const e=Tn(M);let n=!1;return e.forEach(((a,o)=>{let s;if(s=a.hasDomain?(0,t.validateRangeDomain)(a.value,a.name,f):((0,t.isDate)(a.type),(0,t.validateField)(a.value,a.name,f)),(0,t.isDefined)(aa)){let t=[];const n=function(e,t,n,a,o,s,r){const i={};if(ta(a))if(-1===e&&-1===n)a.forEach((e=>{i[e.name]=e.value}));else{const t=a[n];a.forEach((n=>{i[n.name]=n.value,n.name===t.name&&(i[n.name]=e)}))}else r.forEach((e=>{const t=s.attributes[e.name],n=e.alias.split(".")[1];i[n]=t}));const l=[];for(const e of o){const t=e.isEditingRestrictive?"error":"warning";let n=!1;const a=e.contingencies.filter((e=>!e.isRetired));if(!a||0===a.length)return[];for(const e of a){let t=!0;for(const n in e.values){const a=e.values[n];if("any"!==a.objectType)if("null"===a.objectType){if(null!=i[n]){t=!1;break}}else if("code"===a.objectType){if(null!=a.codedValue&&i[n]!==a.codedValue.code){t=!1;break}}else if("range"===a.objectType){const e=i[n];if(null!=a.minValue&&null!=a.maxValue&&(e<a.minValue||e>a.maxValue)){t=!1;break}}}if(t){n=!0;break}}n||l.push({fieldGroup:e,type:t})}return l}(a.value,0,o,e,aa);(null==n?void 0:n.length)>0&&(n.forEach((e=>{var n;const a=null===(n=null==e?void 0:e.fieldGroup)||void 0===n?void 0:n.fields;t.push(a)})),t=t.flat(),t.includes(a.name)&&(G(!0),s={hasError:!0,message:"contingentValueError"}))}if(s.hasError){let e;if("contingentValueError"===s.message){const t=[];aa.forEach((e=>{t.push(e.name)}));let n=i("invalidContingentValues");n=n.replace("{groupNames}",t.join(",")),e=n,U(e)}else{const n=h.useFieldAlias?a.alias:a.name;e=(0,t.formatMessage)(x,"attributeError",{fieldValue:n,message:(0,t.formatMessage)(x,s.message)})}w("error"),j(e),k(!0),setTimeout((()=>{k(!1)}),5e3),n=!0,a.error=i(s.message)}})),n&&W(e),n},J=()=>na(void 0,void 0,void 0,(function*(){var t;const n=f,a=n.getPopupInfo(),o=n.getLayerDefinition(),s=(e=>e.length?e:(()=>{var e;return[{fieldName:null!==(e=null==o?void 0:o.objectIdField)&&void 0!==e?e:"objectid",label:"OBJECTID",tooltip:"",visible:!0}]})())(((null==a?void 0:a.fieldInfos)||[]).filter((e=>e.visible))),r=n.mergeQueryParams(null!==(t=n.getCurrentQueryParams())&&void 0!==t?t:{},{where:"1=1",sqlExpression:null}),i=Object.assign({returnGeometry:!0},r);yield n.load(i,{widgetId:c});const l=new e.DataRecordSetChangeMessage(c,e.RecordSetChangeType.CreateUpdate,[{records:n.getRecords(),fields:s.map((e=>e.fieldName)),dataSource:n,name:n.id}]);e.MessageManager.getInstance().publishMessage(l)})),Q=e=>na(void 0,void 0,void 0,(function*(){var n;if(!(yield a(!1,g,i,h,p,v,S,w,j,k)))return;if(!(yield na(void 0,void 0,void 0,(function*(){let e=!0;return(0,l.loadArcGISJSAPIModules)(["esri/geometry/geometryEngine"]).then((t=>{let n=null;[n]=t;for(let t=0;t<g.length;t++){for(let a=0;a<g.length;a++)if(a!==t){if(!n.disjoint(g[t].geometry,g[a].geometry)||g[t].attributes[h.eventInfo.routeIdFieldName]===g[a].attributes[h.eventInfo.routeIdFieldName]&&(g[t].attributes[h.eventInfo.fromMeasureFieldName]===g[a].attributes[h.eventInfo.toMeasureFieldName]||g[t].attributes[h.eventInfo.toMeasureFieldName]===g[a].attributes[h.eventInfo.fromMeasureFieldName]))break;a===g.length-1&&(e=!1)}if(!e){w("error"),j(i("eventsNotCoincident")),k(!0),setTimeout((()=>{k(!1)}),5e3);break}}return e}))}))))return;if(H())return;if(!(()=>{let e="";const n=[],a=[],o=[];for(let e=0;e<g.length;e++){const s=g[e],r=s.attributes[f.getSchema().idField];null!=s.attributes[h.eventInfo.toDateFieldName]?n.push(r):null!=s.attributes[h.eventInfo.fromDateFieldName]&&s.attributes[h.eventInfo.fromDateFieldName]>(0,t.getDateToUTC)(new Date(Date.now()))?a.push(r):z(s)||o.push(r)}return n.length>0?e=i("eventsToDateNotNull",{objectIds:n.join(", ")}):a.length>0?e=i("eventsNotActiveToday",{objectIds:a.join(", ")}):o.length>0&&(e=i("eventNotOverlapMergeDates",{objectIds:o.join(", ")})),!(e.length>0&&(w("error"),j(e),k(!0),setTimeout((()=>{k(!1)}),5e3),1))})())return;const o={};if((0,t.isDefined)(h)&&b>-1&&g.length>0){const e={},a=h.eventInfo.eventIdFieldName;e[a]=g[b].attributes[h.eventInfo.eventIdFieldName];const s=g[0].attributes[h.eventInfo.routeIdFieldName],r=g[g.length-1].attributes[h.eventInfo.routeIdFieldName];let i=Qn(g[0].attributes[h.eventInfo.fromMeasureFieldName],d.networkInfo.measurePrecision);const l=Qn(g[g.length-1].attributes[h.eventInfo.fromMeasureFieldName],d.networkInfo.measurePrecision);s===r&&l<i&&(i=l);const c=h.eventInfo.fromMeasureFieldName;e[c]=i;const u=g[0].attributes[h.eventInfo.toRouteIdFieldName],v=g[g.length-1].attributes[h.eventInfo.toRouteIdFieldName],p=Qn(g[0].attributes[h.eventInfo.toMeasureFieldName],d.networkInfo.measurePrecision);let y=Qn(g[g.length-1].attributes[h.eventInfo.toMeasureFieldName],d.networkInfo.measurePrecision);u===v&&p>y&&(y=p);const D=h.eventInfo.toMeasureFieldName;e[D]=y,M.forEach((n=>{const a=n.name;if((0,t.isDefined)(n.value)&&(0,t.isDate)(n.type)){const o=(0,t.getDateWithoutTZOffset)(n.value.valueOf(),f);e[a]=(0,t.getDateToUTC)(o)}else(0,t.isNumber)(n.type)?!(0,t.isDefined)(n.value)||isNaN(Number(n.value))?e[a]=null:e[a]=Number(n.value):e[a]=n.value}));const I=null===(n=f.getSchema())||void 0===n?void 0:n.idField,S=[];if(g.forEach((e=>{S.push(e.attributes[I])})),o.attributes=e,o.objectIdToPreserve=g[b].attributes[I],o.objectIds=S,(0,t.isDefined)(m.selectedFromDate)){const e=(0,t.getDateWithoutTZOffset)(m.selectedFromDate.valueOf(),f);o.fromDate=e}else o.fromDate=m.selectedFromDate;if((0,t.isDefined)(m.selectedToDate)){const e=(0,t.getDateWithoutTZOffset)(m.selectedToDate.valueOf(),f);o.toDate=e}else o.toDate=m.selectedToDate}const s=f;yield $n(s,h,o).then((n=>na(void 0,void 0,void 0,(function*(){if(n.success){if((0,t.isDefined)(h)&&(0,t.isDefined)(f)){const e=f;(0,t.queryEventsByEventObjectIds)(e,n.editResults[0].mergeEventsResult.objectIds).then((e=>{e.forEach(((e,n)=>na(void 0,void 0,void 0,(function*(){const n=e.geometry;(0,t.isDefined)(n)&&(0,t.flash)(D,yield(0,t.getGeometryGraphic)(yield(0,t.getSimpleLineGraphic)(n),Yn))}))))}))}w("success"),j(i("eventMerged")),k(!0),J(),setTimeout((()=>na(void 0,void 0,void 0,(function*(){k(!1),w("error"),L(!1);const n=u.jimuLayerViews,a=Object.keys(n);for(let e=0;e<a.length;e++){const t=n[a[e]];t.layer.title===h.name&&t.selectFeaturesByIds([])}if(F&&(0,t.isDefined)(e)){yield(0,t.tryReleaseLockOnDefault)(v,e);const n=Object.assign(Object.assign({},O),{lockAction:t.LockAction.Clear});_(n)}else I()}))),5e3)}else w("error"),j(n.message),k(!0),setTimeout((()=>{k(!1)}),5e3)}))))})),Z=e.React.useCallback((()=>{if(!(0,t.isDefined)(m.selectedFromDate)&&!(0,t.isDefined)(m.selectedToDate))return!1;if((0,t.isDefined)(m.selectedFromDate)&&!(0,t.isDefined)(m.selectedToDate)){if((0,t.isDefined)(m.fromDate)&&m.selectedFromDate<m.fromDate)return!1;if((0,t.isDefined)(m.toDate)&&m.selectedFromDate>m.toDate)return!1}if(!(0,t.isDefined)(m.selectedFromDate)&&(0,t.isDefined)(m.selectedToDate)){if((0,t.isDefined)(m.fromDate)&&m.selectedToDate<m.fromDate)return!1;if((0,t.isDefined)(m.toDate)&&m.selectedToDate>m.toDate)return!1}if((0,t.isDefined)(m.selectedFromDate)&&(0,t.isDefined)(m.selectedToDate)){if(m.selectedFromDate>m.selectedToDate)return!1;if((0,t.isDefined)(m.fromDate)&&m.selectedFromDate<m.fromDate)return!1;if((0,t.isDefined)(m.toDate)&&m.selectedToDate>m.toDate)return!1}return!E&&(0!==g.length&&(-1!==b&&!!R))}),[m]),$=()=>{if(F){const e=Object.assign(Object.assign({},O),{lockAction:t.LockAction.QueryAndAcquire});_(e)}else Q()};return e.React.useEffect((()=>{T(Z())}),[Z,T]),(0,e.jsx)("div",{className:"merge-events-edit-attributes__content",css:e.css`
    flex: 1 1 auto;
    display: flex;
    flex-direction: column;

    .merge-events-edit-attributes__content {
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
      flex: 1 1 auto;
      overflow: auto;
    }
    .merge-events-edit-attributes__action {
      height: 100%;
    }
  `},(0,e.jsx)("div",{className:"h-100"},F&&(0,e.jsx)(t.LockManagerComponent,{intl:x,featureDS:v,lockInfo:O,showAlert:!1,conflictPreventionEnabled:F,onQueryAndAcquireComplete:(e,n,a)=>{const o=Object.assign(Object.assign({},e),{lockAction:t.LockAction.None});_(o),a&&Q(o)},onMessageClear:()=>{const e=Object.assign(Object.assign({},O),{lockAction:t.LockAction.None});_(e),I()}}),P&&(0,e.jsx)("div",{style:{marginTop:"1.2rem"}},(0,e.jsx)(s.Alert,{tabIndex:0,className:"w-100 userInfo",onClose:function(){G(!1)},open:P,text:C,type:"warning",closable:!0,withIcon:!0})),(0,e.jsx)(t.AttributeTable,{tableIndex:0,collapable:!1,eventDS:f,eventLayer:h,fieldInfos:M,useAlias:!(0,t.isDefined)(h)||h.useFieldAlias,onUpdateItem:(e,t,n)=>{const a=Tn(M);a[n].value=e,a[n].error=t,N(a),A(q(a))},onUpdateAll:W,onFieldGrpUpdated:(e,t)=>{aa=e,aa&&0!==(null==aa?void 0:aa.length)||G(!1)},tableLabel:i("mergedEventAttributesLabel")})))}));function sa(t){const{network:n,event:a,dataSourcesReady:o,onCreateNetworkDs:s,onCreateEventDs:r}=t,[i,l]=e.React.useState(null!=n?n:null),[c,u]=e.React.useState(null!=a?a:null),[d,f]=e.React.useState(!1),[v,h]=e.React.useState(!1);e.React.useEffect((()=>{n&&l(n)}),[n]),e.React.useEffect((()=>{a&&u(a)}),[a]),e.React.useEffect((()=>{o(d&&v)}),[o,v,d]);const p=e.React.useCallback((e=>{s(e)}),[s]),m=e.React.useCallback((e=>{r(e)}),[r]),y=e.React.useCallback((t=>{if(t){const{status:n,instanceStatus:a}=t;a===e.DataSourceStatus.NotCreated||a===e.DataSourceStatus.CreateError||n===e.DataSourceStatus.LoadError||n===e.DataSourceStatus.NotReady?f(!1):f(!0)}}),[f]),g=e.React.useCallback((t=>{if(t){const{status:n,instanceStatus:a}=t;a===e.DataSourceStatus.NotCreated||a===e.DataSourceStatus.CreateError||n===e.DataSourceStatus.LoadError||n===e.DataSourceStatus.NotReady?h(!1):h(!0)}}),[h]),b=e.React.useCallback((()=>{f(!1)}),[f]),D=e.React.useCallback((()=>{h(!1)}),[h]);return(0,e.jsx)("div",null,i&&(0,e.jsx)(e.DataSourceComponent,{useDataSource:i.useDataSource,onDataSourceInfoChange:y,onCreateDataSourceFailed:b,onDataSourceCreated:p}),c&&(0,e.jsx)(e.DataSourceComponent,{useDataSource:c.useDataSource,onDataSourceInfoChange:g,onCreateDataSourceFailed:D,onDataSourceCreated:m}))}var ra=f(98640),ia=function(e,t,n,a){return new(n||(n=Promise))((function(o,s){function r(e){try{l(a.next(e))}catch(e){s(e)}}function i(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}l((a=a.apply(e,t||[])).next())}))};const la=f(62838);function ca(n){const a=e.hooks.useTranslation(o),{network:r,eventDS:i,eventLayer:l,clearPickedGraphic:c,eventFeatures:u,onEventRemoved:d,onPreservedEventIndexChanged:f,preservedEventIndex:v,flashGraphic:h}=n;e.React.useEffect((()=>{(0,t.isDefined)(r)&&c()}),[r]);const p={overrideItemBlockInfo:({itemBlockInfo:e},t)=>({name:ra.TreeItemActionType.RenderOverrideItem,children:[{name:ra.TreeItemActionType.RenderOverrideItemDroppableContainer,withListGroupItemWrapper:!1,children:[{name:ra.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:ra.TreeItemActionType.RenderOverrideItemBody,children:[{name:ra.TreeItemActionType.RenderOverrideItemMainLine,children:[{name:ra.TreeItemActionType.RenderOverrideItemDragHandle},{name:ra.TreeItemActionType.RenderOverrideItemTitle},{name:ra.TreeItemActionType.RenderOverrideItemDetailToggle},{name:ra.TreeItemActionType.RenderOverrideItemCommands}]}]}]}]}]})},m=e=>{var n;if((0,t.isDefined)(l)&&(0,t.isDefined)(i)){const a=i,o=null===(n=i.getSchema())||void 0===n?void 0:n.idField;(0,t.queryEventsByEventObjectIds)(a,[u[e].attributes[o]]).then((e=>{e.forEach((e=>ia(this,void 0,void 0,(function*(){const n=e.geometry;(0,t.isDefined)(n)&&(0,t.flash)(h,yield(0,t.getGeometryGraphic)(yield(0,t.getSimpleLineGraphic)(n),Yn))}))))}))}};return(0,e.jsx)("div",{className:"merge-events-list-form d-flex w-100 pt-1 px-3"},r&&(0,e.jsx)("div",{className:"w-100"},(0,e.jsx)(s.Label,{size:"sm",className:"w-100 mb-0 pt-3",style:{width:100,alignItems:"center",fontWeight:500}},a("eventListLabel")),(0,e.jsx)("div",{className:"setting-ui-unit-list w-100"},(0,e.jsx)(ra.List,Object.assign({className:"setting-ui-unit-list-exsiting",itemsJson:Array.from(u).map(((e,t)=>({itemStateDetailContent:e,itemKey:`${t}`,itemStateChecked:v===t,itemStateTitle:e.attributes[i.getSchema().idField],itemStateCommands:[{label:a("remove"),iconProps:()=>({icon:la,size:12}),action:({data:e})=>{d(t)}}]}))),renderOverrideItemDetailToggle:(t,n)=>n.props.itemJsons[0].itemStateChecked?(0,e.jsx)("div",{style:{fontWeight:500}},a("preserveLabel")):"",onClickItemBody:(e,t)=>{const{itemJsons:[n]}=t.props;f(+n.itemKey),m(+n.itemKey)}},p)))))}function ua(n){const a=e.hooks.useTranslation(o),{routeInfo:r,reset:i,onUpdateRouteInfo:l,currentSketchVM:c,isEventPickerActive:u,onUpdateIsEventPickerActive:d}=n,[f,v]=e.React.useState(!1),[h,p]=e.React.useState(!1),[m,y]=e.React.useState(!0);e.React.useEffect((()=>{i&&(v(!1),p(!1))}),[i]),e.React.useEffect((()=>{let e=!1;const n=Object.assign({},r);(0,t.isDefined)(r.selectedFromDate)&&f&&r.selectedFromDate!==r.fromDate&&(n.selectedFromDate=r.fromDate,e=!0),h&&r.selectedToDate!==r.toDate&&(n.selectedToDate=r.toDate,e=!0),e&&l(n)}),[l,r,f,h]);const g=()=>{c&&(m&&c.cancel(),c.create("rectangle"))};return(0,e.jsx)("div",{className:"merge-events-change-event-selection-form px-3 w-100 pt-3"},(0,e.jsx)(s.Button,{role:"button","aria-label":a("selectButtonLabel"),title:a("selectButtonLabel"),size:"sm",type:u?"primary":"secondary",className:"w-100 px-3",onClick:()=>{y(!0),g();d(!u)}},a("selectButtonLabel")))}var da=function(e,t,n,a){return new(n||(n=Promise))((function(o,s){function r(e){try{l(a.next(e))}catch(e){s(e)}}function i(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}l((a=a.apply(e,t||[])).next())}))};const fa=()=>e.css`
    display: flex;
    flex-direction: column;

    .merge-events-event-selection-form__content {
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
    flex: 1 1 auto;
    overflow: auto;
    }
    .merge-events-event-selection-form__actions {
    height: 100%;
    }
`;function va(n){const{widgetId:a,network:o,networkDS:s,eventDS:r,eventLayer:i,reset:l,jimuMapView:c,hoverGraphic:u,pickedGraphic:d,flashGraphic:f,currentSketchVM:v,eventFeatures:h,onEventRemoved:p,onPreservedEventIndexChanged:m,preservedEventIndex:y,isEventPickerActive:g,onUpdateIsEventPickerActive:b}=n,[D,I]=e.React.useState((0,t.getInitialRouteInfoState)());e.React.useEffect((()=>{(0,t.isDefined)(o)&&(I((0,t.getInitialRouteInfoState)()),S())}),[o]),e.React.useEffect((()=>{l&&(I((0,t.getInitialRouteInfoState)()),S())}),[l]);const S=()=>{(0,t.isDefined)(d)&&d.removeAll()},w=(e,n)=>da(this,void 0,void 0,(function*(){var a;(0,t.isDefined)(e.selectedPolyline)&&n&&(a=yield(0,t.getGeometryGraphic)(yield(0,t.getSimpleLineGraphic)(e.selectedPolyline),Yn),(0,t.isDefined)(a)&&(f.add(a),setTimeout((()=>{f.removeAll(),setTimeout((()=>{f.add(a),setTimeout((()=>{f.removeAll(),setTimeout((()=>{f.add(a),setTimeout((()=>{f.removeAll()}),800)}),800)}),800)}),800)}),800))),(0,t.isDefined)(e.selectedPoint)?(e=>{(0,t.isDefined)(e)?(d.removeAll(),d.add(e)):S()})(yield(0,t.getGeometryGraphic)(yield(0,t.getSimplePointGraphic)(e.selectedPoint),Kn)):S()}));return(0,e.jsx)("div",{className:"merge-events-event-selection-form__content d-flex",css:fa()},(0,e.jsx)("div",{className:"d-flex w-100"},(0,e.jsx)(ca,{widgetId:a,network:o,networkDS:s,eventDS:r,eventLayer:i,routeInfo:D,jimuMapView:c,hoverGraphic:u,reset:l,clearPickedGraphic:S,eventFeatures:h,onEventRemoved:p,onPreservedEventIndexChanged:m,preservedEventIndex:y,flashGraphic:f})),(0,e.jsx)("div",{className:"d-flex w-100"},(0,e.jsx)(ua,{routeInfo:D,reset:l,onUpdateRouteInfo:(e,t=!1)=>{I(e),w(e,t)},networkDS:s,jimuMapView:c,currentSketchVM:v,isEventPickerActive:g,onUpdateIsEventPickerActive:b})))}function ha(n){const a=e.hooks.useTranslation(o),{network:r,reset:i,clearPickedGraphic:l,eventLayer:c,eventFeatures:u,intl:d,resetForDataAction:f}=n,[v,h]=e.React.useState(a("chooseEventsFromMap")),[p,m]=e.React.useState(a("chooseEventsFromMap"));return e.React.useEffect((()=>{(0,t.isDefined)(c)&&(h(a("chooseEventsFromMap")),m(a("chooseEventsFromMap")),l())}),[c]),e.React.useEffect((()=>{if(l(),(0,t.isDefined)(u)&&0!==u.length){if((0,t.isDefined)(r)){const e=u[0].attributes[c.eventInfo.routeIdFieldName],t=u[u.length-1].attributes[c.eventInfo.routeIdFieldName];let n=Qn(u[0].attributes[c.eventInfo.fromMeasureFieldName],r.measurePrecision);const a=Qn(u[u.length-1].attributes[c.eventInfo.fromMeasureFieldName],r.measurePrecision);e===t&&a<n&&(n=a);const o=u[0].attributes[c.eventInfo.toRouteIdFieldName],s=u[u.length-1].attributes[c.eventInfo.toRouteIdFieldName],i=Qn(u[0].attributes[c.eventInfo.toMeasureFieldName],r.measurePrecision);let l=Qn(u[u.length-1].attributes[c.eventInfo.toMeasureFieldName],r.measurePrecision);o===s&&i>l&&(l=i),h(n.toString()),m(l.toString())}}else h(a("chooseEventsFromMap")),m(a("chooseEventsFromMap"))}),[u]),e.React.useEffect((()=>{i&&!f&&(h(a("chooseEventsFromMap")),m(a("chooseEventsFromMap")))}),[i]),(0,e.jsx)("div",{className:"route-and-measure-form d-flex w-100 pt-1 px-3"},r&&(0,e.jsx)("div",{className:"w-100"},(0,e.jsx)(s.Label,{size:"sm",className:"w-100 mb-0 pt-3",style:{width:100,alignItems:"center",fontWeight:500}},a("fromMeasureWithUnits",{units:(0,t.GetUnits)(r.unitsOfMeasure,d)})),(0,e.jsx)("div",{className:"d-flex w-100"},(0,e.jsx)(s.Label,{size:"sm",className:"w-100 mb-0",style:{width:100,alignItems:"center"}},v)),(0,e.jsx)(s.Label,{size:"sm",className:"w-100 mb-0 pt-3",style:{width:100,alignItems:"center",fontWeight:500}},a("toMeasureWithUnits",{units:(0,t.GetUnits)(r.unitsOfMeasure,d)})),(0,e.jsx)("div",{className:"d-flex w-100"},(0,e.jsx)(s.Label,{size:"sm",className:"w-100 mb-0",style:{width:100,alignItems:"center"}},p))))}var pa=f(99037);function ma(n){const a=e.hooks.useTranslation(o),{routeInfo:r,reset:i,onUpdateRouteInfo:l,eventLayer:c,intl:u}=n,[d,f]=e.React.useState(!1),[v,h]=e.React.useState(!1),[p,m]=e.React.useState("idle"),[y,g]=e.React.useState("idle"),[b,D]=e.React.useState(""),[I,S]=e.React.useState(""),[w,j]=e.React.useState(!0);e.React.useEffect((()=>{i&&(f(!1),h(!1),m("idle"),g("idle"),D(""),S(""),j(!1))}),[i]),e.React.useEffect((()=>{let e=!1;const n=Object.assign({},r);"idle"===p&&D(""),"idle"===y&&S(""),(0,t.isDefined)(r.selectedFromDate)&&d&&r.selectedFromDate!==r.fromDate&&(n.selectedFromDate=r.fromDate,e=!0),v&&r.selectedToDate!==r.toDate&&(n.selectedToDate=r.toDate,e=!0),e&&l(n)}),[l,r,d,v]),e.React.useEffect((()=>{j(!(null==c?void 0:c.eventInfo.canSpanRoutes))}),[c]);const k=(e,n)=>{const o=e;if(!(0,t.isDefined)(o))return n?m("idle"):g("idle"),n?D(""):S(""),!0;let s=!0;return(0,t.isDefined)(r.fromDate)&&o<r.fromDate?(n?m("invalid"):g("invalid"),n?D(a("invalidFromDateBefore")):S(a("invalidToDateBefore")),s=!1,!1):(0,t.isDefined)(r.toDate)&&o>r.toDate?(n?m("invalid"):g("invalid"),n?D(a("invalidFromDateAfter")):S(a("invalidToDateAfter")),s=!1,!1):((0,t.isDefined)(r.selectedToDate)&&n&&(o>r.selectedToDate&&(m("invalid"),n?D(a("invalidDatesOrder")):S(a("invalidDatesOrder")),s=!1),I===a("invalidDatesOrder")?o<r.selectedToDate&&(g("idle"),S("")):I===a("invalidDatesSameDay")&&o!==r.selectedFromDate&&(g("idle"),S(""))),(0,t.isDefined)(r.selectedToDate)&&n&&o.getTime()===r.selectedToDate.getTime()&&(m("invalid"),n?D(a("invalidDatesSameDay")):S(a("invalidDatesSameDay")),s=!1),(0,t.isDefined)(r.selectedFromDate)&&(n||(o<r.selectedFromDate&&(g("invalid"),n?D(a("invalidDatesOrder")):S(a("invalidDatesOrder")),s=!1),b===a("invalidDatesOrder")?o>r.selectedFromDate&&(m("idle"),D("")):b===a("invalidDatesSameDay")&&o!==r.selectedFromDate&&(m("idle"),D("")))),(0,t.isDefined)(r.selectedFromDate)&&(n||o.getTime()!==r.selectedFromDate.getTime()||(g("invalid"),n?D(a("invalidDatesSameDay")):S(a("invalidDatesSameDay")),s=!1)),s&&(n?m("idle"):g("idle"),n?D(""):S("")),!0)};return(0,e.jsx)("div",{className:"merge-events-date-form px-3 w-100",css:(0,t.getCalciteBasicTheme)()},(0,e.jsx)(s.Label,{size:"sm",className:"mb-0 pt-3",style:{width:100,alignItems:"center",fontWeight:500}},(0,t.formatMessage)(u,"startDateRequiredLabel")),(0,e.jsx)(s.Tooltip,{title:b},(0,e.jsx)(pa.CalciteInputDatePicker,{scale:"s",disabled:!!d||void 0,valueAsDate:r.selectedFromDate,onCalciteInputDatePickerChange:e=>{var t;if(e){const n=null===(t=e.target)||void 0===t?void 0:t.valueAsDate;if(k(n,!0),n){const e=Object.assign(Object.assign({},r),{selectedFromDate:n});l(e)}else{const e=Object.assign(Object.assign({},r),{selectedFromDate:null});l(e)}}},status:p,placement:"top",overlayPositioning:"fixed"})),(0,e.jsx)(s.Label,{size:"sm",className:"w-100 pt-2",centric:!0,check:!0},(0,e.jsx)(s.Checkbox,{checked:d,className:"mr-2",disabled:!w,onChange:(e,t)=>{k(r.fromDate,!0),f(t)}}),a("useStartDateLabel")),(0,e.jsx)(s.Label,{size:"sm",className:"mb-0 pt-1",style:{width:100,alignItems:"center",fontWeight:500}},a("endDateLabel")),(0,e.jsx)(s.Tooltip,{title:I},(0,e.jsx)(pa.CalciteInputDatePicker,{scale:"s",disabled:!!v||void 0,valueAsDate:r.selectedToDate,onCalciteInputDatePickerChange:e=>{var t;if(e){const n=null===(t=e.target)||void 0===t?void 0:t.valueAsDate;if(k(n,!1),n){const e=Object.assign(Object.assign({},r),{selectedToDate:n});l(e)}else{const e=Object.assign(Object.assign({},r),{selectedToDate:null});l(e)}}},status:y,placement:"top",overlayPositioning:"fixed"})),(0,e.jsx)(s.Label,{size:"sm",className:"w-100 pt-2",centric:!0,check:!0},(0,e.jsx)(s.Checkbox,{checked:v,className:"mr-2",disabled:!w,onChange:(e,t)=>{k(r.toDate,!1),h(t)}}),a("useEndDateLabel")))}var ya=function(e,t,n,a){return new(n||(n=Promise))((function(o,s){function r(e){try{l(a.next(e))}catch(e){s(e)}}function i(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}l((a=a.apply(e,t||[])).next())}))};const ga=()=>e.css`
    display: flex;
    flex-direction: column;

    .merge-events-route-selection-form__content {
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
      flex: 1 1 auto;
      overflow: auto;
    }
    .merge-events-route-selection-form__actions {
      height: 100%;
    }
  `;function ba(n){const{widgetId:a,network:o,networkDS:s,reset:r,jimuMapView:i,hoverGraphic:l,pickedGraphic:c,flashGraphic:u,eventLayer:d,eventFeatures:f,routeInfo:v,onUpdateRouteInfo:h,intl:p,resetForDataAction:m}=n;e.React.useEffect((()=>{(0,t.isDefined)(o)&&y()}),[o]),e.React.useEffect((()=>{r&&y()}),[r]);const y=()=>{(0,t.isDefined)(c)&&c.removeAll()},g=(e,n)=>ya(this,void 0,void 0,(function*(){var a;(0,t.isDefined)(e.selectedPolyline)&&n&&(0,t.flash)(u,yield(0,t.getGeometryGraphic)(yield(0,t.getSimpleLineGraphic)(e.selectedPolyline),Yn)),(0,t.isDefined)(e.selectedPoint)?(a=yield(0,t.getGeometryGraphic)(yield(0,t.getSimplePointGraphic)(e.selectedPoint),Kn),(0,t.isDefined)(a)?(c.removeAll(),c.add(a)):y()):y()})),b=(e,t=!1)=>{h(e),g(e,t)};return(0,e.jsx)("div",{className:"merge-events-route-selection-form__content d-flex",css:ga()},(0,e.jsx)("div",{className:"d-flex w-100"},(0,e.jsx)(ha,{widgetId:a,network:o,networkDS:s,routeInfo:v,jimuMapView:i,hoverGraphic:l,reset:r,clearPickedGraphic:y,onRouteInfoUpdated:b,eventLayer:d,eventFeatures:f,intl:p,resetForDataAction:m})),(0,e.jsx)("div",{className:"d-flex w-100"},(0,e.jsx)(ma,{routeInfo:v,reset:r,eventLayer:d,onUpdateRouteInfo:b,intl:p})))}function Da(n){var a;const{widgetId:r,lrsLayers:i,hideTitle:l,eventLayers:u,defaultEvent:d,JimuMapView:f,hoverGraphic:v,pickedGraphic:h,flashGraphic:p,conflictPreventionEnabled:m,onClearGraphic:y,displayConfig:g,currentSketchVM:b,onUpdateSelectedEventLayer:D,onUpdateSelectedNetworkLayer:I,eventFeatures:S,onEventRemoved:w,preservedEventIndex:j,onPreservedEventIndexChanged:k,onUpdateEventFeatures:L,routeInfo:T,onUpdateRouteInfo:x,eventDS:R,eventLayer:F,onUpdateEventDS:M,networkDS:N,onUpdateNetworkDS:E,intl:A,isEventPickerActive:O,onUpdateIsEventPickerActive:_,onUpdateToastMsgType:C,onUpdateToastMsg:U,onUpdateToastOpen:P,onUpdateStopQuery:G,toastMsgType:V,toastMsg:B,toastOpen:q,resetForDataAction:W,onUpdateResetForDataAction:z}=n,[H,J]=e.React.useState(null),[Q,Z]=e.React.useState(!1),[$,Y]=e.React.useState(!1),[K,X]=e.React.useState((0,t.getIntialLocksInfo)()),[ee,te]=e.React.useState(!m),[ne,ae]=e.React.useState(!0),oe=e.React.useRef(null),se=e.hooks.useTranslation(o);e.React.useEffect((()=>{(0,t.isDefined)(H)&&x((0,t.getInitialRouteInfoState)())}),[H]),e.React.useEffect((()=>{$&&(x((0,t.getInitialRouteInfoState)()),W?S.length>0&&k(0):L([]))}),[$]);const re=e.React.useCallback((()=>{Z(!0)}),[Z]);e.React.useEffect((()=>{if(F){const n=i.find((e=>(0,t.isDefined)(e.networkInfo)&&e.networkInfo.lrsNetworkId===F.eventInfo.parentNetworkId));n&&n.layerType===t.LrsLayerType.network&&(J((0,e.Immutable)(n)),I((0,e.Immutable)(n)))}else{const t=i.find((e=>e.name===d.name));D((0,e.Immutable)(t))}}),[d,i,F,D,I]),e.React.useEffect((()=>{ie(t.LockAction.QueryAndAcquire,T)}),[T]),e.React.useEffect((()=>{ie(t.LockAction.None)}),[N,F,H]);const ie=e.React.useCallback(((e=t.LockAction.None,n)=>{if(m){const a=Object.assign({},K);(0,t.isDefined)(H)&&(a.networkId=[H.networkInfo.lrsNetworkId]),(0,t.isDefined)(F)&&(a.eventServiceLayerIds=[F.serviceId]),(0,t.isDefined)(n)&&(a.routeInfo=n),a.lockAction=e,X(a)}}),[m,F,K,H]),le=e.React.useCallback((n=>{const a=i.find((e=>e.name===n));if(a){const n=i.find((e=>(0,t.isDefined)(e.networkInfo)&&e.networkInfo.lrsNetworkId===a.eventInfo.parentNetworkId));n&&n.layerType===t.LrsLayerType.network&&(J((0,e.Immutable)(n)),I((0,e.Immutable)(n))),D((0,e.Immutable)(a))}}),[i,D,I]),ce=e.React.useCallback((e=>{x(e)}),[x]),ue=e.React.useCallback((()=>{x((0,t.getInitialRouteInfoState)()),ie(t.LockAction.Clear,(0,t.getInitialRouteInfoState)()),Y(!0),setTimeout((()=>{Y(!1)}),800)}),[ie,x]),de=e.React.useCallback((()=>{ue(),f.clearSelectedFeatures()}),[f,ue]);e.React.useEffect((()=>{W&&(k(-1),ue(),setTimeout((()=>{z(!1)}),100))}),[W,ue,z,k]);const fe=e.React.useMemo((()=>!!(Q&&(0,t.isDefined)(f)&&(0,t.isDefined)(null==f?void 0:f.view))),[f,Q]),ve=e.React.useCallback((()=>{y(),ue()}),[]),he=e.React.useCallback(((e,t,n)=>{te(!!n),X(e)}),[]),pe=e.React.useCallback((e=>{ae(e)}),[]);return(0,e.jsx)("div",{className:"merge-events h-100 d-flex",css:e.css`
    flex: 1 1 auto;
    display: flex;
    flex-direction: column;

    &.wrapped .merge-events-form {
      height: 100%;
    }

    .merge-events__content {
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
      flex: 1 1 auto;
      overflow: auto;
    }
    .merge-events__toast-container {
      position: absolute;
      background-color: rgba(255, 255, 255, 0.7);
      height: 100%;
    }
    .merge-events__toast {
      position: relative;
      top: 4%;
    }
    .merge-events-footer {
      display: flex;
      height: auto;
      padding: 12px;
    }
  `},!l&&(0,e.jsx)(c,null),(0,e.jsx)("div",{className:"merge-events__content"},(0,e.jsx)(sa,{network:H,event:F,dataSourcesReady:re,onCreateNetworkDs:E,onCreateEventDs:M}),m&&(0,e.jsx)(t.LockManagerComponent,{intl:A,featureDS:N,showAlert:!0,lockInfo:K,networkName:null===(a=null==H?void 0:H.networkInfo)||void 0===a?void 0:a.datasetName,conflictPreventionEnabled:m,onQueryAndAcquireComplete:he,onMessageClear:()=>{ie(t.LockAction.None)}}),!g.hideEvent&&(0,e.jsx)("div",null,(0,e.jsx)(s.Label,{size:"sm",className:"mb-0 pt-3 px-3 w-100",style:{fontWeight:500}},(0,t.formatMessage)(A,"eventRequiredLabel")),(0,e.jsx)(s.Select,{"aria-label":(0,t.formatMessage)(A,"eventRequiredLabel"),className:"w-100 px-3",size:"sm",value:F?F.name:"",disabled:1===u.length,onChange:e=>{le(e.target.value)}},u.map(((t,n)=>(0,e.jsx)("options",{key:n,value:t},t))))),(0,e.jsx)(va,{widgetId:r,network:H?H.networkInfo:null,isReady:fe&&(null==f?void 0:f.view.ready),networkDS:N,eventDS:R,eventLayer:F,reset:$,jimuMapView:f,hoverGraphic:v,pickedGraphic:h,flashGraphic:p,onsubmit:ce,onReset:ue,currentSketchVM:b,eventFeatures:S,onEventRemoved:w,onPreservedEventIndexChanged:k,preservedEventIndex:j,isEventPickerActive:O,onUpdateIsEventPickerActive:_}),(0,e.jsx)(ba,{widgetId:r,network:H?H.networkInfo:null,isReady:fe&&(null==f?void 0:f.view.ready),networkDS:N,reset:$,jimuMapView:f,hoverGraphic:v,pickedGraphic:h,flashGraphic:p,onsubmit:ce,onReset:ue,eventLayer:F,eventFeatures:S,routeInfo:T,onUpdateRouteInfo:x,intl:A,resetForDataAction:W}),(0,e.jsx)(oa,{ref:oe,widgetId:r,network:H,jimuMapView:f,eventDS:R,networkDS:N,eventLayer:F,networkLayer:H,routeInfo:T,reset:$,eventFeatures:S,preservedEventIndex:j,flashGraphic:p,onSubmit:ve,onUpdateToastMsgType:C,onUpdateToastMsg:U,onUpdateToastOpen:P,onUpdateStopQuery:G,onValidationChanged:pe,intl:A,lockAquired:ee,conflictPreventionEnabled:m,toastMsgType:V})),(0,e.jsx)("div",{className:"merge-events-footer w-100"},(0,e.jsx)("div",{className:"merge-events-edit-attributes__action w-100 d-flex"},(0,e.jsx)(s.Label,{size:"sm",className:" mt-auto mr-auto",style:{fontWeight:500,marginBottom:0,alignItems:"center",textAlign:"left",color:"var(--primary-500)"},onClick:de},"Reset"),(0,e.jsx)(s.Tooltip,{title:se("mergeLabel")},(0,e.jsx)("div",{className:"mt-auto ml-auto"},(0,e.jsx)(s.Button,{className:"active","aria-label":se("mergeLabel"),size:"sm",disabled:!ne,onClick:()=>{var e;null===(e=oe.current)||void 0===e||e.onSubmitClicked()}},se("mergeLabel")))))),q&&(0,e.jsx)("div",{className:"merge-events__toast-container px-3 w-100"},(0,e.jsx)(s.Alert,{className:"merge-events__toast w-100",type:V,text:B,closable:!0,withIcon:!0,open:q,onClose:()=>{P(!1)}})))}var Ia=f(59620),Sa=f(10624),wa=f(22089),ja=function(e,t,n,a){return new(n||(n=Promise))((function(o,s){function r(e){try{l(a.next(e))}catch(e){s(e)}}function i(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}l((a=a.apply(e,t||[])).next())}))};const ka=e.css`
  background-color: var(--ref-palette-white);
`;class La extends e.React.PureComponent{constructor(n){super(n),this.componentDidMount=()=>{var e;(null===(e=this.props.mutableStatePropsVersion)||void 0===e?void 0:e.selectedEventLyr)&&this.setState({selectedEventLayer:this.props.selectedEventLyr,resetForDataAction:!0});const n=(0,t.isInWidgetController)(this.widgetOuterDivId);this.setState({hideTitle:n})},this.selectFeaturesByGraphic=(e,t,n,...a)=>ja(this,[e,t,n,...a],void 0,(function*(e,t,n,a=!1){return(0,l.loadArcGISJSAPIModules)(["esri/geometry/geometryEngine"]).then((o=>ja(this,void 0,void 0,(function*(){const s=o[0];let r=e.geometry;if("point"===r.type||"polyline"===r.type){const e=2.54*this.state.jimuMapView.view.scale/9600;r=s.buffer(r,10*e,"meters")}const i={geometry:r,spatialRelationship:t,returnGeometry:!0,returnZ:!0};a&&(i.outFields=["*"]);const c=this.state.jimuMapView.jimuLayerViews,u=Object.keys(c),d=[];for(let e=0;e<u.length;e++){const t=c[u[e]];if((t.type===l.LayerTypes.FeatureLayer||t.type===l.LayerTypes.SceneLayer)&&t.layer.title===this.state.selectedEventLayer.name&&t.selectFeaturesByQuery){const e=t.selectFeaturesByQuery(i,n);d.push(e)}}return this.state.jimuMapView.onSelectByQueryProgressChange(),Promise.all(d)}))))})),this.onUpdateStopQuery=e=>{this.setState({stopQuery:e})},this.onJimuLayerViewSelectedFeaturesChange=e=>{this.state.stopQuery||e.layer.title===this.state.selectedEventLayer.name&&setTimeout((()=>{this.querySelectedFeatures(this.state.jimuMapView)}),100)},this.onActiveViewChange=e=>ja(this,void 0,void 0,(function*(){e&&e.view&&this.waitForChildDataSourcesReady(e).finally((()=>{this.state.jimuMapView&&this.state.jimuMapView.removeJimuLayerViewSelectedFeaturesChangeListener(this.onJimuLayerViewSelectedFeaturesChange),this.setState({jimuMapView:e}),e&&e.addJimuLayerViewSelectedFeaturesChangeListener(this.onJimuLayerViewSelectedFeaturesChange),setTimeout((()=>{this.querySelectedFeatures(e)}),100)}))})),this.waitForChildDataSourcesReady=t=>ja(this,void 0,void 0,(function*(){yield null==t?void 0:t.whenAllJimuLayerViewLoaded();const n=e.DataSourceManager.getInstance().getDataSource(null==t?void 0:t.dataSourceId);return(null==n?void 0:n.isDataSourceSet())&&!n.areChildDataSourcesCreated()?n.childDataSourcesReady().then((()=>n)).catch((e=>n)):Promise.resolve(n)})),this.getI18nMessage=(e,t)=>{const n=Object.assign({},o,s.defaultMessages);return this.props.intl.formatMessage({id:e,defaultMessage:n[e]},t)},this.handleSelectedEventLayerUpdate=e=>{this.setState({selectedEventLayer:e})},this.handleSelectedNetworkLayerUpdate=e=>{this.setState({selectedNetworkLayer:e})},this.removeEvent=e=>ja(this,void 0,void 0,(function*(){var t;this.state.flashGraphic.removeAll();const n=[],a=[],o=null===(t=this.state.eventDS.getSchema())||void 0===t?void 0:t.idField;this.state.eventFeatures.forEach(((t,s)=>{s!==e&&(n.push(t),a.push(t.attributes[o]))})),this.setState({preservedEventIndex:-1,routeInfo:this.getInitialRouteInfoState()});const s=this.state.jimuMapView.jimuLayerViews,r=Object.keys(s);for(let e=0;e<r.length;e++){const t=s[r[e]];if(t.layer.title===this.state.selectedEventLayer.name){const e=a.map((e=>Number(e)));if(e.length>0){if(this.state.eventDS){const n=(yield this.state.eventDS.query({objectIds:e.slice().map((e=>e+"")),returnGeometry:!0,returnZ:!0})).records;n&&n.length>0&&t.selectFeaturesByIds(e,n)}}else t.selectFeaturesByIds([])}}})),this.onUpdateEventFeatures=e=>{this.setState({eventFeatures:e})},this.onPreservedEventIndexChanged=e=>{this.setState({preservedEventIndex:e})},this.onUpdateRouteInfo=e=>{this.setState({routeInfo:e})},this.queryEvents=e=>{const n=this.state.eventDS;(0,t.queryEventsByEventObjectIds)(n,e).then((e=>ja(this,void 0,void 0,(function*(){if(this.state.flashGraphic.removeAll(),yield a(!0,e,this.getI18nMessage,this.state.selectedEventLayer,this.state.selectedNetworkLayer,this.state.networkDS,this.state.toastMsgType,this.onUpdateToastMsgType,this.onUpdateToastMsg,this.onUpdateToastOpen),e.length>0){this.setState({preservedEventIndex:0,eventFeatures:e});const n=e[0].attributes[this.state.selectedEventLayer.eventInfo.routeIdFieldName];(0,t.queryRouteId)(n.trim(),this.state.selectedNetworkLayer.networkInfo,this.state.networkDS).then((e=>{(0,t.isDefined)(e)&&e.features.map((e=>ja(this,void 0,void 0,(function*(){const n=e.attributes[this.state.selectedNetworkLayer.networkInfo.routeIdFieldSchema.name],a=e.attributes[this.state.selectedNetworkLayer.networkInfo.fromDateFieldSchema.name],o=e.attributes[this.state.selectedNetworkLayer.networkInfo.toDateFieldSchema.name],s=this.state.selectedNetworkLayer.networkInfo.useRouteName?e.attributes[this.state.selectedNetworkLayer.networkInfo.routeNameFieldSchema.name]:"",r=this.state.selectedNetworkLayer.networkInfo.supportsLines?e.attributes[this.state.selectedNetworkLayer.networkInfo.lineIdFieldSchema.name]:"",i=this.state.selectedNetworkLayer.networkInfo.supportsLines?e.attributes[this.state.selectedNetworkLayer.networkInfo.lineNameFieldSchema.name]:"";let l=new Date(Date.now());(0,t.isDefined)(o)&&l>o?l=(0,t.getDateWithTZOffset)(a,this.state.networkDS):l.setHours(0,0,0,0);let c=new Date(Date.now());(0,t.isDefined)(o)&&c>o?c=(0,t.getDateWithTZOffset)(o,this.state.networkDS):c.setHours(0,0,0,0),(0,t.isDefined)(o)||(c=null);const u={routeId:n,fromDate:(0,t.isDefined)(a)?(0,t.getDateWithTZOffset)(a,this.state.networkDS):null,toDate:(0,t.isDefined)(o)?(0,t.getDateWithTZOffset)(o,this.state.networkDS):null,selectedFromDate:l,selectedToDate:c,routeName:s,fromMeasure:NaN,toMeasure:NaN,selectedMeasure:NaN,lineId:r,lineName:i};this.setState({routeInfo:u})}))))}))}else this.setState({eventFeatures:[]})}))))},this.querySelectedFeatures=e=>ja(this,void 0,void 0,(function*(){var t;if(null==e?void 0:e.view){this.setState({preservedEventIndex:-1,routeInfo:this.getInitialRouteInfoState()});const n=yield this.getSelectedGraphics(e);if(n.length>0){const e=[],a=null===(t=this.state.eventDS.getSchema())||void 0===t?void 0:t.idField;n.forEach((t=>{var n,o;"polyline"===(null===(n=t.geometry)||void 0===n?void 0:n.type)&&(null===(o=t.layer)||void 0===o?void 0:o.layerId)===this.state.selectedEventLayer.serviceId&&e.push(t.attributes[a])})),this.queryEvents(e)}else"error"===this.state.toastMsgType&&this.onUpdateToastOpen(!1),this.setState({eventFeatures:[]})}})),this.onUpdateEventDS=e=>{this.setState({eventDS:e,preservedEventIndex:-1,eventFeatures:[],routeInfo:this.getInitialRouteInfoState()}),this.querySelectedFeatures(this.state.jimuMapView)},this.onUpdateNetworkDS=e=>{this.setState({networkDS:e})},this.onUpdateIsEventPickerActive=e=>{e||this.state.currentSketchVM.cancel(),this.setState({isEventPickerActive:e})},this.onUpdateToastMsgType=e=>{this.setState({toastMsgType:e})},this.onUpdateToastMsg=e=>{this.setState({toastMsg:e})},this.onUpdateToastOpen=e=>{this.setState({toastOpen:e})},this.onUpdateResetForDataAction=e=>{this.setState({resetForDataAction:e})},this.state={hideTitle:!1,jimuMapView:void 0,hoverGraphic:null,pickedGraphic:null,flashGraphic:null,initialStage:!0,resultStage:!1,selectModeActive:!0,addToSelectionTool:!1,drawModeActive:!1,onDrawingComplete:!1,currentSketchVM:null,noFeaturesError:!1,noGraphicAfterFirstSelection:!1,onWidgetLoadShowLoadingIndicator:!0,loadingIndicator:!1,nextPossibleloadingIndicator:!1,selectedFeatureRecord:null,selectedEventLayer:null,selectedNetworkLayer:null,eventFeatures:[],preservedEventIndex:-1,routeInfo:this.getInitialRouteInfoState(),eventDS:null,networkDS:null,isEventPickerActive:!1,featuresByLayer:null,toastOpen:!1,toastMsgType:"info",toastMsg:"",stopQuery:!1,resetForDataAction:!1},this.widgetOuterDivId="widget-outer-div-"+this.props.id}getInitialRouteInfoState(){return{routeId:"",routeName:"",fromMeasure:NaN,toMeasure:NaN,fromDate:null,toDate:null,selectedMeasure:NaN,selectedFromDate:new Date(Date.now()),selectedToDate:null}}componentWillUnmount(){this.removeGraphicLayers()}componentDidUpdate(n,a){var o,s,r,i,l,c;a.jimuMapView!==this.state.jimuMapView&&(0,t.isDefined)(this.state.jimuMapView)&&(this.removeGraphicLayers(),this.createGraphicLayers(),this.createApiWidget(this.state.jimuMapView));const u=null===(r=null===(s=null===(o=(0,e.getAppStore)())||void 0===o?void 0:o.getState())||void 0===s?void 0:s.widgetsRuntimeInfo[this.props.id])||void 0===r?void 0:r.state;u!==e.WidgetState.Opened&&u||(null===(i=this.props)||void 0===i?void 0:i.selectedEventLyr)&&(n&&n.mutableStatePropsVersion&&n.mutableStatePropsVersion.selectedEventLyr&&(null===(l=null==n?void 0:n.mutableStatePropsVersion)||void 0===l?void 0:l.selectedEventLyr)===(null===(c=this.props.mutableStatePropsVersion)||void 0===c?void 0:c.selectedEventLyr)||this.setState({selectedEventLayer:this.props.selectedEventLyr,resetForDataAction:!0}))}removeGraphicLayers(){(0,t.isDefined)(this.state.hoverGraphic)&&(this.state.hoverGraphic.removeAll(),this.state.hoverGraphic.destroy(),this.setState({hoverGraphic:null})),(0,t.isDefined)(this.state.pickedGraphic)&&(this.state.pickedGraphic.removeAll(),this.state.pickedGraphic.destroy(),this.setState({pickedGraphic:null})),(0,t.isDefined)(this.state.flashGraphic)&&(this.state.flashGraphic.removeAll(),this.state.flashGraphic.destroy(),this.setState({flashGraphic:null}))}createGraphicLayers(){var e,n;if((0,t.isDefined)(this.state.jimuMapView)){this.removeGraphicLayers();const t=new Ia.default({listMode:"hide"}),a=new Ia.default({listMode:"hide"}),o=new Ia.default({listMode:"hide"});null===(n=null===(e=this.state.jimuMapView)||void 0===e?void 0:e.view)||void 0===n||n.map.addMany([a,o,t]),this.setState({hoverGraphic:t}),this.setState({pickedGraphic:a}),this.setState({flashGraphic:o})}}clearGraphics(){(0,t.isDefined)(this.state.hoverGraphic)&&this.state.hoverGraphic.removeAll(),(0,t.isDefined)(this.state.pickedGraphic)&&this.state.pickedGraphic.removeAll(),(0,t.isDefined)(this.state.flashGraphic)&&this.state.flashGraphic.removeAll()}queryForNewSelection(e,t){this.setState({featuresByLayer:e});let n=null;e.length>0&&e.forEach((e=>{var t,a,o,s,r;if(e.length>0&&"polyline"===(null===(t=e[0].geometry)||void 0===t?void 0:t.type)&&e[0].layer.layerId===this.state.selectedEventLayer.serviceId){this.setState({isEventPickerActive:!1});const t=null===(a=this.state.eventDS.getSchema())||void 0===a?void 0:a.idField,i=[];return e.forEach((e=>{i.push(e.attributes[t])})),this.queryEvents(i),n=new wa.default({geometry:null===(o=e[0])||void 0===o?void 0:o.geometry,attributes:(null===(s=e[0])||void 0===s?void 0:s.attributes)?null===(r=e[0])||void 0===r?void 0:r.attributes:{}}),!0}})),n||this.state.selectModeActive&&this.state.currentSketchVM.create("rectangle")}createApiWidget(t){var n;const a=new Sa.default({view:t?t.view:null,layer:new Ia.default,updateOnGraphicClick:!1,defaultCreateOptions:{mode:"hybrid",hasZ:"3d"===(null===(n=null==t?void 0:t.view)||void 0===n?void 0:n.type)},polylineSymbol:{type:"simple-line",width:5},defaultUpdateOptions:{toggleToolOnClick:!1}});a.on("create",(t=>{if("start"===t.state){const e={type:"simple-line",width:5};this.state.currentSketchVM.set("polylineSymbol",e)}else"complete"===t.state&&(this.setState({noFeaturesError:!1}),this.state.selectModeActive&&(this.setState({loadingIndicator:!0}),this.selectFeaturesByGraphic(t.graphic,"intersects",e.DataSourceSelectionMode.New).then((e=>{this.queryForNewSelection(e,!0)}),(e=>{}))))})),this.setState({currentSketchVM:a})}getSelectedGraphics(e){return ja(this,void 0,void 0,(function*(){let t=[];return e&&(t=yield e.getSelectedFeatures()),t}))}render(){var t;const{config:n,id:a}=this.props,{lrsLayers:o,networkLayers:r,eventLayers:c,intersectionLayers:u,defaultEvent:d,displayConfig:f,conflictPreventionEnabled:v}=n,{jimuMapView:h}=this.state;return(null==r?void 0:r.length)&&(null==c?void 0:c.length)?(0,e.jsx)("div",{id:this.widgetOuterDivId,className:"jimu-widget runtime-merge-events surface-1 border-0",css:ka},(0,e.jsx)(l.JimuMapViewComponent,{useMapWidgetId:null===(t=this.props.useMapWidgetIds)||void 0===t?void 0:t[0],onActiveViewChange:this.onActiveViewChange}),(0,e.jsx)(Da,{widgetId:a,intl:this.props.intl,hideTitle:this.state.hideTitle,lrsLayers:o,JimuMapView:h,eventLayers:c,networkLayers:r,instersectionLayers:u,defaultEvent:d,hoverGraphic:this.state.hoverGraphic,pickedGraphic:this.state.pickedGraphic,flashGraphic:this.state.flashGraphic,conflictPreventionEnabled:v,onClearGraphic:this.clearGraphics.bind(this),displayConfig:f,currentSketchVM:this.state.currentSketchVM,onUpdateSelectedEventLayer:this.handleSelectedEventLayerUpdate,onUpdateSelectedNetworkLayer:this.handleSelectedNetworkLayerUpdate,eventFeatures:this.state.eventFeatures,preservedEventIndex:this.state.preservedEventIndex,onEventRemoved:this.removeEvent,onPreservedEventIndexChanged:this.onPreservedEventIndexChanged,onUpdateEventFeatures:this.onUpdateEventFeatures,routeInfo:this.state.routeInfo,onUpdateRouteInfo:this.onUpdateRouteInfo,eventDS:this.state.eventDS,eventLayer:this.state.selectedEventLayer,networkDS:this.state.networkDS,onUpdateEventDS:this.onUpdateEventDS,onUpdateNetworkDS:this.onUpdateNetworkDS,isEventPickerActive:this.state.isEventPickerActive,onUpdateIsEventPickerActive:this.onUpdateIsEventPickerActive,onUpdateToastMsgType:this.onUpdateToastMsgType,onUpdateToastMsg:this.onUpdateToastMsg,onUpdateToastOpen:this.onUpdateToastOpen,toastMsgType:this.state.toastMsgType,toastMsg:this.state.toastMsg,toastOpen:this.state.toastOpen,onUpdateStopQuery:this.onUpdateStopQuery,resetForDataAction:this.state.resetForDataAction,onUpdateResetForDataAction:this.onUpdateResetForDataAction})):(0,e.jsx)(s.WidgetPlaceholder,{icon:i(),widgetId:a,message:this.getI18nMessage("_widgetLabel")})}}La.mapExtraStateProps=(e,t)=>{var n;return{selectedEventLyr:null===(n=null==t?void 0:t.mutableStateProps)||void 0===n?void 0:n.selectedEventLyr}};const Ta=La;function xa(e){f.p=e}})(),v})())}}}));