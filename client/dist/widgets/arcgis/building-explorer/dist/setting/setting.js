System.register(["jimu-core","jimu-arcgis","jimu-theme","jimu-ui","jimu-ui/advanced/setting-components","esri/core/Collection"],(function(e,l){var t={},n={},a={},i={},o={},s={};return{setters:[function(e){t.Immutable=e.Immutable,t.React=e.React,t.classNames=e.classNames,t.css=e.css,t.hooks=e.hooks,t.jsx=e.jsx,t.polished=e.polished},function(e){n.JimuMapViewComponent=e.JimuMapViewComponent,n.MapViewManager=e.MapViewManager},function(e){a.useTheme=e.useTheme},function(e){i.Alert=e.Alert,i.MultiRangeSlider=e.MultiRangeSlider,i.Option=e.Option,i.Select=e.Select,i.Switch=e.Switch,i.defaultMessages=e.defaultMessages},function(e){o.MapWidgetSelector=e.MapWidgetSelector,o.MultipleJimuMapConfig=e.MultipleJimuMapConfig,o.SettingRow=e.SettingRow,o.SettingSection=e.SettingSection},function(){}],execute:function(){e((()=>{var e={31027:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5m-9 0a3.5 3.5 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5M15.5 11l-5 1-3 4-1-9.5zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38z" clip-rule="evenodd"></path></svg>'},23321:e=>{"use strict";e.exports=s},62686:e=>{"use strict";e.exports=n},79244:e=>{"use strict";e.exports=t},1888:e=>{"use strict";e.exports=a},14321:e=>{"use strict";e.exports=i},79298:e=>{"use strict";e.exports=o}},l={};function u(t){var n=l[t];if(void 0!==n)return n.exports;var a=l[t]={exports:{}};return e[t](a,a.exports,u),a.exports}u.n=e=>{var l=e&&e.__esModule?()=>e.default:()=>e;return u.d(l,{a:l}),l},u.d=(e,l)=>{for(var t in l)u.o(l,t)&&!u.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:l[t]})},u.o=(e,l)=>Object.prototype.hasOwnProperty.call(e,l),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var d={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(d),u.d(d,{__set_webpack_public_path__:()=>j,default:()=>w});var e=u(79244),l=u(62686),t=u(1888),n=u(14321),a=u(79298);const i={ds:"Data source",mapSettings:"Map settings",mapSettingsTip:"Click a map below to customize the building explorer settings.",noMapTips:"The Map widget does not contain a web scene. Please select another map for configurations.",mapNotSupportedTips:"Web maps are not supported.",noBuildingLayerTips:"The web scene does not contain any building scene layers.",generalSetting:"General settings",zoomToLayer:"Zoom to layer on selection",applyFilterOnDs:"Apply filter to data sources",layerMode:"Layer selection mode",level:"Level",levelRange:"Level range",defaultLevel:"Default level",buildingPhase:"Building phase",buildingPhaseTips:"Building Phase tool is not applicable on the selected data.",phaseRange:"Phase range",defaultPhase:"Default phase",noPhaseTips:"Building Phase tool is not applicable on the selected data.",disciplinesCategories:"Disciplines & Categories",layerOnLoading:"Building Layer on loading"};var o;u(23321);function s(e,t){const n=l.MapViewManager.getInstance().getJimuMapViewGroup(e[0]),a=null==n?void 0:n.jimuMapViews,i=a&&Object.keys(a),o=null==i?void 0:i.find((e=>a[e].dataSourceId===t));return o?a[o]:null}function r(e){const t=l.MapViewManager.getInstance().getJimuMapViewGroup(e[0]),n=null==t?void 0:t.jimuMapViews,a=n&&Object.keys(n);return null==a?void 0:a.some((e=>"3d"===n[e].view.type))}function c(e){var l;const t=[];return null===(l=null==e?void 0:e.getAllJimuLayerViews())||void 0===l||l.forEach((e=>{"building-scene"===e.type&&t.push(e)})),t}function g(e){let l=[];return l=null==e?void 0:e.filter((e=>!e.fromRuntime)),l}!function(e){e.Single="SINGLE"}(o||(o={}));const p=e.React.memo((l=>{var t,o,s,u;const d=e.hooks.useTranslation(i,n.defaultMessages),{config:r,viewModelResult:c,isEnableLevel:g,isMultipleMode:p,currentDSIdState:v,getCurrentSetting:m,handEnableChanged:h,onMapSettingsChanged:S}=l,x=e.React.useCallback((()=>{var e,l,t,n,a,i;const{currentSetting:o}=m(),s=null===(e=o.level)||void 0===e?void 0:e.min,u=null===(l=o.level)||void 0===l?void 0:l.max;let d=null!==(n=null===(t=o.level)||void 0===t?void 0:t.defaultValue)&&void 0!==n?n:null===(a=null==c?void 0:c.level)||void 0===a?void 0:a.defaultValue;return void 0===d&&(d=""),{min:s,max:u,allowedValuesLimit:(null===(i=null==c?void 0:c.level)||void 0===i?void 0:i.allowedValuesLimit)||null,defaultValue:d}}),[c,m]),f=e.React.useCallback((e=>{var l,t,n,a,i,o,s;const u=Math.max(null!==(l=(null==e?void 0:e.min)||x().min)&&void 0!==l?l:0,null!==(n=null===(t=null==c?void 0:c.level)||void 0===t?void 0:t.min)&&void 0!==n?n:0),d=Math.min(null!==(a=(null==e?void 0:e.max)||x().max)&&void 0!==a?a:0,null!==(o=null===(i=null==c?void 0:c.level)||void 0===i?void 0:i.max)&&void 0!==o?o:0),r=null===(s=null==c?void 0:c.level)||void 0===s?void 0:s.allowedValuesLimit,g=[];for(let e=u;e<=d;e++){(null===r||(null==r?void 0:r.includes(e)))&&g.push(e)}return g}),[null==c?void 0:c.level,x]);const b=e.React.useCallback((l=>{let t=r.getIn(["mapSettings"]),n=t[v];n||(n=(0,e.Immutable)({})),t=t.setIn([v],n),S(t)}),[r,v,S]);return(0,e.jsx)(a.SettingSection,null,(0,e.jsx)(a.SettingRow,{label:d("level")},(0,e.jsx)(n.Switch,{"aria-label":d("level"),checked:g,onChange:e=>{h("enableLevel",e)}})),p&&g&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(a.SettingRow,{label:d("levelRange"),className:"mt-4"}),(0,e.jsx)(a.SettingRow,null,(0,e.jsx)(n.MultiRangeSlider,{"aria-label":d("levelRange"),tooltip:!0,defaultMinValue:null===(t=null==c?void 0:c.level)||void 0===t?void 0:t.min,defaultMaxValue:null===(o=null==c?void 0:c.level)||void 0===o?void 0:o.max,min:null===(s=null==c?void 0:c.level)||void 0===s?void 0:s.min,max:null===(u=null==c?void 0:c.level)||void 0===u?void 0:u.max,minValue:x().min,maxValue:x().max,step:1,onChange:(e,l)=>{b({min:e,max:l})},disabled:!c})),(0,e.jsx)(a.SettingRow,{label:d("defaultLevel")}),(0,e.jsx)(a.SettingRow,null,(0,e.jsx)(n.Select,{size:"sm",value:x().defaultValue,placeholder:d("none"),disabled:!c,onChange:e=>{b({defaultValue:e.target.value})}},function(){const l=[];return l.push((0,e.jsx)(n.Option,{key:"",value:""},d("none"))),f().forEach((t=>{l.push((0,e.jsx)(n.Option,{key:t,value:t},t))})),l}()))))})),v=e.React.memo((l=>{var t,o,s,u;const d=e.hooks.useTranslation(i,n.defaultMessages),{config:r,viewModelResult:c,isEnablePhase:g,isShowPhaseSetting:p,isMultipleMode:v,currentDSIdState:m,getCurrentSetting:h,handEnableChanged:S,onMapSettingsChanged:x}=l,f=e.React.useCallback((()=>{var e,l,t,n,a,i;const{currentSetting:o}=h(),s=null===(e=o.phase)||void 0===e?void 0:e.min,u=null===(l=o.phase)||void 0===l?void 0:l.max;let d=null!==(n=null===(t=o.phase)||void 0===t?void 0:t.defaultValue)&&void 0!==n?n:null===(a=null==c?void 0:c.phase)||void 0===a?void 0:a.defaultValue;return void 0===d&&(d=""),{min:s,max:u,allowedValuesLimit:(null===(i=null==c?void 0:c.phase)||void 0===i?void 0:i.allowedValuesLimit)||null,defaultValue:d}}),[c,h]),b=e.React.useCallback((e=>{var l,t,n,a,i,o,s;const u=Math.max(null!==(l=(null==e?void 0:e.min)||f().min)&&void 0!==l?l:0,null!==(n=null===(t=null==c?void 0:c.phase)||void 0===t?void 0:t.min)&&void 0!==n?n:0),d=Math.min(null!==(a=(null==e?void 0:e.max)||f().max)&&void 0!==a?a:0,null!==(o=null===(i=null==c?void 0:c.phase)||void 0===i?void 0:i.max)&&void 0!==o?o:0),r=null===(s=null==c?void 0:c.phase)||void 0===s?void 0:s.allowedValuesLimit,g=[];for(let e=u;e<=d;e++){(null===r||(null==r?void 0:r.includes(e)))&&g.push(e)}return g}),[null==c?void 0:c.phase,f]);const M=e.React.useCallback((l=>{let t=r.getIn(["mapSettings"]),n=t[m];n||(n=(0,e.Immutable)({})),t=t.setIn([m],n),x(t)}),[r,m,x]);return(0,e.jsx)(a.SettingSection,null,(0,e.jsx)(a.SettingRow,{label:d("buildingPhase")},(0,e.jsx)(n.Switch,{"aria-label":d("buildingPhase"),checked:g,onChange:e=>{S("enablePhase",e)}})),v&&g&&(0,e.jsx)("div",{className:p?"d-block":"d-none"},(0,e.jsx)(a.SettingRow,{label:d("phaseRange"),className:"mt-4"}),(0,e.jsx)(a.SettingRow,null,(0,e.jsx)(n.MultiRangeSlider,{disabled:!c&&!p,"aria-label":d("phaseRange"),tooltip:!0,defaultMinValue:null===(t=null==c?void 0:c.phase)||void 0===t?void 0:t.min,defaultMaxValue:null===(o=null==c?void 0:c.phase)||void 0===o?void 0:o.max,min:null===(s=null==c?void 0:c.phase)||void 0===s?void 0:s.min,max:null===(u=null==c?void 0:c.phase)||void 0===u?void 0:u.max,minValue:f().min,maxValue:f().max,step:1,onChange:(e,l)=>{M({min:e,max:l})}})),(0,e.jsx)(a.SettingRow,{label:d("defaultPhase")}),(0,e.jsx)(a.SettingRow,null,(0,e.jsx)(n.Select,{size:"sm",value:f().defaultValue,placeholder:d("none"),onChange:e=>{M({defaultValue:e.target.value})},disabled:!c},function(){const l=[];return l.push((0,e.jsx)(n.Option,{key:"",value:""},d("none"))),b().forEach((t=>{l.push((0,e.jsx)(n.Option,{key:t,value:t},t))})),l}()))))})),m=e.React.memo((l=>{var u,d,m,h;(0,t.useTheme)();const S=e.hooks.useTranslation(i,n.defaultMessages),{onMapSettingsChanged:x,config:f}=l,b=S("none"),[M,w]=e.React.useState(""),j=e.React.useCallback((()=>{const e=l.config.getIn(["mapSettings"]);return{currentSetting:e.getIn([M]),mapsSettings:e}}),[l.config,M]),y=l.viewModelResult,R=e.React.useCallback((()=>{const{currentSetting:e}=j(),l=null==e?void 0:e.layerMode;return null!=l?l:o.Single}),[j]),C=e.React.useCallback((e=>{const t=null!=e?e:M;if(!t)return[];return c(s(l.useMapWidgetIds,t))}),[M,l.useMapWidgetIds]),I=e=>{let l=C(e);return l=g(l),(null==l?void 0:l.length)>0},V=e=>{var t;return"3d"===(null===(t=s(l.useMapWidgetIds,e).view)||void 0===t?void 0:t.type)},k=e.React.useCallback((()=>{let e=C();return e=g(e),e?(e.unshift({id:"",layer:{title:b}}),e):null}),[b,C]),L=k(),O=e.React.useCallback((()=>{var t;const{currentSetting:n}=j();return!(a=null==n?void 0:n.layersOnLoad)||(null==a?void 0:a.length)<=0||a&&1===a.length&&""===a[0]?k():function(e,l){var t;const n=[];return null===(t=null==l?void 0:l.getAllJimuLayerViews())||void 0===t||t.forEach((l=>{(null==e?void 0:e.includes(l.id))&&n.push(l)})),n}(null!==(t=n.layersOnLoad)&&void 0!==t?t:e.Immutable[""],l.activatedJimuMapView);var a}),[l.activatedJimuMapView,j,k]),T=e.React.useCallback((()=>O().at(0)),[O]),N=e.React.useCallback((l=>{const t=l.target.value;let n=f.getIn(["mapSettings"]),a=n[M];a||(a=(0,e.Immutable)({})),a=a.setIn(["layersOnLoad"],[t]),n=n.setIn([M],a),x(n)}),[f,M,x]),P=e.React.useCallback((e=>{const{currentSetting:l}=j(),t=l&&l[e];return null==t||t}),[j]),W=(t,n)=>{let a=f.getIn(["mapSettings"]),i=a[M];i||(i=(0,e.Immutable)({})),i=i.setIn([t],n.target.checked),a=a.setIn([M],i),l.onMapSettingsChanged(a)},E=R()!==o.Single,J=P("enableLevel"),z=P("enablePhase"),D=!((null===(u=null==y?void 0:y.phase)||void 0===u?void 0:u.min)===(null===(d=null==y?void 0:y.phase)||void 0===d?void 0:d.max));return(0,e.jsx)(a.SettingSection,{title:S("mapSettings"),"aria-label":S("mapSettings")},r(l.useMapWidgetIds)&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(a.SettingRow,{label:S("mapSettingsTip"),className:"mapSettingsTip",css:e.css`
    label {
      max-width: 100% !important;
    }
  `}),(0,e.jsx)(a.SettingRow,{className:"d-block"},(0,e.jsx)("div",{className:"w-100"},(0,e.jsx)(a.MultipleJimuMapConfig,{mapWidgetId:null===(m=l.useMapWidgetIds)||void 0===m?void 0:m[0],onClick:e=>{w(e)},isDataSourceValid:e=>V(e)?I(e)?{isValid:!0}:{isValid:!1,invalidMessage:S("noBuildingLayerTips")}:{isValid:!1,invalidMessage:S("mapNotSupportedTips")},keepLastTimeMap:!0,sidePopperContent:(0,e.jsx)("div",{className:"side-popper-container"},(0,e.jsx)(a.SettingSection,null,(0,e.jsx)(a.SettingRow,{label:S("layerOnLoading")}),(0,e.jsx)(a.SettingRow,{className:"mt-2"},l.activatedJimuMapView&&(0,e.jsx)(n.Select,{value:null===(h=T())||void 0===h?void 0:h.id,onChange:N,size:"sm",placeholder:b},L&&L.map(((l,t)=>{var a,i;return(0,e.jsx)(n.Option,{tabIndex:0,role:"option","aria-label":null===(a=l.layer)||void 0===a?void 0:a.title,key:t,value:l.id},null===(i=l.layer)||void 0===i?void 0:i.title)}))))),(0,e.jsx)(p,{config:f,getCurrentSetting:j,viewModelResult:y,currentDSIdState:M,isEnableLevel:J,isMultipleMode:E,onMapSettingsChanged:x,handEnableChanged:W}),(0,e.jsx)(v,{config:f,getCurrentSetting:j,viewModelResult:y,currentDSIdState:M,isEnablePhase:z,isShowPhaseSetting:D,isMultipleMode:E,onMapSettingsChanged:x,handEnableChanged:W}),(0,e.jsx)(a.SettingSection,null,(0,e.jsx)(a.SettingRow,{label:S("disciplinesCategories")},(0,e.jsx)(n.Switch,{"aria-label":S("disciplinesCategories"),checked:P("enableCtegories"),onChange:e=>{W("enableCtegories",e)}}))))})))),!r(l.useMapWidgetIds)&&(0,e.jsx)(a.SettingRow,null,(0,e.jsx)(n.Alert,{tabIndex:0,className:"warningMsg",type:"warning",withIcon:!0,onClose:function(){},open:!0,text:S("noMapTips")})))})),h=e.React.memo((l=>{const t=e.hooks.useTranslation(i,n.defaultMessages),o=(e,t)=>{const n=l.config.setIn(["general",e],t.target.checked);l.onGeneralSettingChanged(n.general)};return(0,e.jsx)(a.SettingSection,{title:t("generalSetting"),"aria-label":t("generalSetting")},(0,e.jsx)(a.SettingRow,{label:t("zoomToLayer")},(0,e.jsx)(n.Switch,{checked:l.config.general.zoomToLayer,onChange:e=>{o("zoomToLayer",e)},"aria-label":t("zoomToLayer")})),(0,e.jsx)(a.SettingRow,{label:t("applyFilterOnDs")},(0,e.jsx)(n.Switch,{checked:l.config.general.applyFilterOnDs,onChange:e=>{o("applyFilterOnDs",e)},"aria-label":t("applyFilterOnDs")})))}));var S=u(31027),x=u.n(S),f=function(e,l){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&l.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)l.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]])}return t};const b=l=>{const t=window.SVG,{className:n}=l,a=f(l,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",n);return t?e.React.createElement(t,Object.assign({className:i,src:x()},a)):e.React.createElement("svg",Object.assign({className:i},a))};var M=function(e,l,t,n){return new(t||(t=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var l;e.done?a(e.value):(l=e.value,l instanceof t?l:new t((function(e){e(l)}))).then(o,s)}u((n=n.apply(e,l||[])).next())}))};const w=o=>{var s;(0,t.useTheme)();const u=e.hooks.useTranslation(i,n.defaultMessages),d=null===(s=o.useMapWidgetIds)||void 0===s?void 0:s[0],r=e.React.useMemo((()=>{var e;return(null===(e=o.useMapWidgetIds)||void 0===e?void 0:e.length)>0}),[o.useMapWidgetIds]),[c,g]=e.React.useState(null),p=e.React.useCallback((e=>M(void 0,void 0,void 0,(function*(){var l;"3d"===(null===(l=null==e?void 0:e.view)||void 0===l?void 0:l.type)?(yield e.whenJimuMapViewLoaded(),yield e.whenAllJimuLayerViewLoaded(),g(e)):g(null)}))),[]),[v]=e.React.useState(null);return(0,e.jsx)("div",{className:"widget-setting-directions jimu-widget-setting",css:e.css`
      font-size: 13px;
      font-weight: lighter;

      .jimu-widget-setting--section {
        padding: 18px 16px;
      }

      .placeholder-container{
        height: calc(100% - 180px);

        .placeholder-icon{
          color: var(--ref-palette-neutral-800);
        }
        .placeholder-hint{
          font-size: ${e.polished.rem(14)};
          font-weight: 500;
          color: var(--ref-palette-neutral-1000);
          max-width: ${e.polished.rem(160)};
        }
      }
  `},(0,e.jsx)(a.SettingSection,{title:u("ds"),"aria-label":u("ds"),className:(0,e.classNames)({"border-0":!r})},(0,e.jsx)(a.SettingRow,{label:u("selectMapWidget"),className:"mb-2"}),(0,e.jsx)("div",null,(0,e.jsx)(a.MapWidgetSelector,{onSelect:e=>{o.onSettingChange({id:o.id,useMapWidgetIds:e})},useMapWidgetIds:o.useMapWidgetIds})),d&&(0,e.jsx)(l.JimuMapViewComponent,{useMapWidgetId:d,onActiveViewChange:p})),!r&&(0,e.jsx)("div",{className:"d-flex justify-content-center align-items-center placeholder-container"},(0,e.jsx)("div",{className:"text-center"},(0,e.jsx)(b,{size:48,className:"d-inline-block placeholder-icon mb-2"}),(0,e.jsx)("p",{className:"placeholder-hint"},u("selectMapHint")))),r&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(m,{widgetId:o.id,useMapWidgetIds:o.useMapWidgetIds,activatedJimuMapView:c,config:o.config,onMapSettingsChanged:e=>{o.onSettingChange({id:o.id,config:o.config.setIn(["mapSettings"],e)})},viewModelResult:v}),(0,e.jsx)(h,{config:o.config,onGeneralSettingChanged:e=>{o.onSettingChange({id:o.id,config:o.config.setIn(["general"],e)})}})))};function j(e){u.p=e}})(),d})())}}}));