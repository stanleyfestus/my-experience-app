System.register(["jimu-arcgis","jimu-core","jimu-ui","jimu-core/react","esri/Graphic","esri/geometry/Circle","esri/layers/GraphicsLayer"],(function(e,t){var i={},a={},s={},n={},o={},r={},l={};return{setters:[function(e){i.JimuMapViewComponent=e.JimuMapViewComponent,i.MapViewManager=e.MapViewManager,i.zoomToUtils=e.zoomToUtils},function(e){a.DataSourceComponent=e.DataSourceComponent,a.DataSourceManager=e.DataSourceManager,a.DataSourceStatus=e.DataSourceStatus,a.EsriFieldType=e.EsriFieldType,a.Immutable=e.Immutable,a.JimuFieldType=e.JimuFieldType,a.QueryScope=e.QueryScope,a.React=e.React,a.TimezoneConfig=e.TimezoneConfig,a.WidgetVersionManager=e.WidgetVersionManager,a.classNames=e.classNames,a.css=e.css,a.dataSourceUtils=e.dataSourceUtils,a.dateUtils=e.dateUtils,a.getAppStore=e.getAppStore,a.hooks=e.hooks,a.indexedDBUtils=e.indexedDBUtils,a.injectIntl=e.injectIntl,a.jsx=e.jsx,a.utils=e.utils},function(e){s.Alert=e.Alert,s.Button=e.Button,s.ConfirmDialog=e.ConfirmDialog,s.DataActionList=e.DataActionList,s.DataActionListStyle=e.DataActionListStyle,s.Icon=e.Icon,s.Loading=e.Loading,s.Tab=e.Tab,s.Tabs=e.Tabs,s.Tooltip=e.Tooltip,s.WidgetPlaceholder=e.WidgetPlaceholder},function(e){n.useRef=e.useRef},function(e){o.default=e.default},function(e){r.default=e.default},function(e){l.default=e.default}],execute:function(){e((()=>{var e={48932:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#fff" fill-rule="evenodd" d="M17.5 5a2.5 2.5 0 1 0-2.45-3H4.75a4.25 4.25 0 0 0 0 8.5h10.5a3.25 3.25 0 0 1 0 6.5H4.95a2.5 2.5 0 1 0 0 1h10.3a4.25 4.25 0 0 0 0-8.5H4.75a3.25 3.25 0 1 1 0-6.5h10.3a2.5 2.5 0 0 0 2.45 2m0-1a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3M4 17.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0" clip-rule="evenodd"></path></svg>'},35737:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m14 4-6 8-6-8z"></path></svg>'},23001:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m4 2 8 6-8 6z"></path></svg>'},26490:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M3.154 3.154a.527.527 0 0 1 .746 0l1.317 1.317A8.6 8.6 0 0 1 8 4c2.667 0 5.667 1.333 7 4-.696 1.393-1.847 2.422-3.168 3.087l1.014 1.013a.527.527 0 1 1-.746.746l-1.317-1.317A8.6 8.6 0 0 1 8 12c-2.667 0-5.667-1.333-7-4 .696-1.393 1.847-2.422 3.168-3.087L3.154 3.9a.527.527 0 0 1 0-.746m1.698 2.443C3.726 6.087 2.782 6.882 2 8c1.422 2.033 3.382 3 6 3a8.7 8.7 0 0 0 2.03-.225l-.675-.674A2.5 2.5 0 0 1 5.9 6.644zm6.296 4.805C12.275 9.913 13.218 9.119 14 8c-1.422-2.033-3.382-3-6-3q-1.088 0-2.03.225l.675.674a2.5 2.5 0 0 1 3.457 3.456zM6.5 8c0-.221.048-.431.134-.62l1.987 1.986A1.5 1.5 0 0 1 6.5 8m.88-1.366 1.986 1.987a1.5 1.5 0 0 0-1.987-1.987" clip-rule="evenodd"></path></svg>'},73529:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 12c-2.667 0-5.667-1.333-7-4 1.333-2.667 4.333-4 7-4s5.667 1.333 7 4c-1.333 2.667-4.333 4-7 4m0-7c-2.618 0-4.578.967-6 3 1.422 2.033 3.382 3 6 3s4.578-.967 6-3c-1.422-2.033-3.382-3-6-3m0 5.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5m0-1a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3" clip-rule="evenodd"></path></svg>'},31795:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M14 8A6 6 0 1 1 2 8a6 6 0 0 1 12 0m1 0A7 7 0 1 1 1 8a7 7 0 0 1 14 0M5.172 5.879a.5.5 0 0 1 .707-.707L8 7.292l2.121-2.12a.5.5 0 1 1 .707.707L8.708 8l2.12 2.121a.5.5 0 1 1-.707.707L8 8.708l-2.121 2.12a.5.5 0 1 1-.707-.707L7.292 8z" clip-rule="evenodd"></path></svg>'},40904:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M5 1H4v14h1zm7 0h-1v14h1z" clip-rule="evenodd"></path></svg>'},97408:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="m2 1 12 7-12 7zm9.983 6.999L3 2.723v10.553z" clip-rule="evenodd"></path></svg>'},9044:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M6 6.5a.5.5 0 0 1 1 0v6a.5.5 0 0 1-1 0zM9.5 6a.5.5 0 0 0-.5.5v6a.5.5 0 0 0 1 0v-6a.5.5 0 0 0-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M11 0H5a1 1 0 0 0-1 1v2H.5a.5.5 0 0 0 0 1h1.6l.81 11.1a1 1 0 0 0 .995.9h8.19a1 1 0 0 0 .995-.9L13.9 4h1.6a.5.5 0 0 0 0-1H12V1a1 1 0 0 0-1-1m0 3V1H5v2zm1.895 1h-9.79l.8 11h8.19z" clip-rule="evenodd"></path></svg>'},74919:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M7 2h2a2 2 0 0 1 2 2v7.817l-3 2.812-3-2.812V4a2 2 0 0 1 2-2m5 2v8.25L8 16l-4-3.75V4a3 3 0 0 1 3-3h2a3 3 0 0 1 3 3M9 6a1 1 0 1 1-2 0 1 1 0 0 1 2 0m1 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0" clip-rule="evenodd"></path></svg>'},56431:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 15"><path fill="#fff" fill-rule="evenodd" d="M5 0 1.5.5l1.261 1.261L.867 3.655l-.008.01-.076.08c-.162.168-.454.473-.624.857-.226.511-.243 1.139.16 1.87.408.74 1.084 1.089 1.818 1.064.703-.024 1.41-.386 1.974-.951l4.137-4.363c.134-.132.367-.223.64-.222.278 0 .515.095.651.23.2.196.378.477.42.775.038.269-.023.617-.422 1.016-.81.81-4.006 4.304-5.67 6.134-.263.265-.652.706-.864 1.24-.225.568-.254 1.271.282 1.922.43.524.982.839 1.606.84.614 0 1.193-.305 1.692-.804.414-.414 1.342-1.454 2.172-2.394l.89-1.01.229-.261.53-.597V9.09c.143-.143.415-.366.731-.474a.95.95 0 0 1 .95.159c.095.072.307.309.38.618.06.264.038.647-.428 1.113-.205.204-.46.47-.702.721l-.03.032c-.234.243-.453.47-.608.625l.707.708c.163-.163.387-.396.616-.635l.036-.037c.244-.254.492-.511.688-.707.694-.694.839-1.424.694-2.046-.134-.577-.503-1.001-.744-1.186a1.95 1.95 0 0 0-1.882-.311 3.04 3.04 0 0 0-1.115.713c-.06.06-.403.45-.857.966-.253.288-.541.616-.835.948-.84.951-1.743 1.963-2.129 2.349-.377.378-.717.51-.984.51-.257 0-.546-.123-.835-.474-.25-.304-.25-.601-.124-.92.137-.346.414-.673.65-.909l.009-.008.008-.01c1.672-1.838 4.855-5.318 5.644-6.107.601-.601.791-1.256.705-1.863-.082-.579-.404-1.049-.707-1.348-.365-.359-.877-.516-1.35-.517s-.99.152-1.355.519L3.4 5.882c-.434.432-.91.642-1.297.655-.359.012-.683-.14-.908-.547-.262-.476-.213-.776-.121-.984.091-.207.231-.355.391-.525l.127-.136 1.876-1.877L4.5 3.5z" clip-rule="evenodd"></path></svg>'},45508:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14" clip-rule="evenodd"></path></svg>'},30563:e=>{e.exports="data:image/png;base64,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"},95684:e=>{e.exports="data:image/png;base64,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"},22089:e=>{"use strict";e.exports=o},50152:e=>{"use strict";e.exports=r},59620:e=>{"use strict";e.exports=l},62686:e=>{"use strict";e.exports=i},79244:e=>{"use strict";e.exports=a},68972:e=>{"use strict";e.exports=n},14321:e=>{"use strict";e.exports=s}},t={};function c(i){var a=t[i];if(void 0!==a)return a.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,c),s.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var i in t)c.o(t,i)&&!c.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.p="";var d={};return c.p=window.jimuConfig.baseUrl,(()=>{"use strict";c.r(d),c.d(d,{__set_webpack_public_path__:()=>ei,default:()=>$t});var e,t,i,a,s,n=c(62686),o=c(79244),r=c(14321);function l(e,t,i,a){const s=e.sys.color.surface.paper;return o.css`
    .empty-content{
        height:100%;
        width:100%;
        display: flex;
        flex-direction:column;
        align-items: center;
        justify-content:center;
        .info-txt{
          margin-top: 6px;
          color:${e.sys.color.surface.paperHint};
          text-align: center;
        }
    }
    .widget-track-panel{
      height:40px;
      line-height: 40px;
      width:100%;
      background-color: ${s};
      display:flex;
      align-items: center;
      justify-content:space-between;
    }
    .tool-dividing-line{
        height: 16px;
        width: 1px;
        display: inline-flex;
        background-color: ${e.sys.color.divider.secondary};
        margin: 8px 4px;
    }
    .header-section{
        position: relative;
        width: 100%;
        height: 32px;
        display: flex;
        flex: 0 0 auto;
        justify-content: space-between;
        .left,.right{
          display:flex;
          justify-content: left;
          align-items: center;
          .track-name{
            margin-left:8px;
            font-weight: 500;
            font-size: 16px;
            color:${e.sys.color.surface.paperText};
          }
          .track-icon{
            width:16px;
            height:16px;
            color:${e.sys.color.surface.paperText};
          }
        } 
        .del-icon{
          height: 16px;
          width:16px;
          cursor: pointer;
        }
    }
    .widget-track{
        width: calc(100% - 32px);
        height: calc(100% - 24px);
        display: inline-block;
        ${a&&"min-height: 430px;"};
        ${i&&"min-width: 360px;"};
        display: flex;
        flex-direction: column;
        height: 100%;
        width:100%;
        background-color: ${s};
      .warning-inaccessible{
        position: absolute;
        left: 0.25rem;
        right: 0.25rem;
        top: 0.25rem;
        width: auto;
        z-index:100;
      }
      .btn-content{
        flex: 0 0 auto;
        width: 100%;
        height: 30px;
        margin-top: 16px;
        .btn{
          height: 30px;
          line-height: 30px;
          width: 100%;
          padding: 0;
        }
      }
      .btn-content-trace{
        flex: 0 0 auto;
        display: flex;
        flex-direction: row;
        align-items: flex-start;
        width: 100%;
        height: 30px;
        margin-top: 16px;
        .btn-span{
          width: 30px;
          height: 30px;
          margin-right: 8px;
        }
        .btn-trace{
          padding: 5px;
          border-radius: 2px;
          border: 1px solid ${e.sys.color.divider.tertiary};
          background: ${e.sys.color.surface.paper};
        }
        span{
          width: 100%;
        }
        .btn-auto{
          height: 31px;
          line-height: 31px;
          width: 100%;
          padding: 0;
        }
      }
      .track-list-items{
        padding-top:16px;
        padding-bottom: 16px;
        margin:0;
      }
    }  
`}!function(e){e.Panel="PANEL",e.Toolbar="TOOLBAR"}(e||(e={})),function(e){e.Distance="DISTANCE",e.Time="TIME"}(t||(t={})),function(e){e.ft="FT",e.m="M"}(i||(i={})),function(e){e.sec="S"}(a||(a={})),function(e){e.DD="DD",e.DMS="DMS"}(s||(s={}));const u="My Location",p="Locations",h="The location cannot be retrieved.",m="The path cannot be generated.",g="Activate the widget to retrieve records.",f="No paths have been generated at this time.",y="Clear results",v="Delete the record",S="Show from the Map",w="Hide from the Map",x="Locations",b="Paths",j="Path",L="Trace a path",T="Get location",k="Start watching",D="End watching",E="Are you sure you wish to delete the record(s)?",I="Timestamp",M="Longitude",C="Latitude",A="Altitude",O="Orientation",R="Speed",N="Accuracy",V="Start Time",P="End Time",F="Average Altitude",B="Average Speed",W="Average Accuracy",J="m/s",U="meters";var H,z=c(68972),q=c(22089),Q=function(e,t,i,a){return new(i||(i=Promise))((function(s,n){function o(e){try{l(a.next(e))}catch(e){n(e)}}function r(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((a=a.apply(e,t||[])).next())}))};!function(e){e.CREATE="CREATE",e.ADD="ADD",e.DELETE="DELETE",e.UPDATE="UPDATE",e.CLEAR="CLEAR",e.REFRESH="REFRESH"}(H||(H={}));const Y={jimuName:"OBJECTID",name:"OBJECTID",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.OID,alias:"ObjectID"},K={jimuName:"location_timestamp",name:"location_timestamp",type:o.JimuFieldType.Date,esriType:o.EsriFieldType.Date,alias:"Time",format:{dateFormat:"shortDateLongTime24"}},X={jimuName:"Longitude",name:"Longitude",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"Longitude"},Z={jimuName:"Latitude",name:"Latitude",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"Latitude"},G={jimuName:"altitude",name:"altitude",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"Altitude"},_={jimuName:"Orientation",name:"Orientation",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"Orientation"},$={jimuName:"speed",name:"speed",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"Speed"},ee={jimuName:"Accuracy",name:"Accuracy",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"Accuracy"},te={jimuName:"LineID",name:"LineID",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Integer,alias:"LineID"},ie={jimuName:"StartTime",name:"StartTime",type:o.JimuFieldType.Date,esriType:o.EsriFieldType.Date,alias:"StartTime",format:{dateFormat:"shortDateLongTime24"}},ae={jimuName:"EndTime",name:"EndTime",type:o.JimuFieldType.Date,esriType:o.EsriFieldType.Date,alias:"EndTime",format:{dateFormat:"shortDateLongTime24"}},se={jimuName:"AverageAltitude",name:"AverageAltitude",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"AverageAltitude"},ne={jimuName:"AverageSpeed",name:"averageSpeed",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"AverageSpeed"},oe={jimuName:"AverageAccuracy",name:"AverageAccuracy",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"AverageAccuracy"},re=(e,t="",i="")=>{const a=((e,t)=>{let i;return K.alias=t.formatMessage({id:"trackTime",defaultMessage:I}),X.alias=t.formatMessage({id:"trackLongitude",defaultMessage:M}),Z.alias=t.formatMessage({id:"trackLatitude",defaultMessage:C}),G.alias=t.formatMessage({id:"trackAltitude",defaultMessage:A}),_.alias=t.formatMessage({id:"trackOrientation",defaultMessage:O}),$.alias=t.formatMessage({id:"trackSpeed",defaultMessage:R}),ee.alias=t.formatMessage({id:"trackAccuracy",defaultMessage:N}),ie.alias=t.formatMessage({id:"trackStartTime",defaultMessage:V}),ae.alias=t.formatMessage({id:"trackEndTime",defaultMessage:P}),se.alias=t.formatMessage({id:"averageAltitude",defaultMessage:F}),ne.alias=t.formatMessage({id:"averageSpeed",defaultMessage:B}),oe.alias=t.formatMessage({id:"averageAccuracy",defaultMessage:W}),"track"===e?i={[Y.jimuName]:Y,[K.jimuName]:K,[X.jimuName]:X,[Z.jimuName]:Z,[G.jimuName]:G,[_.jimuName]:_,[$.jimuName]:$,[ee.jimuName]:ee}:"trackline_point"===e?i={[Y.jimuName]:Y,[te.jimuName]:te,[K.jimuName]:K,[X.jimuName]:X,[Z.jimuName]:Z,[G.jimuName]:G,[_.jimuName]:_,[$.jimuName]:$,[ee.jimuName]:ee}:"trackline"===e&&(i={[Y.jimuName]:Y,[ie.jimuName]:ie,[ae.jimuName]:ae,[se.jimuName]:se,[ne.jimuName]:ne,[oe.jimuName]:oe}),i})(i,e);return{label:t,idField:Y.jimuName,fields:a}},le=(e,t,i,...a)=>Q(void 0,[e,t,i,...a],void 0,(function*(e,t,i,a=!0,s=!0){const n=yield t.addLayerToMap(e,e+"__layer");return n.layer.visible=a,n.layer._exb_not_editable=!0,n.layer.listMode=s?"show":"hide",i&&(n.layer.renderer=i),Promise.resolve(n)})),ce=(e,t,i)=>null==e?void 0:e.setSourceFeatures(t,{geometryType:i}),de=(e,t,i,a)=>Q(void 0,void 0,void 0,(function*(){if(!t)return void console.error("The layer is not found.");const s=null==a?void 0:a.map((e=>e.attributes.OBJECTID));if(i===H.ADD)yield t.applyEdits({addFeatures:a}),a.forEach((t=>{e.afterAddRecord(t.attributes)}));else if(i===H.DELETE)yield t.applyEdits({deleteFeatures:a}),e.afterDeleteRecordsByIds(s);else if(i===H.UPDATE)yield t.applyEdits({updateFeatures:a});else if(i===H.CLEAR){const i=yield t.queryFeatures();yield t.applyEdits({deleteFeatures:i.features}),e.afterDeleteRecordsByIds(i.features.map((e=>e.getObjectId().toString())))}else i===H.CREATE&&(yield t.applyEdits({addFeatures:a}),a.forEach((t=>{e.afterAddRecord(t.attributes)})))})),ue=(e,t,i)=>{e&&n.zoomToUtils.zoomTo(e.view,t,{scale:i})},pe=e=>{const t=e,i={type:"point",x:e.Longitude,y:e.Latitude};return q.default.fromJSON({geometry:i,attributes:t})},he=(e,t)=>{const i=e,a=t.map((e=>[e.Longitude,e.Latitude]));1===t.length&&a.push([t[0].Longitude,t[0].Latitude]);const s={type:"polyline",paths:[a]};return q.default.fromJSON({geometry:s,attributes:i})};function me(e,t){var i,a;return`exb-${(null===(i=window.jimuConfig)||void 0===i?void 0:i.isBuilder)?null===(a=(0,o.getAppStore)().getState().appStateInBuilder)||void 0===a?void 0:a.appId:(0,o.getAppStore)().getState().appId}-${e}-${t}-key`}const ge=e=>{var t;const i=null!==(t=o.utils.readLocalStorage(e))&&void 0!==t?t:"0",a=Number(i)+1;return o.utils.setLocalStorage(e,a.toString()),a};var fe=function(e,t,i,a){return new(i||(i=Promise))((function(s,n){function o(e){try{l(a.next(e))}catch(e){n(e)}}function r(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((a=a.apply(e,t||[])).next())}))};const ye=e=>{const{widgetId:t,dataSourceId:i,track:a,operation:s,symbolColor:n,jimuMapView:r,layerVisible:l,highlightLocation:c,showRuntimeLayers:d,onCreate:u,onTracksChange:p}=e,h=(0,z.useRef)(!0),m=(0,z.useRef)(null),g=(0,z.useRef)(null),[f,y]=o.React.useState({type:"simple",symbol:{type:"simple-marker",size:10,color:n||"#007AC2",outline:null}}),[v,S]=o.React.useState(null),[w,x]=o.React.useState(null),b=o.hooks.useLatest(u),j=(e,t,i)=>fe(void 0,void 0,void 0,(function*(){e&&(t!==H.REFRESH&&(null==e?void 0:e.layer)?yield de(e,e.layer,t,i):yield ce(e,i,"point"),g.current?yield de(e,g.current.layer,t,i.map((e=>e.clone()))):i.length>0&&(yield T()),null==e||e.setStatus(o.DataSourceStatus.Unloaded),null==e||e.setCountStatus(o.DataSourceStatus.Unloaded))}));o.React.useEffect((()=>{if(h.current)h.current=!1;else{const e=a?[a].map((e=>pe(e))):[];s===H.ADD?j(v,H.ADD,e):s===H.DELETE?j(v,H.DELETE,e):s===H.CLEAR&&j(v,H.CLEAR,e)}}),[a,s]),o.React.useEffect((()=>{var e;(null===(e=g.current)||void 0===e?void 0:e.layer)&&(g.current.layer.listMode=d?"show":"hide")}),[e.showRuntimeLayers]),o.React.useEffect((()=>{g.current&&(g.current.layer.visible=l)}),[l]),o.React.useEffect((()=>{!c&&g.current&&(g.current.layer.renderer={type:"simple"}),e.tracks.length>0&&c&&v&&(g.current?g.current.layer.renderer=f:T())}),[c]),o.React.useEffect((()=>{var t;m.current&&g.current&&(t=m.current,fe(void 0,void 0,void 0,(function*(){w&&(w.remove(),x(null)),t.removeJimuLayerView(g.current),g.current=null,null==v||v.setStatus(o.DataSourceStatus.Unloaded),null==v||v.setCountStatus(o.DataSourceStatus.Unloaded)}))),r&&e.tracks.length>0&&c&&v&&(g.current||j(v,H.REFRESH,e.tracks.map((e=>pe(e))))),m.current=r}),[r]),o.React.useEffect((()=>{const e={type:"simple",symbol:{type:"simple-marker",size:10,color:n,outline:null}};y(e),g.current&&c&&(g.current.layer.renderer=e)}),[n]);const L=o.React.useMemo((()=>{if(i)return(0,o.Immutable)({dataSourceId:i,mainDataSourceId:i})}),[i]),T=()=>fe(void 0,void 0,void 0,(function*(){const t=c?f:{type:"simple"};if(g.current=yield le(i,r,t,l,d),null==v||v.setStatus(o.DataSourceStatus.Unloaded),null==v||v.setCountStatus(o.DataSourceStatus.Unloaded),g.current&&!w){const t=g.current.layer.watch("visible",(t=>{e.handleLayerVisibleChange([i],t,1)}));x(t)}}));return o.React.createElement(o.DataSourceComponent,{query:{where:"1=1",outFields:e.selectedFields,returnGeometry:!0},queryCount:!0,widgetId:t,useDataSource:L,onDataSourceCreated:t=>{var i;S(t),null===(i=b.current)||void 0===i||i.call(b,t),t&&t.layer&&j(t,H.REFRESH,e.tracks.map((e=>pe(e))))},onSelectionChange:t=>{t&&e.onHandleSelection(Array.from(t),"point")},onDataSourceStatusChange:t=>fe(void 0,void 0,void 0,(function*(){if(t===o.DataSourceStatus.Loaded&&v){const t=v.getRecords().map((e=>e.getData().OBJECTID));e.onHandleFilter(t,"point");const i=v.getRecords().map((e=>e.getData())).sort(((e,t)=>t.location_timestamp-e.location_timestamp)),a=yield v.queryCount({where:"1=1",returnGeometry:!1},{scope:o.QueryScope.InRemoteConfigView});null==p||p(i,a.count)}}))})};var ve=function(e,t,i,a){return new(i||(i=Promise))((function(s,n){function o(e){try{l(a.next(e))}catch(e){n(e)}}function r(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((a=a.apply(e,t||[])).next())}))};const Se=e=>{const{widgetId:t,dataSourceId:i,jimuMapView:a,highlightLocation:s,trackLines:n,trackLinePoints:r,tracksWithLine:l,symbolColor:c,layerVisible:d,operation:u,showRuntimeLayers:p,onCreate:h,onLinesChanges:m,onHandleSelection:g,onHandleFilter:f,handleLayerVisibleChange:y}=e,[v,S]=o.React.useState({type:"simple",symbol:{type:"simple-line",color:c||"#007AC2",width:2,style:"solid"}}),w=(0,z.useRef)(null),x=(0,z.useRef)(null),[b,j]=o.React.useState(null),[L,T]=o.React.useState(null),k=o.hooks.useLatest(h),D=(0,z.useRef)(!0);o.React.useEffect((()=>{D.current?D.current=!1:u===H.ADD?(e=>{ve(void 0,void 0,void 0,(function*(){if(!e)return;const t=[],i=he(e.line,e.tracks);t.push(i),yield C(b,H.ADD,t)}))})(l):u===H.DELETE?(e=>{ve(void 0,void 0,void 0,(function*(){if(!e)return;const t=[],i=he(e.line,e.tracks);t.push(i),yield C(b,H.DELETE,t)}))})(l):u===H.UPDATE?(e=>{ve(void 0,void 0,void 0,(function*(){if(!e)return;const t=[];if(e.line){const i=he(e.line,e.tracks);t.push(i)}yield C(b,H.UPDATE,t)}))})(l):u===H.CLEAR&&C(b,H.CLEAR,[])}),[l,u]),o.React.useEffect((()=>{const e={type:"simple",symbol:{type:"simple-line",color:c,width:2,style:"solid"}};S(e),x.current&&s&&(x.current.layer.renderer=e)}),[c]),o.React.useEffect((()=>{var e;(null===(e=x.current)||void 0===e?void 0:e.layer)&&(x.current.layer.listMode=p?"show":"hide")}),[p]),o.React.useEffect((()=>{x.current&&(x.current.layer.visible=d)}),[d]),o.React.useEffect((()=>{!s&&x.current&&(x.current.layer.renderer={type:"simple"}),n&&n.length>0&&s&&b&&(x.current?x.current.layer.renderer=v:M())}),[s]),o.React.useEffect((()=>{w.current&&x.current&&I(w.current),a&&n&&n.length>0&&s&&b&&(x.current||C(b,H.REFRESH,n.map(((e,t)=>he(e,r[t]))))),w.current=a}),[a]);const E=o.React.useMemo((()=>{if(i)return(0,o.Immutable)({dataSourceId:i,mainDataSourceId:i})}),[i]),I=e=>ve(void 0,void 0,void 0,(function*(){L&&(L.remove(),T(null)),e.removeJimuLayerView(x.current),x.current=null,null==b||b.setStatus(o.DataSourceStatus.Unloaded),null==b||b.setCountStatus(o.DataSourceStatus.Unloaded)})),M=()=>ve(void 0,void 0,void 0,(function*(){const e=s?v:{type:"simple"};if(x.current=yield le(i,a,e,d,p),x.current&&!L){const e=x.current.layer.watch("visible",(e=>{y([i],e,2)}));T(e)}})),C=(e,t,i)=>ve(void 0,void 0,void 0,(function*(){e&&(t!==H.REFRESH&&(null==e?void 0:e.layer)?yield de(e,e.layer,t,i):yield ce(e,i,"polyline"),x.current?yield de(e,x.current.layer,t,i):i.length>0&&(yield M()),null==e||e.setStatus(o.DataSourceStatus.Unloaded),null==e||e.setCountStatus(o.DataSourceStatus.Unloaded))}));return o.React.createElement(o.DataSourceComponent,{query:{where:"1=1",outFields:["*"],returnGeometry:!0},queryCount:!0,widgetId:t,useDataSource:E,onDataSourceCreated:e=>{var t;j(e),null===(t=k.current)||void 0===t||t.call(k,e),e&&e.layer&&C(e,H.REFRESH,n.map(((e,t)=>he(e,r[t]))))},onSelectionChange:e=>{e&&g(Array.from(e),"line")},onDataSourceStatusChange:e=>ve(void 0,void 0,void 0,(function*(){if(e===o.DataSourceStatus.Loaded&&b){const e=b.getRecords().map((e=>e.getData().OBJECTID));f(e,"line");const t=b.getRecords().map((e=>e.getData())).sort(((e,t)=>t.OBJECTID-e.OBJECTID)),i=yield b.queryCount({where:"1=1",returnGeometry:!1},{scope:o.QueryScope.InRemoteConfigView});null==m||m(t,i.count)}}))})};var we=function(e,t,i,a){return new(i||(i=Promise))((function(s,n){function o(e){try{l(a.next(e))}catch(e){n(e)}}function r(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((a=a.apply(e,t||[])).next())}))};const xe=e=>{const{widgetId:t,dataSourceId:i,operationRecords:a,operation:s,symbolColor:n,jimuMapView:r,layerVisible:l,highlightLocation:c,showRuntimeLayers:d,tracks:u,onCreate:p,onHandleSelection:h,onHandleFilter:m,handleLayerVisibleChange:g,onLinePointsRecordsChanges:f}=e,y=(0,z.useRef)(!0),v=(0,z.useRef)(null),S=(0,z.useRef)(null),[w,x]=o.React.useState({type:"simple",symbol:{type:"simple-marker",size:10,color:n||"#007AC2",outline:null}}),[b,j]=o.React.useState(null),[L,T]=o.React.useState(null),k=o.hooks.useLatest(p),D=(e,t,i)=>we(void 0,void 0,void 0,(function*(){e&&(t!==H.REFRESH&&(null==e?void 0:e.layer)?yield de(e,e.layer,t,i):yield ce(e,i,"point"),S.current?yield de(e,S.current.layer,t,i.map((e=>e.clone()))):i.length>0&&(yield I()),null==e||e.setStatus(o.DataSourceStatus.Unloaded),null==e||e.setCountStatus(o.DataSourceStatus.Unloaded))}));o.React.useEffect((()=>{if(y.current)y.current=!1;else{const e=a&&a.length>0?a.map((e=>pe(e))):[];s===H.ADD?D(b,H.ADD,e):s===H.DELETE?D(b,H.DELETE,e):s===H.CLEAR&&D(b,H.CLEAR,e)}}),[a,s]),o.React.useEffect((()=>{var e;(null===(e=S.current)||void 0===e?void 0:e.layer)&&(S.current.layer.listMode=d?"show":"hide")}),[d]),o.React.useEffect((()=>{S.current&&(S.current.layer.visible=l)}),[l]),o.React.useEffect((()=>{!c&&S.current&&(S.current.layer.renderer={type:"simple"}),u.length>0&&c&&b&&(S.current?S.current.layer.renderer=w:I())}),[c]),o.React.useEffect((()=>{var e;v.current&&S.current&&(e=v.current,we(void 0,void 0,void 0,(function*(){L&&(L.remove(),T(null)),e.removeJimuLayerView(S.current),S.current=null,null==b||b.setStatus(o.DataSourceStatus.Unloaded),null==b||b.setCountStatus(o.DataSourceStatus.Unloaded)}))),r&&u.length>0&&c&&b&&(S.current||D(b,H.REFRESH,u.map((e=>pe(e))))),v.current=r}),[r]),o.React.useEffect((()=>{const e={type:"simple",symbol:{type:"simple-marker",size:10,color:n,outline:null}};x(e),S.current&&c&&(S.current.layer.renderer=e)}),[n]);const E=o.React.useMemo((()=>{if(i)return(0,o.Immutable)({dataSourceId:i,mainDataSourceId:i})}),[i]),I=()=>we(void 0,void 0,void 0,(function*(){const e=c?w:{type:"simple"};if(S.current=yield le(i,r,e,l,d),null==b||b.setStatus(o.DataSourceStatus.Unloaded),null==b||b.setCountStatus(o.DataSourceStatus.Unloaded),S.current&&!L){const e=S.current.layer.watch("visible",(e=>{g([i],e,1)}));T(e)}}));return o.React.createElement(o.DataSourceComponent,{query:{where:"1=1",outFields:e.selectedFields,returnGeometry:!0},queryCount:!0,widgetId:t,useDataSource:E,onDataSourceCreated:e=>{var t;j(e),null===(t=k.current)||void 0===t||t.call(k,e),e&&e.layer&&D(e,H.REFRESH,u.map((e=>pe(e))))},onSelectionChange:e=>{e&&h(Array.from(e),"point")},onDataSourceStatusChange:e=>we(void 0,void 0,void 0,(function*(){if(e===o.DataSourceStatus.Loaded&&b){const e=b.getRecords().map((e=>e.getData().OBJECTID));m(e,"point");const t=b.getRecords().map((e=>e.getData())).sort(((e,t)=>t.location_timestamp-e.location_timestamp)),i=yield b.queryCount({where:"1=1",returnGeometry:!1},{scope:o.QueryScope.InRemoteConfigView});null==f||f(t,i.count)}}))})};var be=c(73529),je=c.n(be),Le=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(i[a[s]]=e[a[s]])}return i};const Te=e=>{const t=window.SVG,{className:i}=e,a=Le(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:je()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var ke=c(40904),De=c.n(ke),Ee=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(i[a[s]]=e[a[s]])}return i};const Ie=e=>{const t=window.SVG,{className:i}=e,a=Ee(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:De()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var Me=c(97408),Ce=c.n(Me),Ae=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(i[a[s]]=e[a[s]])}return i};const Oe=e=>{const t=window.SVG,{className:i}=e,a=Ae(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Ce()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var Re=c(9044),Ne=c.n(Re),Ve=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(i[a[s]]=e[a[s]])}return i};const Pe=e=>{const t=window.SVG,{className:i}=e,a=Ve(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Ne()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var Fe=c(74919),Be=c.n(Fe),We=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(i[a[s]]=e[a[s]])}return i};const Je=e=>{const t=window.SVG,{className:i}=e,a=We(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Be()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var Ue=c(56431),He=c.n(Ue),ze=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(i[a[s]]=e[a[s]])}return i};const qe=e=>{const t=window.SVG,{className:i}=e,a=ze(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:He()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var Qe=c(26490),Ye=c.n(Qe),Ke=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(i[a[s]]=e[a[s]])}return i};const Xe=e=>{const t=window.SVG,{className:i}=e,a=Ke(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Ye()},a)):o.React.createElement("svg",Object.assign({className:s},a))},Ze=!1,Ge=e.Panel,_e=!0,$e=5e4,et=!0,tt={TYPE:t.Distance,UNIT:i.ft,INTERVAL:15};var it;!function(e){e[e.location_timestamp=0]="location_timestamp",e[e.Longitude=1]="Longitude",e[e.Latitude=2]="Latitude",e[e.altitude=3]="altitude",e[e.Orientation=4]="Orientation",e[e.speed=5]="speed",e[e.Accuracy=6]="Accuracy"}(it||(it={}));const at=["OBJECTID","location_timestamp","altitude","Orientation","speed","Accuracy","Latitude","Longitude"],st=["OBJECTID","StartTime","EndTime","AverageAltitude","AverageSpeed","AverageAccuracy"],nt=[{storeName:"location",indexName:"timeIndex",indexKey:"location_timestamp",keyPath:"OBJECTID"},{storeName:"path-point",indexName:"lineIdIndex",indexKey:"LineID",keyPath:"OBJECTID"},{storeName:"path",indexName:"timeIndex",indexKey:"EndTime",keyPath:"OBJECTID"}];var ot=c(50152),rt=c(59620);function lt(e){const{highlightLocation:t,position:i,jimuMapView:a,showCompassOrientation:s,showLocationAccuracy:n,graphicsLayerId:r,watchLocation:l,layerVisible:d}=e,u=(0,z.useRef)(null),p=(0,z.useRef)(null),h=(0,z.useRef)(null),m=c(95684),g=c(30563),f={type:"simple-fill",color:"rgba(11,100,244,0.2)",style:"solid",outline:{color:"rgba(11,100,244,0.2)",width:1}},y={type:"picture-marker",url:g,width:48,height:48,angle:0},v={type:"picture-marker",url:m,width:18,height:18};function S(){if(e.position){const{longitude:t,latitude:i,accuracy:a,heading:s}=e.position,o=t,r=i;!function(e,t,i){if(n&&null!=i){const a=new ot.default({center:{x:e,y:t},geodesic:!0,numberOfPoints:60,radius:i,radiusUnit:"meters"});if(h.current)h.current.geometry=a;else{const e=new q.default({geometry:a,symbol:f});b(e),h.current=e}}else h.current&&(a=h.current,u.current&&u.current.graphics.remove(a),h.current=null);var a}(o,r,a),function(t,i,a){const s={type:"point",x:t,y:i};if(p.current)p.current.geometry=s;else{const e=new q.default({geometry:s});p.current=e,b(e)}e.showCompassOrientation&&null!=a?(y.angle=a,p.current.symbol=y):p.current.symbol=v}(o,r,s)}else u.current&&u.current.removeAll(),p.current=null,h.current=null}function w(){var e,t,i,s;if(u.current&&a&&(null===(t=null===(e=null==a?void 0:a.view)||void 0===e?void 0:e.map)||void 0===t||t.remove(u.current),u.current=null,p.current=null,h.current=null),a){const e=new rt.default({id:r,listMode:"hide",title:r,visible:d});(null===(s=null===(i=null==a?void 0:a.view)||void 0===i?void 0:i.map)||void 0===s?void 0:s.findLayerById(r))||(u.current=e,a.view.map.layers.on("after-add",(()=>{const e=a.view.map.layers;let t=-1;const i=[];e.forEach(((e,a)=>{"-point-of-sight-track-layer"===e.id.slice(-27)&&i.push(a),e.id===r&&(t=a)})),1===i.length&&t!==e.length-1?e.reorder(e.getItemAt(t),e.length-1):-1===t||i.includes(t)||e.reorder(e.getItemAt(t),e.length-1)})),a.view.map.add(e)),S()}}function x(){var e,t;u.current&&a&&(null===(t=null===(e=null==a?void 0:a.view)||void 0===e?void 0:e.map)||void 0===t||t.remove(u.current)),u.current=null,p.current=null,h.current=null}function b(e){u.current&&u.current.graphics.add(e)}return o.React.useEffect((()=>()=>{x()}),[]),o.React.useEffect((()=>{u.current&&(u.current.visible=d)}),[d]),o.React.useEffect((()=>{a&&t?w():x()}),[a]),o.React.useEffect((()=>{t?w():x()}),[t,l]),o.React.useEffect((()=>{a&&u.current&&S()}),[i,s,n]),null}var ct=c(45508),dt=c.n(ct),ut=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(i[a[s]]=e[a[s]])}return i};const pt=e=>{const t=window.SVG,{className:i}=e,a=ut(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:dt()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var ht=c(35737),mt=c.n(ht),gt=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(i[a[s]]=e[a[s]])}return i};const ft=e=>{const t=window.SVG,{className:i}=e,a=gt(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:mt()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var yt=c(23001),vt=c.n(yt),St=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(i[a[s]]=e[a[s]])}return i};const wt=e=>{const t=window.SVG,{className:i}=e,a=St(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:vt()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var xt=c(31795),bt=c.n(xt),jt=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(i[a[s]]=e[a[s]])}return i};const Lt=e=>{const t=window.SVG,{className:i}=e,a=jt(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:bt()},a)):o.React.createElement("svg",Object.assign({className:s},a))},Tt=e=>null==e||""===e,kt=(e,t)=>parseFloat(e.toFixed(t)),Dt=(e,t,i)=>{let a=i;switch(t){case"location_timestamp":case"StartTime":case"EndTime":a=((e,t)=>{let i,a;if(i=window.jimuConfig.isBuilder?(0,o.getAppStore)().getState().appStateInBuilder.appConfig.attributes.timezone:(0,o.getAppStore)().getState().appConfig.attributes.timezone,(null==i?void 0:i.type)===o.TimezoneConfig.Specific){const e=o.dataSourceUtils.getTimeZoneOffsetByName(i.value);a=t-o.dataSourceUtils.getLocalTimeOffset()+e}else a=t;return o.dateUtils.formatDateField(a,"shortDateLongTime24",e)})(e,i);break;case"Longitude":a=i>=0?`${i} \xb0E`:`${i} \xb0W`;break;case"Latitude":a=i>=0?`${i} \xb0N`:`${i} \xb0S`;break;case"speed":case"AverageSpeed":a=Tt(i)?"":`${i} ${e.formatMessage({id:"speedUnit",defaultMessage:J})}`;break;case"Orientation":a=Tt(i)?"":`${i} \xb0`;break;case"Accuracy":case"AverageAccuracy":case"altitude":case"AverageAltitude":a=Tt(i)?"":`${i} ${e.formatMessage({id:"altitudeUnit",defaultMessage:U})}`}return a};function Et(e){return e*(Math.PI/180)}class It extends o.React.PureComponent{constructor(e){super(e),this.getStyle=()=>o.css`
    border: 1px solid ${this.props.theme.sys.color.divider.tertiary};
    padding: 3px;
    width: 100%;
    display:flex;
    justify-content: space-between;
    flex-direction: column;
    margin: 5px auto;
    cursor: pointer;
    .head{
        width: 100%;
        font-weight: var(--ref-typeface-font-weight-medium);
        color: var(--ref-palette-black);
        display:flex;
        justify-content: space-between;
        .title{
            display: flex;
            justify-content: center;
            align-items: center;
            .arrow-icon{
                height: 8px;
                width: 8px;
                cursor: pointer;
            }
            .time{
                font-size:14px;
                font-weight: var(--ref-typeface-font-weight-medium);
                margin-left:5px;
            }
        }
        .del-icon{
            height: 16px;
            width: 16px;
            cursor: pointer;
        }
    }    
    .props{
        display:flex;
        flex-direction:column;
        margin-left: 22px;
        .prop{
            margin-top:2px;
            display:flex;
            justify-content: flex-start;
            vertical-align:middle
            .attr{
                line-height:18px;
                font-weight: var(--ref-typeface-font-weight-regular);
            }
            .val{
                margin-left: 5px;
            }
        }
    }
  `,this.state={open:!1}}handleSel(e){this.props.onHandleSelect(e,!this.props.active)}render(){const e=this.props.isLine?"trackline_point":"track",t=re(this.props.intl,"",e),i=null==t?void 0:t.fields,a=this.props.track,s=this.state.open;return(0,o.jsx)("div",{className:"track-item"+(this.props.active?" active":""),key:a.location_timestamp,css:this.getStyle(),onClick:()=>{this.handleSel(a)}},(0,o.jsx)("div",{className:"head"},(0,o.jsx)("div",{className:"title"},(0,o.jsx)(r.Button,{"aria-label":this.props.intl.formatMessage({id:s?"collapse":"expand"}),className:(0,o.classNames)("p-0 jimu-outline-inside",{expanded:s}),type:"tertiary",icon:!0,size:"sm",onClick:e=>{e.stopPropagation(),this.setState({open:!s})}},s?(0,o.jsx)(ft,{size:"s"}):(0,o.jsx)(wt,{size:"s",autoFlip:!0})),(0,o.jsx)("div",{className:"time"},Dt(this.props.intl,"location_timestamp",a.location_timestamp))),(0,o.jsx)(r.Tooltip,{title:this.props.intl.formatMessage({id:"delTrack",defaultMessage:v}),placement:"right"},(0,o.jsx)(r.Button,{className:"ml-auto",icon:!0,size:"sm",type:"tertiary",onClick:e=>{e.stopPropagation(),this.props.onHandleDelete(a)},"aria-label":this.props.intl.formatMessage({id:"delTrack",defaultMessage:v})},(0,o.jsx)(Lt,{size:16})))),s&&(0,o.jsx)("div",{className:"props"},this.props.selectedFields.map((e=>{var t;return(0,o.jsx)("div",{className:"prop",key:e},(0,o.jsx)("div",{className:"attr"},null===(t=i[e])||void 0===t?void 0:t.alias,":"),(0,o.jsx)("div",{className:"val"},Dt(this.props.intl,e,a[e])))}))))}}const Mt=(0,o.injectIntl)(It),Ct=(0,o.injectIntl)((e=>{const{selectedFields:t,isLine:i,tracks:a,theme:s,selectedIds:n,notFilterPointIds:r,tempTracksWithLine:l,onHandleSelect:c,onHandleDelete:d,intl:u}=e,p=o.css`
    width: 100%;
    height: 100%;
    overflow: auto;
    display:flex;
    flex-direction:column;
    margin:5px auto;
    .horizontal-line{
      position: relative;
      text-align: center; 
      margin: 8px 0;
    }
    .horizontal-line::before,
    .horizontal-line::after {
      content: "";
      display: block;
      width: 30%; 
      border-top: 1px solid ${s.sys.color.divider.tertiary};
      position: absolute;
      top: 50%; 
    }
    .horizontal-line::before {
      left: 0; 
    }
    .horizontal-line::after {
      right: 0;
    }
    .text {
      color: var(--ref-palette-neutral-1200);
      display: inline-block; 
      padding: 0 10px; 
      position: relative;
      z-index: 1; 
    }
    .active{
      border: 1px solid var(--sys-color-primary-main);
    }
  `,h=u.formatMessage({id:"trackLineDivide",defaultMessage:j}),m=a.map(((e,u)=>i?(0,o.jsx)("div",{key:u},a.length>1&&r.length>1&&!(l&&0===u)&&(0,o.jsx)("div",{className:"horizontal-line"},(0,o.jsx)("span",{className:"text"},h," ",a.length-u)),(e=>e.map((e=>r.includes(e.OBJECTID)?(0,o.jsx)(Mt,{key:e.OBJECTID,theme:s,track:e,isLine:!0,selectedFields:t,active:null==n?void 0:n.includes(e.OBJECTID.toString()),onHandleSelect:c,onHandleDelete:d}):null)))(e)):r.includes(e.OBJECTID)?(0,o.jsx)(Mt,{key:e.OBJECTID,theme:s,track:e,isLine:!1,selectedFields:t,active:null==n?void 0:n.includes(e.OBJECTID.toString()),onHandleSelect:c,onHandleDelete:d}):null));return(0,o.jsx)("div",{className:"track-list-items",css:p},m)}));class At extends o.React.PureComponent{constructor(){super(...arguments),this.trackLabel=this.props.intl.formatMessage({id:"trackLabel",defaultMessage:p}),this.mvManager=n.MapViewManager.getInstance(),this.widgetStyle=o.css`
  flex: 1 1 auto;
  width:100%;
  display:flex;
  flex-direction:column;
  align-items: flex-start;
  overflow: auto;
  .track-head{
    height:26px;
    line-height: 26px;
    display:flex;
    align-items:center;
    justify-content: flex-start;
    .track-name{
      font-size:13px;
      font-weight:  var(--ref-typeface-font-weight-regular);
    }
    .visible-icon{
      height:16px;
      width:16px;
      margin-left: 5px;
      cursor: pointer;
    }
  }
`,this.handleSelect=(e,t)=>{var i,a;let s=[];if(t){s=this.props.selectedIds.concat([e.OBJECTID.toString()]);let t=null;t=pe(e),t&&this.props.jimuMapView&&n.zoomToUtils.zoomTo(null===(i=this.props.jimuMapView)||void 0===i?void 0:i.view,[t],{scale:null!==(a=this.props.scale)&&void 0!==a?a:5e4,padding:{left:10,right:10,top:10,bottom:10}})}else s=this.props.selectedIds.filter((t=>t!==e.OBJECTID.toString()));this.props.dataSource&&this.props.dataSource.selectRecordsByIds(s.map((e=>e.toString())))}}render(){const e=this.props.layerVisible?this.props.intl.formatMessage({id:"hideOnMap",defaultMessage:w}):this.props.intl.formatMessage({id:"showOnMap",defaultMessage:S});return(0,o.jsx)("div",{className:"track-content",css:this.widgetStyle},(0,o.jsx)("div",{className:"track-head"},(0,o.jsx)("div",{className:"track-name"},this.trackLabel),(0,o.jsx)(r.Tooltip,{title:e,placement:"bottom"},(0,o.jsx)(r.Button,{className:"ml-auto",icon:!0,size:"sm",type:"tertiary",onClick:()=>{this.props.handleLayerVisibleChange([this.props.dataSourceId],!this.props.layerVisible,1)},"aria-label":e},this.props.layerVisible&&(0,o.jsx)(Te,null),!this.props.layerVisible&&(0,o.jsx)(Xe,null)))),this.props.tracks.length>0&&(0,o.jsx)(Ct,{theme:this.props.theme,tracks:this.props.tracks,isLine:!1,selectedFields:this.props.selectedFields,onHandleSelect:this.handleSelect,onHandleDelete:this.props.onHandleDelete,selectedIds:this.props.selectedIds,notFilterPointIds:this.props.notFilterPointIds}),0===this.props.tracks.length&&!this.props.loading&&(0,o.jsx)("div",{className:"empty-content"},(0,o.jsx)(pt,{className:"info-icon",size:24,color:this.props.theme.sys.color.surface.paperHint}),(0,o.jsx)("div",{className:"info-txt"},this.props.intl.formatMessage({id:"emptyStateText",defaultMessage:g}))))}}const Ot=(0,o.injectIntl)(At);class Rt extends o.React.PureComponent{constructor(e){super(e),this.state={open:!1}}getStyle(){return o.css`
    border: 1px solid ${this.props.theme.sys.color.divider.tertiary};
    padding: 3px;
    width: 100%;
    display:flex;
    justify-content: space-between;
    flex-direction: column;
    cursor: pointer ;
    .head{
        width: 100%;
        font-weight: var(--ref-typeface-font-weight-medium);
        color: var(--ref-palette-black);
        display:flex;
        justify-content: space-between;
        .title{
            display: flex;
            justify-content: center;
            align-items: center;
            .arrow-icon{
                height: 8px;
                width: 8px;
                cursor: pointer;
            }
            .time{
                font-size:14px;
                font-weight: var(--ref-typeface-font-weight-medium);
                margin-left:5px;
            }
        }
        .del-icon{
            height: 16px;
            width: 16px;
            cursor: pointer;
        }
    }
    .active{
      border: 1px solid var(--sys-color-primary-main);
    }
    .props{
      display:flex;
      flex-direction:column;
      .prop{
          margin-top:2px;
          display:flex;
          justify-content: flex-start;
          vertical-align:middle
          .attr{
              line-height:18px;
              font-weight: var(--ref-typeface-font-weight-regular);
          }
          .val{
              margin-left: 5px;
          }
      }
    }
`}handleSel(e){this.props.onHandleSelect(e,!this.props.active)}render(){const e=re(this.props.intl,"","trackline"),t=null==e?void 0:e.fields,i=this.props.track,a=this.state.open;return(0,o.jsx)("div",{className:"track-item"+(this.props.active?" active":""),key:i.EndTime,css:this.getStyle(),onClick:()=>{this.handleSel(i)}},(0,o.jsx)("div",{className:"head"},(0,o.jsx)("div",{className:"title"},(0,o.jsx)(r.Button,{"aria-label":this.props.intl.formatMessage({id:a?"collapse":"expand"}),className:(0,o.classNames)("p-0 jimu-outline-inside",{expanded:a}),type:"tertiary",icon:!0,size:"sm",onClick:e=>{e.stopPropagation(),this.setState({open:!a})}},a?(0,o.jsx)(ft,{size:"s"}):(0,o.jsx)(wt,{size:"s",autoFlip:!0})),(0,o.jsx)("div",{className:"time"},Dt(this.props.intl,"EndTime",i.EndTime))),(0,o.jsx)(r.Tooltip,{title:this.props.intl.formatMessage({id:"delTrack",defaultMessage:v}),placement:"right"},(0,o.jsx)(r.Button,{className:"ml-auto",icon:!0,size:"sm",type:"tertiary",onClick:e=>{e.stopPropagation(),this.props.onHandleDelete(i)},"aria-label":this.props.intl.formatMessage({id:"delTrack",defaultMessage:v})},(0,o.jsx)(Lt,{size:16})))),a&&(0,o.jsx)("div",{className:"props"},st.map((e=>{var a;return(0,o.jsx)("div",{className:"prop",key:e},(0,o.jsx)("div",{className:"attr"},null===(a=t[e])||void 0===a?void 0:a.alias,":"),(0,o.jsx)("div",{className:"val"},Dt(this.props.intl,e,i[e])))}))))}}const Nt=(0,o.injectIntl)(Rt);class Vt extends o.React.PureComponent{constructor(e){super(e),this.widgetStyle=o.css`
      width: 100%;
      height: 100%;
      overflow: auto;
      display:flex;
      flex-direction:column;
      margin:5px auto;
      .track-item{
          border: 1px solid ${this.props.theme.sys.color.divider.tertiary};
          padding: 3px;
          margin: 5px auto;
          width: 100%;
          display:flex;
          justify-content: space-between;
          flex-direction: column;
          .head{
              width: 100%;
              font-weight: var(--ref-typeface-font-weight-medium);
              color: var(--ref-palette-black);
              display:flex;
              justify-content: space-between;
              .title{
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  .arrow-icon{
                      height: 8px;
                      width: 8px;
                      cursor: pointer;
                  }
                  .time{
                      font-size:14px;
                      font-weight: var(--ref-typeface-font-weight-medium);
                      margin-left:5px;
                  }
              }
              .del-icon{
                  height: 16px;
                  width: 16px;
                  cursor: pointer;
              }       
          }
          .props{
              display:flex;
              flex-direction:column;
              margin-left: 22px;
              .prop{
                  margin-top:2px;
                  display:flex;
                  justify-content: flex-start;
                  vertical-align:middle;
                  .attr{
                      line-height:18px;
                      font-weight: var(--ref-typeface-font-weight-regular);
                  }
                  .val{
                      margin-left: 5px;
                  }
              }
          }
      }
      .active{
        border: 1px solid var(--sys-color-primary-main);
      }
  `,this.state={}}render(){const e=this.props.trackLines.map(((e,t)=>{var i;return this.props.tempTracksWithLine&&e.OBJECTID===this.props.tempTracksWithLine.line.OBJECTID?null:this.props.notFilterLineIds.includes(e.OBJECTID)?(0,o.jsx)(Nt,{key:t,theme:this.props.theme,track:e,active:null===(i=this.props.selectedIds)||void 0===i?void 0:i.includes(e.OBJECTID.toString()),onHandleSelect:this.props.onHandleSelect,onHandleDelete:this.props.onHandleDelete}):null}));return(0,o.jsx)("div",{className:"track-list-items",css:this.widgetStyle},e)}}const Pt=(0,o.injectIntl)(Vt),Ft=o.css`
    flex: 1 1 auto;
    width: 100%;
    overflow: auto;
    height: calc(100% - 102px);
    display:flex;
    flex-direction:column;
    .track-tab {
      height: 100%;      
      width: 100%;
      ul{
        align-items: center;
      }
    }
`;class Bt extends o.React.PureComponent{constructor(e){super(e),this.trackLabel=this.props.intl.formatMessage({id:"_widgetLabel",defaultMessage:u}),this.handleTabsChange=e=>{this.setState({activeTab:e}),"track_trackline_point_ouput"===e?this.props.handleCurrentDataSource(this.props.dataSourceId):this.props.handleCurrentDataSource(this.props.lineDataSourceId)},this.handleSelect=(e,t,i,a,s)=>{var o,r;let l=[];if(t){l=this.props[a].concat([e.OBJECTID.toString()]);let t=null;if("point"===s)t=pe(e);else if("line"===s){const i=this.props.tracks.filter((t=>t.some((t=>t.LineID===e.OBJECTID))))[0];t=he(e,i)}t&&this.props.jimuMapView&&n.zoomToUtils.zoomTo(null===(o=this.props.jimuMapView)||void 0===o?void 0:o.view,[t],{scale:null!==(r=this.props.scale)&&void 0!==r?r:5e4,padding:{left:10,right:10,top:10,bottom:10}})}else l=this.props[a].filter((t=>t!==e.OBJECTID.toString()));i&&i.selectRecordsByIds(l.map((e=>e.toString())))},this.handlePointSelect=(e,t)=>{this.handleSelect(e,t,this.props.dataSource,"selectedPointIds","point")},this.handleLineSelect=(e,t)=>{this.handleSelect(e,t,this.props.lineDataSource,"selectedLineIds","line")},this.state={activeTab:"track_trackline_point_ouput",showFromMap:!0,lineShowFromMap:!0,points:[],startTime:null}}render(){const e=this.props.locationLayerVisible?this.props.intl.formatMessage({id:"hideOnMap",defaultMessage:w}):this.props.intl.formatMessage({id:"showOnMap",defaultMessage:S}),t=this.props.intl.formatMessage({id:"trackLine",defaultMessage:b}),i=this.props.intl.formatMessage({id:"track",defaultMessage:x}),a=(0,o.jsx)("div",null,i,(0,o.jsx)(r.Tooltip,{title:e,placement:"bottom"},(0,o.jsx)(r.Button,{className:"ml-auto",icon:!0,size:"sm",type:"tertiary",onClick:e=>{e.stopPropagation(),this.props.handleLayerVisibleChange([this.props.dataSourceId],!this.props.locationLayerVisible,1)},"aria-label":e},this.props.locationLayerVisible&&(0,o.jsx)(Te,null),!this.props.locationLayerVisible&&(0,o.jsx)(Xe,null)))),s=(0,o.jsx)("div",null,t,(0,o.jsx)(r.Tooltip,{title:e,placement:"bottom"},(0,o.jsx)(r.Button,{className:"ml-auto",icon:!0,size:"sm",type:"tertiary",onClick:e=>{e.stopPropagation(),this.props.handleLayerVisibleChange([this.props.lineDataSourceId],!this.props.pathLayerVisible,2)},"aria-label":e},this.props.pathLayerVisible&&(0,o.jsx)(Te,null),!this.props.pathLayerVisible&&(0,o.jsx)(Xe,null))));return(0,o.jsx)("div",{css:Ft},(0,o.jsx)(r.Tabs,{type:"underline",fill:!0,className:"track-tab",defaultValue:"track",value:this.state.activeTab,onChange:this.handleTabsChange},(0,o.jsx)(r.Tab,{id:"track_trackline_point_ouput",className:"w-50",title:a},"track_trackline_point_ouput"===this.state.activeTab&&this.props.tracks.length>0&&(0,o.jsx)(Ct,{theme:this.props.theme,isLine:!0,tracks:this.props.tracks,tempTracksWithLine:this.props.tempTracksWithLine,selectedFields:this.props.selectedFields,selectedIds:this.props.selectedPointIds,notFilterPointIds:this.props.notFilterPointIds,onHandleSelect:this.handlePointSelect,onHandleDelete:e=>{this.props.onHandleLineDelete(e,null,"point")}}),0===this.props.tracks.length&&!this.props.loading&&(0,o.jsx)("div",{className:"empty-content"},(0,o.jsx)(pt,{className:"info-icon",size:24,color:this.props.theme.sys.color.surface.paperHint}),(0,o.jsx)("div",{className:"info-txt"},this.props.intl.formatMessage({id:"emptyStateText",defaultMessage:g})))),(0,o.jsx)(r.Tab,{id:"track_trackline_ouput",className:"w-50",title:s},"track_trackline_ouput"===this.state.activeTab&&this.props.trackLines.length>0&&(0,o.jsx)(Pt,{theme:this.props.theme,trackLines:this.props.trackLines,tempTracksWithLine:this.props.tempTracksWithLine,selectedIds:this.props.selectedLineIds,notFilterPointIds:this.props.notFilterPointIds,notFilterLineIds:this.props.notFilterLineIds,onHandleSelect:this.handleLineSelect,onHandleDelete:e=>{this.props.onHandleLineDelete(null,e,"line")}}),0===this.props.trackLines.length&&!this.props.loading&&(0,o.jsx)("div",{className:"empty-content"},(0,o.jsx)(pt,{className:"info-icon",size:24,color:this.props.theme.sys.color.surface.paperHint}),(0,o.jsx)("div",{className:"info-txt"},this.props.intl.formatMessage({id:"emptyStateText",defaultMessage:f}))))))}}const Wt=(0,o.injectIntl)(Bt);var Jt=function(e,t,i,a){return new(i||(i=Promise))((function(s,n){function o(e){try{l(a.next(e))}catch(e){n(e)}}function r(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((a=a.apply(e,t||[])).next())}))};function Ut(e){return Jt(this,void 0,void 0,(function*(){var t,i;const a=yield function(){return Jt(this,void 0,void 0,(function*(){if("function"==typeof indexedDB.databases){return(yield indexedDB.databases()).map((e=>e.name||""))}return[]}))}(),s=null===(i=null===(t=(0,o.getAppStore)().getState())||void 0===t?void 0:t.appConfig)||void 0===i?void 0:i.widgets;if(void 0!==s){const t=Object.keys(s).filter((t=>s[t].manifest.name===e)).map((t=>function(e,t){var i,a;return`exb-${(null===(i=window.jimuConfig)||void 0===i?void 0:i.isBuilder)?null===(a=(0,o.getAppStore)().getState().appStateInBuilder)||void 0===a?void 0:a.appId:(0,o.getAppStore)().getState().appId}-${t}-${e}-cache`}(t,e)));a.forEach((e=>{t.includes(e)||function(e){o.utils.removeFromLocalStorage(nt[0].storeName),o.utils.removeFromLocalStorage(nt[1].storeName),o.utils.removeFromLocalStorage(nt[2].storeName);const t=indexedDB.deleteDatabase(e);o.indexedDBUtils.whenRequest(t)}(e)}))}}))}var Ht=function(e,t,i,a){return new(i||(i=Promise))((function(s,n){function o(e){try{l(a.next(e))}catch(e){n(e)}}function r(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((a=a.apply(e,t||[])).next())}))};const zt={enableHighAccuracy:!0,timeout:5e3,maximumAge:0},qt=e=>{navigator.geolocation&&navigator.geolocation.clearWatch(e)},Qt=e=>{const t=e.location_timestamp;return{tracks:[e],line:{StartTime:t,EndTime:t,OBJECTID:e.LineID,AverageAltitude:null!==e.altitude?kt(e.altitude,2):null,AverageSpeed:null!==e.speed?kt(e.speed,2):null,AverageAccuracy:null!==e.Accuracy?kt(e.Accuracy,2):null}}},Yt=()=>Ht(void 0,void 0,void 0,(function*(){return(yield new Promise(((e,t)=>{if("undefined"!=typeof navigator&&"geolocation"in navigator){const i=navigator;"permissions"in navigator?navigator.permissions.query({name:"geolocation"}).then((i=>{"granted"===i.state?e(!0):"prompt"===i.state?navigator.geolocation.getCurrentPosition((()=>{e(!0)}),(i=>{i.code===i.PERMISSION_DENIED?e(!1):t("Geolocation error: "+i.message)})):"denied"===i.state&&e(!1)})).catch((e=>{t("Permissions API error: "+e.message)})):i.geolocation.getCurrentPosition((()=>{e(!0)}),(i=>{i.code===i.PERMISSION_DENIED?e(!1):t("Geolocation error: "+i.message)}))}else t("Geolocation is not supported by this browser.")})).catch((e=>{console.log(e)})))||!1}));var Kt=function(e,t,i,a){return new(i||(i=Promise))((function(s,n){function o(e){try{l(a.next(e))}catch(e){n(e)}}function r(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((a=a.apply(e,t||[])).next())}))};class Xt extends o.WidgetVersionManager{constructor(){super(...arguments),this.versions=[{version:"1.16.0",description:"Upgrade my location setting config for selectedFields, and use output dataSources with fields",upgradeFullInfo:!0,upgrader:e=>Kt(this,void 0,void 0,(function*(){const t={ObjectID:"OBJECTID",Time:"location_timestamp",Altitude:"altitude",Speed:"speed",LineId:"LineID"};let i=e.widgetJson.config;if(null==i?void 0:i.selectedFields){const e=i.selectedFields,a=[...i.selectedFields];e.forEach(((e,i)=>{Object.keys(t).includes(e)&&(a[i]=t[e])})),i=i.setIn(["selectedFields"],a)}const a=e.widgetJson.outputDataSources;let s=e.outputDataSourceJsons;s&&a.forEach((e=>{const i=s[e].schema.fields,a=Object.assign({},i);Object.keys(i).forEach((n=>{if(Object.keys(t).includes(n)){const r=Object.assign({},i[n]);r.name===s[e].schema.idField&&(r.esriType=o.EsriFieldType.OID),r.name=t[n],r.jimuName=t[n],delete a[n],a[t[n]]=r}})),s=s.setIn([e,"schema","fields"],a),Object.keys(t).includes(s[e].schema.idField)&&(s=s.setIn([e,"schema","idField"],t[s[e].schema.idField]))}));return{widgetJson:e.widgetJson.set("config",i),outputDataSourceJsons:s}}))}]}}const Zt=new Xt;var Gt=function(e,t,i,a){return new(i||(i=Promise))((function(s,n){function o(e){try{l(a.next(e))}catch(e){n(e)}}function r(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((a=a.apply(e,t||[])).next())}))};class _t extends o.React.PureComponent{constructor(e){var t,i,a,s,r;super(e),this.dsManager=o.DataSourceManager.getInstance(),this.mvManager=n.MapViewManager.getInstance(),this.trackLabel=this.props.intl.formatMessage({id:"_widgetLabel",defaultMessage:u}),this.locationDataSourceKey=me(this.props.id,"location"),this.pathDataSourceKey=me(this.props.id,"path"),this.resetObjectKeys=()=>{o.utils.setLocalStorage(this.locationDataSourceKey,"0"),o.utils.setLocalStorage(this.pathDataSourceKey,"0")},this.onTrackDataSourceCreated=e=>{this.setState({trackSource:e}),e&&(this.setState((t=>({dataSources:t.dataSources.concat(e)}))),this.setState({currentDataSourceId:e.id}))},this.onLineDataSourceCreated=e=>{this.setState({lineDataSource:e}),e&&this.setState((t=>({dataSources:t.dataSources.concat(e)})))},this.onCreateDataSourceFailed=()=>{},this.onLinesChanges=(e,t=0)=>{this.setState({trackLines:e}),this.state.currentDataSourceId===this.state.lineDataSource.id&&this.setState({showActionBtn:t>0})},this.onLinePointsRecordsChanges=(e,t)=>{this.setState({trackLinePoints:e});const i=Array.from(new Set(e.map((e=>e.LineID)))).sort(((e,t)=>t-e)).map((t=>e.filter((e=>e.LineID===t)).sort(((e,t)=>t.OBJECTID-e.OBJECTID))));this.setState({trackLinePointsList:i}),this.state.currentDataSourceId===this.state.trackSource.id&&this.setState({showActionBtn:t>0})},this.onTracksChange=(e,t=0)=>{this.setState({tracks:e,showActionBtn:t>0})},this.handleTabsChange=e=>{this.setState({activeTab:e})},this.handleTrackPath=()=>{if(0===this.state.points.length)return void this.handleWarning(2);const e=Object.assign({},this.state.points[this.state.points.length-1]);e.OBJECTID=ge(this.locationDataSourceKey),e.LineID=ge(this.pathDataSourceKey);const t=Qt(e);this.setState({points:[e],operationRecords:[e],locationOperation:H.ADD,tracksWithLine:this.state.tempTracksWithLine,operation:H.ADD,tempTracksWithLine:t})},this.handleWatchingFinished=e=>{if(e&&this.state.tempTracksWithLine&&this.state.tempTracksWithLine.line&&this.state.tempTracksWithLine.tracks&&this.state.tempTracksWithLine.tracks.length>0){const e=this.state.trackLines.concat([this.state.tempTracksWithLine.line]);this.onLinesChanges(e)}0===this.state.points.length?(this.handleWarning(2),this.setState({operationRecords:[],locationOperation:H.CREATE,operation:H.CREATE,tempTracksWithLine:null,tracksWithLine:null,points:[],position:null})):this.setState({operationRecords:[],locationOperation:H.CREATE,tempTracksWithLine:null,points:[],position:null,operation:H.ADD,tracksWithLine:this.state.tempTracksWithLine})},this.clearStores=()=>Gt(this,void 0,void 0,(function*(){return this.setState({operation:H.CLEAR,locationOperation:H.CLEAR,position:null,tracks:[],track:null,trackLines:[],trackLinePointsList:[],operationRecords:[],trackLinePoints:[],tracksWithLine:null,points:[],tempTracksWithLine:null,showActionBtn:!1,locationLayerVisible:!0,pathLayerVisible:!0}),Promise.resolve()})),this.handleConfirmOk=()=>{switch(this.state.confirmType){case"point":this.handleDelete(this.state.deleteTrackArgs);break;case"line":this.onHandleLineDelete(this.state.deleteLineArgs);break;case"clear":this.clearStores()}this.setState({clearRecordsConfirmOpen:!1})},this.handleSelection=(e,t)=>{"point"===t?this.setState({selectedPointIds:e}):"line"===t&&this.setState({selectedLineIds:e})},this.handleFilter=(e,t)=>{"point"===t?this.setState({notFilterPointIds:e}):"line"===t&&this.setState({notFilterLineIds:e})},this.onActiveViewChange=e=>Gt(this,void 0,void 0,(function*(){e&&e.view&&(yield e.whenAllJimuLayerViewLoaded().finally((()=>{this.setState({loading:!1})})),this.setState({loading:!1}),this.setState({jimuMapView:e}))})),this.handleCurrentDataSource=e=>Gt(this,void 0,void 0,(function*(){const t=this.dsManager.getDataSource(e),i=yield null==t?void 0:t.queryCount({where:"1=1",returnGeometry:!1},{scope:o.QueryScope.InRemoteConfigView});this.setState({currentDataSourceId:e,showActionBtn:(null==i?void 0:i.count)>0})})),this.state={mapViewWidgetId:null,jimuMapViews:null,jimuMapView:null,dataSources:[],dataSourceWidgetId:null,dataSourceLabel:"",activeTab:"track",isWarning:!1,warnType:1,trackSource:null,lineDataSource:null,track:null,tracking:!1,showActionBtn:!1,tracks:[],trackLines:[],trackLinePointsList:[],operationRecords:[],trackLinePoints:[],tracksWithLine:null,points:[],tempTracksWithLine:null,watchId:null,loading:!1,operation:H.CREATE,locationOperation:H.CREATE,clearRecordsConfirmOpen:!1,currentDataSourceId:null,selectedPointIds:[],selectedLineIds:[],notFilterPointIds:[],notFilterLineIds:[],position:null,confirmType:null,deleteLineArgs:{track:null,line:null,type:null},deleteTrackArgs:{track:null},isRendered:!1,graphicsLayerId:(r=this.props.id,`${r}-point-of-sight-track-layer`),locationLayerVisible:!0,pathLayerVisible:!0,selectedFields:null!==(i=null===(t=e.config.selectedFields)||void 0===t?void 0:t.asMutable())&&void 0!==i?i:at,selectedLineFields:null!==(s=null===(a=e.config.selectedLineFields)||void 0===a?void 0:a.asMutable())&&void 0!==s?s:st}}clearDataSources(e,t=!1){e&&(this.state.dataSources.forEach((t=>{((e,t)=>{if(t&&e){const i=e.getJimuLayerViewByDataSourceId(t);if(i){const t=i.getLayerDataSource();e.removeJimuLayerView(i),t&&(t.clearRecords(),null==t||t.setStatus(o.DataSourceStatus.NotReady),null==t||t.setCountStatus(o.DataSourceStatus.NotReady))}}})(e,t.id)})),t&&(this.state.dataSources.forEach((e=>{this.dsManager.destroyDataSource(e.id)})),this.setState({showActionBtn:!1,tracks:[],track:null,trackLines:[],tracksWithLine:null,tempTracksWithLine:null,operationRecords:[],points:[],trackLinePointsList:[],trackLinePoints:[],operation:null,dataSources:[],trackSource:null,lineDataSource:null}),this.resetObjectKeys()))}clearGraphicsLayer(e){var t,i;if(e){const a=null===(i=null===(t=null==e?void 0:e.view)||void 0===t?void 0:t.map)||void 0===i?void 0:i.findLayerById(this.state.graphicsLayerId);a&&e.view.map.remove(a)}this.setState({position:null})}defaultActivate(){var e,t;if(!window.jimuConfig.isInBuilder&&!this.state.isRendered){const{jimuMapView:i,dataSources:a}=this.state;if(i&&a.length>0){const i=null!==(e=this.props.config.watchLocation)&&void 0!==e?e:Ze;null!==(t=this.props.config.defaultActivation)&&void 0!==t&&t&&(i?this.state.tracking||this.handleTracking(!0):this.getLocation(),this.setState({isRendered:!0}))}}}componentDidMount(){this.setState({loading:!0}),Ut(this.props.manifest.name),window.addEventListener("beforeunload",this.resetObjectKeys)}componentWillUnmount(){this.clearWidget(),window.removeEventListener("beforeunload",this.resetObjectKeys)}componentDidUpdate(e,t){var i,a;const{mapWidgetId:s}=this.props,{jimuMapView:n}=this.state;e.config.selectedFields!==this.props.config.selectedFields&&this.setState({selectedFields:null!==(a=null===(i=this.props.config.selectedFields)||void 0===i?void 0:i.asMutable())&&void 0!==a?a:at}),e.config.watchLocation!==this.props.config.watchLocation&&(this.clearStores(),this.clearWidget()),this.state.isRendered||this.defaultActivate(),t.jimuMapView!==n&&this.state.tracking&&this.handleTracking(!1,!0),e.mapWidgetId!==s&&(this.state.tracking&&this.handleTracking(!1,!0),this.clearGraphicsLayer(n),t.jimuMapView&&!s&&(this.clearDataSources(t.jimuMapView,!1),this.setState({jimuMapView:null,jimuMapViews:null,currentDataSourceId:null})))}clearWidget(){const{jimuMapView:e}=this.state;this.clearGraphicsLayer(e),this.clearDataSources(e,!0),this.state.watchId&&qt(this.state.watchId),this.setState({tracking:!1,watchId:null,position:null})}getLocation(){return Gt(this,void 0,void 0,(function*(){var e,t;this.setState({loading:!0});if(!(yield Yt()))return this.handleWarning(),void this.setState({loading:!1});let i=setTimeout((()=>{this.handleWarning()}),1e3*(null!==(e=this.props.config.timeOut)&&void 0!==e?e:15));var a;(a=Object.assign(Object.assign({},zt),{timeout:1e3*(null!==(t=this.props.config.timeOut)&&void 0!==t?t:15)}),new Promise(((e,t)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition((t=>{e(t)}),(e=>{t(e)}),a||zt):t(new Error("Geolocation is not supported by this browser."))}))).then((e=>{var t,a;i&&(clearTimeout(i),i=null);const s=null==e?void 0:e.coords,n=kt(s.longitude,6),o=kt(s.latitude,6),r=Object.assign(Object.assign({},s),{accuracy:s.accuracy,heading:s.heading,longitude:n,latitude:o}),l={location_timestamp:Date.now(),Longitude:n,Latitude:o,altitude:Tt(s.altitude)?null:kt(s.altitude,2),Orientation:Tt(s.heading)?null:kt(s.heading,2),speed:Tt(s.speed)?null:kt(s.speed,2),Accuracy:s.accuracy?kt(s.accuracy,2):null,OBJECTID:ge(this.locationDataSourceKey)};this.setState({track:l,operation:H.ADD}),this.setState({position:(null!==(t=this.props.config.highlightLocation)&&void 0!==t?t:_e)?r:null}),this.setState({loading:!1}),ue(this.state.jimuMapView,[pe(l)],null!==(a=this.props.config.zoomScale)&&void 0!==a?a:$e)})).catch((()=>{i&&(clearTimeout(i),i=null),this.handleWarning(),this.setState({loading:!1}),this.setState({position:null})}))}))}updateTrackLine(e,t){var i;let a;t?(a=Qt(e),this.setState({operationRecords:[e],locationOperation:H.ADD,tempTracksWithLine:a})):(a=((e,t)=>{const i=e.location_timestamp,a=t.tracks.concat(e),s=["altitude","speed","Accuracy"],n={altitude:null,speed:null,Accuracy:null};return a.forEach((e=>{s.forEach((t=>{null!==e[t]&&void 0!==e[t]&&(n[t]=null!==n[t]?n[t]+e[t]:e[t])}))})),t.line.EndTime=i,t.line.AverageAltitude=null!==n.altitude?kt(n.altitude/a.length,2):null,t.line.AverageSpeed=null!==n.speed?kt(n.speed/a.length,2):null,t.line.AverageAccuracy=null!==n.Accuracy?kt(n.Accuracy/a.length,2):null,{tracks:a,line:t.line}})(e,this.state.tempTracksWithLine),this.setState({operationRecords:[e],locationOperation:H.ADD,tempTracksWithLine:a})),ue(this.state.jimuMapView,[he(a.line,a.tracks)],null!==(i=this.props.config.zoomScale)&&void 0!==i?i:$e)}keepPoint(e){var s;if(0===this.state.points.length)return!0;const n=this.state.points[this.state.points.length-1];if(e.timestamp-n.location_timestamp<1e3)return!1;if(n.Longitude===e.coords.longitude&&n.Latitude===e.coords.latitude)return!1;const o=null!==(s=this.props.config.watchLocationSettings)&&void 0!==s?s:{manualPathTracing:et,streaming:{type:tt.TYPE,unit:tt.UNIT,interval:tt.INTERVAL}};if(o.streaming.type===t.Distance){return((e,t,a,s,n)=>{const o=Et(a-e),r=Et(s-t),l=Math.sin(o/2)*Math.sin(o/2)+Math.cos(Et(e))*Math.cos(Et(a))*Math.sin(r/2)*Math.sin(r/2);let c=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6371;return n===i.ft?c*=3280.84:n===i.m&&(c*=1e3),c})(e.coords.longitude,e.coords.latitude,n.Longitude,n.Latitude,o.streaming.unit)>o.streaming.interval}if(o.streaming.type===t.Time&&o.streaming.unit===a.sec){return(r=Date.now(),l=n.location_timestamp,Math.abs(l-r)/1e3)>o.streaming.interval}var r,l}handleTracking(e){return Gt(this,arguments,void 0,(function*(e,t=!1){var i;let a;this.setState({tracking:e});const s=1e3*(null!==(i=this.props.config.timeOut)&&void 0!==i?i:15),n=()=>{a&&(clearTimeout(a),a=null),this.state.tracking&&(a=setTimeout((()=>{this.state.tracking&&(this.handleWarning(),n())}),s))};if(e){this.setState({loading:!0});const e=yield Yt();if(this.setState({loading:!1}),!e)return void this.handleWarning();n();const t=(o=e=>{var t,i;if(!this.keepPoint(e))return;n();const a=null==e?void 0:e.coords,s=kt(a.longitude,6),o=kt(a.latitude,6),r=Object.assign(Object.assign({},a),{accuracy:a.accuracy,heading:a.heading,longitude:s,latitude:o}),l={location_timestamp:Date.now(),Longitude:s,Latitude:o,altitude:Tt(a.altitude)?null:kt(a.altitude,2),Orientation:Tt(a.heading)?null:kt(a.heading,2),speed:Tt(a.speed)?null:kt(a.speed,2),Accuracy:a.accuracy?kt(a.accuracy,2):null,OBJECTID:ge(this.locationDataSourceKey),LineID:null};this.state.tempTracksWithLine?(l.LineID=this.state.tempTracksWithLine.line.OBJECTID,this.updateTrackLine(l,!1),this.setState({points:this.state.points.concat([l])})):(l.LineID=ge(this.pathDataSourceKey),this.updateTrackLine(l,!0),this.setState({points:[l]})),ue(this.state.jimuMapView,[pe(l)],null!==(t=this.props.config.zoomScale)&&void 0!==t?t:$e),this.setState({position:(null!==(i=this.props.config.highlightLocation)&&void 0!==i?i:_e)?r:null}),n()},r=()=>{n(),this.handleWarning()},l=Object.assign(Object.assign({},zt),{timeout:s}),navigator.geolocation?navigator.geolocation.watchPosition((e=>{o(e)}),(e=>{r?r(e):console.error(`Error watching position: ${e.message}`)}),l||zt):(console.error("Geolocation is not supported by this browser."),0));this.setState({watchId:t})}else a&&(clearTimeout(a),a=null),qt(this.state.watchId),this.setState({watchId:null}),this.handleWatchingFinished(t);var o,r,l}))}handleLayerVisibleChange(e,t,i){this.state.jimuMapView&&e.forEach((e=>{if(e){const a=this.state.jimuMapView.getJimuLayerViewByDataSourceId(e);a&&(a.layer.visible=t),1===i?this.setState({locationLayerVisible:t}):2===i?this.setState({pathLayerVisible:t}):3===i&&(this.setState({locationLayerVisible:t}),this.setState({pathLayerVisible:t}))}}))}handleClear(){this.setState({confirmType:"clear",clearRecordsConfirmOpen:!0})}handleDelete(e){const{track:t}=e;this.state.tracks.length>0&&this.state.tracks[0].OBJECTID===t.OBJECTID&&this.setState({position:null}),this.setState({operation:H.DELETE,track:t})}onHandleLineDelete(e){const{track:t,line:i,type:a}=e,s={tracks:[],line:null};if("point"===a){const e=this.state.trackLinePointsList.find((e=>e.some((e=>e.OBJECTID===t.OBJECTID))));s.line=this.state.trackLines.find((e=>e.OBJECTID===t.LineID));const i=e.filter((e=>e.OBJECTID!==t.OBJECTID));this.state.tempTracksWithLine&&this.state.tempTracksWithLine.line&&this.state.tempTracksWithLine.line.OBJECTID===t.LineID?0===i.length?(s.tracks=e,this.setState({position:null,operationRecords:e,locationOperation:H.DELETE,tracksWithLine:null,points:[],tempTracksWithLine:null})):(s.tracks=i,this.setState({operationRecords:[t],locationOperation:H.DELETE,tempTracksWithLine:s})):(s.tracks=1===i.length?e:i,this.setState({operationRecords:s.tracks,locationOperation:H.DELETE,operation:1===i.length?H.DELETE:H.UPDATE,tracksWithLine:s}))}else"line"===a&&(s.tracks=this.state.trackLinePointsList.find((e=>e.some((e=>e.LineID===i.OBJECTID)))),s.line=i,this.setState({operationRecords:s.tracks,locationOperation:H.DELETE,operation:H.DELETE,tracksWithLine:s}))}handleWarning(e=1){this.setState({isWarning:!0,warnType:e}),setTimeout((()=>{this.setState({isWarning:!1})}),3e3)}renderDataActionList(e,t){var i;if(!t)return null;const a=null===(i=this.state.dataSources)||void 0===i?void 0:i[e],s=0===e?this.state.selectedFields:this.state.selectedLineFields;return(0,o.jsx)(r.DataActionList,{widgetId:this.props.id,dataSets:[{dataSource:a,type:"selected",records:null==a?void 0:a.getSelectedRecords(),name:null==a?void 0:a.getLabel(),fields:s}],listStyle:r.DataActionListStyle.Dropdown,buttonType:"tertiary"})}render(){var t,i,a,s,d,u,p,g,f,v,x,b,j,I,M,C,A,O,R,N,V,P,F,B,W,J,U,H,z;const q="string"==typeof this.props.icon?this.props.icon:this.props.icon.svg,Q=null!==(t=this.props.config.watchLocation)&&void 0!==t?t:Ze,Y=null!==(i=this.props.config.arrangement)&&void 0!==i?i:Ge,K=null!==(s=null===(a=this.props.config.watchLocationSettings)||void 0===a?void 0:a.manualPathTracing)&&void 0!==s?s:et,X=null!==(u=null===(d=this.props.config.highlightInfo)||void 0===d?void 0:d.symbolColor)&&void 0!==u?u:"#007AC2",Z=null!==(p=this.props.config.highlightLocation)&&void 0!==p?p:_e,G=null!==(f=null===(g=this.props.config.highlightInfo)||void 0===g?void 0:g.showCompassOrientation)&&void 0!==f&&f,_=null!==(x=null===(v=this.props.config.highlightInfo)||void 0===v?void 0:v.showLocationAccuracy)&&void 0!==x&&x,$=null!==(b=this.props.config.zoomScale)&&void 0!==b?b:$e,ee=this.props.useMapWidgetIds&&this.props.useMapWidgetIds[0],te=null===(j=this.props.config.showRuntimeLayers)||void 0===j||j;let ie=null,ae=null;this.props.useMapWidgetIds&&1===this.props.useMapWidgetIds.length&&(ae=(0,o.jsx)(n.JimuMapViewComponent,{useMapWidgetId:null===(I=this.props.useMapWidgetIds)||void 0===I?void 0:I[0],onActiveViewChange:this.onActiveViewChange,onViewsCreate:e=>{this.setState({jimuMapViews:e})}}));const se=void 0===this.props.enableDataAction||this.props.enableDataAction;let ne=null,oe=null;if(null!==(M=this.props.config.useMapWidget)&&void 0!==M&&!M||!ee){const t=Y===e.Panel?this.trackLabel:null;ne=(0,o.jsx)("div",{className:Y===e.Toolbar?"widget-track-panel":"widget-track"},(0,o.jsx)(r.WidgetPlaceholder,{icon:c(48932),message:t,widgetId:this.props.id}))}else{let t=null,i=null,a=null;t=this.props.useMapWidgetIds&&1===this.props.useMapWidgetIds.length&&(null===(C=this.props.outputDataSources)||void 0===C?void 0:C.length)>0&&!Q&&this.state.jimuMapView?(0,o.jsx)(ye,{widgetId:this.props.widgetId,layerVisible:this.state.locationLayerVisible,highlightLocation:Z,symbolColor:X,track:this.state.track,tracks:this.state.tracks,operation:this.state.operation,showRuntimeLayers:te,selectedFields:this.state.selectedFields,onCreate:this.onTrackDataSourceCreated,onTracksChange:this.onTracksChange,onHandleSelection:this.handleSelection,onHandleFilter:this.handleFilter,handleLayerVisibleChange:(e,t)=>{this.handleLayerVisibleChange(e,t,1)},dataSourceId:null===(A=this.props.outputDataSources)||void 0===A?void 0:A[0],jimuMapView:this.state.jimuMapView}):null,this.props.useMapWidgetIds&&1===this.props.useMapWidgetIds.length&&(null===(O=this.props.outputDataSources)||void 0===O?void 0:O.length)>1&&Q&&this.state.jimuMapView?(i=(0,o.jsx)(xe,{widgetId:this.props.widgetId,layerVisible:this.state.locationLayerVisible,highlightLocation:Z,symbolColor:X,tracks:this.state.trackLinePoints,operationRecords:this.state.operationRecords,operation:this.state.locationOperation,dataSourceId:null===(R=this.props.outputDataSources)||void 0===R?void 0:R[0],jimuMapView:this.state.jimuMapView,showRuntimeLayers:te,selectedFields:this.state.selectedFields,onCreate:this.onTrackDataSourceCreated,onLinePointsRecordsChanges:this.onLinePointsRecordsChanges,onHandleSelection:this.handleSelection,onHandleFilter:this.handleFilter,handleLayerVisibleChange:(e,t,i)=>{this.handleLayerVisibleChange(e,t,i)}}),a=(0,o.jsx)(Se,{widgetId:this.props.widgetId,widgetLabel:this.props.manifest.name,layerVisible:this.state.pathLayerVisible,highlightLocation:Z,symbolColor:X,tracksWithLine:this.state.tracksWithLine,tempTracksWithLine:this.state.tempTracksWithLine,trackLines:this.state.trackLines,trackLinePoints:this.state.trackLinePointsList,operation:this.state.operation,dataSourceId:null===(N=this.props.outputDataSources)||void 0===N?void 0:N[1],jimuMapView:this.state.jimuMapView,onLinesChanges:this.onLinesChanges,onHandleFilter:this.handleFilter,showRuntimeLayers:te,onCreate:this.onLineDataSourceCreated,onHandleSelection:this.handleSelection,handleLayerVisibleChange:(e,t,i)=>{this.handleLayerVisibleChange(e,t,i)}})):(i=null,a=null);const s=2===this.state.warnType?this.props.intl.formatMessage({id:"trackLineError",defaultMessage:m}):this.props.intl.formatMessage({id:"locationError",defaultMessage:h});if(Y===e.Toolbar){const e=this.state.locationLayerVisible?this.props.intl.formatMessage({id:"hideOnMap",defaultMessage:w}):this.props.intl.formatMessage({id:"showOnMap",defaultMessage:S}),t=this.props.intl.formatMessage({id:"trackPath",defaultMessage:L}),i=this.state.tracking?this.props.intl.formatMessage({id:"endTracking",defaultMessage:D}):this.props.intl.formatMessage({id:"startTracking",defaultMessage:k}),a=this.props.intl.formatMessage({id:"getLocation",defaultMessage:T}),n=Q?this.state.locationLayerVisible||this.state.pathLayerVisible:this.state.locationLayerVisible;ne=(0,o.jsx)("div",{className:"widget-track-panel p-2"},ae,(0,o.jsx)("div",{className:"header-section"},this.state.loading&&(0,o.jsx)(r.Loading,{type:"SECONDARY"}),(0,o.jsx)("div",{className:"left"},(0,o.jsx)(r.Icon,{className:"track-icon",icon:q,size:"m",color:this.props.theme.sys.color.surface.paperText}),(0,o.jsx)("div",{className:"track-name"},this.props.label),this.state.isWarning&&(0,o.jsx)(r.Alert,{"aria-live":"polite",buttonType:"tertiary",form:"tooltip",placement:"bottom",size:"small",type:"warning",withIcon:!0,leaveDelay:700},s)),(0,o.jsx)("div",{className:"right"},K&&this.state.tracking&&(0,o.jsx)(r.Tooltip,{title:t,placement:"bottom"},(0,o.jsx)(r.Button,{className:"ml-auto",icon:!0,size:"sm",type:"tertiary",onClick:()=>{this.handleTrackPath()},"aria-label":e},(0,o.jsx)(qe,null))),(0,o.jsx)(r.Tooltip,{title:e,placement:"bottom"},(0,o.jsx)(r.Button,{className:"ml-auto",icon:!0,size:"sm",type:"tertiary",onClick:()=>{this.handleLayerVisibleChange(Array.from(this.props.outputDataSources),!n,3)},"aria-label":e},n?(0,o.jsx)(Te,null):(0,o.jsx)(Xe,null))),this.state.showActionBtn&&!this.state.tracking&&(0,o.jsx)(r.Tooltip,{title:this.props.intl.formatMessage({id:"clearResult",defaultMessage:y}),placement:"bottom"},(0,o.jsx)(r.Button,{className:"ml-auto",icon:!0,size:"sm",type:"tertiary",onClick:()=>{this.handleClear()},"aria-label":this.props.intl.formatMessage({id:"clearResult",defaultMessage:y})},(0,o.jsx)(Pe,null))),this.state.showActionBtn&&(0,o.jsx)("span",{className:"tool-dividing-line"}),!Q&&(0,o.jsx)(r.Tooltip,{title:a,placement:"bottom"},(0,o.jsx)(r.Button,{className:"ml-auto",icon:!0,size:"sm",type:"tertiary",onClick:()=>{this.getLocation()},"aria-label":e},(0,o.jsx)(Je,null))),Q&&!this.state.tracking&&(0,o.jsx)(r.Tooltip,{title:i,placement:"bottom"},(0,o.jsx)(r.Button,{className:"ml-auto",icon:!0,size:"sm",type:"tertiary",onClick:()=>{this.handleTracking(!0)},"aria-label":e},(0,o.jsx)(Oe,null))),Q&&this.state.tracking&&(0,o.jsx)(r.Tooltip,{title:i,placement:"bottom"},(0,o.jsx)(r.Button,{className:"ml-auto",icon:!0,size:"sm",type:"tertiary",onClick:()=>{this.handleTracking(!1)},"aria-label":e},(0,o.jsx)(Ie,null))))))}else{let e=null;e=(0,o.jsx)("div",{className:"header-section"},(0,o.jsx)(r.Alert,{className:"warning-inaccessible",type:"warning",open:this.state.isWarning,closable:!0,withIcon:!0,text:s,onClose:()=>{this.setState({isWarning:!1})}}),(0,o.jsx)("div",{className:"left"},(0,o.jsx)(r.Icon,{className:"track-icon",icon:q,size:"m",color:this.props.theme.sys.color.surface.paperText}),(0,o.jsx)("div",{className:"track-name"},this.props.label)),this.state.showActionBtn&&(0,o.jsx)("div",{className:"right"},(0,o.jsx)(r.Tooltip,{title:this.props.intl.formatMessage({id:"clearResult",defaultMessage:y}),placement:"bottom"},(0,o.jsx)("span",null,(0,o.jsx)(r.Button,{className:"ml-auto",icon:!0,size:"sm",type:"tertiary",disabled:this.state.tracking,onClick:()=>{this.handleClear()},"aria-label":this.props.intl.formatMessage({id:"clearResult",defaultMessage:y})},(0,o.jsx)(Pe,null)))),se&&(0,o.jsx)("span",{className:"tool-dividing-line"}),se&&(0,o.jsx)(o.React.Fragment,null,this.renderDataActionList(0,!Q||Q&&this.state.currentDataSourceId===(null===(P=null===(V=this.state.dataSources)||void 0===V?void 0:V[0])||void 0===P?void 0:P.id)),Q&&this.renderDataActionList(1,this.state.currentDataSourceId===(null===(B=null===(F=this.state.dataSources)||void 0===F?void 0:F[1])||void 0===B?void 0:B.id)))));let t=null,i=null;if(Q){t=(0,o.jsx)(Wt,{theme:this.props.theme,dataSourceId:null===(J=this.props.outputDataSources)||void 0===J?void 0:J[0],dataSource:this.state.trackSource,lineDataSource:this.state.lineDataSource,lineDataSourceId:null===(U=this.props.outputDataSources)||void 0===U?void 0:U[1],jimuMapView:this.state.jimuMapView,tracks:this.state.trackLinePointsList,trackLines:this.state.trackLines,tempTracksWithLine:this.state.tempTracksWithLine,scale:$,loading:this.state.loading,locationLayerVisible:this.state.locationLayerVisible,pathLayerVisible:this.state.pathLayerVisible,selectedFields:this.state.selectedFields,selectedPointIds:this.state.selectedPointIds,selectedLineIds:this.state.selectedLineIds,notFilterPointIds:this.state.notFilterPointIds,notFilterLineIds:this.state.notFilterLineIds,onHandleLineDelete:(e,t,i)=>{this.setState({deleteLineArgs:{track:e,line:t,type:i},clearRecordsConfirmOpen:!0,confirmType:"line"})},handleCurrentDataSource:e=>{this.handleCurrentDataSource(e)},handleLayerVisibleChange:(e,t,i)=>{this.handleLayerVisibleChange(e,t,i)}});const e=this.state.tracking?this.props.intl.formatMessage({id:"endTracking",defaultMessage:D}):this.props.intl.formatMessage({id:"startTracking",defaultMessage:k}),a=this.props.intl.formatMessage({id:"trackPath",defaultMessage:L});i=(0,o.jsx)("div",{className:"btn-content-trace"},K&&(0,o.jsx)(r.Tooltip,{title:a,placement:"bottom"},(0,o.jsx)("span",{className:"btn-span"},(0,o.jsx)(r.Button,{className:"btn-trace",disabled:!this.state.tracking,icon:!0,size:"sm",type:"tertiary",onClick:e=>{e.stopPropagation(),this.state.tracking&&this.handleTrackPath()},"aria-label":a},(0,o.jsx)(qe,null)))),(0,o.jsx)(r.Tooltip,{title:e,placement:"bottom"},(0,o.jsx)("span",null,(0,o.jsx)(r.Button,{type:"primary",className:"btn-auto",disabled:this.state.loading,"aria-label":e,onClick:()=>{this.handleTracking(!this.state.tracking)}},e,this.state.loading&&(0,o.jsx)(r.Loading,{type:"SECONDARY"})))))}else{const e=this.props.intl.formatMessage({id:"getLocation",defaultMessage:T});i=(0,o.jsx)("div",{className:"btn-content"},(0,o.jsx)(r.Tooltip,{title:e,placement:"bottom"},(0,o.jsx)("span",null,(0,o.jsx)(r.Button,{type:"primary",className:"btn",disabled:this.state.loading,"aria-label":e,onClick:()=>{this.getLocation()}},e,this.state.loading&&(0,o.jsx)(r.Loading,{type:"SECONDARY"}))))),t=(0,o.jsx)(Ot,{theme:this.props.theme,dataSource:this.state.trackSource,dataSourceId:null===(W=this.props.outputDataSources)||void 0===W?void 0:W[0],layerVisible:this.state.locationLayerVisible,tracks:this.state.tracks,selectedFields:this.state.selectedFields,selectedIds:this.state.selectedPointIds,notFilterPointIds:this.state.notFilterPointIds,jimuMapView:this.state.jimuMapView,onHandleDelete:e=>{this.setState({deleteTrackArgs:{track:e},clearRecordsConfirmOpen:!0,confirmType:"point"})},handleLayerVisibleChange:(e,t,i)=>{this.handleLayerVisibleChange(e,t,i)},scale:$,loading:this.state.loading})}ne=(0,o.jsx)("div",{className:"widget-track  px-4 pt-2 pb-4"},e,t,i,ae)}oe=(0,o.jsx)(o.React.Fragment,null,t,i,a)}return ie=(0,o.jsx)(lt,{jimuMapView:this.state.jimuMapView,graphicsLayerId:this.state.graphicsLayerId,highlightLocation:Z,position:this.state.position,showCompassOrientation:G,showLocationAccuracy:_,watchLocation:Q,layerVisible:this.state.locationLayerVisible}),(0,o.jsx)("div",{css:l(this.props.theme,null===(z=null===(H=(0,o.getAppStore)().getState())||void 0===H?void 0:H.appContext)||void 0===z||z.isRTL,this.props.autoWidth,this.props.autoHeight),className:"jimu-widget"},ne,oe,ie,this.state.clearRecordsConfirmOpen&&(0,o.jsx)(r.ConfirmDialog,{level:"warning",title:this.props.intl.formatMessage({id:"clearRecordsConfirm",defaultMessage:E}),hasNotShowAgainOption:!1,content:"",onConfirm:this.handleConfirmOk,onClose:()=>{this.setState({clearRecordsConfirmOpen:!1})}}))}}_t.mapExtraStateProps=(e,t)=>({mapWidgetId:t.useMapWidgetIds&&0!==t.useMapWidgetIds.length?t.useMapWidgetIds[0]:void 0}),_t.versionManager=Zt;const $t=_t;function ei(e){c.p=e}})(),d})())}}}));