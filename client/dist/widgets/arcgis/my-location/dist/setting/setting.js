System.register(["jimu-core","jimu-for-builder","jimu-ui","jimu-ui/advanced/setting-components","esri/Graphic","jimu-arcgis","jimu-theme","jimu-ui/basic/color-picker","jimu-layouts/layout-runtime","jimu-ui/advanced/data-source-selector","jimu-ui/basic/list-tree"],(function(e,t){var i={},a={},s={},o={},n={},l={},r={},c={},d={},p={},m={};return{setters:[function(e){i.DataSourceManager=e.DataSourceManager,i.DataSourceTypes=e.DataSourceTypes,i.EsriFieldType=e.EsriFieldType,i.Immutable=e.Immutable,i.JimuFieldType=e.JimuFieldType,i.LayoutItemType=e.LayoutItemType,i.React=e.React,i.classNames=e.classNames,i.css=e.css,i.jsx=e.jsx,i.polished=e.polished},function(e){a.getAppConfigAction=e.getAppConfigAction},function(e){s.Button=e.Button,s.Icon=e.Icon,s.Label=e.Label,s.NumericInput=e.NumericInput,s.Select=e.Select,s.Switch=e.Switch,s.defaultMessages=e.defaultMessages},function(e){o.MapWidgetSelector=e.MapWidgetSelector,o.SettingRow=e.SettingRow,o.SettingSection=e.SettingSection},function(){},function(){},function(e){r.styled=e.styled},function(e){c.ColorPicker=e.ColorPicker},function(e){d.LayoutItemSizeModes=e.LayoutItemSizeModes,d.searchUtils=e.searchUtils},function(e){p.FieldSelector=e.FieldSelector,p.dataComponentsUtils=e.dataComponentsUtils},function(e){m.List=e.List,m.TreeItemActionType=e.TreeItemActionType}],execute:function(){e((()=>{var e={31027:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5m-9 0a3.5 3.5 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5M15.5 11l-5 1-3 4-1-9.5zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38z" clip-rule="evenodd"></path></svg>'},27132:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA4IiBoZWlnaHQ9IjcyIiB2aWV3Qm94PSIwIDAgMTA4IDcyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHJlY3QgeD0iOCIgeT0iOCIgd2lkdGg9IjkyIiBoZWlnaHQ9IjU2IiBmaWxsPSIjMjgyODI4Ii8+DQo8cmVjdCB4PSIxMyIgeT0iNDAiIHdpZHRoPSI1MyIgaGVpZ2h0PSI2IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSIxMyIgeT0iMzIiIHdpZHRoPSI4MSIgaGVpZ2h0PSIxIiBmaWxsPSIjNDQ0NDQ0Ii8+DQo8cmVjdCB4PSIxMyIgeT0iNTIiIHdpZHRoPSI4MSIgaGVpZ2h0PSI2IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSIxMyIgeT0iMTQiIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgcng9IjIiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjI5IiB5PSIxNCIgd2lkdGg9IjEyIiBoZWlnaHQ9IjEyIiByeD0iMiIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iNDUiIHk9IjE0IiB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHJ4PSIyIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI2MSIgeT0iMTQiIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgcng9IjIiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9Ijc3IiB5PSIxNCIgd2lkdGg9IjEiIGhlaWdodD0iMTIiIGZpbGw9IiM0NDQ0NDQiLz4NCjxyZWN0IHg9IjgyIiB5PSIxNCIgd2lkdGg9IjEyIiBoZWlnaHQ9IjEyIiByeD0iMiIgZmlsbD0iIzZBNkE2QSIvPg0KPC9zdmc+DQo="},55677:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA4IiBoZWlnaHQ9IjcyIiB2aWV3Qm94PSIwIDAgMTA4IDcyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHJlY3QgeD0iOCIgeT0iMjYiIHdpZHRoPSI5MiIgaGVpZ2h0PSIyMCIgZmlsbD0iIzI4MjgyOCIvPg0KPHJlY3QgeD0iMTQiIHk9IjMwIiB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHJ4PSIyIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSIzMCIgeT0iMzAiIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgcng9IjIiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjQ2IiB5PSIzMCIgd2lkdGg9IjEyIiBoZWlnaHQ9IjEyIiByeD0iMiIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iNjIiIHk9IjMwIiB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHJ4PSIyIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI3OCIgeT0iMzAiIHdpZHRoPSIxIiBoZWlnaHQ9IjEyIiBmaWxsPSIjNDQ0NDQ0Ii8+DQo8cmVjdCB4PSI4MyIgeT0iMzAiIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgcng9IjIiIGZpbGw9IiM2QTZBNkEiLz4NCjwvc3ZnPg0K"},22089:e=>{"use strict";e.exports=n},62686:e=>{"use strict";e.exports=l},79244:e=>{"use strict";e.exports=i},4108:e=>{"use strict";e.exports=a},41496:e=>{"use strict";e.exports=d},1888:e=>{"use strict";e.exports=r},14321:e=>{"use strict";e.exports=s},13089:e=>{"use strict";e.exports=p},79298:e=>{"use strict";e.exports=o},54337:e=>{"use strict";e.exports=c},98640:e=>{"use strict";e.exports=m}},t={};function g(i){var a=t[i];if(void 0!==a)return a.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,g),s.exports}g.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return g.d(t,{a:t}),t},g.d=(e,t)=>{for(var i in t)g.o(t,i)&&!g.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},g.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),g.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},g.p="";var u={};return g.p=window.jimuConfig.baseUrl,(()=>{"use strict";g.r(u),g.d(u,{__set_webpack_public_path__:()=>Ae,default:()=>Pe});var e,t,i,a,s,o=g(79244),n=g(4108),l=g(14321),r=g(79298);!function(e){e.Panel="PANEL",e.Toolbar="TOOLBAR"}(e||(e={})),function(e){e.Distance="DISTANCE",e.Time="TIME"}(t||(t={})),function(e){e.ft="FT",e.m="M"}(i||(i={})),function(e){e.sec="S"}(a||(a={})),function(e){e.DD="DD",e.DMS="DMS"}(s||(s={}));const c=!1,d=e.Panel,p=!0,m={TYPE:t.Distance,UNIT:i.ft,INTERVAL:15};var h;!function(e){e[e.location_timestamp=0]="location_timestamp",e[e.Longitude=1]="Longitude",e[e.Latitude=2]="Latitude",e[e.altitude=3]="altitude",e[e.Orientation=4]="Orientation",e[e.speed=5]="speed",e[e.Accuracy=6]="Accuracy"}(h||(h={}));const I=["OBJECTID","location_timestamp","altitude","Orientation","speed","Accuracy","Latitude","Longitude"];g(22089),g(62686);const f="Timestamp",y="Longitude",S="Latitude",b="Altitude",j="Orientation",T="Speed",M="Accuracy",v="Start Time",x="End Time",N="Average Altitude",D="Average Speed",w="Average Accuracy";var C;!function(e){e.CREATE="CREATE",e.ADD="ADD",e.DELETE="DELETE",e.UPDATE="UPDATE",e.CLEAR="CLEAR",e.REFRESH="REFRESH"}(C||(C={}));const L={jimuName:"OBJECTID",name:"OBJECTID",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.OID,alias:"ObjectID"},P={jimuName:"location_timestamp",name:"location_timestamp",type:o.JimuFieldType.Date,esriType:o.EsriFieldType.Date,alias:"Time",format:{dateFormat:"shortDateLongTime24"}},A={jimuName:"Longitude",name:"Longitude",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"Longitude"},k={jimuName:"Latitude",name:"Latitude",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"Latitude"},O={jimuName:"altitude",name:"altitude",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"Altitude"},E={jimuName:"Orientation",name:"Orientation",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"Orientation"},R={jimuName:"speed",name:"speed",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"Speed"},B={jimuName:"Accuracy",name:"Accuracy",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"Accuracy"},H={jimuName:"LineID",name:"LineID",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Integer,alias:"LineID"},F={jimuName:"StartTime",name:"StartTime",type:o.JimuFieldType.Date,esriType:o.EsriFieldType.Date,alias:"StartTime",format:{dateFormat:"shortDateLongTime24"}},W={jimuName:"EndTime",name:"EndTime",type:o.JimuFieldType.Date,esriType:o.EsriFieldType.Date,alias:"EndTime",format:{dateFormat:"shortDateLongTime24"}},Z={jimuName:"AverageAltitude",name:"AverageAltitude",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"AverageAltitude"},Q={jimuName:"AverageSpeed",name:"averageSpeed",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"AverageSpeed"},z={jimuName:"AverageAccuracy",name:"AverageAccuracy",type:o.JimuFieldType.Number,esriType:o.EsriFieldType.Double,alias:"AverageAccuracy"},_=e=>{let t;return"track"===e||"trackline_point"===e?t=[L.jimuName,P.jimuName]:"trackline"===e&&(t=[]),t},G=(e,t="",i="")=>{const a=((e,t)=>{let i;return P.alias=t.formatMessage({id:"trackTime",defaultMessage:f}),A.alias=t.formatMessage({id:"trackLongitude",defaultMessage:y}),k.alias=t.formatMessage({id:"trackLatitude",defaultMessage:S}),O.alias=t.formatMessage({id:"trackAltitude",defaultMessage:b}),E.alias=t.formatMessage({id:"trackOrientation",defaultMessage:j}),R.alias=t.formatMessage({id:"trackSpeed",defaultMessage:T}),B.alias=t.formatMessage({id:"trackAccuracy",defaultMessage:M}),F.alias=t.formatMessage({id:"trackStartTime",defaultMessage:v}),W.alias=t.formatMessage({id:"trackEndTime",defaultMessage:x}),Z.alias=t.formatMessage({id:"averageAltitude",defaultMessage:N}),Q.alias=t.formatMessage({id:"averageSpeed",defaultMessage:D}),z.alias=t.formatMessage({id:"averageAccuracy",defaultMessage:w}),"track"===e?i={[L.jimuName]:L,[P.jimuName]:P,[A.jimuName]:A,[k.jimuName]:k,[O.jimuName]:O,[E.jimuName]:E,[R.jimuName]:R,[B.jimuName]:B}:"trackline_point"===e?i={[L.jimuName]:L,[H.jimuName]:H,[P.jimuName]:P,[A.jimuName]:A,[k.jimuName]:k,[O.jimuName]:O,[E.jimuName]:E,[R.jimuName]:R,[B.jimuName]:B}:"trackline"===e&&(i={[L.jimuName]:L,[F.jimuName]:F,[W.jimuName]:W,[Z.jimuName]:Z,[Q.jimuName]:Q,[z.jimuName]:z}),i})(i,e);return{label:t,idField:L.jimuName,fields:a}},J=(e,t,i,a,s)=>{const n=G(e,i,a),l=t+"__layer";return{id:t,type:o.DataSourceTypes.FeatureLayer,label:i,originDataSources:[],isOutputFromWidget:!0,isDataInDataSourceInstance:!1,schema:n,geometryType:s,layerId:l}};var V=g(1888),$=g(54337),U=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(i[a[s]]=e[a[s]])}return i};const K=V.styled.div`
  position: relative;
  .mask {
    position: absolute;
    width: 100%;
    height: 100%;
  }
`,Y=o.React.forwardRef(((e,t)=>{const{disabled:i}=e,a=U(e,["disabled"]);return o.React.createElement(K,{ref:t},i&&o.React.createElement("div",{className:"mask"}),o.React.createElement($.ColorPicker,Object.assign({},a)))})),q="Arrangement",X="Panel",ee="Bar",te="General settings",ie="Highlight location",ae="Symbol color",se="Show compass orientation",oe="Show location accuracy",ne="Zoom scale",le="Timeout (second)",re="Select fields",ce="Default activation",de="Watch location",pe="Streaming",me="Manual path tracing",ge="Locations",ue="Paths",he="Time",Ie="Distance",fe="ft",ye="m",Se="sec",be=o.React.memo((e=>{const t=e.intl.formatMessage({id:"symbolColorTips",defaultMessage:ae}),i=e.intl.formatMessage({id:"compassOrientationTips",defaultMessage:se}),a=e.intl.formatMessage({id:"locationAccuracyTips",defaultMessage:oe}),{symbolColor:s,showCompassOrientation:n,showLocationAccuracy:c}=e.highlightInfo;return(0,o.jsx)(o.React.Fragment,null,(0,o.jsx)("div",{className:"highlight-info-section"},(0,o.jsx)(r.SettingRow,{label:t,className:"bold-font-label",role:"group","aria-label":t},(0,o.jsx)(Y,{className:"",color:s,onChange:t=>{e.onHighlightInfoChange(Object.assign(Object.assign({},e.highlightInfo),{symbolColor:t}))}})),(0,o.jsx)(r.SettingRow,{label:i,className:"bold-font-label",role:"group","aria-label":i},(0,o.jsx)(l.Switch,{checked:n,onChange:()=>{e.onHighlightInfoChange(Object.assign(Object.assign({},e.highlightInfo),{showCompassOrientation:!n}))},"aria-label":i})),(0,o.jsx)(r.SettingRow,{label:a,className:"bold-font-label",role:"group","aria-label":a},(0,o.jsx)(l.Switch,{checked:c,onChange:t=>{e.onHighlightInfoChange(Object.assign(Object.assign({},e.highlightInfo),{showLocationAccuracy:!c}))},"aria-label":a}))))})),je=o.React.memo((e=>{const s=e.intl.formatMessage({id:"streamingTips",defaultMessage:pe}),n=e.intl.formatMessage({id:"manualPathTracingTips",defaultMessage:me}),{manualPathTracing:c,streaming:d}=e.watchLocationSettings,p=s=>s===t.Distance?e.intl.formatMessage({id:"streamingDistance",defaultMessage:Ie}):s===t.Time?e.intl.formatMessage({id:"streamingTime",defaultMessage:he}):s===i.ft?e.intl.formatMessage({id:"distanceFeet",defaultMessage:fe}):s===i.m?e.intl.formatMessage({id:"distanceMeters",defaultMessage:ye}):s===a.sec?e.intl.formatMessage({id:"timeSec",defaultMessage:Se}):void 0;return(0,o.jsx)(o.React.Fragment,null,(0,o.jsx)("div",{className:"highlight-info-section"},(0,o.jsx)(r.SettingRow,{label:s,className:"bold-font-label",role:"group","aria-label":s}),(0,o.jsx)(r.SettingRow,{className:"streaming-section"},(0,o.jsx)(l.Select,{size:"sm",className:"streaming-type-select",defaultValue:d.type===t.Distance?t.Distance:t.Time,value:d.type,onChange:(s,o)=>{const n=o.props.value===t.Distance?i.ft:a.sec,l=o.props.value===t.Distance?15:5;e.onTrackLocationSettingsChange(Object.assign(Object.assign({},e.watchLocationSettings),{streaming:Object.assign(Object.assign({},e.watchLocationSettings.streaming),{type:o.props.value,interval:l,unit:n})}))}},Object.keys(t).map((e=>(0,o.jsx)("option",{key:e,value:t[e]},p(t[e]))))),(0,o.jsx)(l.NumericInput,{className:"streaming-input",showHandlers:!1,min:0,defaultValue:d.type===t.Distance?15:5,value:d.interval,onAcceptValue:i=>{null===i&&(i=d.type===t.Distance?15:5),e.onTrackLocationSettingsChange(Object.assign(Object.assign({},e.watchLocationSettings),{streaming:Object.assign(Object.assign({},e.watchLocationSettings.streaming),{interval:i})}))}}),(0,o.jsx)(l.Select,{size:"sm",className:"streaming-unit-select",value:d.unit,onChange:(t,i)=>{e.onTrackLocationSettingsChange(Object.assign(Object.assign({},e.watchLocationSettings),{streaming:Object.assign(Object.assign({},e.watchLocationSettings.streaming),{unit:i.props.value})}))}},d.type===t.Distance?Object.keys(i).map((e=>(0,o.jsx)("option",{key:e,value:i[e]},p(i[e])))):Object.keys(a).map((e=>(0,o.jsx)("option",{key:e,value:a[e]},p(a[e])))))),(0,o.jsx)(r.SettingRow,{label:n,className:"bold-font-label",role:"group","aria-label":n},(0,o.jsx)(l.Switch,{checked:c,onChange:t=>{e.onTrackLocationSettingsChange(Object.assign(Object.assign({},e.watchLocationSettings),{manualPathTracing:!c}))},"aria-label":n}))))}));function Te(e,t){const i=e.ref.palette.neutral[300],a=e.ref.palette.neutral[1e3];return o.css`
      font-size: 13px;
      font-weight: lighter;

      .jimu-widget-setting--section {
        padding: 18px 16px;
      }

      .ui-mode-setting {
        display: flex;
      }

      /* ui-mode */
      .ui-mode-card-chooser{
        display: flex;
        align-items: start;

        .ui-mode-card-wapper {
          width: calc((100% - ${10}px - ${8}px) / 2);
        }

        .ui-mode-card-separator {
          width: ${10}px
        }
        .ui-mode-card {
          flex: 1;
          width: 100%;
          background: ${i};
          border: ${2}px solid ${i};
          margin: 0 0 0.5rem 0;

          .jimu-icon {
            margin: 0
          }
        }
        .ui-mode-card.active {
          border: ${2}px solid #00D8ED;
          background-color: ${i} !important;
        }
        .ui-mode-label {
          overflow: hidden;
          text-align: center;
        }
      }

      .placeholder-container{
        height: calc(100% - 180px);

        .placeholder{
          flex-direction: column;

          .icon{
            color: var(--ref-palette-neutral-800);
          }
          .hint{
            font-size: ${t.rem(14)};
            font-weight: ${e.ref.typeface.fontWeightBold}!important;
            color: var(--ref-palette-neutral-1000);
            max-width: ${t.rem(160)};
          }
        }

      }
      /* labels */

      .setting-label{
        font-weight: ${e.ref.typeface.fontWeightRegular};
        color:${e.ref.palette.neutral[1100]};
        letter-spacing: 4px;
      }

      /* zoom scale */
      .zoom-scale-input{
        max-width:40%;
        height: 26px!important;
        .jimu-numeric-input-input{
          height: 26px!important;
          line-height: 26px!important;
        }
      }
      .highlight-info-section{
        margin-top: 16px;
        margin-bottom: 16px;
        .bold-font-label{
          font-weight:${e.ref.typeface.fontWeightMedium}!important ;
          color: ${a} !important;
        }
        .streaming-section{
          display: flex;
          justify-content: space-between;
          align-items: center;
          .streaming-input{
            height: 26px!important;
            margin:0 0.5rem;
            .jimu-numeric-input-input{
              height: 26px!important;
              line-height: 26px!important;
            }
          }
          .streaming-type-select{
            width: 6rem;
          }
          .streaming-unit-select{
            width: 4rem;
          }
        }
      }
      .selected-fields-con{
            margin-top: 0;
            .selected-fields-list {
              flex: 1;
              max-height: 265px;
              overflow-y: auto;
            }
            .jimu-tree-item{
              background: ${e.ref.palette.neutral[300]};
              border-bottom: 1px solid ${e.ref.palette.neutral[400]};
              .jimu-tree-item__content{
                div:first-of-type{
                  padding-left: 2px;
                }
                .jimu-tree-item__body{
                  background: ${e.ref.palette.neutral[300]};
                }
              }
            }
      }
  `}var Me=g(31027),ve=g.n(Me),xe=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(i[a[s]]=e[a[s]])}return i};const Ne=e=>{const t=window.SVG,{className:i}=e,a=xe(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:ve()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var De=g(41496),we=g(13089),Ce=g(98640),Le=function(e,t,i,a){return new(i||(i=Promise))((function(s,o){function n(e){try{r(a.next(e))}catch(e){o(e)}}function l(e){try{r(a.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,l)}r((a=a.apply(e,t||[])).next())}))};class Pe extends o.React.PureComponent{constructor(t){var i,a;super(t),this.trackPointOutId=this.props.id+"_track_output",this.trackLinePointOutId=this.props.id+"_trackline_point_output",this.trackLinePointLabel=this.props.intl.formatMessage({id:"trackDsLabel",defaultMessage:ge}),this.trackPointOutLabel=this.props.intl.formatMessage({id:"trackDsLabel",defaultMessage:ge}),this.crateDataSources=e=>Le(this,void 0,void 0,(function*(){if(e){const e=this.props.id+"_trackline_output",t=this.props.intl.formatMessage({id:"trackLineDsLabel",defaultMessage:ue}),i=J(this.props.intl,this.trackLinePointOutId,this.trackLinePointLabel,"trackline_point","esriGeometryPoint"),a=J(this.props.intl,e,t,"trackline","esriGeometryPolyline");this.props.onSettingChange({id:this.props.id,useDataSources:[]},[i,a])}else{const e=J(this.props.intl,this.trackPointOutId,this.trackPointOutLabel,"track","esriGeometryPoint");this.props.onSettingChange({id:this.props.id,useDataSources:[]},[e])}})),this.handleMapWidgetChange=e=>{var t;const i=!!(null==e?void 0:e[0]);this.setState({isSelectedMap:i}),this.props.onSettingChange({id:this.props.id,useMapWidgetIds:e}),i&&this.crateDataSources(null!==(t=this.props.config.watchLocation)&&void 0!==t?t:c)},this.updateLayoutItemHeight=e=>{const t=(0,n.getAppConfigAction)();De.searchUtils.getLayoutInfosHoldContent(t.appConfig,o.LayoutItemType.Widget,this.props.id).forEach((i=>{e?t.editLayoutItemProperty(i,"setting.autoProps.height",De.LayoutItemSizeModes.Auto).exec():t.editLayoutItemProperty(i,"setting.autoProps.height",De.LayoutItemSizeModes.Custom).editLayoutItemProperty(i,"bbox.height","430px").exec()}))},this.handleArrangementChange=t=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("arrangement",t)}),this.updateLayoutItemHeight(t===e.Toolbar),(0,n.getAppConfigAction)().editWidgetProperty(this.props.id,"offPanel",t===e.Toolbar).exec()},this.handleShowAdvancedSettingClick=()=>{this.setState({isShowAdvancedSetting:!this.state.isShowAdvancedSetting})},this.handleHighlightLocationChange=e=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("highlightLocation",e)})},this.handleHighlightInfoChange=e=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("highlightInfo",e)})},this.handleZoomScale=e=>{(e<35.2655368||e>591657527)&&(e=5e4),this.props.onSettingChange({id:this.props.id,config:this.props.config.set("zoomScale",e)})},this.handleTimeOut=e=>{(e<1||e>60)&&(e=15),this.props.onSettingChange({id:this.props.id,config:this.props.config.set("timeOut",e)})},this.handleFieldsChange=(e,...t)=>{const i=Array.from(new Set(e.map((e=>e.jimuName)).concat(this.state.hiddenFields)));this.props.onSettingChange({id:this.props.id,config:this.props.config.set("selectedFields",i)})},this.onItemUpdated=(e,t)=>{const i=e.map((e=>e.itemStateDetailContent.jimuName));this.props.onSettingChange({id:this.props.id,config:this.props.config.set("selectedFields",i)})},this.handleDefaultActivationTipsChange=e=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("defaultActivation",e)})},this.handleTrackLocationChange=e=>{this.crateDataSources(e);const t=_(e?"trackline_point":"track");this.setState({hiddenFields:t}),this.props.onSettingChange({id:this.props.id,config:this.props.config.set("watchLocation",e).set("selectedFields",I)})},this.handleTrackLocationSettingsChange=e=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("watchLocationSettings",e)})},this.onShowRuntimeLayersChange=e=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("showRuntimeLayers",e)})},this.getSelectorFields=e=>{const t=[];return e&&e.length>0&&e.forEach((e=>{t.push(e.jimuName)})),t},this.state={isSelectedMap:!!(null===(i=this.props.useMapWidgetIds)||void 0===i?void 0:i[0]),isShowAdvancedSetting:!1,hiddenFields:_((null!==(a=this.props.config.watchLocation)&&void 0!==a?a:c)?"trackline_point":"track")}}componentDidMount(){var e;(null===(e=this.props.useMapWidgetIds)||void 0===e?void 0:e[0])&&this.setState({isSelectedMap:!0})}componentDidUpdate(e){var t,i,a;(null===(t=e.useMapWidgetIds)||void 0===t?void 0:t[0])!==(null===(i=this.props.useMapWidgetIds)||void 0===i?void 0:i[0])&&this.setState({isSelectedMap:!!(null===(a=this.props.useMapWidgetIds)||void 0===a?void 0:a[0])})}render(){var t,i,a,s,n,u,h,f,y,S,b,j,T,M,v,x,N,D,w,C,L,P,A,k,O,E;const R={overrideItemBlockInfo:({itemBlockInfo:e},t)=>({name:Ce.TreeItemActionType.RenderOverrideItem,children:[{name:Ce.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:Ce.TreeItemActionType.RenderOverrideItemContent,children:[{name:Ce.TreeItemActionType.RenderOverrideItemBody,children:[{name:Ce.TreeItemActionType.RenderOverrideItemMainLine,children:[{name:Ce.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:Ce.TreeItemActionType.RenderOverrideItemDragHandle},{name:Ce.TreeItemActionType.RenderOverrideItemChildrenToggle},{name:Ce.TreeItemActionType.RenderOverrideItemIcon},{name:Ce.TreeItemActionType.RenderOverrideItemTitle},{name:Ce.TreeItemActionType.RenderOverrideItemCommands}]}]},{name:Ce.TreeItemActionType.RenderOverrideItemDetailLine}]}]}]}]})},B=(null===(t=this.props.outputDataSources)||void 0===t?void 0:t.length)>0?{dataSourceId:null===(i=this.props.outputDataSources)||void 0===i?void 0:i[0],mainDataSourceId:null===(a=this.props.outputDataSources)||void 0===a?void 0:a[0]}:null,H=null!==(s=this.props.config.selectedFields)&&void 0!==s?s:I;let F=null===(h=null===(u=o.DataSourceManager.getInstance().getDataSource(null===(n=this.props.outputDataSources)||void 0===n?void 0:n[0]))||void 0===u?void 0:u.getSchema())||void 0===h?void 0:h.fields;if(!F){const e=(null!==(f=this.props.config.watchLocation)&&void 0!==f?f:c)?null===(y=G(this.props.intl,"","trackline_point"))||void 0===y?void 0:y.fields:null===(S=G(this.props.intl,"","track"))||void 0===S?void 0:S.fields;F=(0,o.Immutable)(e)}const W=null==H?void 0:H.map((e=>(null==F?void 0:F[e])||null)).filter((e=>null!==e)),Z=this.props.id+"-uimode-description",Q=this.props.id+"-uimode-0",z=this.props.id+"-uimode-1",_=this.props.intl.formatMessage({id:"selectMapWidget",defaultMessage:l.defaultMessages.selectMapWidget}),J=this.props.intl.formatMessage({id:"selectMapHint",defaultMessage:l.defaultMessages.selectMapHint}),V=this.props.intl.formatMessage({id:"arrangementTips",defaultMessage:q}),$=this.props.intl.formatMessage({id:"panelTips",defaultMessage:X}),U=this.props.intl.formatMessage({id:"toolbarTips",defaultMessage:ee}),K=this.props.intl.formatMessage({id:"generalSettingsTips",defaultMessage:te}),Y=this.props.intl.formatMessage({id:"highlightLocationTips",defaultMessage:ie}),ae=this.props.intl.formatMessage({id:"zoomScaleTips",defaultMessage:ne}),se=this.props.intl.formatMessage({id:"timeoutTips",defaultMessage:le}),oe=this.props.intl.formatMessage({id:"selectFieldsTips",defaultMessage:re}),pe=this.props.intl.formatMessage({id:"defaultActivationTips",defaultMessage:ce}),me=this.props.intl.formatMessage({id:"trackLocationTips",defaultMessage:de}),ge=this.props.intl.formatMessage({id:"showRuntimeLayers",defaultMessage:l.defaultMessages.showRuntimeLayers});return(0,o.jsx)("div",{css:Te(this.props.theme,o.polished),className:"widget-setting-menu jimu-widget-setting"},(0,o.jsx)(r.SettingSection,{title:_,className:(0,o.classNames)("map-selector-section",{"border-0":!this.state.isSelectedMap}),role:"group","aria-label":_},(0,o.jsx)(r.SettingRow,{role:"group","aria-label":_},(0,o.jsx)(r.MapWidgetSelector,{onSelect:this.handleMapWidgetChange,useMapWidgetIds:this.props.useMapWidgetIds}))),!this.state.isSelectedMap&&(0,o.jsx)("div",{className:"d-flex placeholder-container justify-content-center align-items-center"},(0,o.jsx)("div",{className:"d-flex text-center placeholder justify-content-center align-items-center "},(0,o.jsx)(Ne,{size:48,className:"d-flex icon mb-2"}),(0,o.jsx)("p",{className:"hint"},J))),this.state.isSelectedMap&&(0,o.jsx)(o.React.Fragment,null,(0,o.jsx)(r.SettingSection,{title:V,role:"group","aria-label":V},(0,o.jsx)(r.SettingRow,{role:"group","aria-label":V},(0,o.jsx)("div",{className:"ui-mode-card-chooser"},(0,o.jsx)(l.Label,{className:"d-flex flex-column ui-mode-card-wapper"},(0,o.jsx)(l.Button,{variant:"text",disableHoverEffect:!0,disableRipple:!0,icon:!0,className:(0,o.classNames)("ui-mode-card",{active:(null!==(b=this.props.config.arrangement)&&void 0!==b?b:d)===e.Panel}),onClick:()=>{this.handleArrangementChange(e.Panel)},"aria-labelledby":Q,"aria-describedby":Z,title:$},(0,o.jsx)(l.Icon,{width:100,height:72,icon:g(27132),autoFlip:!0})),(0,o.jsx)("div",{id:Q,className:"mx-1 text-break ui-mode-label"},$)),(0,o.jsx)("div",{className:"ui-mode-card-separator"}),(0,o.jsx)(l.Label,{className:"d-flex flex-column ui-mode-card-wapper"},(0,o.jsx)(l.Button,{variant:"text",disableHoverEffect:!0,disableRipple:!0,icon:!0,className:(0,o.classNames)("ui-mode-card",{active:(null!==(j=this.props.config.arrangement)&&void 0!==j?j:d)===e.Toolbar}),onClick:()=>{this.handleArrangementChange(e.Toolbar)},"aria-labelledby":z,"aria-describedby":Z,title:U},(0,o.jsx)(l.Icon,{width:100,height:72,icon:g(55677),autoFlip:!0})),(0,o.jsx)("div",{id:z,className:"mx-1 text-break ui-mode-label"},U))))),(0,o.jsx)(r.SettingSection,{title:K,role:"group","aria-label":K},(0,o.jsx)(r.SettingRow,{label:Y,className:"bold-font-label",role:"group","aria-label":Y},(0,o.jsx)(l.Switch,{checked:null!==(T=this.props.config.highlightLocation)&&void 0!==T?T:p,onChange:e=>{this.handleHighlightLocationChange(e.target.checked)},"aria-label":Y})),(null!==(M=this.props.config.highlightLocation)&&void 0!==M?M:p)&&(0,o.jsx)(be,{theme:this.props.theme,intl:this.props.intl,highlightInfo:null!==(x=null===(v=this.props.config.highlightInfo)||void 0===v?void 0:v.asMutable())&&void 0!==x?x:{symbolColor:"#007AC2",showCompassOrientation:false,showLocationAccuracy:false},onHighlightInfoChange:this.handleHighlightInfoChange}),(0,o.jsx)(r.SettingRow,{label:ae,className:"bold-font-label",role:"group","aria-label":ae},(0,o.jsx)(l.Label,{className:"setting-label"},"1:")," ",(0,o.jsx)(l.NumericInput,{className:"zoom-scale-input",showHandlers:!1,defaultValue:5e4,value:null!==(N=this.props.config.zoomScale)&&void 0!==N?N:5e4,onAcceptValue:this.handleZoomScale})),(0,o.jsx)(r.SettingRow,{label:se,className:"bold-font-label",role:"group","aria-label":se},(0,o.jsx)(l.NumericInput,{className:"zoom-scale-input",showHandlers:!0,defaultValue:15,value:null!==(D=this.props.config.timeOut)&&void 0!==D?D:15,onAcceptValue:this.handleTimeOut})),(0,o.jsx)(r.SettingRow,{flow:"wrap",label:oe,className:"bold-font-label",role:"group","aria-label":oe},(0,o.jsx)(we.FieldSelector,{useDataSources:B?(0,o.Immutable)([B]):(0,o.Immutable)([]),css:o.css`width: 120px; .jimu-dropdown { width: 100%; }`,"aria-label":oe,onChange:this.handleFieldsChange,selectedFields:(0,o.Immutable)(H.filter((e=>!this.state.hiddenFields.includes(e)))),hiddenFields:(0,o.Immutable)(this.state.hiddenFields),isMultiple:!0,isDataSourceDropDownHidden:!0,useDropdown:!0,useMultiDropdownBottomTools:!0})),(0,o.jsx)(r.SettingRow,{className:"selected-fields-con"},(0,o.jsx)(Ce.List,Object.assign({className:"selected-fields-list",itemsJson:Array.from(W).map(((e,t)=>({itemStateDetailContent:e,itemExpandIconShown:!1,itemStateExpanded:!1,itemKey:`${t}`,itemStateIcon:we.dataComponentsUtils.getIconFromFieldType(e.type,this.props.theme),itemStateTitle:e.alias||e.jimuName||e.name,isCheckboxDisabled:!0,itemStateCommands:[]}))),onUpdateItem:(e,t)=>{if(e.updateType===Ce.TreeItemActionType.HandleDidDrop){const{itemJsons:e}=t.props,[i,a]=e;this.onItemUpdated(a,+i.itemKey)}},dndEnabled:!0,isMultiSelection:!1},R))),(0,o.jsx)(r.SettingRow,{label:me,className:"bold-font-label",role:"group","aria-label":me},(0,o.jsx)(l.Switch,{checked:null!==(w=this.props.config.watchLocation)&&void 0!==w?w:c,onChange:e=>{this.handleTrackLocationChange(e.target.checked)},"aria-label":me})),(null!==(C=this.props.config.watchLocation)&&void 0!==C?C:c)&&(0,o.jsx)(je,{theme:this.props.theme,intl:this.props.intl,timeOut:null!==(L=this.props.config.timeOut)&&void 0!==L?L:15,watchLocationSettings:null!==(A=null===(P=this.props.config.watchLocationSettings)||void 0===P?void 0:P.asMutable())&&void 0!==A?A:{manualPathTracing:true,streaming:{type:m.TYPE,unit:m.UNIT,interval:m.INTERVAL}},onTrackLocationSettingsChange:this.handleTrackLocationSettingsChange}),(0,o.jsx)(r.SettingRow,{label:ge,role:"group","aria-label":ge},(0,o.jsx)(l.Switch,{checked:null===(O=null===(k=this.props.config)||void 0===k?void 0:k.showRuntimeLayers)||void 0===O||O,onChange:e=>{this.onShowRuntimeLayersChange(e.target.checked)}})),(0,o.jsx)(r.SettingRow,{label:pe,className:"bold-font-label",role:"group","aria-label":pe},(0,o.jsx)(l.Switch,{checked:null!==(E=this.props.config.defaultActivation)&&void 0!==E&&E,onChange:e=>{this.handleDefaultActivationTipsChange(e.target.checked)},"aria-label":pe})))))}}function Ae(e){g.p=e}})(),u})())}}}));