/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-8f16b7.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-8f16b7"],{99004:(e,r,t)=>{t.d(r,{c:()=>n,g:()=>a});var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t.g?t.g:"undefined"!=typeof self?self:{};function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}},20259:(e,r,t)=>{t.r(r),t.d(r,{arcgis_new_item_pages_tile_layer_from_existing:()=>f});var n=t(20536),a=t(5479),o=t(44090),i=t(38973),s=t(64243),l=t(51933),c=t(1391),d=t(19832),u=t(27995),y=t(15834);t(25972),t(98034),t(99004),t(369),t(78231),t(79717),t(85781),t(10699),t(76776),t(67914),t(30554),t(34472),t(76246),t(16093),t(90230),t(40883),t(86980),t(59377),t(68537),t(11163),t(90079),t(4291);const f=class{constructor(e){(0,n.r)(this,e),this.newItemUpdatePage=(0,n.c)(this,"newItemUpdatePage",7),this.selectedItem=void 0,this.error=void 0,this.isProcessing=!1}async handleNext(){var e;if("3dTiles"===c.a.tileLayerPublishType)return;this.error=null;const{selectedItem:r}=this;if(!r)return(0,y.f)("No layer selected"),void(this.error="noLayerSelected");const{id:t,url:n,title:d}=r;try{const y=c.a.tileLayerPublishType;this.isProcessing=!0;const f=o.c.portal,[{layers:m,tables:p,serviceInfo:v},{total:g,relatedItems:w}]=await Promise.all([(0,s.w)(n,(0,i.g)(f),!0),(0,a.b)(t,f,{relationshipType:"Service2Service"})]),{result:h}=await(0,l.f)({itemId:t,itemUrl:n,publishType:"vectorTiles"===c.a.tileLayerPublishType?"vector":"raster",portal:f,fullLayers:m});if(g>0&&("vectorTiles"===y&&w.some((e=>"Vector Tile Service"===e.type))||"tiles"===y&&w.some((e=>"Map Service"===e.type))))return void(this.error="tileLayerAlreadyExist");const b=e=>(null!=e?e:[]).some((e=>{var r,t;const{drawingInfo:n,fields:a,layerDefinition:o}=e,i=null==o?void 0:o.drawingInfo,s=null!==(r=null==i?void 0:i.renderer)&&void 0!==r?r:null==n?void 0:n.renderer;return s&&a?!(0,l.c)(s,e.geometryType,a)||(0,l.l)(e):null!==(t=(0,l.l)(e))&&void 0!==t&&t}));if(b(m)||b(h.layers))return void(this.error="badRenderer");const S=e=>(0,l.a)(e,!0);if(!m.some(S)||(null===(e=null==h?void 0:h.layers)||void 0===e?void 0:e.length)>0&&!h.layers.some(S))return void(this.error="badLayer");c.a.sourceTitle=d,(0,u.s)(r),c.a.tileAutoCreation=!0,c.a.tileLayerBasemapType="standard",c.a.tileLayerBasemapUrl="",c.a.tileLayerFromFeatureLayer=!0,c.a.tileLayerLayers=m,c.a.tileLayerTables=p,c.a.tileLayerServiceInfo=v,c.a.tileLayerData=h,c.a.item=r,this.isProcessing=!1,this.newItemUpdatePage.emit("tileLayerSettings")}catch(e){console.error(e)}}onError(){this.isProcessing=!1}componentWillLoad(){c.a.serviceInfo=null,c.a.selectedServiceInfoLayersNames=null,this.i18n=d.u.i18n.tileLayerFromExisting}render(){var e,r;const{error:t,i18n:a,isProcessing:o}=this;return(0,n.h)(n.H,{key:"a4f550dd05d4c323e2569d32230add90941910a3"},(0,n.h)("arcgis-new-item-loader",{key:"d95d78b22ff764bdca59d14da27157fc6ec9a676",active:o}),(0,n.h)("arcgis-new-item-feature-layer-browser",{key:"ee9f3dcf9fef5c49ffeefb3eafd4e4b9fedcd28c",itemBrowserBucket:["my"],onItemSelected:({detail:e})=>this.selectedItem=e,query:'type:"Feature Service" AND typekeywords:"Hosted Service" NOT typekeywords:"Spatiotemporal"'}),(0,n.h)("arcgis-new-item-alert",{key:"9920e37f76b91b615ab821b667523f212c18f0c2",heading:"badLayer"===t?a.error.tileLayerAlreadyExist.title:null===(e=a.error[t])||void 0===e?void 0:e.title,description:"badLayer"===t||null===(r=a.error[t])||void 0===r?void 0:r.description,active:null!=t,onAlertDismiss:()=>{this.error=null}}))}static get watchers(){return{error:["onError"]}}}},15834:(e,r,t)=>{t.d(r,{a:()=>m,b:()=>y,c:()=>v,d:()=>f,e:()=>d,f:()=>p,i:()=>u});var n=t(44090),a=t(1391),o=t(25972),i=t(38973);const s="create feature layer",l="my content",c=e=>{switch(e){case"build":return"blank";case"existing":return"fs";case"template":return"template";case"link":return"url"}},d=e=>{const r=n.c.telemetry;null==r||r.stepWorkflow(s,"enable "+("captureGPS"===e?"gps":"enableZDefaults"===e?"z":"m"),{category:s,attribute:c(a.a.addFeatureLayerType),pageName:l})},u=e=>{const r=n.c.telemetry;null==r||r.stepWorkflow(s,`expand ${e} details`,{category:s,attribute:c(a.a.addFeatureLayerType),pageName:l})},y=()=>{const e=n.c.telemetry;null==e||e.stepWorkflow(s,"filter",{category:s,attribute:c(a.a.addFeatureLayerType),pageName:l})},f=e=>{const r=c(e),t=n.c.telemetry;null==t||t.stepWorkflow(s,"from option",{category:s,attribute:r,pageName:l})},m=()=>{const{addFeatureLayerType:e,serviceInfo:r}=a.a,t=r,o=n.c.telemetry;null==o||o.endWorkflow(s,{category:s,attribute:c(e),pageName:l,count:t.layers.length,number:t.tables.length})},p=e=>{var r;null===(r=n.c.telemetry)||void 0===r||r.logError({category:s,error:e})};async function v(){const e=(0,i.g)().replace("portal/sharing/rest/","server/admin/services/types/customdataproviders/checkcdf");try{return await(0,o.r)(e,"post")}catch(e){return e}}},5479:(e,r,t)=>{t.d(r,{a:()=>g,b:()=>d,c:()=>u,f:()=>c,g:()=>y});var n=t(25972),a=t(67324),o=t(78231),i=t(38973),s=t(79717),l=t(85781);const c=async(e,r)=>{const{owningSystemUrl:t}=await(0,n.f)((async()=>(0,s.g)(e)),"portalInfo",e.id);return(await Promise.all(r.map((async e=>{try{const{owningSystemUrl:r}=await(0,s.a)(e);return{owningSystemUrl:r,url:e}}catch(r){return console.error(r),{owningSystemUrl:null,url:e}}})))).filter((({owningSystemUrl:e})=>e===t)).map((({url:e})=>e))};async function d(e,r,t){const{relationshipType:a,direction:o}=t,s=`${(0,i.g)(r)}content/items/${e}/relatedItems`;return await(0,n.r)(s,{relationshipType:a,direction:o,includeRecycleBin:!0})}const u=async(e,r)=>{try{return{result:(await(0,n.r)(`${(0,i.g)(r)}/search`,{filter:`id:(${e.join(" OR ")})`,num:100})).results}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},y=async(e,r)=>{try{const t=[],a=[],o=[];await Promise.all(e.map((async e=>{const{result:i,error:c}=await(0,n.f)((()=>(async(e,r)=>{var t;try{return{result:await(0,l.r)(e,r,{addTokenManually:!1})}}catch(e){const r="token required";return(null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.toLowerCase().includes(r))?{error:{code:"tokenRequired"}}:(console.error(e),{error:{code:"unhandledError"}})}})(e,r)),"itemMetadata",`${e}--no-token`);if("tokenRequired"!==(null==c?void 0:c.code))if(f(i))t.push(m(i,e));else try{const r=await(0,s.a)(e);o.push(Object.assign(Object.assign({},i),{owningSystemUrl:r.owningSystemUrl}))}catch(c){console.warn(c)}else a.push(e)})));const i=await c(r,a),d=(await Promise.all(i.map((async e=>({response:await(0,l.r)(e,r,{addTokenManually:!0}),owningSystemUrl:(await(0,s.a)(e)).owningSystemUrl,url:e}))))).reduce(((e,{response:r,url:n,owningSystemUrl:a})=>f(r)?(t.push(m(r,n)),e):[...e,Object.assign(Object.assign({},r),{owningSystemUrl:a})]),[]),u=await Promise.all([...o,...d].map((async({serviceItemId:e,owningSystemUrl:r})=>{if(!e)return null;const{result:t}=await v({itemId:e,owningSystemUrl:r});return{item:t,owningSystemUrl:r}}))),{result:p}=t.length<=0?{result:[]}:await y(t,r);return{result:[...u.filter((e=>!!e)),...p]}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},f=e=>!!(null==e?void 0:e.sources),m=(e,r)=>{var t;const n=null===(t=Object.values(e.sources)[0])||void 0===t?void 0:t.url;return n?n.includes("..")?(0,i.t)({url:r,path:n}):n:null},p=e=>`${e}/sharing/rest`,v=async({itemId:e,owningSystemUrl:r,requestOptions:t})=>{try{const a=(0,o.g)(e,p(r));return{result:await(0,n.r)(a,{},Object.assign(Object.assign({},t),{addTokenManually:!1}))}}catch(e){return console.error(e),(0,a.a)(e)&&e.message.toLocaleLowerCase().includes("invalid token")?{error:{code:"invalidToken"}}:{error:{code:"unhandledError"}}}},g=async({itemId:e,owningSystemUrl:r,requestOptions:t})=>{try{const a=`${(0,o.g)(e,p(r))}/data`;return{result:await(0,n.r)(a,{},Object.assign(Object.assign({},t),{addTokenManually:!1}))}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}},98034:(e,r,t)=>{t.d(r,{e:()=>o,l:()=>i});var n,a=t(99004),o={exports:{}};n=o.exports,a.c,function(e){var r={Promise:"undefined"!=typeof window?window.Promise:void 0},t="4.24",n="next";function a(e){if(e.toLowerCase()===n)return n;var r=e&&e.match(/^(\d)\.(\d+)/);return r&&{major:parseInt(r[1],10),minor:parseInt(r[2],10)}}function o(e){return void 0===e&&(e=t),"https://js.arcgis.com/".concat(e,"/")}function i(e){void 0===e&&(e=t);var r=o(e),i=a(e);if(i!==n&&3===i.major){var s=i.minor<=10?"js/":"";return"".concat(r).concat(s,"esri/css/esri.css")}return"".concat(r,"esri/themes/light/main.css")}function s(e){var r=document.createElement("link");return r.rel="stylesheet",r.href=e,r}function l(e,r){if(r){var t=document.querySelector(r);t.parentNode.insertBefore(e,t)}else document.head.appendChild(e)}function c(e){return document.querySelector('link[href*="'.concat(e,'"]'))}function d(e){return!e||a(e)?i(e):e}function u(e,r){var t=d(e),n=c(t);return n||l(n=s(t),r),n}var y={};function f(e){var r=document.createElement("script");return r.type="text/javascript",r.src=e,r.setAttribute("data-esri-loader","loading"),r}function m(e,r,t){var n;t&&(n=p(e,t));var a=function(){r(e),e.removeEventListener("load",a,!1),n&&e.removeEventListener("error",n,!1)};e.addEventListener("load",a,!1)}function p(e,r){var t=function(n){r(n.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",t,!1)};return e.addEventListener("error",t,!1),t}function v(e){void 0===e&&(e={}),y=e}function g(){return document.querySelector("script[data-esri-loader]")}function w(){var e=window.require;return e&&e.on}function h(e){void 0===e&&(e={});var t={};[y,e].forEach((function(e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}));var n=t.version,a=t.url||o(n);return new r.Promise((function(e,r){var o=g();if(o){var i=o.getAttribute("src");i!==a?r(new Error("The ArcGIS API for JavaScript is already loaded (".concat(i,")."))):w()?e(o):m(o,e,r)}else if(w())r(new Error("The ArcGIS API for JavaScript is already loaded."));else{var s=t.css;s&&u(!0===s?n:s,t.insertCssBefore),m(o=f(a),(function(){o.setAttribute("data-esri-loader","loaded"),e(o)}),r),document.body.appendChild(o)}}))}function b(e){return new r.Promise((function(r,t){var n=window.require.on("error",t);window.require(e,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.remove(),r(e)}))}))}function S(e,r){if(void 0===r&&(r={}),w())return b(e);var t=g(),n=t&&t.getAttribute("src");return!r.url&&n&&(r.url=n),h(r).then((function(){return b(e)}))}e.utils=r,e.loadModules=S,e.getScript=g,e.isLoaded=w,e.loadScript=h,e.setDefaultOptions=v,e.loadCss=u,Object.defineProperty(e,"__esModule",{value:!0})}(n);const i=async(e,r)=>(await o.exports.loadModules(e,r)).map((e=>e.__esModule&&e.default?e.default:e))},85781:(e,r,t)=>{t.d(r,{r:()=>o});var n=t(25972),a=t(44090);const o=async(e,r,t={})=>{const{body:o,usePost:i,addTokenManually:s,api:l=(null===a.c||void 0===a.c?void 0:a.c.api),customToken:c}=t,d=new URLSearchParams;o&&Object.entries(o).forEach((([e,r])=>{void 0!==r&&d.append(e,r)}));const u=new URL(e);if(u.searchParams.append("f","json"),c)u.searchParams.append("token",c);else{const e=!1===s?null:await(0,n.g)(r,l);e&&u.searchParams.append("token",e)}const y=await fetch(u.toString(),{body:i?d:void 0,method:i?"POST":"GET"}),f=await y.json(),m=f.error;if(m)throw"string"==typeof m?new Error(m):m;return f}}}]);