/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_fieldA-8f1d85.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_fieldA-8f1d85"],{93511:(e,i,r)=>{r.d(i,{F:()=>d,a:()=>c,c:()=>u});var n=r(20536),o=r(74129),t=r(78231),s=r(91616),l=r(98034),a=r(38973);const d=({fieldType:e})=>e===o.a.oid||e===o.a.guid||e===o.a.globalId?(0,n.h)("calcite-icon",{scale:"s",icon:"key"}):e===o.a.integer||e===o.a.smallInteger||e===o.a.bigInteger?(0,n.h)("calcite-icon",{scale:"s",icon:"integer"}):e===o.a.single||e===o.a.double||e===o.a.long||e===o.a.number?(0,n.h)("calcite-icon",{scale:"s",icon:"number"}):e===o.a.string?(0,n.h)("calcite-icon",{scale:"s",icon:"string"}):e===o.a.date?(0,n.h)("calcite-icon",{scale:"s",icon:"date-time"}):e===o.a.dateOnly?(0,n.h)("calcite-icon",{scale:"s",icon:"calendar"}):e===o.a.timestampOffset?(0,n.h)("calcite-icon",{scale:"s",icon:"time-zone"}):e===o.a.timeOnly?(0,n.h)("calcite-icon",{scale:"s",icon:"clock"}):(0,n.h)("calcite-icon",{scale:"s",icon:"string"});async function u(e){var i,r,n;const o="feature"===e.type||"oriented-imagery"===e.type,s=null==e?void 0:e.portalItem,l=e.sourceJSON;if(!o||!s)return Promise.resolve(!1);const a=s.portal;if(!(null==a?void 0:a.user))return Promise.resolve(!1);if((0,t.f)(s))return Promise.resolve(!1);if(!(0,t.h)(s))return Promise.resolve(!1);if((0,t.l)(s))return Promise.resolve(!1);if((0,t.p)(l))return Promise.resolve(!1);const d=(0,t.u)(s,a.user),u=null!==(i=await(0,t.j)(e))&&void 0!==i?i:[],c=null!==(r=await(0,t.k)(e))&&void 0!==r?r:[],v=(0,t.m)(u,c);if(!d&&!v)return Promise.resolve(!1);const m=await(0,t.n)(s.id,a,{relationshipType:"Service2Service"});if(null===(n=null==m?void 0:m.data)||void 0===n?void 0:n.relatedItems){if(m.data.relatedItems.some((e=>["WMTS","Map Service","Vector Tile Service"].includes(e.type))))return Promise.resolve(!1)}return Promise.resolve(!0)}async function c(e,i,r){var n,o,s,d,u,c,p;if(!r)return Promise.resolve(!1);const w="feature"===i.type||"oriented-imagery"===i.type,y=i.portalItem,P=i.sourceJSON;if(!w||!y)return Promise.resolve(!1);if(!y.portal.user)return Promise.resolve(!1);if(!(0,t.h)(y))return Promise.resolve(!1);if((0,t.f)(y))return Promise.resolve(!1);if((0,t.l)(y))return Promise.resolve(!1);if((0,t.p)(P))return Promise.resolve(!1);if(y.portal.isPortal&&(0,t.o)(y))return Promise.resolve(!1);if(["oid","global-id","geometry"].indexOf(r.type)>-1)return Promise.resolve(!1);const g=i.sourceJSON.geometryProperties;if([null==g?void 0:g.shapeLengthFieldName,null==g?void 0:g.shapeAreaFieldName].includes(r.name))return Promise.resolve(!1);const h=i.editFieldsInfo;if(h&&(h.creationDateField===r.name||h.creatorField===r.name||h.editDateField===r.name||h.editorField===r.name))return Promise.resolve(!1);if(i.objectIdField===r.name||i.displayField===r.name)return Promise.resolve(!1);if(i.typeIdField===r.name)return Promise.resolve(!1);if(i.subtypeField===r.name)return Promise.resolve(!1);if(i.timeInfo&&(i.timeInfo.startField===r.name||i.timeInfo.endField===r.name||i.timeInfo.trackIdField===r.name))return Promise.resolve(!1);const[I]=await(0,l.l)(["esri/layers/support/fieldUtils"]),F=await I.getRendererFields(i.renderer,i.fieldsIndex);if(null==F?void 0:F.includes(r.name))return Promise.resolve(!1);if(i.featureReduction){const e=await I.getRendererFields(i.featureReduction.renderer);if(m(i.featureReduction,e).includes(r.name))return Promise.resolve(!1);if((await f(i,i.featureReduction,e,I)).includes(r.name))return Promise.resolve(!1)}const S=null===(n=i.labelingInfo)||void 0===n?void 0:n.map((e=>{var i;return null===(i=e.labelExpressionInfo)||void 0===i?void 0:i.expression}));if(S){const e=await I.getExpressionFields(i,S);if(null==e?void 0:e.includes(r.name))return Promise.resolve(!1);if(await v(i,r,"layer"))return Promise.resolve(!1)}if(i.featureReduction){const e=null===(o=i.featureReduction.labelingInfo)||void 0===o?void 0:o.map((e=>{var i;return null===(i=e.labelExpressionInfo)||void 0===i?void 0:i.expression}));if(e){const[n]=await(0,l.l)(["esri/support/arcadeUtils"]),o=[],t=null===(s=i.featureReduction.fields)||void 0===s?void 0:s.map((e=>e.name));await Promise.all(e.map((async e=>{(await n.extractFieldNames(e,t)).forEach((e=>{o.includes(e)||o.push(e)}))})));if(m(i.featureReduction,o).includes(r.name))return Promise.resolve(!1);if((await f(i,i.featureReduction,o,I)).includes(r.name))return Promise.resolve(!1);if(await v(i,r,"featureReduction"))return Promise.resolve(!1)}}if(i.definitionExpression){const[e]=await(0,l.l)(["esri/core/sql"]);if(null===(d=(await e.parseWhereClause(i.definitionExpression)).fieldNames)||void 0===d?void 0:d.includes(r.name))return Promise.resolve(!1)}const R=await async function(e,i){var r;const n=e.portalItem;if(!n)return Promise.resolve(!1);const o=`${(0,a.g)(n.portal)}content/items/${n.id}/data`,[t]=await(0,l.l)(["esri/request"]);return await t(o,{query:{f:"json"},method:"get",responseType:"json",token:null===(r=n.portal.credential)||void 0===r?void 0:r.token}).then((async r=>{var n,o,t,s,a,d,u;const c=r.data;if(!c)return Promise.resolve(!1);if(null==c?void 0:c.layers){const[r,v]=await(0,l.l)(["esri/layers/support/fieldUtils","esri/renderers/support/jsonUtils"]),p=c.layers.find((i=>i.id===e.layerId)),w=null===(o=null===(n=null==p?void 0:p.layerDefinition)||void 0===n?void 0:n.drawingInfo)||void 0===o?void 0:o.renderer,y=null===(a=null===(s=null===(t=null==p?void 0:p.layerDefinition)||void 0===t?void 0:t.featureReduction)||void 0===s?void 0:s.drawingInfo)||void 0===a?void 0:a.renderer;if(!w&&!y)return Promise.resolve(!1);if(w){const n=v.fromJSON(w),o=await r.getRendererFields(n,e.fieldsIndex);if(null==o?void 0:o.includes(i.name))return Promise.resolve(!0);const t=null===(d=null==p?void 0:p.layerDefinition)||void 0===d?void 0:d.definitionExpression;if(t){const[e]=await(0,l.l)(["esri/core/sql"]);if(null===(u=(await e.parseWhereClause(t)).fieldNames)||void 0===u?void 0:u.includes(i.name))return Promise.resolve(!0)}}if(y){const n=v.fromJSON(y),o=await r.getRendererFields(n),[t]=await(0,l.l)(["esri/layers/support/FeatureReductionBinning"]),s=t.fromJSON(p.layerDefinition.featureReduction);if(m(s,o).includes(i.name))return Promise.resolve(!0);if((await f(e,s,o,r)).includes(i.name))return Promise.resolve(!0)}}return Promise.resolve(!1)}),(()=>Promise.resolve(!1)))}(i,r);if(R)return Promise.resolve(!1);const b=await async function(e,i){var r,n,o;const t=e.sourceJSON,s=null===(r=null==t?void 0:t.drawingInfo)||void 0===r?void 0:r.renderer,a=null===(o=null===(n=null==t?void 0:t.featureReduction)||void 0===n?void 0:n.drawingInfo)||void 0===o?void 0:o.renderer;if(!s&&!a)return Promise.resolve(!1);const[d,u]=await(0,l.l)(["esri/layers/support/fieldUtils","esri/renderers/support/jsonUtils"]);if(s){const e=u.fromJSON(s),r=await d.getRendererFields(e);if(null==r?void 0:r.includes(i.name))return Promise.resolve(!0)}if(a){const r=u.fromJSON(a),n=await d.getRendererFields(r),[o]=await(0,l.l)(["esri/layers/support/FeatureReductionBinning"]),s=o.fromJSON(t.featureReduction);if(m(s,n).includes(i.name))return Promise.resolve(!0);if((await f(e,s,n,d)).includes(i.name))return Promise.resolve(!0)}return Promise.resolve(!1)}(i,r);if(b)return Promise.resolve(!1);const k=function(e,i,r){var n,o,t,s,l;const a=null===(t=null===(o=null===(n=e.map)||void 0===n?void 0:n.applicationProperties)||void 0===o?void 0:o.viewing)||void 0===t?void 0:t.search;if(a){const e=null===(s=a.layers)||void 0===s?void 0:s.find((e=>e.id===i.id));if(e){const i=null===(l=null==e?void 0:e.field)||void 0===l?void 0:l.name;if(i)return i===r.name}}return!1}(e,i,r);if(k)return Promise.resolve(!1);const x=i.relationships,N=null==x?void 0:x.map((e=>e.keyField));if(null==N?void 0:N.includes(r.name))return Promise.resolve(!1);const j=(0,t.u)(y,y.portal.user),_=null!==(u=await(0,t.j)(i))&&void 0!==u?u:[],O=null!==(c=await(0,t.k)(i))&&void 0!==c?c:[],q=(0,t.m)(_,O);if(!j&&!q)return Promise.resolve(!1);const $=await(0,t.n)(y.id,y.portal,{relationshipType:"Service2Service"});if(null===(p=null==$?void 0:$.data)||void 0===p?void 0:p.relatedItems){if($.data.relatedItems.some((e=>["WMTS","Map Service","Vector Tile Service"].includes(e.type))))return Promise.resolve(!1)}return Promise.resolve(!0)}async function v(e,i,r){var n,o;const[t]=await(0,l.l)(["esri/core/sql"]),a="layer"===r?null===(n=e.labelingInfo)||void 0===n?void 0:n.filter((e=>(0,s.i)(e.where))):null===(o=e.featureReduction.labelingInfo)||void 0===o?void 0:o.filter((e=>(0,s.i)(e.where)));if(!(null==a?void 0:a.length))return Promise.resolve(!1);const d=[...await Promise.all(a.map((async e=>{if(e.where)return await t.parseWhereClause(e.where)})))];let u=!1;for(let n=0;n<d.length;n++){const o="layer"===r?d[n].fieldNames:m(e.featureReduction,d[n].fieldNames);if(!u&&(null==o?void 0:o.includes(i.name))){u=!0;break}}return Promise.resolve(u)}function m(e,i){return e.fields.filter((e=>i.includes(e.name)||i.includes(e.name.toLowerCase()))).map((e=>e.onStatisticField))}async function f(e,i,r,n){const o=r.map((e=>{var r;return null===(r=i.fields.find((i=>i.name.toLowerCase()===e.toLowerCase())).onStatisticExpression)||void 0===r?void 0:r.expression})),t=await n.getExpressionFields(e,o);return Promise.resolve(t)}},78231:(e,i,r)=>{r.d(i,{a:()=>l,b:()=>s,c:()=>u,d:()=>c,e:()=>v,f:()=>p,g:()=>S,h:()=>w,i:()=>a,j:()=>g,k:()=>h,l:()=>y,m:()=>F,n:()=>I,o:()=>f,p:()=>P,q:()=>m,u:()=>d});var n=r(98034),o=r(38973);function t(e){var i;return!!(null===(i=e.owner)||void 0===i?void 0:i.toLowerCase().includes("esri"))}function s(e){var i;return t(e)&&!!(null===(i=e.typeKeywords)||void 0===i?void 0:i.includes("Requires Credits"))}function l(e){var i;return t(e)&&!!(null===(i=e.typeKeywords)||void 0===i?void 0:i.includes("Requires Subscription"))}function a(e,i){return e.owner===i.username}function d(e,i){return a(e,i)||function(e,i){var r;if(null!=e.isAdmin)return!!e.isAdmin;const n=e.owner,o="admin"===e.itemControl,t=["esri_livingatlas","esri_demographics","esri_boundaries"];if((null===(r=e.portal)||void 0===r?void 0:r.isPortal)&&!a(e,i)&&o&&n.includes("esri_")&&!t.includes(n))return!1;return o}(e,i)}const u=(e,i)=>!!i.orgId&&e.every((e=>e.isOrgItem)),c=(e,i)=>`${(0,o.a)(i)}item.html?id=${e}`,v=(e,i)=>`${(0,o.g)(i)}/content/users/${e}`,m=e=>e.reduce(((e,i)=>(e[i.owner]=e[i.owner]?[...e[i.owner],i.id]:[i.id],e)),{});function f(e){var i;return null===(i=e.typeKeywords)||void 0===i?void 0:i.includes("Spatiotemporal")}function p(e){var i;return null===(i=e.typeKeywords)||void 0===i?void 0:i.includes("View Service")}function w(e){var i;return null===(i=e.typeKeywords)||void 0===i?void 0:i.includes("Hosted Service")}function y(e){var i;return null===(i=e.typeKeywords)||void 0===i?void 0:i.includes("Multi Services View")}function P(e){return(null==e?void 0:e.hasViews)&&!e.sourceSchemaChangesAllowed}async function g(e){var i;const r=null==e?void 0:e.portalItem;if(!r)return Promise.resolve(null);const t=r.portal,[s]=await(0,n.l)(["esri/request"]);if(null==t?void 0:t.user){return s(`${(0,o.g)(t)}community/users/${t.user.username}`,{query:{f:"json",token:null===(i=r.portal.credential)||void 0===i?void 0:i.token},responseType:"json"}).then((e=>{var i,r;const n=null!==(r=null===(i=e.data)||void 0===i?void 0:i.groups)&&void 0!==r?r:[];return Promise.resolve(n)}),(()=>Promise.reject()))}return Promise.resolve(null)}async function h(e){var i;const r=null==e?void 0:e.portalItem;if(!r)return Promise.resolve(null);const t=r.portal,[s]=await(0,n.l)(["esri/request"]);return s(`${(0,o.g)(t)}content/items/${r.id}/groups`,{query:{f:"json",token:null===(i=r.portal.credential)||void 0===i?void 0:i.token},responseType:"json"}).then((e=>{var i,r,n,o,t,s;const l=[...null!==(r=null===(i=e.data)||void 0===i?void 0:i.admin)&&void 0!==r?r:[],...null!==(o=null===(n=e.data)||void 0===n?void 0:n.member)&&void 0!==o?o:[],...null!==(s=null===(t=e.data)||void 0===t?void 0:t.other)&&void 0!==s?s:[]];return Promise.resolve(l)}),(()=>Promise.reject()))}async function I(e,i,{relationshipType:r,direction:t}){const s=`${(0,o.g)(i)}content/items/${e}/relatedItems`,[l]=await(0,n.l)(["esri/request"]);return await l(s,{query:{f:"json",relationshipType:r,direction:t},method:"get",responseType:"json"})}function F(e,i){return null==e?void 0:e.some((e=>null==i?void 0:i.some((i=>e.id===i.id&&e.capabilities.includes("updateitemcontrol")))))}const S=(e,i)=>`${i}/content/items/${e}`}}]);