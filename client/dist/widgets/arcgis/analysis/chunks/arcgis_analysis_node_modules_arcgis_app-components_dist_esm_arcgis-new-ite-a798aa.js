/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-a798aa.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-a798aa"],{1391:(i,t,a)=>{a.d(t,{a:()=>s,b:()=>n,c:()=>r,d:()=>e});const e=(0,a(10699).c)({typeKeywords:[],customParameters:[],analyzedLocationTypes:[],allowStoredAuth:!0,isSecured:null,checkAuth:!1}),s=e.state,r=e.state,n=e.state},66951:(i,t,a)=>{a.r(t),a.d(t,{arcgis_new_item_classification:()=>c});var e=a(20536),s=a(44090),r=a(1391),n=a(37568),o=a(28250);a(10699),a(91102),a(73807),a(34752),a(98034),a(99004),a(25972),a(38973),a(369);const c=class{constructor(i){(0,e.r)(this,i),this.classificationValueChange=(0,e.c)(this,"classificationValueChange",7),this.retrieveClassificationSchema=async()=>{var i,t;const a=`${s.c.portal.restUrl}/portals/self/classification/classificationSchema`,{result:e,error:r}=await(0,o.r)(a);e?(o.i.itemClassificationSchema=e,this.classificationCategoryArr=null===(t=null===(i=e.classificationMetadata)||void 0===i?void 0:i.classificationValueProperties)||void 0===t?void 0:t.map((({value:i,textColor:t,backgroundColor:a})=>({value:i,label:i,textColor:t,backgroundColor:a}))),e.attributeCategories&&this.setAttributeCategory(e.attributeCategories[0]),this.primaryAttribute=e.classificationMetadata.primaryAttribute,this.setClassificationValue()):this.handleDisplayNotificationModal({alertIndicatorActive:!0,alertIndicatorType:"danger",alertIndicatorIcon:"exclamation-mark-triangle",alertIndicatorInfo:null==r?void 0:r.message})},this.setClassificationValue=async()=>{var i;const{itemClassificationSchema:t,itemClassificationValue:a}=o.i;if(null==a?void 0:a.banner){const{error:i}=await(0,o.v)(a);i&&this.handleDisplayNotificationModal({alertIndicatorActive:!0,alertIndicatorType:"danger",alertIndicatorIcon:"exclamation-mark-triangle",alertIndicatorInfo:i.messages.join(", ")})}o.i.itemClassificationValueWithDefaults=(0,o.d)(a,this.primaryAttribute,t),o.i.itemClassificationValue=(0,o.b)(a,this.primaryAttribute,t),this.classificationType=(0,o.c)({value:null===(i=o.i.itemClassificationValueWithDefaults)||void 0===i?void 0:i.classification},t)},this.generateBannerText=async()=>{const{itemClassificationSchema:i,itemClassificationValueWithDefaults:t}=o.i,a=await(0,o.g)(i,t);t.banner=a;const e=await(0,o.l)(i,t);r.a.classification=e,this.emitClassificationValue(e)},this.emitClassificationValue=i=>{this.classificationValueChange.emit(Object.assign(Object.assign({},i),this.getEditInfo(s.c.user.username,o.i)))},this.setClassificationType=i=>{this.classificationType=i},this.setAttributeCategory=i=>{this.attributeCategory=i},this.setItemClassificationValue=i=>{const{itemClassificationSchema:t}=o.i,a=(0,o.m)(i,o.i.itemClassificationValueWithDefaults,this.primaryAttribute);o.i.itemClassificationValueWithDefaults=(0,o.n)(t,a),o.i.itemClassificationValue=a},this.handleItemClassificationChange=async()=>{const{itemClassificationSchema:i,itemClassificationValueWithDefaults:t,classificationErrors:a,activeAttributeId:e}=o.i;this.currSelectionText=await(0,o.e)(i,t),this.generateBannerText(),this.isEnableAttribute=await(0,o.f)(i,t);const s=await(0,o.h)(i,t,a,e);o.i.classificationErrors.conflictsError=s;const r=(0,o.j)({isEnableAttribute:this.isEnableAttribute,i18n:this.i18n,itemClassificationSchema:i,itemClassificationValue:t,classificationErrors:a,activeAttributeId:e});o.i.classificationErrors.requiredError=r,this.hasError=!!s.length||!!r.length},this.getEditInfo=(i,t)=>{const a=Date.now(),{createdUser:e=i,createdDate:s=a}=t.itemClassificationValueWithDefaults;return{createdUser:e,createdDate:s,lastEditedUser:i,lastEditedDate:a}},this.renderHeader=()=>{var i,t;const a=null===(i=o.i.itemClassificationSchema)||void 0===i?void 0:i.helpUrl,s=null===(t=o.i.itemClassificationSchema)||void 0===t?void 0:t.helpTooltip;return(0,e.h)("div",{role:"heading",class:"classification-section-label","aria-label":this.i18n.classificationSectionLabel},this.i18n.classificationSectionLabel,!!s&&(0,e.h)("arcgis-item-classification-header-help-tooltip",{helpUrl:a,helpTooltip:s}))},this.renderContent=()=>{const{itemClassificationSchema:i,itemClassificationValue:t,itemClassificationValueWithDefaults:a}=o.i;return(0,e.h)("div",{class:"portal-item-classification-content"},(0,e.h)("item-classification-info",{i18n:this.i18n,primaryAttribute:this.primaryAttribute,currSelectionText:this.currSelectionText}),!!this.classificationType&&(0,e.h)("item-classification-category",{i18n:this.i18n,primaryAttribute:this.primaryAttribute,classificationCategoryArr:this.classificationCategoryArr,classificationType:this.classificationType,onClassificationTypeChange:i=>{this.setClassificationType(i.detail)},onClassificationValueChange:i=>{this.setItemClassificationValue(i.detail)}}),!!i&&!!a&&(0,e.h)("item-classification-content",{i18n:this.i18n,primaryAttribute:this.primaryAttribute,itemClassificationValue:t,itemClassificationValueWithDefaults:a,attributeCategory:this.attributeCategory,onAttributeCategoryChange:i=>{this.setAttributeCategory(i.detail)},onArcgisItemClassificationContentDisplayNotification:i=>this.handleDisplayNotificationModal(i.detail),hasError:this.hasError}))},this.renderApp=()=>this.renderContent(),this.handleDisplayNotificationModal=i=>{this.alertIndicator=i,this.isNotificationModalActive=!0},this.handleCloseNotificationModal=()=>this.isNotificationModalActive=!1,this.classificationCategoryArr=[],this.classificationType=void 0,this.attributeCategory="General",this.primaryAttribute=void 0,this.currSelectionText=void 0,this.isEnableAttribute=[],this.hasError=!1,this.isNotificationModalActive=!1,this.alertIndicator={alertIndicatorActive:!1,alertIndicatorType:"danger",alertIndicatorIcon:"exclamation-mark-triangle",alertIndicatorInfo:""}}async componentWillLoad(){const i=await(0,n.g)(this.el);this.i18n=i[0],this.retrieveClassificationSchema(),o.p.onChange("itemClassificationValue",(i=>{i&&this.handleItemClassificationChange()}))}disconnectedCallback(){o.p.reset()}handleAttributeValueChange(i){const t=i.detail;o.i.activeAttributeId=t.attributeId,o.i.itemClassificationValueWithDefaults=Object.assign(Object.assign({},t.classificationWithDefaults),this.getEditInfo(s.c.user.username,o.i)),o.i.itemClassificationValue=t.classification}async checkAllAttributesInputErrors(){const{itemClassificationSchema:i,itemClassificationValueWithDefaults:t,classificationErrors:a}=o.i,e=[];Object.entries(i.attributes).forEach((([a,{attributeCategory:s}])=>{if((0,o.q)(a,this.isEnableAttribute,i,t)){const t=i.attributes[a].label;e.push({attributeId:a,attributeLabel:t,attributeCategory:s,errorMessage:this.i18n.fieldSelectionError})}})),o.i.classificationErrors.requiredError=e,this.hasError=!0;return(0,o.o)(this.i18n,a)}render(){return(0,e.h)(e.F,{key:"c88c40fbff8149884a0d6414e0d37c0622873b08"},this.renderHeader(),this.renderApp(),this.isNotificationModalActive&&(0,e.h)("item-classification-notification",{key:"51c5d65dd7361f2410770b463fb8e9e80ec9dfaa",i18n:this.i18n,alertIndicator:this.alertIndicator,onArcgisItemClassificationNotificationClose:()=>{this.handleCloseNotificationModal()}}))}get el(){return(0,e.d)(this)}};c.style=".item-classification-error{margin:1.25rem}.classification-section-label{margin-bottom:0.5rem;font-weight:700}#classification-tooltip-button{padding-inline-start:0.25rem}"}}]);