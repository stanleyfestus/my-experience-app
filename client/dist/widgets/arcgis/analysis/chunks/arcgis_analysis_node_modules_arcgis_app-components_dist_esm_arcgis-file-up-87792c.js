/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-file-up-87792c.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-file-up-87792c"],{81914:(e,i,a)=>{a.r(i),a.d(i,{arcgis_file_upload:()=>o});var s=a(20536),t=a(37568),r=a(30554),c=a(90230),l=a(7459);a(91102),a(73807),a(34752),a(98034),a(99004),a(25972),a(44090),a(10699),a(38973),a(369),a(78231),a(34472),a(1391),a(64243),a(76776),a(27995),a(90079),a(4291),a(67914),a(19832),a(79717),a(76246),a(16093),a(40883),a(86980),a(59377),a(68537),a(27126),a(11163),a(10493),a(16808),a(44069);const o=class{constructor(e){(0,s.r)(this,e),this.arcgisFileUploadComplete=(0,s.c)(this,"arcgisFileUploadComplete",7),this.allowedExtensions=null,this.portal=void 0,this.existingItem=void 0,this.user=void 0,this.config=void 0,this.isActive=!0,this.header=void 0,this.loading=!1,this.loaderMessage=void 0,this.loaderType="indeterminate",this.error=void 0}async componentWillLoad(){const{existingItem:e}=this,i=e.type,a=await(0,t.g)(this.el);this.i18n=a[0],"Vector Tile Service"===i&&(this.allowedExtensions=["json"])}async fileSelectHandler(e){var i;const{existingItem:a}=this;this.sourceName=(null===(i=a.sourceData)||void 0===i?void 0:i.name)||a.name;const s=e.detail.file,t=a.type,{fileName:r,extension:l}=(0,c.s)(s);"Vector Tile Service"!==t||"json"===l?r===this.sourceName?(this.file=s,"Vector Tile Service"===t?this.handleUpdateStyle():this.handleUpdate()):this.handleError({code:"useSameFileName"}):this.handleError({code:"invalidExtension"})}determineHeader(e,i){const{i18n:a}=this;switch(e){case"Vector Tile Service":return a.editStyle;case"Vector Tile Package":case"Layer Package":case"Tile Package":return a.updatePackages.replace("${type}",e.toLowerCase()).replace("${hostedLayerName}",i);case"Microsoft Powerpoint":case"Microsoft Word":case"PDF":return a.uploadStaticFiles.replace("${fileName}",i);default:return a.sameFileNameDescription.replace("${fileName}",i)}}async handleUpdate(){const{existingItem:e,portal:i,file:a,i18n:s}=this;this.loading=!0,this.loaderMessage=s.updating;const t=await(0,l.u)(e,(0,r.g)({username:e.owner},i),{file:a,overwrite:!0,keepDescription:!0,fileName:e.name});t.success?this.arcgisFileUploadComplete.emit({success:t.success}):this.handleError({code:"unhandledError"})}async handleUpdateStyle(){const{existingItem:e,portal:i,file:a,i18n:s}=this;this.loading=!0,this.loaderMessage=s.updating;const{result:t,error:c}=e.hasResources?await(0,l.a)(this.existingItem,(0,r.g)({username:e.owner},i),{file:a}):await(0,l.b)(this.existingItem,(0,r.g)({username:e.owner},i),{file:a});t.success&&this.arcgisFileUploadComplete.emit({success:t.success}),c&&this.handleError({code:c.code})}async handleError(e){const{i18n:i}=this;this.loading=!1;let a=i.errors.errorWhileUpload;switch(e.code){case"invalidExtension":a=i.errors.invalidStyleFileExtension;case"useSameFileName":a=i.errors.sameFileName.replace("${fileName}",this.sourceName);break;case"unhandledError":a=i.errors.errorUpdate}this.error={title:i.error,description:a}}render(){const{loaderType:e,loading:i,loaderMessage:a,error:t,allowedExtensions:r,isActive:c,portal:l,config:o,user:n,existingItem:d,i18n:h}=this,p=this.header||this.determineHeader(d.type,d.name);return(0,s.h)(s.H,{key:"73ccf9d026e4d372bf4729a9f1635a36e075f124"},(0,s.h)("calcite-dialog",{key:"79c4a869b5ca1a812b65aa8875204cbc39c73326",open:c,modal:!0,heading:h.updateData},(0,s.h)("arcgis-new-item-loader",{key:"a6614aeaff2b8ab8cd859f11a4c30ef813578d2e",type:e,active:i,text:a}),(0,s.h)("arcgis-new-item-description",{key:"c9a3da4fedb6e75c1959896c57a9dd8ab0a8b5f2",header:p}),(0,s.h)("arcgis-file-browser",{key:"57461841c4ce857554816d0918b83d3e695ca9c6",class:"arcgis-file-browser",cloud:!1,insideModal:!0,fullHeight:!0,portal:l,config:o,user:n,allowedExtensions:r}),(0,s.h)("calcite-alert",{key:"eb5b8a213565718b3ddcc3b394d95127385ba1ea",icon:"exclamation-mark-triangle",open:!!t,label:null==t?void 0:t.title,kind:"danger",slot:"alerts"},(0,s.h)("div",{key:"13a4c905ac76c982f53c6c43e5112b1db7979995",slot:"title"},null==t?void 0:t.title),(null==t?void 0:t.description)&&(0,s.h)("div",{key:"6de4cc55493994df79e8f61c57e1aa8be66c850e",slot:"message",class:"description"},t.description),(null==t?void 0:t.link)&&(0,s.h)("calcite-link",{key:"4ce07e24275b7c30ce40297111233770c27d5c1f",slot:"link",class:"link",href:t.link.href,target:"_blank"},t.link.title)),(0,s.h)("calcite-button",{key:"e1d796bd260b4634366a8c9bcf2445a23fb65831",slot:"footer-end",appearance:"outline-fill",onClick:()=>{this.isActive=!1}},h.cancel)))}get el(){return(0,s.d)(this)}}}}]);