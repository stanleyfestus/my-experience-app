/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f49b1e.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f49b1e"],{99004:(e,t,i)=>{i.d(t,{c:()=>a,g:()=>r});var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}},5298:(e,t,i)=>{i.r(t),i.d(t,{arcgis_field_add_pages_add_field:()=>f});var a=i(20536),r=i(37909),l=i(35162),n=i(79238),s=i(64243),o=i(98034),d=i(38973),c=i(76418),u=i(90079),p=i(25972);i(10699),i(44090),i(76776),i(1391),i(27995),i(4291),i(369),i(67914),i(30554),i(78231),i(19832),i(34472),i(79717),i(76246),i(16093),i(90230),i(40883),i(86980),i(59377),i(68537),i(99004),i(91102),i(73807);function h(e){return`${e}:00`}const m={esriFieldTypeInteger:"intDefaultValueError",esriFieldTypeBigInteger:"bigIntDefaultValueError",esriFieldTypeDouble:"doubleDefaultValueError"},f=class{constructor(e){(0,a.r)(this,e),this.arcgisWorkflowCancel=(0,a.c)(this,"arcgisWorkflowCancel",7),this.arcgisWorkflowComplete=(0,a.c)(this,"arcgisWorkflowComplete",7),this.arcgisWorkflowPrimaryButtonTextChange=(0,a.c)(this,"arcgisWorkflowPrimaryButtonTextChange",7),this.arcgisFieldAddFieldAdded=(0,a.c)(this,"arcgisFieldAddFieldAdded",7),this.arcgisWorkflowToggleNavigationEnabled=(0,a.c)(this,"arcgisWorkflowToggleNavigationEnabled",7),this.arcgisWorkflowCloseButtonEnabled=(0,a.c)(this,"arcgisWorkflowCloseButtonEnabled",7),this.selectedFieldValueType=null,this.showNullableToggle=!1,this.payload=void 0,this.layerAfterFieldAddition=void 0,this.nullValueInput=!0,this.payloadIsValid=!0,this.timeDateInputs=void 0,this.timeDatePickerIsValid=!0,this.fieldErrors={nameFieldError:null,lengthFieldError:null,bigIntDefaultValueError:null,doubleDefaultValueError:null,intDefaultValueError:null,timeDefaultValueFieldError:null,dateDefaultValueFieldError:null,timezoneDefaultValueFieldError:null,stringDefaultValueFieldError:null},this.nameFieldErrorTest=null,this.dateTimeDefaultValueIsValid=!0,this.dateTimeDefaultValueIsActive=!1,this.error=void 0,this.addInProgress=!1}async navigateToNextPage(){var e;const{i18n:t}=r.a,i=await(null===(e=this.descriptionRef)||void 0===e?void 0:e.getErrorMessage());if(i)return void(this.error={title:t.error,message:i.translatedMessage});if(!this.validatePayload())return this.payloadIsValid=!1,void(this.error={title:t.addFieldErrors.invalidFieldParameters,message:t.addFieldErrors.invalidInputsError});this.payload.type=r.a.selectedFieldType,this.payload.hasOwnProperty("defaultValue")&&!this.payload.defaultValue&&delete this.payload.defaultValue;const a={fields:[this.payload]},l=JSON.stringify(a);this.addInProgress=!0,this.disableModalButtons(!0),this.handleAddField(l)}handleFieldDescriptionInputChange(e){const{detail:t}=e;this.descriptionInput=t}async componentWillLoad(){var e;const{i18n:t,layer:i,selectedFieldType:a}=r.a;this.arcgisWorkflowPrimaryButtonTextChange.emit(t.addField),this.layerInfoToUpdate={},this.token=null!==(e=await(0,p.g)(i.portalItem.portal,4))&&void 0!==e?e:i.portalItem.portal.credential.token,await this.loadAllModules();const n=await i.queryFeatureCount();switch(this.showNullableToggle=0===n,await this.modules.request(i.url.replace("/rest/services","/rest/admin/services"),{query:{f:"json",token:this.token},responseType:"json"}).then((async e=>{const t=e.data;this.maxFieldNameLength=t.maxFieldNameLength}),(()=>this.maxFieldNameLength=l.g)),this.payload={name:"",type:"",alias:"",nullable:!0,editable:!0},this.timeDateInputs={date:"",time:""},a){case"esriFieldTypeGlobalID":this.payload.name="GlobalID",this.payload.alias="GlobalID",this.payload.nullable=!1,this.payload.editable=!1,this.payload.defaultValue="NEWID() WITH VALUES";break;case"esriFieldTypeString":this.payload.length=256;break;case"esriFieldTypeTimestampOffset":this.timeDateInputs.timezone="";break;case"esriFieldTypeGUID":this.selectedFieldValueType="uniqueIdentifier"}this.handlePickerConditions()}componentDidLoad(){const{i18n:e,selectedFieldType:t}=r.a;if("esriFieldTypeBigInteger"===t){document.querySelector("#esriFieldTypeBigInteger-block").shadowRoot.querySelector(".description").innerHTML=(0,c.i)(e.numbers.types.esriFieldTypeBigInteger.description)}"esriFieldTypeTimestampOffset"===r.a.selectedFieldType&&(this.timeZoneEl.shadowRoot.childNodes[0].maxItems=8)}render(){const{showNullableToggle:e,error:t,fieldErrors:i,addInProgress:l}=this,{selectedFieldType:s,selectedFieldTypeCategory:o,i18n:d}=r.a,{nameFieldError:c}=i,u="esriFieldTypeTimeOnly"===s||"esriFieldTypeDateOnly"===s||"esriFieldTypeTimestampOffset"===s||"esriFieldTypeBigInteger"===s,p=d[o].types[s].title,h=d[o].types[s].description;return(0,a.h)(a.H,{key:"e46e2d251732b52f05f5c14769672128c81ce051",class:{"overflow-hidden":l}},this.renderAddLoader(),(0,a.h)("div",{key:"4e347ee277ac41cade5952981f1e21536f571b8c",class:"field-block"},(0,a.h)("calcite-block",{key:"f7fcd780c9d8a86d6cca7013e0d95c4c2f2cdcea",id:`${s}-block`,class:"field-type-block",heading:p,description:h},(0,a.h)("calcite-icon",{key:"53780fa5f75a98f404ec6174d5e8c9e0b03844c4",scale:"s",slot:"icon",icon:n.f[s]})),u&&(0,a.h)("calcite-notice",{key:"a9409b5fd260fcf675b5ba633f140de8f5876ec1",open:!0,class:"new-field-type-notice",icon:"information",scale:"s"},(0,a.h)("div",{key:"01acaea8d887fbd2fcc3bacecdc4270d0ea9eae2",slot:"title"},d.newFieldTypeNotice))),"esriFieldTypeGlobalID"!==s?(0,a.h)("div",{class:"main-input-fields-container"},(0,a.h)("calcite-label",{class:"field-section"},d.fieldName,(0,a.h)("calcite-input",{status:null==c?void 0:c.status,required:!0,onCalciteInputInput:e=>{const t=e.target.value;this.handlePayloadInput(t,"name")}}),c&&(0,a.h)("calcite-input-message",{icon:null==c?void 0:c.icon,status:null==c?void 0:c.status},null==c?void 0:c.message)),(0,a.h)("calcite-label",{class:"field-section"},d.displayName,(0,a.h)("calcite-input",{onCalciteInputInput:e=>{const t=e.target.value;this.handlePayloadInput(t,"alias")}})),"esriFieldTypeString"===s&&(0,a.h)("calcite-label",{class:"field-section"},d.length,this.renderLengthField()),"esriFieldTypeGUID"!==s&&(0,a.h)("calcite-label",{class:"field-section"},d.defaultValue,this.fieldsToShow.enableNormalPicker?"esriFieldTypeString"===s?this.renderTextDefaultValue():this.renderNumberDefaultValue():(0,a.h)("div",{class:"time-date-pickers"},this.fieldsToShow.enableDatePicker&&this.renderDatePicker(),this.fieldsToShow.enableTimePicker&&this.renderTimePicker(),this.fieldsToShow.enableTimezonePicker&&this.renderTimezonePicker())),this.renderFieldDescriptionArea(),(0,a.h)("calcite-label",{class:"field-section"},d.fieldValueType,this.renderFieldValueTypeCombobox()),e&&this.renderNullableToggle()):(0,a.h)("calcite-notice",{open:!0,class:"global-id-notice",icon:"information",scale:"s"},(0,a.h)("div",{slot:"title"},d.addGlobalIDNotice)),(0,a.h)("arcgis-new-item-alert",{key:"0c564a512d398593a5166eafc86b534282fb2619",heading:null==t?void 0:t.title,description:null==t?void 0:t.message,active:!!t,onAlertDismiss:()=>this.error=null}))}renderAddLoader(){const{addInProgress:e}=this,{i18n:t}=r.a;return(0,a.h)("div",{class:"loader-container "+(e?"active":"")},(0,a.h)("calcite-loader",{class:"loader",label:t.addingField,hidden:!e}),(0,a.h)("div",{class:"loader-text"},t.addingField))}renderNullableToggle(){const{i18n:e}=r.a;return(0,a.h)("calcite-label",{layout:"inline",class:"field-section"},(0,a.h)("calcite-switch",{id:"toggleNullValues",checked:this.nullValueInput,onCalciteSwitchChange:e=>{this.nullValueInput=e.target.checked,this.handlePayloadInput(this.nullValueInput,"nullable")}}),e.allowNullValues)}renderTextDefaultValue(){const{stringDefaultValueFieldError:e}=this.fieldErrors;return(0,a.h)("div",null,(0,a.h)("calcite-input",{type:"text",onCalciteInputInput:e=>{const t=e.target.value;this.handlePayloadInput(t,"defaultValue")}}),e&&(0,a.h)("calcite-input-message",{class:"default-text-input-message",icon:null==e?void 0:e.icon,status:null==e?void 0:e.status},null==e?void 0:e.message))}renderNumberDefaultValue(){const{selectedFieldType:e}=r.a,{max:t,min:i}=function(e){let t,i;switch(e){case"esriFieldTypeBigInteger":t=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;break;case"esriFieldTypeDouble":default:t=l.b,i=l.c;break;case"esriFieldTypeInteger":t=l.M,i=l.a}return{max:t,min:i}}(e),n="esriFieldTypeDouble"===e,s=this.fieldErrors[m[e]];let o;const d=()=>{this.handlePayloadInput(o,"defaultValue"),this.inputNumberNode.value=this.payload.defaultValue};return(0,a.h)("calcite-input-number",{ref:e=>this.inputNumberNode=e,inputMode:"decimal",max:t,min:i,integer:!n,step:n?.01:1,status:s?"invalid":"idle","validation-icon":s?"exclamation-mark-triangle":null,"validation-message":s,onCalciteInputNumberInput:e=>{o=e.target.value,n||this.handlePayloadInput(o,"defaultValue")},onBlur:()=>{n&&d()}})}renderLengthField(){const{lengthFieldError:e}=this.fieldErrors;return(0,a.h)("calcite-input-number",{integer:!0,inputMode:"decimal",min:l.e,max:l.f,value:`${this.payload.length}`,required:!0,status:e?"invalid":"idle","validation-icon":e?"exclamation-mark-triangle":null,"validation-message":e,onCalciteInputNumberInput:e=>{const t=e.target.value;this.handlePayloadInput(t,"length")}})}renderDatePicker(){const{dateDefaultValueFieldError:e}=this.fieldErrors;return(0,a.h)("calcite-input-date-picker",{overlayPositioning:"fixed",class:"time-date-picker "+(e?"error-active":""),required:!!e,status:e?"invalid":"idle","validation-icon":e?"exclamation-mark-triangle":null,"validation-message":e,onCalciteInputDatePickerChange:e=>{const t=e.target.value,i=Array.isArray(t)?t[0]:t;this.handleTimeDatePickerInputs(i,"date")}})}renderTimePicker(){const{timeDefaultValueFieldError:e}=this.fieldErrors;return(0,a.h)("calcite-input-time-picker",{class:"time-date-picker "+(e?"error-active":""),required:!!e,status:e?"invalid":"idle","validation-icon":e?"exclamation-mark-triangle":null,"validation-message":e,onCalciteInputTimePickerChange:e=>{const t=e.target.value;this.handleTimeDatePickerInputs(t,"time")}})}renderTimezonePicker(){const{timezoneDefaultValueFieldError:e}=this.fieldErrors;return(0,a.h)("calcite-input-time-zone",{clearable:!0,value:this.timeDateInputs.timezone||null,id:"timezonePickerInput",ref:e=>this.timeZoneEl=e,class:"time-date-picker "+(e?"error-active":""),status:e?"invalid":"idle","validation-icon":e?"exclamation-mark-triangle":null,"validation-message":e,onCalciteInputTimeZoneChange:e=>{const t=e.target.value;this.handleTimeDatePickerInputs(t,"timezone")}})}renderFieldValueTypeCombobox(){const{i18n:e,selectedFieldType:t}=r.a,i="esriFieldTypeDate"===(n=t)||"esriFieldTypeDateOnly"===n||"esriFieldTypeTimeOnly"===n||"esriFieldTypeTimestampOffset"===n?"esriFieldTypeTime":t;var n;const s=l.h[i].sort(),o=Object.keys(e.fieldValueTypes).filter((e=>!s.includes(e)&&"none"!==e)).sort();return(0,a.h)("calcite-combobox",{maxItems:7,label:e.fieldValueType,selectionMode:"single-persist",onCalciteComboboxChange:e=>{const t=e.target.value;this.selectedFieldValueType=t}},(0,a.h)("calcite-combobox-item-group",{label:e.suggestedHeader},s.map((i=>(0,a.h)("calcite-combobox-item",{value:i,textLabel:e.fieldValueTypes[i],selected:"esriFieldTypeGUID"===t&&"uniqueIdentifier"===i})))),(0,a.h)("calcite-combobox-item-group",{label:e.otherHeader},o.map((t=>(0,a.h)("calcite-combobox-item",{value:t,textLabel:e.fieldValueTypes[t]})))))}renderFieldDescriptionArea(){const{i18n:e}=r.a;return(0,a.h)("arcgis-field-description-input",{trimInput:!0,label:e.fieldDescription,placeholder:e.provideDescription,maxLength:l.i,ref:e=>this.descriptionRef=e})}async loadAllModules(){const[e,t,i]=await(0,o.l)(["esri/request","esri/layers/support/FeatureTemplate","esri/Graphic"]);this.modules={request:e,FeatureTemplate:t,Graphic:i}}async handleAddField(e){var t;const{layer:i,i18n:a}=r.a,{request:l}=this.modules,{token:n}=this;try{const a={layer:i},o=`${i.url}/${i.layerId}`;await(0,s.A)(e,o,!1);const d=`${i.url}/${i.layerId}`;await l(d,{query:{f:"json",token:n},method:"post",responseType:"json"}).then((async e=>{a.serviceInfo=e.data,this.layerAfterFieldAddition=e.data}),(()=>this.handleError()));const c=a.serviceInfo.fields.filter((e=>e.name.toLowerCase()===this.payload.name.toLowerCase()&&(e.name!==this.payload.name&&(this.payload.name=e.name,a.name=e.name),!0)))[0];this.newFieldName=c.name;const u=function(e,t,i){let a={};switch(t.type){case"esriFieldTypeInteger":a.places=0,a.digitSeparator=!0;break;case"esriFieldTypeDouble":a.places=2,a.digitSeparator=!0;break;case i>=10:a.dateFormat="short-date-long-time"}const r={fieldName:t.name,label:t.alias,isEditable:t.editable,tooltip:"",visible:!0,format:a,stringFieldOption:"text-box"};e&&e.fieldInfos&&(e.fieldInfos.some((e=>e.fieldName===r.fieldName))||e.fieldInfos.push(r));return e}(i.popupTemplate,c,i.version);this.layerInfoToUpdate.popupInfo=u,a.popupInfo=u,this.updateTypesAndTemplatesOnLayer(),(null===(t=a.serviceInfo.templates)||void 0===t?void 0:t.length)?a.serviceInfo.templates.forEach((e=>{"esriFieldTypeGlobalID"!==r.a.selectedFieldType&&(e.prototype.attributes[c.name]=c.defaultValue||null)})):a.serviceInfo.types.forEach((e=>{e.templates.forEach((e=>{"esriFieldTypeGlobalID"!==r.a.selectedFieldType&&(e.prototype.attributes[c.name]=c.defaultValue||null)}))})),this.updateFeatureService(a,this.modules.request)}catch(e){console.error(e),this.addInProgress=!1,this.disableModalButtons(!1),this.error={title:a.addFieldErrors.genericAddFieldError.title,message:a.addFieldErrors.genericAddFieldError.description}}}updateTypesAndTemplatesOnLayer(){var e;const{layerAfterFieldAddition:t}=this,i=t;if(null===(e=i.templates)||void 0===e?void 0:e.length){const e=this.updateTemplatesList(i.templates);i.templates=e}else if(i.types){const e=i.types;i.types=[],e.forEach((e=>{e.templates=this.updateTemplatesList(e.templates),this.addType(i,e)}))}}updateTemplatesList(e){const{i18n:t}=r.a,{layerAfterFieldAddition:i}=this,{modules:a}=this,l=[];return(null!=e?e:[]).forEach((e=>{var r;const n=new a.FeatureTemplate;n.description=null!==(r=e.description)&&void 0!==r?r:"",n.name=e.name||t.newFeature,n.drawingTool=e.drawingTool||"point";const s={};i.fields.forEach((t=>{let i=!1;for(const a in e.prototype.attributes)if(a===t.name){i=!0,s[t.name]=e.prototype.attributes[t.name];break}!i&&t.editable&&(s[t.name]=t.defaultValue||null)}));const o=new a.Graphic({attributes:s});n.prototype=o,l.push(n)})),l}addType(e,t){if(e.types){e.types.some((e=>e.id===t.id))||e.types.push(t)}else e.types=[t]}async updateFeatureService(e,t){const{i18n:i,layer:a}=r.a,{payload:l,token:n}=this,s=a.portalItem;let o=e.serviceInfo.templates;if(!o.length){const e={name:i.newFeature,description:"",drawingTool:"esriFeatureEditToolPoint",prototype:{attributes:{}}};this.layerAfterFieldAddition.fields.forEach((t=>{"esriFieldTypeGlobalID"!==r.a.selectedFieldType&&(e.prototype.attributes[t.name]=t.defaultValue||null)})),o=[e]}const c={templates:o,types:e.serviceInfo.types};let p=JSON.stringify(c);if(this.selectedFieldValueType||this.descriptionInput){l.description=Object.assign({value:this.descriptionInput?this.descriptionInput.replace(/"/g,"${addEscapeDash}").replace(/\n/g,"\\n"):""},this.selectedFieldValueType&&{fieldValueType:this.selectedFieldValueType}),l.domain=null,c.fields=[l];p=function(e,t,i){const a=e.indexOf(t),r=e.indexOf(i),l=e.slice(a,r).replace(/"/g,'\\"').replace(/\$\{addEscapeDash}/g,'\\\\\\"');return`${e.slice(0,a)}"${l}"${e.slice(r)}`}(JSON.stringify(c),'{"value"',',"domain"')}const h=`${a.url.replace("/rest/services","/rest/admin/services")}/${a.layerId}/updateDefinition`,m={f:"json",updateDefinition:p};await t(h,{query:Object.assign(Object.assign({},m),{f:"json",token:n}),method:"post",responseType:"json"}).then((async i=>{var r;if(null===(r=i.data)||void 0===r?void 0:r.success){const i=e.serviceInfo;if(i){const e=i.fields;e.forEach(((t,i)=>e[i].type=u.e[e[i].type])),this.layerInfoToUpdate.fields=e}const r=`${(0,d.g)(s.portal)}content/items/${s.id}/data`;await t(r,{query:{f:"json"},method:"get",responseType:"json",token:n}).then((async i=>{const r=i.data;if((null==r?void 0:r.layers)||(null==r?void 0:r.tables)){const i=a.isTable,l=i?r.tables:r.layers,o=null==l?void 0:l.find((e=>e.id===a.layerId));if(null==o?void 0:o.popupInfo){o.popupInfo.fieldInfos=[...e.popupInfo.fieldInfos];const a=`${(0,d.g)(s.portal)}content/users/${s.owner}/items/${s.id}/update`,r=i?{tables:l}:{layers:l},c={f:"json",text:JSON.stringify(r)};await t(a,{query:Object.assign(Object.assign({f:"json"},c),{token:n}),method:"post",responseType:"json"}).then((e=>{var t;(null===(t=e.data)||void 0===t?void 0:t.success)?this.handleSuccess():this.handleError()}),(()=>this.handleError()))}else this.handleSuccess()}else 200!==i.httpStatus||i.data&&"{}"!==JSON.stringify(i.data)?this.handleError():this.handleSuccess()}),(()=>this.handleError()))}}),(()=>this.handleError()))}validatePayload(){var e;return"esriFieldTypeGlobalID"!==r.a.selectedFieldType&&this.checkFieldErrors(),this.dateTimeDefaultValueIsValid&&(!this.fieldErrors.nameFieldError||"invalid"!==(null===(e=this.fieldErrors.nameFieldError)||void 0===e?void 0:e.status))&&!this.fieldErrors.lengthFieldError&&!this.fieldErrors.bigIntDefaultValueError&&!this.fieldErrors.doubleDefaultValueError&&!this.fieldErrors.intDefaultValueError}checkFieldErrors(){const{payload:e,fieldErrors:t,maxFieldNameLength:i}=this,{layer:a,selectedFieldType:n,i18n:s}=r.a,o=Object.assign({},t);switch(o.nameFieldError=function(e,t,i){const{addFieldErrors:a}=r.a.i18n,n={icon:"exclamation-mark-triangle",status:"invalid",message:null},s=e.toUpperCase(),o=l.s.includes(s),d=/[\`\~\@\#\$\%\^\&\*\(\)\\\-\+\=\|\,<>\?\/\{\}\.\!\'\[\]\:\;\n\r\s\"]/.test(e)||/[\`\~\@\#\$\%\^\&\*\(\)\\\-\+\=\|\,<>\?\/\{\}\.\!\'\[\]\:\;\n\r\d\_\"]/.test(e.charAt(0)),c=t.some((t=>t.name.toLowerCase()===e.toLowerCase())),u=e.length>i,p=+e[0],h=e.length>l.d;switch(!0){case!e.length:n.message=a.valueIsRequiredError;break;case!!p:case d:n.message=a.invalidNameInputInvalidCharactersError;break;case o:n.message=a.invalidNameInputSQLError;break;case c:n.message=a.existingFieldNameError;break;case u:n.message=a.lengthExceeds.replace("${maxFieldNameLength}",`${i}`);break;case h:n.icon="information",n.status="idle",n.message=r.a.i18n.fieldNameCharacterNotice}return n.message?n:null}(e.name,a.fields,i),!0){case"esriFieldTypeString"===n:o.lengthFieldError=function(e){const{addFieldErrors:t}=r.a.i18n,i=e<l.e,a=e>l.f;return i||a?t.outOfRangeValueError:null}(e.length),o.stringDefaultValueFieldError=e.defaultValue&&function(e,t){const{addFieldErrors:i}=r.a.i18n;return t.length>e?{icon:"information",status:"idle",message:i.defaultValueExceeds}:null}(e.length,e.defaultValue);break;case"esriFieldTypeInteger"===n:case"esriFieldTypeDouble"===n:case"esriFieldTypeBigInteger"===n:o[m[n]]=function(e,t){const{addFieldErrors:i}=r.a.i18n;switch(e){case"esriFieldTypeBigInteger":if(t>Number.MAX_SAFE_INTEGER||t<Number.MIN_SAFE_INTEGER)return i.outOfRangeValueError;break;case"esriFieldTypeDouble":if(t>l.b||t<l.c)return i.outOfRangeValueError;break;case"esriFieldTypeInteger":if(t>l.M||t<l.a)return i.outOfRangeValueError}return null}(n,e.defaultValue);break;case("esriFieldTypeDate"===n||"esriFieldTypeTimestampOffset"===n)&&!this.dateTimeDefaultValueIsValid:o.timeDefaultValueFieldError=this.timeDateInputs.time.length?null:s.addFieldErrors.valueIsRequiredError,o.dateDefaultValueFieldError=this.timeDateInputs.date.length?null:s.addFieldErrors.valueIsRequiredError,"esriFieldTypeTimestampOffset"===n&&(o.timezoneDefaultValueFieldError=this.timeDateInputs.timezone.length?null:s.addFieldErrors.valueIsRequiredError)}this.fieldErrors=Object.assign({},o)}handlePayloadInput(e,t){const{selectedFieldType:i}=r.a;let a=e;if("defaultValue"===t&&e)switch(i){case"esriFieldTypeTimeOnly":a=h(e);break;case"esriFieldTypeDouble":a=function(e){let t=e;if(null==e?void 0:e.includes(".")){const i=e.split(".");if(null==i?void 0:i.length){const e=i[1].length,a=Number(i[0]);a!==l.b&&a!==l.c||(t=Math.round(Number(t))),e>3&&(t=Number(t).toFixed(3))}}return`${t}`}(e)}this.payload[t]=a,this.checkFieldErrors()}checkIfTimeDatePickerValid(){const e=Object.values(this.timeDateInputs).every((e=>!!e)),t=Object.values(this.timeDateInputs).every((e=>!e));return this.dateTimeDefaultValueIsValid=e||t,this.dateTimeDefaultValueIsValid}handleTimeDatePickerInputs(e,t){const{selectedFieldType:i}=r.a;switch(i){case"esriFieldTypeDate":this.timeDateInputs[t]=e,this.timeDateInputs.date&&this.timeDateInputs.time?this.handlePayloadInput(function(e,t){const i=h(e);return Date.parse(`${t} ${i}`)}(this.timeDateInputs.time,this.timeDateInputs.date),"defaultValue"):this.timeDateInputs.date||this.timeDateInputs.time||(this.dateTimeDefaultValueIsValid=!0,this.handlePayloadInput("","defaultValue"));break;case"esriFieldTypeTimestampOffset":this.timeDateInputs[t]=e,this.timeDateInputs.date&&this.timeDateInputs.time&&this.timeDateInputs.timezone?this.handlePayloadInput(function(e,t,i){const a=Math.floor(Number(i)/60),r=a<0?-1*a:a,l=Number(i)%60;return`${e}T${t}:00${a<0?"-":"+"}${String(r).padStart(2,"0")}:${l>0?l:"00"}`}(this.timeDateInputs.date,this.timeDateInputs.time,this.timeDateInputs.timezone),"defaultValue"):this.timeDateInputs.date||this.timeDateInputs.time||this.timeDateInputs.timezone||(this.dateTimeDefaultValueIsValid=!0,this.handlePayloadInput("","defaultValue"));break;case"esriFieldTypeTimeOnly":case"esriFieldTypeDateOnly":this.handlePayloadInput(e,"defaultValue")}this.dateTimeDefaultValueIsActive=Object.values(this.timeDateInputs).some((e=>e.length>0)),this.checkIfTimeDatePickerValid()}handlePickerConditions(){const{selectedFieldType:e}=r.a,t="esriFieldTypeDate"===e||"esriFieldTypeTimestampOffset"===e,i=t||"esriFieldTypeTimeOnly"===e,a=t||"esriFieldTypeDateOnly"===e,l="esriFieldTypeTimestampOffset"===e,n=!i&&!a&&!l;this.fieldsToShow={enableNormalPicker:n,enableTimePicker:i,enableDatePicker:a,enableTimezonePicker:l}}disableModalButtons(e){this.arcgisWorkflowToggleNavigationEnabled.emit(!e),this.arcgisWorkflowCloseButtonEnabled.emit(!e)}handleSuccess(){this.displaySuccessAlert(),this.arcgisFieldAddFieldAdded.emit(this.newFieldName),(0,r.d)(),this.arcgisWorkflowComplete.emit("success")}displaySuccessAlert(){const{i18n:e}=r.a,t=document.createElement("calcite-alert");t.kind="success",t.icon="check-circle",t.autoClose=!0;const i=document.createElement("div");i.slot="message",i.innerHTML=e.fieldAdded,t.append(i),t.open=!0,document.body.append(t)}displayErrorAlert(){var e;const{i18n:t}=r.a;this.errorAlertNode&&(null===(e=this.errorAlertNode.parentElement)||void 0===e||e.removeChild(this.errorAlertNode),this.errorAlertNode=null);const i=this.errorAlertNode=document.createElement("calcite-alert");i.kind="danger",i.icon="exclamation-mark-triangle";const a=document.createElement("div");a.slot="message",a.innerHTML=t.fieldAdditionUnsuccessful,i.append(a),i.open=!0,document.body.append(i),setTimeout((()=>i.setFocus()),1e3)}handleError(){this.arcgisWorkflowCancel.emit(),this.displayErrorAlert()}get el(){return(0,a.d)(this)}};f.style=".field-type-block.sc-arcgis-field-add-pages-add-field{margin-bottom:1.25rem}.time-date-pickers.sc-arcgis-field-add-pages-add-field{display:flex;flex-direction:column;gap:0.75rem}.new-field-type-notice.sc-arcgis-field-add-pages-add-field{padding-bottom:1rem;color:var(--calcite-color-text-1)}.field-section.sc-arcgis-field-add-pages-add-field{margin-bottom:0.75rem}.global-id-notice.sc-arcgis-field-add-pages-add-field{color:var(--calcite-color-text-1)}.error-active.sc-arcgis-field-add-pages-add-field{margin-bottom:0.5rem}.loader-container.sc-arcgis-field-add-pages-add-field{position:absolute;top:0px;right:0px;z-index:40;display:none;height:100%;width:100%;overflow:hidden;padding:0px;background:rgba(255, 255, 255, 0.95)}.active.sc-arcgis-field-add-pages-add-field{display:flex;flex-direction:column;place-content:center;align-items:center;justify-items:center}.loader.sc-arcgis-field-add-pages-add-field{padding:0px}.loader-text.sc-arcgis-field-add-pages-add-field{text-align:center;font-size:1rem;font-weight:500;margin-right:6.25rem;margin-left:6.25rem}.character-notice-icon.sc-arcgis-field-add-pages-add-field{--calcite-ui-icon-color:var(--calcite-color-brand)}calcite-block.sc-arcgis-field-add-pages-add-field{border-width:2px;border-style:solid;border-color:var(--calcite-color-border-3)}.default-text-input-message.sc-arcgis-field-add-pages-add-field{--calcite-input-message-spacing-value:0.75rem}"},91102:(e,t,i)=>{i.d(t,{a:()=>o,c:()=>r,d:()=>d,g:()=>l,i:()=>n,s:()=>s});var a=i(73807);function r(e,t){return function e(i){return i?i.closest(t)||e(function(e){return e.getRootNode()}(i).host||null):null}(e)}function l(e){const t=r(e,".calcite-mode-dark, .calcite-mode-light");return(null==t?void 0:t.classList.contains("calcite-mode-dark"))?"dark":"light"}function n(e){let t=e;for(;null==t?void 0:t.parentNode;){if(t.parentNode===document)return!0;t=t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}return!1}function s(e){return(new a.S).sanitize(e)}function o(e){const t=s(e),i=document.createElement("div");return i.innerHTML=t,i.textContent||i.innerText||""}function d(e){const t=document.createElement("textarea");return t.innerHTML=e,t.value}},98034:(e,t,i)=>{i.d(t,{e:()=>l,l:()=>n});var a,r=i(99004),l={exports:{}};a=l.exports,r.c,function(e){var t={Promise:"undefined"!=typeof window?window.Promise:void 0},i="4.24",a="next";function r(e){if(e.toLowerCase()===a)return a;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function l(e){return void 0===e&&(e=i),"https://js.arcgis.com/".concat(e,"/")}function n(e){void 0===e&&(e=i);var t=l(e),n=r(e);if(n!==a&&3===n.major){var s=n.minor<=10?"js/":"";return"".concat(t).concat(s,"esri/css/esri.css")}return"".concat(t,"esri/themes/light/main.css")}function s(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}function o(e,t){if(t){var i=document.querySelector(t);i.parentNode.insertBefore(e,i)}else document.head.appendChild(e)}function d(e){return document.querySelector('link[href*="'.concat(e,'"]'))}function c(e){return!e||r(e)?n(e):e}function u(e,t){var i=c(e),a=d(i);return a||o(a=s(i),t),a}var p={};function h(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}function m(e,t,i){var a;i&&(a=f(e,i));var r=function(){t(e),e.removeEventListener("load",r,!1),a&&e.removeEventListener("error",a,!1)};e.addEventListener("load",r,!1)}function f(e,t){var i=function(a){t(a.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",i,!1)};return e.addEventListener("error",i,!1),i}function T(e){void 0===e&&(e={}),p=e}function E(){return document.querySelector("script[data-esri-loader]")}function g(){var e=window.require;return e&&e.on}function y(e){void 0===e&&(e={});var i={};[p,e].forEach((function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(i[t]=e[t])}));var a=i.version,r=i.url||l(a);return new t.Promise((function(e,t){var l=E();if(l){var n=l.getAttribute("src");n!==r?t(new Error("The ArcGIS API for JavaScript is already loaded (".concat(n,")."))):g()?e(l):m(l,e,t)}else if(g())t(new Error("The ArcGIS API for JavaScript is already loaded."));else{var s=i.css;s&&u(!0===s?a:s,i.insertCssBefore),m(l=h(r),(function(){l.setAttribute("data-esri-loader","loaded"),e(l)}),t),document.body.appendChild(l)}}))}function I(e){return new t.Promise((function(t,i){var a=window.require.on("error",i);window.require(e,(function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];a.remove(),t(e)}))}))}function b(e,t){if(void 0===t&&(t={}),g())return I(e);var i=E(),a=i&&i.getAttribute("src");return!t.url&&a&&(t.url=a),y(t).then((function(){return I(e)}))}e.utils=t,e.loadModules=b,e.getScript=E,e.isLoaded=g,e.loadScript=y,e.setDefaultOptions=T,e.loadCss=u,Object.defineProperty(e,"__esModule",{value:!0})}(a);const n=async(e,t)=>(await l.exports.loadModules(e,t)).map((e=>e.__esModule&&e.default?e.default:e))},37909:(e,t,i)=>{i.d(t,{a:()=>r,d:()=>l});const a=(0,i(10699).c)({itemData:null,layer:null,selectedFieldType:null,selectedFieldTypeCategory:null,i18n:null}),r=a.state,l=a.dispose},76418:(e,t,i)=>{i.d(t,{a:()=>s,c:()=>o,g:()=>r,i:()=>l,r:()=>n});var a=i(91102);function r(e){return function(e){return null==e?void 0:e.replace(/&#10;&#13;|&#10;|&#13;|\r\n|\r|\n/g,"<br>")}(function(e){return null==e?void 0:e.replace(/(?:\r)/g,"&#10;").replace(/(?:\n)/g,"&#13;")}(function(e){return null==e?void 0:e.replace(/(https?:\/\/[^\s]+)/g,(e=>`<a href="${e}" target="_blank">${e}</a>`))}(function(e){return null==e?void 0:e.replace(/(?:&#10;)/g,"\r").replace(/(?:&#13;)/g,"\n")}(e))))}function l(e){return e.replace(/\$\{startSup\}/g,"<sup>").replace(/\$\{endSup\}/g,"</sup>")}function n(e,t,i){return e.replace(/\$\{startLink\}/g,`<calcite-link label="${i}" href="${t}" target="_blank">`).replace(/\$\{endLink\}/g,"</calcite-link>")}function s(e){return e.replace(/\$\{startStrong\}/g,"<strong>").replace(/\$\{endStrong\}/g,"</strong>")}function o(e){return(0,a.s)((null==e?void 0:e.trim())||"").replace(/[!*+\-&|()[\]{}^~?:"\\]/g,"\\$&")}},79238:(e,t,i)=>{i.d(t,{a:()=>a,e:()=>r,f:()=>l});const a={point:"point",line:"line",polygon:"polygon",multipatch:"cube",table:"table",multipoint:"layer-points"},r={esriGeometryPoint:"point",esriGeometryPolyline:"line",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"cube",esriGeometryMultipoint:"point",none:"table"},l={esriFieldTypeOID:"key",esriFieldTypeBoolean:"boolean",esriFieldTypeString:"string",esriFieldTypeSingle:"number",esriFieldTypeDouble:"number",esriFieldTypeInteger:"integer",esriFieldTypeSmallInteger:"integer",esriFieldTypeGlobalID:"key",esriFieldTypeDate:"date-time",esriFieldTypeBigInteger:"integer",esriFieldTypeDateOnly:"calendar",esriFieldTypeTimeOnly:"clock",esriFieldTypeTimestampOffset:"time-zone",esriFieldTypeGUID:"key"}},35162:(e,t,i)=>{i.d(t,{M:()=>o,a:()=>s,b:()=>c,c:()=>d,d:()=>r,e:()=>n,f:()=>l,g:()=>a,h:()=>m,i:()=>u,j:()=>p,k:()=>h,s:()=>f});const a=128,r=31,l=2147483647,n=1,s=-2147483648,o=2147483647,d=-9e15,c=9e15,u=500,p=["text","numbers","dates","globalIdentifiers"],h=["esriFieldTypeString","esriFieldTypeDouble","esriFieldTypeInteger","esriFieldTypeBigInteger","esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset","esriFieldTypeGlobalID","esriFieldTypeGUID"],m={esriFieldTypeString:["binary","coordinate","dateAndTime","description","emailAddress","locationOrPlaceName","nameOrTitle","orderedOrRanked","phoneNumber","typeOrCategory","uniqueIdentifier"],esriFieldTypeInteger:["binary","coordinate","countOrAmount","currency","measurement","orderedOrRanked","percentageOrRatio","phoneNumber","typeOrCategory","uniqueIdentifier"],esriFieldTypeBigInteger:["countOrAmount","currency","measurement","orderedOrRanked","phoneNumber","typeOrCategory","uniqueIdentifier"],esriFieldTypeDouble:["binary","coordinate","countOrAmount","currency","measurement","orderedOrRanked","percentageOrRatio","typeOrCategory"],esriFieldTypeTime:["dateAndTime"],esriFieldTypeGUID:["uniqueIdentifier"]},f=["ABSOLUTE","ACCESS","ACTION","ADD","ALL","ALLOCATE","ALPHANUMERIC","ALTER","AND","ANY","ARE","AS","ASC","ASSERTION","AT","AUTHORIZATION","AUTOINCREMENT","AVG","BEGIN","BETWEEN","BINARY","BIT","BIT_LENGTH","BOOLEAN","BOTH","BY","BYTE","CASCADE","CASCADED","CASE","CAST","CATALOG","CHAR","CHAR_LENGTH","CHARACTER","CHARACTER_LENGTH","CHECK","CLOSE","COALESCE","COLLATE","COLLATION","COLUMN","COMMENT","COMMIT","CONNECT","CONNECTION","CONSTRAINT","CONSTRAINTS","CONTINUE","CONVERT","CORRESPONDING","COUNT","COUNTER","CREATE","CROSS","CURRENCY","CURRENT","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATE","DATETIME","DAY","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DESC","DESCRIBE","DESCRIPTOR","DIAGNOSTICS","DISCONNECT","DISALLOW","DISTINCT","DISTINCTROW","DOMAIN","DOUBLE","DROP","EQV","ELSE","END","END-EXEC","ESCAPE","EXCEPT","EXCEPTION","EXEC","EXECUTE","EXISTS","EXTERNAL","EXTRACT","FALSE","FETCH","FIRST","FLOAT","FLOAT4","FLOAT8","FOR","FOREIGN","FOUND","FROM","FULL","GENERAL","GET","GLOBAL","GO","GOTO","GRANT","GROUP","GUID","HAVING","HOUR","IDENTITY","IEEEDOUBLE","IEEESINGLE","IGNORE","IMMEDIATE","IMAGE","IN","IMP","INDEX","INDICATOR","INITIALLY","INNER","INPUT","INSENSITIVE","INSERT","INT","INTEGER","INTEGER4","INTEGER1","INTEGER2","INTERSECT","INTERVAL","INTO","IS","ISOLATION","JOIN","KEY","LANGUAGE","LAST","LEADING","LEFT","LEVEL","LIKE","LOCAL","LOCK","LOGICAL","LOGICAL1","LONG","LONGBINARY","LONGTEXT","LOWER","MATCH","MAX","MEMO","MIN","MINUTE","MODULE","MONTH","MOD","MONEY","NAMES","NATIONAL","NATURAL","NCHAR","NEXT","NO","NOT","NULL","NULLIF","NUMBER","NUMERIC","OCTET_LENGTH","OF","OFF","OLEOBJECT","ON","ONLY","OPEN","OPTION","OR","ORDER","OUTER","OUTPUT","OWNERACCESS","OVERLAPS","PAD","PARTIAL","PARAMETERS","PERCENT","PIVOT","POSITION","PRECISION","PREPARE","PRESERVE","PRIMARY","PRIOR","PRIVILEGES","PROCEDURE","PUBLIC","READ","REAL","REFERENCES","RELATIVE","RESTRICT","REVOKE","RIGHT","ROLLBACK","ROWID","ROWS","SCHEMA","SCROLL","SECOND","SECTION","SELECT","SESSION","SESSION_USER","SET","SHORT","SINGLE","SIZE","SMALLINT","SOME","SPACE","SQL","SQLCODE","SQLERROR","SQLSTATE","STDEV","STDEVP","STRING","SUBTYPE","SUBSTRING","SUM","SYSTEM_USER","TABLE","TABLEID","TEMPORARY","TEXT","THEN","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TOP","TRAILING","TRANSACTION","TRANSFORM","TRANSLATE","TRANSLATION","TRIM","TRUE","TYPE","UNION","UNIQUE","UNKNOWN","UPDATE","UPPER","USAGE","USER","USING","VALUE","VALUES","VAR","VARCHAR","VARBINARY","VARP","VARYING","VIEW","WHEN","WHENEVER","WHERE","WITH","WORK","WRITE","XOR","YEAR","YESNO","ZONE"]}}]);