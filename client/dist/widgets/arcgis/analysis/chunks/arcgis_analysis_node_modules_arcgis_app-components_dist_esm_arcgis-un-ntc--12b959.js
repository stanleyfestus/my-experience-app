"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-un-ntc--12b959"],{3725:(t,e,i)=>{i.r(e),i.d(e,{arcgis_un_ntc_pick_list:()=>l,arcgis_un_ntc_pick_list_info:()=>d});var s,n=i(20536),r=i(98034),o=i(37568);i(99004),i(91102),i(73807),i(34752);!function(t){t.default="default",t.title="title",t.type="type",t.description="description"}(s||(s={}));const l=class{constructor(t){(0,n.r)(this,t),this.arcgisNtcPickListChange=(0,n.c)(this,"arcgisNtcPickListChange",7),this.arcgisNtcPickListDismissed=(0,n.c)(this,"arcgisNtcPickListDismissed",7),this.arcgisNtcPickListSortByChange=(0,n.c)(this,"arcgisNtcPickListSortByChange",7),this.errorMessage="",this.namedTraceConfigurationsInfo=[],this.calciteValueList=t=>(0,n.h)("calcite-list-item",{key:t.id,label:t.title,description:t.description,value:t.id,selected:this.selectedNTCs.indexOf(t.id)>-1,metadata:{id:t.id,title:t.title}},(0,n.h)("calcite-action",{slot:"actions-end",text:this.strings.info,title:this.strings.info,scale:"s",icon:"information",onClick:e=>{e.stopPropagation();const i=document.createElement("calcite-flow-item");i.heading=t.title,i.description=t.description;const s=document.createElement("arcgis-un-ntc-pick-list-info");s.utilityNetwork=this.utilityNetwork,s.ntcId=t.id,s.strings=this.strings,s.classList.add("content"),i.appendChild(s),this.flowElement.appendChild(i),i.setFocus()}})),this.filterPlaceholderText=void 0,this.multiple=!0,this.popoverProps=void 0,this.selectedNTCs=[],this.showFilterLength=10,this.showSort=!0,this.sortBy=s.default,this.utilityNetwork=void 0,this.lastSortyBy=s.default,this.filterNTCs=null,this.isOpen=!1}async componentWillLoad(){await this.loadAllModules();const t=await(0,o.g)(this.hostElement);this.strings=t[0],this.currentLanguage=t[1],this.lastSortyBy=this.sortBy||this.lastSortyBy;try{if(this.namedTraceConfigurations=await this.utilityNetwork.queryNamedTraceConfigurations({}),!this.namedTraceConfigurations.length)return void(this.errorMessage=this.strings.ntcNoTracesFound);this.namedTraceConfigurations.forEach((t=>{this.namedTraceConfigurationsInfo.push({id:t.globalId,creationDate:t.creationDate,creator:t.creator,description:t.description,minStartingPoints:t.minStartingPoints,resultTypes:t.resultTypes,tags:t.tags,title:t.title,type:t.traceType})})),this.utilityNetwork.sharedNamedTraceConfigurations.forEach((t=>{this.selectedNTCs.push(t.globalId)}))}catch(t){this.errorMessage=t.message}}componentDidLoad(){this.isOpen=!0}async reposition(){var t;null===(t=this.popoverNode)||void 0===t||t.reposition()}getSortedList(){const t=[...this.namedTraceConfigurationsInfo];return this.lastSortyBy===s.title?t.sort(((t,e)=>t.title.localeCompare(e.title))):this.lastSortyBy===s.description&&t.sort(((t,e)=>t.description.localeCompare(e.description))),this.lastSortyBy===s.type&&t.sort(((t,e)=>t.type.localeCompare(e.type))),t}selectDeselect(){var t;return(null===(t=this.filterNTCs)||void 0===t?void 0:t.length)?this.filterContainsAll():this.selectedNTCs.length===this.namedTraceConfigurationsInfo.length}filterContainsAll(){return this.filterNTCs.every((t=>this.selectedNTCs.some((e=>e===t))))}async loadAllModules(){const[t]=await(0,r.l)(["esri/networks/support/NamedTraceConfiguration"]);this.NamedTraceConfiguration=t}render(){var t;const e=(0,n.h)("calcite-dropdown",{overlayPositioning:"fixed",slot:"filter-actions-end",placement:"bottom-end"},(0,n.h)("calcite-action",{slot:"trigger",text:this.strings.sort,title:this.strings.sort},(0,n.h)("calcite-icon",{scale:"s",icon:"sortDescending"})),(0,n.h)("calcite-dropdown-group",null,(0,n.h)("calcite-dropdown-item",{selected:this.lastSortyBy===s.default,onClick:()=>{this.lastSortyBy=s.default,this.arcgisNtcPickListSortByChange.emit(this.lastSortyBy)}},this.strings.default),(0,n.h)("calcite-dropdown-item",{selected:this.lastSortyBy===s.title,onClick:()=>{this.lastSortyBy=s.title,this.arcgisNtcPickListSortByChange.emit(this.lastSortyBy)}},this.strings.name),(0,n.h)("calcite-dropdown-item",{selected:this.lastSortyBy===s.type,onClick:()=>{this.lastSortyBy=s.type,this.arcgisNtcPickListSortByChange.emit(this.lastSortyBy)}},this.strings.type),(0,n.h)("calcite-dropdown-item",{selected:this.lastSortyBy===s.description,onClick:()=>{this.lastSortyBy=s.description,this.arcgisNtcPickListSortByChange.emit(this.lastSortyBy)}},this.strings.description))),i=(0,n.h)("div",{class:"selection-button-div"},(0,n.h)("calcite-button",{appearance:"transparent",scale:"s",width:"full",onClick:()=>{var t,e;this.selectDeselect()?this.selectedNTCs=(null===(t=this.filterNTCs)||void 0===t?void 0:t.length)?this.selectedNTCs.filter((t=>!this.filterNTCs.includes(t))):[]:this.selectedNTCs=(null===(e=this.filterNTCs)||void 0===e?void 0:e.length)?[...new Set([...this.selectedNTCs,...this.filterNTCs])]:this.namedTraceConfigurationsInfo.map((t=>t.id)),this.emitChange()}},this.selectDeselect()?this.strings.deselectAll:this.strings.selectAll)),r=(0,n.h)("calcite-label",{class:"label"},this.errorMessage),o=(0,n.h)("calcite-list",{selectionMode:this.multiple?"multiple":"single",ref:t=>this.listNode=t,filterEnabled:this.namedTraceConfigurationsInfo.length>=this.showFilterLength,filterPlaceholder:null!==(t=this.filterPlaceholderText)&&void 0!==t?t:this.strings.filter,onCalciteListFilter:t=>{var e;t.stopPropagation(),this.filterNTCs=null===(e=this.listNode.filteredItems)||void 0===e?void 0:e.map((t=>t.value))},onCalciteListChange:()=>{const t=this.listNode.selectedItems.map((t=>t.value)),e=this.selectedNTCs.filter((e=>t.includes(e))),i=t.filter((t=>!this.selectedNTCs.includes(t))),s=[...new Set([...e,...i])];this.isSameLists(s,this.selectedNTCs)||(this.selectedNTCs=s,this.emitChange())}},this.namedTraceConfigurationsInfo.length>=this.showFilterLength&&this.showSort&&e,i,[...this.getSortedList()].map((t=>this.calciteValueList(t))));return(0,n.h)(n.H,{class:"js-app-flyout"},(0,n.h)("calcite-popover",{class:"popover",placement:this.popoverProps.placement||"leading-start",open:this.isOpen,pointerDisabled:!0,referenceElement:this.popoverProps.refElement,offsetDistance:this.popoverProps.offsetDistance||-Math.round(this.popoverProps.refElement.getBoundingClientRect().width),offsetSkidding:this.popoverProps.offsetSkidding||25,label:this.strings.headerSelect,ref:t=>this.popoverNode=t},(0,n.h)("calcite-flow",{class:"content",ref:t=>{this.flowElement=t},style:{width:`${this.popoverProps.popoverWidth||this.popoverProps.refElement.getBoundingClientRect().width}px`}},(0,n.h)("calcite-flow-item",{ref:t=>this.flowItemElement=t,class:"panel",heading:this.strings.headerSelect,closable:!0,onCalciteFlowItemClose:()=>this.arcgisNtcPickListDismissed.emit()},""!==this.errorMessage?r:o))))}emitChange(){const{NamedTraceConfiguration:t}=this;this.utilityNetwork.sharedNamedTraceConfigurations=[],this.selectedNTCs.forEach((e=>{let i=this.namedTraceConfigurations.find((t=>t.globalId===e));this.utilityNetwork.sharedNamedTraceConfigurations.push(new t({globalId:i.globalId,title:i.title}))})),this.arcgisNtcPickListChange.emit(this.utilityNetwork.sharedNamedTraceConfigurations)}isSameLists(t,e){if((null==t?void 0:t.length)!==(null==e?void 0:e.length))return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}get hostElement(){return(0,n.d)(this)}};l.style=".popover{z-index:100}.panel{min-height:300px}.label{height:-webkit-fill-available;width:-webkit-fill-available;padding:10px}.selection-button-div{padding:4px 10px}.content{max-height:60vh}";const a="container",c="section",h="title",d=class{constructor(t){(0,n.r)(this,t),this._getResultTypes=t=>{if(0===t.length)return this.strings.ntcNoResultTypes;{let e=[];return t.forEach((t=>{e.push(t.type)})),e.join(", ")}},this._getTags=t=>0===t.length?this.strings.ntcNoTags:t.join(", "),this.utilityNetwork=void 0,this.ntcId=void 0,this.strings=void 0}async componentWillLoad(){const{utilityNetwork:t,ntcId:e}=this;this.props={utilityNetwork:t,ntcId:e};const[i]=await(0,r.l)(["esri/intl"]);this.intl=i,this.props.ntcInfo=await async function(t){const{utilityNetwork:e,ntcId:i}=t;let s;return(await e.queryNamedTraceConfigurations({})).filter((t=>t.globalId===i)).forEach((t=>{const e={title:t.title,description:t.description,creator:t.creator,creationDate:t.creationDate,traceType:t.traceType,minimumPoints:t.minStartingPoints,resultTypes:t.resultTypes,tags:t.tags};s=e})),s}(this.props)}render(){const{props:t}=this,{ntcInfo:e}=t;return e?(0,n.h)(n.H,null,(0,n.h)("div",{class:a},this.renderNtcCreator(),this.renderNtcCreationDate(),this.renderNtcTraceType(),this.renderNtcMinimumPoints(),this.renderNtcResultTypes(),this.renderNtcTags())):null}renderNtcCreator(){const{props:t}=this,{ntcInfo:e}=t;return(0,n.h)("div",{class:c},(0,n.h)("div",{class:h},this.strings.ntcCreator),(0,n.h)("div",null,e.creator))}renderNtcCreationDate(){const{intl:t,props:e}=this,{ntcInfo:i}=e;return(0,n.h)("div",{class:c},(0,n.h)("div",{class:h},this.strings.ntcCreationDate),(0,n.h)("div",null,t.formatDate(i.creationDate,{dateStyle:"full"})))}renderNtcTraceType(){const{props:t}=this,{ntcInfo:e}=t;return(0,n.h)("div",{class:c},(0,n.h)("div",{class:h},this.strings.ntcTraceType),(0,n.h)("div",null,e.traceType))}renderNtcMinimumPoints(){const{props:t}=this,{ntcInfo:e}=t;return(0,n.h)("div",{class:c},(0,n.h)("div",{class:h},this.strings.ntcMinPoints),(0,n.h)("div",null,e.minimumPoints))}renderNtcResultTypes(){const{props:t}=this,{ntcInfo:e}=t;return(0,n.h)("div",{class:c},(0,n.h)("div",{class:h},this.strings.ntcResultTypes),(0,n.h)("div",null,this._getResultTypes(e.resultTypes)))}renderNtcTags(){const{props:t}=this,{ntcInfo:e}=t;return(0,n.h)("div",{class:c},(0,n.h)("div",{class:h},this.strings.ntcTags),(0,n.h)("div",null,this._getTags(e.tags)))}get hostElement(){return(0,n.d)(this)}};d.style=":host{height:100%}.container{padding:6px;background-color:white}.title{font-weight:bold;padding:5px 0}.section{padding:6px 0}"}}]);