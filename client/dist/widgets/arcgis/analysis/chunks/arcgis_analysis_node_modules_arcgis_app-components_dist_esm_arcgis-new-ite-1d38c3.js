/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-1d38c3.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-1d38c3"],{76497:(e,t,i)=>{i.d(t,{a:()=>s});var a=i(25972),n=i(94881),o=i(64243);async function s(e){var t;const i=(0,n.g)(e),s=`${null===(t=e.existingItem)||void 0===t?void 0:t.url}/${e.sourceDataLayer.id}/append`;try{const t=await(0,a.r)(s,i,{},"post"),{status:n,recordCount:d}=await(0,o.g)(e.id,{},null==t?void 0:t.statusUrl);return{result:{status:n,recordCount:d}}}catch(e){let t="unhandledError";const i={error:e}.error.description.toLowerCase();switch(!0){case i.includes("the create unique index statement terminated because a duplicate key was found for the object name"):t="invalidUniqueIdentifier";break;case i.includes("does not allow nulls"):t="cannotAddNullData";break;case i.includes("the value violates the maxlength limit of this column"):t="exceededMaxFieldLength";break;case i.includes("input string was not in a correct format"):t="invalidFieldType"}return console.error(e),{error:{code:t,message:JSON.stringify(e)}}}}},45831:(e,t,i)=>{i.r(t),i.d(t,{arcgis_new_item_pages_append_select_update:()=>p});var a=i(20536),n=i(76497),o=i(7459),s=i(67914),d=i(1391),l=i(19832),r=i(63262),c=i(94881);i(25972),i(44090),i(10699),i(98034),i(99004),i(38973),i(369),i(64243),i(76776),i(27995),i(90079),i(4291),i(79717),i(76246),i(16093),i(34472),i(90230),i(40883),i(30554),i(78231),i(86980),i(59377),i(68537),i(27126),i(11163),i(10493),i(16808),i(44069);const p=class{constructor(e){(0,a.r)(this,e),this.workflowComplete=(0,a.c)(this,"workflowComplete",7),this.newItemToggleNavigationEnabled=(0,a.c)(this,"newItemToggleNavigationEnabled",7),this.newItemDisableCloseButtons=(0,a.c)(this,"newItemDisableCloseButtons",7),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.newItemPrevPage=(0,a.c)(this,"newItemPrevPage",7),this.appendOptions={attribute:{icon:"table",updateGeometry:!1},attributeAndGeometry:{icon:"multiple-variables",updateGeometry:!0}},this.updateOptions={uploaded:{icon:"upload-to",keepDescription:!1},existing:{icon:"feature-details",keepDescription:!0}},this.noticeMessage=null,this.selected=void 0,this.cannotUpdateGeometry=!1,this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.error=void 0}async componentWillLoad(){var e;this.selected="append"===l.u.workflow?"attribute":"uploaded",this.i18n=l.u.i18n.appendSelectUpdateType,"append"===l.u.workflow&&(null!==(e=this.noticeMessage)&&void 0!==e||(this.noticeMessage=(0,r.v)({dataLayer:d.a.dataLayer,type:d.a.type,sourceDataLayer:d.a.sourceDataLayer})),this.cannotUpdateGeometry=!!this.noticeMessage),l.u.nextText="updateAppend"}async handleNext(){const e=this.selected;if("update"===l.u.workflow){d.a.addUpdateItemPropertiesOption=e;const t="uploaded"===e;d.a.keepDescription=t,this.handleUpdate()}else d.a.addAppendSelectUpdateTypeOption=e,this.handleAppend()}async handlePrev(e){e.preventDefault(),!this.loading&&this.newItemPrevPage.emit()}async handleUpdate(){this.loading=!0,this.loaderMessage=l.u.i18n.append.appendLoadingMessages.updating;const{file:e,overwrite:t,keepDescription:i,existingItem:a,fileName:n}=d.a,s=await(0,o.u)(a,a.itemOwner.userContentUrl,{file:e,overwrite:t,keepDescription:i,fileName:n});s.success?this.workflowComplete.emit({success:s.success}):(this.loading=!1,this.error={title:l.u.i18n.error,description:l.u.i18n.appendOverwrite.errors.errorWhileUpdate})}disableModalButtons(e){this.newItemToggleNavigationEnabled.emit(!e),this.newItemDisableCloseButtons.emit(e)}async handleAppend(){var e,t;this.disableModalButtons(!0),this.loading=!0,this.loaderMessage=l.u.i18n.append.appendLoadingMessages.appendCloseNotice;const i=await(0,n.a)({sourceDataLayer:d.a.sourceDataLayer,existingItem:d.a.existingItem,timezone:d.a.timezone,analyzeResults:d.a.analyzeResults,type:d.a.type,fieldMappings:d.a.fieldMappings,dataLayer:d.a.dataLayer,id:d.a.id,uidPair:d.a.uidPair,addAppendSelectOption:d.a.addAppendSelectOption});if("completed"!==(null===(e=null==i?void 0:i.result)||void 0===e?void 0:e.status.toLowerCase()))this.disableModalButtons(!1),this.loading=!1,this.newItemToggleNavigationEnabled.emit(!0),this.error=(0,c.h)(null!==(t=null==i?void 0:i.error)&&void 0!==t?t:{code:"unhandledError"},{appendErrorMessages:l.u.i18n.append.appendErrorMessages});else{await(0,s.d)(d.a.id,{permanentDelete:!0});const e=Object.assign({appendType:d.a.addAppendSelectOption},i);this.workflowComplete.emit(e)}}render(){const{i18n:e,appendOptions:t,updateOptions:i,noticeMessage:n,error:o}=this;let s=t,d=e.header,r="appendOptions";return"update"===l.u.workflow&&(s=i,d=e.itemPropertiesHeader,r="updateOptions"),(0,a.h)(a.H,{key:"0adefdf46c8d6f81f85d3b9cd5bd2ad18865926c",class:{"overflow-hidden":this.loading}},(0,a.h)("arcgis-new-item-description",{key:"538f44ea45d78581dc429f51457f339269364d65",header:d}),(0,a.h)("calcite-tile-select-group",{key:"0a5d45e3a5b871c6f116d12688629edddf698b70",layout:"vertical",class:"tile-select"},Object.keys(s).map((t=>{const{icon:i}=s[t];return(0,a.h)("calcite-tile-select",{key:t,checked:this.selected===t,heading:e[r][t].title,description:e[r][t].description,icon:i,name:"feature-layer-create-mode","input-enabled":!0,width:"full",type:"radio",value:t,disabled:"attributeAndGeometry"===t&&this.cannotUpdateGeometry,onCalciteTileSelectChange:e=>{this.selected=e.target.value}})}))),"append"===l.u.workflow&&this.cannotUpdateGeometry&&(0,a.h)("calcite-notice",{key:"3f181db9cf42e38e9eb185337e35da3e19ac0ea8",class:"need-geometries-notice",open:!0,icon:"lightbulb"},(0,a.h)("div",{key:"60c4b309d29382a99cc540a68ed93632d7d870e2",slot:"title"},e[n.title]),(0,a.h)("div",{key:"c4a0251f27dac39a1dd404a5969aff6af612186c",slot:"message"},e[n.description])),(0,a.h)("arcgis-new-item-loader",{key:"0bcd2c113c8dcd7823956000abd58acdc7a62ec4",type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,a.h)("arcgis-new-item-alert",{key:"18d3f57f57dac679c94359002206ef2db3dc23ae",heading:null==o?void 0:o.title,description:null==o?void 0:o.description,link:{href:null==o?void 0:o.link,title:null==o?void 0:o.linkText},active:!!o,onAlertDismiss:()=>this.error=null}))}get el(){return(0,a.d)(this)}};p.style=".tile-select{margin-top:1.25rem}.need-geometries-notice{margin-top:1.5rem}"},63262:(e,t,i)=>{function a(e){var t,i;const{dataLayer:a,type:n,sourceDataLayer:o}=e,s=null!==(t=null==a?void 0:a.geometryType)&&void 0!==t?t:null===(i=null==a?void 0:a.layerInfo)||void 0===i?void 0:i.geometryType;if("Microsoft Excel"===n||"CSV"===n){if(("address"===a.locationType&&a.addressFields||"coordinates"===a.locationType)&&"esriGeometryPoint"===(null==o?void 0:o.geometryType))return null;if(!s||"none"===a.locationType||"Table"===(null==o?void 0:o.type))return{title:"noGeometryMatchTitle",description:"noGeometryTableMessage"};if((null==o?void 0:o.geometryType)!==s)return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}else if((null==o?void 0:o.geometryType)!==(null==a?void 0:a.geometryType))return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}function n(e,t,i){return"Microsoft Excel"===i||"CSV"===i?"Table"===(null==t?void 0:t.type)||("esriGeometryPoint"===(null==t?void 0:t.geometryType)&&"none"===(null==e?void 0:e.locationType)||"esriGeometryPoint"===(null==t?void 0:t.geometryType)&&(!!e.addressFields||"none"!==e.locationType)):"Table"===(null==t?void 0:t.type)||(null==e?void 0:e.geometryType)===(null==t?void 0:t.geometryType)}i.d(t,{c:()=>n,v:()=>a})}}]);