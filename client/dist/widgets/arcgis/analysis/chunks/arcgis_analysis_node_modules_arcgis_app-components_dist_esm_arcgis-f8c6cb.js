/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f8c6cb.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f8c6cb"],{99004:(e,t,a)=>{a.d(t,{c:()=>i,g:()=>s});var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==a.g?a.g:"undefined"!=typeof self?self:{};function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}},34815:(e,t,a)=>{a.r(t),a.d(t,{arcgis_new_item_pages_data_store_database_credentials:()=>u});var i=a(20536),s=a(44090),r=a(90230),n=a(41011),o=a(1391),c=a(19832),l=a(66301),d=a(76776),h=a(48218);a(10699),a(34472),a(38973),a(85781),a(25972),a(98034),a(99004),a(369),a(64243),a(27995),a(90079),a(4291),a(67914),a(30554),a(78231),a(79717),a(76246),a(16093),a(40883),a(86980),a(59377),a(68537);const u=class{constructor(e){(0,i.r)(this,e),this.newItemUpdatePage=(0,i.c)(this,"newItemUpdatePage",7),this.handleFileInputChange=e=>{this.processFile(e.target.files[0])},this.authenticationType="serviceAuthentication",this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.refreshToken=void 0,this.keyFileContents=void 0,this.projectId=void 0,this.defaultDataset=void 0,this.server=void 0,this.user=void 0,this.password=void 0,this.role=void 0,this.database=void 0,this.schema=void 0,this.warehouse=void 0,this.validJson=!0,this.invalidLogin=!1,this.emptyFieldsExist=!1,this.keyFileName=void 0,this.error=void 0}async handleNext(){o.a.authenticationType=this.authenticationType,o.a.refreshToken=this.refreshToken,o.a.projectID=this.projectId,o.a.defaultDataset=this.defaultDataset,o.a.snowflakeServer=this.server,o.a.snowflakeUsername=this.user,o.a.snowflakePassword=this.password,o.a.role=this.role,o.a.database=this.database,o.a.schema=this.schema,o.a.warehouse=this.warehouse,this.checkValidFields()?(o.a.databaseConnectionPath=this.createDatabaseConnectionPath(),await this.validateConnection()):this.handleError({code:"unhandledError"})}async componentWillLoad(){this.dataStoreConnectionType=o.a.databaseProvider,this.i18n=c.u.i18n.dataStoreDatabaseCredentials,this.populateFields()}checkValidFields(){const{projectId:e,keyFileName:t,server:a,database:i,schema:s,warehouse:r,role:n,user:o,password:c,dataStoreConnectionType:l}=this,d="snowflake"===l?[a,i,s,r,n,o,c]:[t,e];return this.emptyFieldsExist=d.some((e=>!e)),!this.emptyFieldsExist}populateFields(){var e;this.server=o.a.snowflakeServer,null!==(e=this.authenticationType)&&void 0!==e||(this.authenticationType=o.a.authenticationType),this.projectId=o.a.projectID,this.defaultDataset=o.a.defaultDataset,this.role=o.a.role,this.database=o.a.database,this.schema=o.a.schema,this.warehouse=o.a.warehouse}createDatabaseConnectionPath(){const{dataStoreConnectionType:e,authenticationType:t,projectId:a,defaultDataset:i,server:s,user:r,role:n,database:c,schema:l,warehouse:d}=this;let h;switch(e){case"bigQuery":h=`${this.i18n.bigQuery}/${"serviceAuthentication"===t?this.i18n.serviceAuthentication:this.i18n.userAuthentication}/${a}/${i}`;break;case"snowflake":h=`${s}/${r}/${n}/${c}/${l}/${d}`}return o.a.databaseConnectionPath=h,h}async validateConnection(){const{dataStoreConnectionType:e,projectId:t,defaultDataset:a,keyFileContents:i,refreshToken:r,user:c,password:u,database:f,role:p,server:v,warehouse:b,schema:m}=this;let y;const{orgId:k}=s.c.user;this.invalidLogin=!1,this.loading=!0,this.loaderMessage=this.i18n.validating;const g=i||"",w=r||"";if("bigQuery"===e){const e=await(0,l.f)(t,a,g,w);if(null==e?void 0:e.error)return"invalidJSON"===e.error.code&&(this.validJson=!1),void this.handleError({code:e.error.code});y=e.result,o.a.jdbcConnection=Object.assign({},y.info.JDBCConnection)}else y=(0,l.h)({user:c,password:u,database:f,role:p,server:v,warehouse:b,schema:m}),o.a.jdbcConnection=Object.assign({},y.info.JDBCConnection),o.a.typeKeywords=[...o.a.typeKeywords,"CDW","snowflake"];const I="bigQuery"===e?t:f;d.i.title=(0,h.f)(e,I);const{result:F,error:x}=await(0,n.v)(k,s.c.portal,y);"success"===(null==F?void 0:F.status)?this.newItemUpdatePage.emit("itemProperties"):this.handleError(x)}processFile(e){if(!e)return;const{extension:t,fileName:a}=(0,r.s)(e);if(this.keyFileName=a,"json"!==t)return void(this.validJson=!1);this.validJson=!0;const i=new FileReader;i.onload=e=>{this.keyFileContents=String(e.target.result)},i.readAsText(e)}trimInput(e){return e.trim()}handleError(e){this.loading=!1;let t=this.i18n.errors.validationFailedTitle,a=this.i18n.errors.invalidConnection;switch(e.code){case"invalidJSON":t=c.u.i18n.itemProperties.invalidJSON.title,a=c.u.i18n.itemProperties.invalidJSON.description;break;case"invalidUsernameOrPassword":this.invalidLogin=!0;break;case"invalidSnowflakeServer":case"invalidSnowflakeWarehouse":case"invalidSnowflakeDatabase":case"invalidSnowflakeSchema":case"invalidSnowflakeRole":case"invalidBigQueryProjectId":case"invalidCredentials":a=this.i18n.errors[e.code]}this.error={title:t,description:a,details:e.details}}render(){const{dataStoreConnectionType:e,i18n:t,server:a,authenticationType:s,projectId:r,defaultDataset:n,role:o,database:c,schema:l,warehouse:d,validJson:h,error:u,invalidLogin:f}=this;return(0,i.h)("div",{key:"44d1f45681a50784261b76c3b0b01bca655c04f2"},(0,i.h)("arcgis-new-item-loader",{key:"c62db6ad1d6fb471cc80a9d05ee113e744542da0",type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,i.h)("arcgis-new-item-description",{key:"a5c6ad963119b275e6123ce75137e9a915e1233c",class:"header",header:t.dataStoreConnection,content:"bigQuery"===e?t.bigQuery:t.snowflake}),(0,i.h)("div",{key:"4941c10b48794d9e1d883926a71adfcec8671453",class:"configure-form"},"snowflake"===e&&(0,i.h)("calcite-label",{key:"957ba7f7d5304edb01ccd9ea3298a2b39b80872c",class:"field"},t.server,(0,i.h)("calcite-input",{key:"44295023a349a8012e8ec0d42377adbb04ba12d7",placeholder:"server_name.com",value:a,onInput:e=>{this.server=this.trimInput(e.target.value)},required:!0}),!this.server&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"0f1094f5cb320a5f4c3ca8839592b1cb00ac940c",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noServer)),(0,i.h)("calcite-label",{key:"e8407781788f2cf35a7498f32bbc0e40e1297060",class:"field"},t.authenticationType,(0,i.h)("calcite-select",{key:"fae4f5eb7846a8a0cd3f9995b0c8c76ae7f4ac6f",value:s,label:"authentication-type",disabled:!0,onCalciteSelectChange:e=>{this.authenticationType=e.target.selectedOption.value}},"bigQuery"===e?(0,i.h)("calcite-option",{value:"serviceAuthentication"},t.serviceAuthentication):(0,i.h)("calcite-option",{value:"userAuthentication"},t.userAuthentication))),"bigQuery"===e&&(0,i.h)("div",{key:"732a0da86b49f05cf4479e18fe094e25a0bb62ce",class:"configureBigQuery"},"serviceAuthentication"===s?(0,i.h)("calcite-label",{class:"field keyFileInput"},t.keyFile,(0,i.h)("calcite-input",{status:!h||!this.keyFileName&&this.emptyFieldsExist?"invalid":"valid","read-only":!0,value:this.keyFileName,required:!0},(0,i.h)("calcite-button",{"icon-start":"folder",slot:"action",kind:"neutral",appearance:"outline",onClick:()=>{var e;return null===(e=this.inputFileElement)||void 0===e?void 0:e.click()}},t.selectKeyFile)),(0,i.h)("input",{class:"hidden",type:"file",id:"snowflake-key-file",accept:".json",onChange:this.handleFileInputChange,ref:e=>this.inputFileElement=e}),(0,i.h)("calcite-input-message",{icon:!h||!this.keyFileName&&this.emptyFieldsExist?"exclamation-mark-triangle":"information",status:!h||!this.keyFileName&&this.emptyFieldsExist?"invalid":"idle"},!this.keyFileName&&this.emptyFieldsExist?t.errors.noKeyFile:h?t.jsonOnly:t.notJson)):(0,i.h)("calcite-label",{class:"field refreshTokenInput"},t.refreshToken,(0,i.h)("calcite-input",{type:"password",status:"valid",onInput:e=>{this.refreshToken=e.target.value}})),(0,i.h)("calcite-label",{key:"5bd486924db5b08f81d3b90084e17ca8431d5bda",class:"field"},t.projectId,(0,i.h)("calcite-input",{key:"2d3ae88c0078a19e9c26d7752456a45751dfa0db",value:r,onInput:e=>{this.projectId=this.trimInput(e.target.value)},required:!0}),!this.projectId&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"d12226a27a894858ee9f0e1b717fe008c7395f1f",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noProjectId)),"userAuthentication"===s&&(0,i.h)("calcite-label",{key:"2852b75de393169155de9c75b3051539a03ada74",class:"field"},t.defaultDataset,(0,i.h)("calcite-input",{key:"7a2989d7e402ba288e9d171541bd0f965695d3d7",value:n,onInput:e=>{this.defaultDataset=this.trimInput(e.target.value)}}))),"snowflake"===e&&(0,i.h)("div",{key:"d322c2c357251ab34fa97c58d2ff0a7c6758e2aa",class:"configureSnowflake"},(0,i.h)("div",{key:"3f6b4e0e32e4cecf2a665cf2df22fd85c9982ed2",class:"field fill-credentials"},(0,i.h)("calcite-label",{key:"8f2e629a43492206087b14e25b5ae98fb5b607f4",class:"credentials"},(0,i.h)("div",{key:"4fda79e97da8db729e4ec0098d8eacc10147852e",class:"username"},t.username," ",(!this.user&&this.emptyFieldsExist||f)&&(0,i.h)("span",{key:"0823c28c566f0c90c5f9736a3c295836d4565689",class:"asterisk"},"*")),(0,i.h)("calcite-input",{key:"dd8844306c57278df655116f7e3f68716acfe1a1",onInput:e=>{this.user=this.trimInput(e.target.value)},required:!0}),((!this.user||!this.password)&&this.emptyFieldsExist||f)&&(0,i.h)("calcite-input-message",{key:"96f9b17e4c5c8697ef930696bce7825bf274d282",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.incorrectLogin)),(0,i.h)("calcite-label",{key:"e0505ff4f1e9da65af92284c92150f559e375c53",class:"credentials"},(0,i.h)("div",{key:"97f4b69ce328a819771ae9fd6c1ae7342638f1f6",class:"password"},t.password," ",(!this.password&&this.emptyFieldsExist||f)&&(0,i.h)("span",{key:"d688c1fad4465eaf2dd886dc222763ef648b7153",class:"asterisk"},"*")),(0,i.h)("calcite-input",{key:"7bf759e8b7eb695599a51b6184322940f73bca5c",class:"credentials password",type:"password",onInput:e=>{this.password=this.trimInput(e.target.value)},required:!0}))),(0,i.h)("calcite-label",{key:"adb589c64b53f0ec726dd9976ac2cb5653d4009e",class:"field"},t.database,(0,i.h)("calcite-input",{key:"ea6d8251e0b2e66e80f4be1015037d83a527d67a",value:c,onInput:e=>{this.database=this.trimInput(e.target.value)},required:!0}),!this.database&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"468c4d87934a28b8008d95d70236e1a084733ae1",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noDatabase)),(0,i.h)("calcite-label",{key:"93a0638ec3cae93988f47a21443d54bdca69f915",class:"field"},t.schema,(0,i.h)("calcite-input",{key:"82c801f21b7989d564110fcca7611679191cb683",value:l,onInput:e=>{this.schema=this.trimInput(e.target.value)},required:!0}),!this.schema&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"2d3e8dd5f2cd3325f951672bf347fd84dcbba1bf",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noSchema)),(0,i.h)("calcite-label",{key:"5110e570c13608c5a9d6eb119ea0ba8766bf7e5d",class:"field"},t.warehouse,(0,i.h)("calcite-input",{key:"d99b30f5d175e1695a88ae830d818d98151d4445",value:d,onInput:e=>{this.warehouse=this.trimInput(e.target.value)},required:!0}),!this.warehouse&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"6410615fa52852eea77dfe68fbea321854284099",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noWarehouse)),(0,i.h)("calcite-label",{key:"f10d54b573493971295d8f7671262de609dfb3ce",class:"field"},t.role,(0,i.h)("calcite-input",{key:"332f9560da683f2e4db827aabfffde113733f72a",value:o,onInput:e=>{this.role=this.trimInput(e.target.value)},required:!0}),!this.role&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"12888184137b25a0591696dd55f0299a7f04ff9f",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noRole)))),(0,i.h)("arcgis-new-item-alert",{key:"c11d4d9c79fbe1794444ff1027ad099c99f5fced",heading:null==u?void 0:u.title,description:null==u?void 0:u.description,details:null==u?void 0:u.details,detailsPopoverLabel:t.errorDetails,active:!!u,onAlertDismiss:()=>this.error=null}))}};u.style=".configure-form{margin-top:1.5rem}.fill-credentials{display:flex}.credentials{flex:1 1 0%}.password{margin-inline-start:3rem}.info-icon{color:var(--calcite-color-brand)}.hidden{display:none}calcite-label{--calcite-label-margin-bottom:1.25rem}.asterisk{color:var(--calcite-color-status-danger)}"},48218:(e,t,a)=>{a.d(t,{f:()=>i});const i=(e,t)=>{let a;const i=null!=t?t:"";switch(e){case"amazon":a=`AmazonS3_${i}`;break;case"azure":a=`Microsoft_Azure_Storage_${i}`;break;case"bigQuery":a=`BigQuery_${i}`;break;case"snowflake":a=`Snowflake_${i}`}return a.replace(/ /g,"_").replace(/-/g,"_")}},98034:(e,t,a)=>{a.d(t,{e:()=>r,l:()=>n});var i,s=a(99004),r={exports:{}};i=r.exports,s.c,function(e){var t={Promise:"undefined"!=typeof window?window.Promise:void 0},a="4.24",i="next";function s(e){if(e.toLowerCase()===i)return i;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function r(e){return void 0===e&&(e=a),"https://js.arcgis.com/".concat(e,"/")}function n(e){void 0===e&&(e=a);var t=r(e),n=s(e);if(n!==i&&3===n.major){var o=n.minor<=10?"js/":"";return"".concat(t).concat(o,"esri/css/esri.css")}return"".concat(t,"esri/themes/light/main.css")}function o(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}function c(e,t){if(t){var a=document.querySelector(t);a.parentNode.insertBefore(e,a)}else document.head.appendChild(e)}function l(e){return document.querySelector('link[href*="'.concat(e,'"]'))}function d(e){return!e||s(e)?n(e):e}function h(e,t){var a=d(e),i=l(a);return i||c(i=o(a),t),i}var u={};function f(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}function p(e,t,a){var i;a&&(i=v(e,a));var s=function(){t(e),e.removeEventListener("load",s,!1),i&&e.removeEventListener("error",i,!1)};e.addEventListener("load",s,!1)}function v(e,t){var a=function(i){t(i.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",a,!1)};return e.addEventListener("error",a,!1),a}function b(e){void 0===e&&(e={}),u=e}function m(){return document.querySelector("script[data-esri-loader]")}function y(){var e=window.require;return e&&e.on}function k(e){void 0===e&&(e={});var a={};[u,e].forEach((function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t])}));var i=a.version,s=a.url||r(i);return new t.Promise((function(e,t){var r=m();if(r){var n=r.getAttribute("src");n!==s?t(new Error("The ArcGIS API for JavaScript is already loaded (".concat(n,")."))):y()?e(r):p(r,e,t)}else if(y())t(new Error("The ArcGIS API for JavaScript is already loaded."));else{var o=a.css;o&&h(!0===o?i:o,a.insertCssBefore),p(r=f(s),(function(){r.setAttribute("data-esri-loader","loaded"),e(r)}),t),document.body.appendChild(r)}}))}function g(e){return new t.Promise((function(t,a){var i=window.require.on("error",a);window.require(e,(function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];i.remove(),t(e)}))}))}function w(e,t){if(void 0===t&&(t={}),y())return g(e);var a=m(),i=a&&a.getAttribute("src");return!t.url&&i&&(t.url=i),k(t).then((function(){return g(e)}))}e.utils=t,e.loadModules=w,e.getScript=m,e.isLoaded=y,e.loadScript=k,e.setDefaultOptions=b,e.loadCss=h,Object.defineProperty(e,"__esModule",{value:!0})}(i);const n=async(e,t)=>(await r.exports.loadModules(e,t)).map((e=>e.__esModule&&e.default?e.default:e))}}]);