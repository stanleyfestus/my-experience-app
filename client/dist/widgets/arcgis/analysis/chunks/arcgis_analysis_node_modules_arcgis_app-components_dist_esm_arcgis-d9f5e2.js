/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-d9f5e2.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-d9f5e2"],{1612:(e,t,o)=>{o.r(t),o.d(t,{arcgis_sketch_layer_editor:()=>F,arcgis_sketch_layer_editor_content:()=>z,arcgis_sketch_layer_editor_shortcuts:()=>U,arcgis_sketch_layer_editor_snapping:()=>R,arcgis_sketch_layer_editor_tools:()=>N});var i=o(20536),s=o(37568),l=o(34752),n=o(98034),r=o(58151),c=o(91616),a=o(6589),h=o(10699),d=o(74129),p=o(98072),u=o(67911);o(91102),o(73807),o(99004);const g=["#ff4040","#ff8202","#faa83e","#ffd159","#73b566","#008977","#33e3c8","#43abeb","#4b64c9","#9868ed","#b055e6","#db5181","#e03b99","#2b2b2b","#bdbdbd","#ffffff"],y=["#ffffff","#bdbdbd","#2b2b2b","#e03b99","#db5181","#b055e6","#9868ed","#4b64c9","#43abeb","#33e3c8","#008977","#73b566","#ffd159","#faa83e","#ff8202","#ff4040"];function m(e){var t,o;switch(null===(t=null==e?void 0:e.geometry)||void 0===t?void 0:t.type){case"point":return"text"===(null===(o=null==e?void 0:e.symbol)||void 0===o?void 0:o.type)?"text":"point";case"polyline":return"polyline";default:return"polygon"}}async function S(e,t,o,i){const s=function(e){if(e)return(0,r.a)(e.webmap,!0)||(0,r.a)(e.current,!0)||null;return null}(e)||{enabled:!0,selfEnabled:!0,featureEnabled:!0,featureSourcesIds:[t.id]};return new i({enabled:s.enabled,selfEnabled:s.selfEnabled,featureEnabled:s.featureEnabled,featureSources:await k(o,s.featureSourcesIds)})}async function k(e,t){const o=await async function(e){const[t]=await(0,n.l)(["esri/core/CollectionFlattener"]),{map:o}=e,{allLayers:i}=o,s=new t({getCollections:()=>[i],getChildrenFunction:e=>"layers"in e?e.layers:"sublayers"in e?e.sublayers:null,itemFilterFunction:e=>!e.isTable});return[...new Set(s.toArray())]}(e);return o.filter((e=>t.includes(e.id))).map((e=>({layer:e,enabled:!0})))}function b(e,t){const o=[...new Set([...e.featureSources.filter((e=>e.enabled)).map((e=>e.layer.id))])],i={enabled:e.enabled,selfEnabled:e.selfEnabled,featureEnabled:e.featureEnabled,featureSourcesIds:o};(0,r.b)(t,i,!0)}class f{constructor(e,t,o,i,s,l,n){this.mapNotesLayer=e,this.mapView=t,this.sketchViewModelPoint=new o({layer:this.mapNotesLayer.pointLayer,view:this.mapView,defaultCreateOptions:{hasZ:!1,mode:"hybrid"},updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},snappingOptions:i,tooltipOptions:s}),this.sketchViewModelPoint.on("create",(e=>l(e,this.sketchViewModelPoint))),this.sketchViewModelPoint.on("update",(e=>n(e))),this.sketchViewModelLine=new o({layer:this.mapNotesLayer.polylineLayer,view:this.mapView,defaultCreateOptions:{hasZ:!1,mode:"hybrid"},updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},snappingOptions:i,tooltipOptions:s}),this.sketchViewModelLine.on("create",(e=>l(e,this.sketchViewModelLine))),this.sketchViewModelLine.on("update",(e=>n(e))),this.sketchViewModelPolygon=new o({layer:this.mapNotesLayer.polygonLayer,view:this.mapView,defaultCreateOptions:{hasZ:!1,mode:"hybrid"},updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},snappingOptions:i,tooltipOptions:s}),this.sketchViewModelPolygon.on("create",(e=>l(e,this.sketchViewModelPolygon))),this.sketchViewModelPolygon.on("update",(e=>n(e))),this.sketchViewModelText=new o({layer:this.mapNotesLayer.textLayer,view:this.mapView,defaultCreateOptions:{hasZ:!1,mode:"hybrid"},updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},snappingOptions:i,tooltipOptions:s}),this.sketchViewModelText.on("create",(e=>l(e,this.sketchViewModelText))),this.sketchViewModelText.on("update",(e=>n(e)))}updateOnGraphicClick(e,t){var o;null===(o=this.hitTestHandle)||void 0===o||o.remove(),e&&(this.hitTestHandle=this.mapView.on("click",(async e=>{const o=(await this.mapView.hitTest(e,{include:this.mapNotesLayer})).results;if(o.length){const e=["point","polyline","polygon"];o.sort((function(t,o){return e.indexOf(t.graphic.geometry.type)-e.indexOf(o.graphic.geometry.type)}));const t=o[0].graphic;switch(t.layer){case this.mapNotesLayer.pointLayer:await this.updatePoint([t]);break;case this.mapNotesLayer.textLayer:await this.updateText([t]);break;case this.mapNotesLayer.polylineLayer:await this.updateLine([t]);break;case this.mapNotesLayer.polygonLayer:await this.updatePolygon([t]);default:return}}else t&&t({state:"complete"})})))}duplicate(){this._duplicatePoint(),this._duplicateLine(),this._duplicatePolygon(),this._duplicateText()}delete(){this._deletePoint(),this._deleteLine(),this._deletePolygon(),this._deleteText()}cancel(){this._cancelPoint(),this._cancelLine(),this._cancelPolygon(),this._cancelText()}destroy(){this._destroyPoint(),this._destroyLine(),this._destroyPolygon(),this._destroyText()}getPointSVM(){return this.sketchViewModelPoint}getPoint(){return this.sketchViewModelPoint.pointSymbol}setPoint(e){this.sketchViewModelPoint.pointSymbol=e}createPoint(){this.sketchViewModelPoint.create("point")}async updatePoint(e){await this.sketchViewModelPoint.update(e)}_duplicatePoint(){this.sketchViewModelPoint.duplicate()}_deletePoint(){this.sketchViewModelPoint.delete()}_cancelPoint(){this.sketchViewModelPoint.cancel()}_destroyPoint(){this.sketchViewModelPoint.destroy()}getLineSVM(){return this.sketchViewModelLine}getLine(){return this.sketchViewModelLine.polylineSymbol}setLine(e){this.sketchViewModelLine.polylineSymbol=e}createLine(){this.sketchViewModelLine.create("polyline")}async updateLine(e){await this.sketchViewModelLine.update(e)}_duplicateLine(){this.sketchViewModelLine.duplicate()}_deleteLine(){this.sketchViewModelLine.delete()}_cancelLine(){this.sketchViewModelLine.cancel()}_destroyLine(){this.sketchViewModelLine.destroy()}getPolygonSVM(){return this.sketchViewModelPolygon}getPolygon(){return this.sketchViewModelPolygon.polygonSymbol}setPolygon(e){this.sketchViewModelPolygon.polygonSymbol=e}createPolygon(e){this.sketchViewModelPolygon.create(e)}async updatePolygon(e){await this.sketchViewModelPolygon.update(e)}_duplicatePolygon(){this.sketchViewModelPolygon.duplicate()}_deletePolygon(){this.sketchViewModelPolygon.delete()}_cancelPolygon(){this.sketchViewModelPolygon.cancel()}_destroyPolygon(){this.sketchViewModelPolygon.destroy()}getTextSVM(){return this.sketchViewModelText}getText(){return this.sketchViewModelText.pointSymbol}setText(e){this.sketchViewModelText.pointSymbol=e}createText(){this.sketchViewModelText.create("point")}async updateText(e){await this.sketchViewModelText.update(e)}_duplicateText(){this.sketchViewModelText.duplicate()}_deleteText(){this.sketchViewModelText.delete()}_cancelText(){this.sketchViewModelText.cancel()}_destroyText(){this.sketchViewModelText.destroy()}}function v(e){if(!function(e){var t,o,i,s,l,n;const r=e.data.symbol.symbolLayers;if(1===r.length){const e=r[0];if("CIMVectorMarker"!==e.type||e.colorLocked)return!1;const i=null===(o=null===(t=e.markerGraphics[0])||void 0===t?void 0:t.symbol)||void 0===o?void 0:o.symbolLayers;return 1===e.markerGraphics.length&&x(i)}if(2===r.length){const e=r[0],t=r[1];if("CIMVectorMarker"!==e.type||"CIMVectorMarker"!==t.type||e.colorLocked||e.size>t.size)return!1;const o=null===(s=null===(i=e.markerGraphics[0])||void 0===i?void 0:i.symbol)||void 0===s?void 0:s.symbolLayers,c=null===(n=null===(l=t.markerGraphics[0])||void 0===l?void 0:l.symbol)||void 0===n?void 0:n.symbolLayers;return 1===e.markerGraphics.length&&1===t.markerGraphics.length&&x(o)&&function(e){return function(e){return null==e?void 0:e.find((e=>"CIMSolidFill"===e.type))}(e)&&L(e)}(c)}return!1}(e))return;const t=e.data.symbol.symbolLayers;return t[t.length-1].markerGraphics[0].symbol.symbolLayers.find((e=>"CIMSolidStroke"===e.type))}function w(e){var t,o;return"cim"===(null==e?void 0:e.type)?a.e.Color.fromJSON(null===(t=a.e.cimSymbolUtils.getCIMSymbolColor(e))||void 0===t?void 0:t.toJSON()):"simple-marker"===(null==e?void 0:e.type)&&["x","cross"].indexOf(null==e?void 0:e.style)>-1?null===(o=null==e?void 0:e.outline)||void 0===o?void 0:o.color:null==e?void 0:e.color}function C(e){return"cim"===e.type?a.e.cimSymbolUtils.getCIMSymbolSize(e):"text"===e.type?e.font.size:(0,c.i)(e.size)?e.size:e.width}function E(e,t){if("cim"===e.type)!function(e){return"CIMPolygonSymbol"===e.data.symbol.type}(e)?a.e.cimSymbolUtils.scaleCIMSymbolTo(e,t):function(e,t){var o;null===(o=e.data.symbol.symbolLayers)||void 0===o||o.forEach((e=>{["CIMSolidStroke","CIMPictureStroke"].indexOf(e.type)>-1&&(e.width=t)}))}(e,t);else if((0,c.i)(e.size))e.size=t;else{const o=e.height/e.width;e.width=t,e.height=e.width*o}}function I(e){return"cim"===(null==e?void 0:e.type)?function(e){var t;if("picture-marker"===e.type)return;return"CIMPolygonSymbol"===(null===(t=e.data.symbol)||void 0===t?void 0:t.type)?function(e){const t=e.data.symbol.symbolLayers;return t.find((e=>"CIMSolidStroke"===e.type))}(e):void 0}(e):null==e?void 0:e.outline}function P(e){return"cim"===e.type?a.e.cimSymbolUtils.getCIMSymbolRotation(e,!0):["simple-marker","picture-marker"].indexOf(e.type)>-1?e.angle:void 0}function T(e,t){(0,c.i)(t)&&("cim"===e.type?a.e.cimSymbolUtils.applyCIMSymbolRotation(e,t,!0):["simple-marker","picture-marker"].indexOf(e.type)>-1&&(e.angle=t))}function L(e){return null==e?void 0:e.find((e=>"CIMSolidStroke"===e.type))}function x(e){return function(e){return null==e?void 0:e.find((e=>"CIMSolidFill"===e.type&&!e.colorLocked))}(e)&&L(e)}function M(e,t){const o=function(e){if(e)return(0,r.a)(e.webmap,!0)||(0,r.a)(e.current,!0)||null;return null}(e)||{enabled:!1};return new t({enabled:o.enabled})}function V(e,t){const o={enabled:e.enabled};(0,r.b)(t,o,!0)}const O=(0,h.c)({mapView:null,portal:null,layer:null,strings:null,currentLanguage:"",sketchMessage:"",sketchLayerEditorSVModel:null,snappingOptions:null,sketchTooltipOptions:null,snappingSessionStorageIds:null,sketchTooltipSessionStorageIds:null}).state,F=class{constructor(e){(0,i.r)(this,e),this.sketchUpdated=(0,i.c)(this,"sketchUpdated",7),this.arcgisSketchCopyToNewSketchLayer=(0,i.c)(this,"arcgisSketchCopyToNewSketchLayer",7),this.arcgisRecentColorsUpdate=(0,i.c)(this,"arcgisRecentColorsUpdate",7),this.arcgisSketchDismissedChange=(0,i.c)(this,"arcgisSketchDismissedChange",7),this.internalSketchUpdated=(0,i.c)(this,"internalSketchUpdated",7),this.sketchContentReRender=(0,i.c)(this,"sketchContentReRender",7),this.sketchActionOnSelectFeatures=(0,i.c)(this,"sketchActionOnSelectFeatures",7),this.closeSketchPopovers=(0,i.c)(this,"closeSketchPopovers",7),this.closePopupPopovers=(0,i.c)(this,"closePopupPopovers",7),this.closeSketchSnappingPopovers=(0,i.c)(this,"closeSketchSnappingPopovers",7),this.disableSketchPanel=(0,i.c)(this,"disableSketchPanel",7),this.sketchMode="update",this.escKey=!1,this.deleteInProgress=!1,this.keepSelectionMessage="",this.keepSelectionTool=null,this.needsMapViewHandles=!1,this.onGraphicUpdate=e=>{var t,o;if("start"===e.state)if(this.mapView.closePopup(),this.multipleSelectedGraphics.length<=1&&1===e.graphics.length)this.currentSketchInfo.graphics=[e.graphics[0]],this.currentSketchInfo.symbol=this.currentSketchInfo.graphics[0].symbol,this.currentSketchInfo.tool=m(this.currentSketchInfo.graphics[0]),this.currentSketchInfo.title=(null===(t=this.currentSketchInfo.graphics[0].attributes)||void 0===t?void 0:t.title)||this.getDefaultGraphicTitle(),this.currentSketchInfo.popup=this.currentSketchInfo.graphics[0].popupTemplate,!this.multipleSelectedGraphics.length&&this.multipleSelectedGraphics.push(this.currentSketchInfo.graphics[0]),this.sketchContentReRender.emit(),this.showSketchContent=!0;else if(this.multipleSelectedGraphics.length){this.currentSketchInfo.graphics=this.multipleSelectedGraphics,this.currentSketchInfo.symbol=this.currentSketchInfo.graphics[0].symbol,this.currentSketchInfo.tool=m(this.currentSketchInfo.graphics[0]);const e=(null===(o=this.currentSketchInfo.graphics[0].attributes)||void 0===o?void 0:o.title)||this.getDefaultGraphicTitle(),t=this.currentSketchInfo.graphics.every((t=>{var o;return(null===(o=t.attributes)||void 0===o?void 0:o.title)===e})),i=this.currentSketchInfo.graphics[0].popupTemplate,s=this.currentSketchInfo.graphics.every((e=>JSON.stringify(e.popupTemplate)===JSON.stringify(i)));this.currentSketchInfo.title=t?e:null,this.currentSketchInfo.popup=s?i:null,this.sketchContentReRender.emit(),this.showSketchContent=!0}else this.updateSketchMessage(null);if("complete"===e.state){const{keepSelectionTool:e}=this,t=e!==this.sketchToolsEl.activeSelectTool;!e||t?(this.currentSketchInfo.graphics=null,this.multipleSelectedGraphics=[],this.closeSketchPopovers.emit(),this.internalSketchUpdated.emit(),this.sketchContentReRender.emit()):!this.deleteInProgress&&this.keepSelectToolSelection()}},this.mapView=void 0,this.layer=void 0,this.portal=void 0,this.dismissible=!1,this.showSketchToolsOnly=!1,this.activeSketchTool=void 0,this.sketchToolsToHide=[],this.hideSelectionTools=!1,this.sketchToolsReferenceElement=void 0,this.selectedSketchFeaturesFeatures=void 0,this.mapNotesFeature=null,this.snappingSessionStorageIds=void 0,this.sketchTooltipSessionStorageIds=void 0,this.hideSvgUploadSymbols=!1,this.hideAddStyles=!1,this.currentSketchInfo={tool:null,symbol:null,graphics:null,popup:null,title:null,sourceIds:{}},this.multipleSelectedGraphics=[],this.showSketchContent=!0}arcgisSketchPanelLoaderHandler(e){e.stopPropagation(),this.sketchFlowItemEl.loading=e.detail}internalSketchUpdatedHandler(e){e.stopPropagation(),this.sketchUpdated.emit()}closeSketchPopoversHandler(){this.sketchToolsEl.activeSelectTool&&"select"!==this.sketchToolsEl.activeSelectTool&&this.updateSketchMessage(null),this.showSketchContent=!1,this.closePopupPopovers.emit(),this.closeSketchSnappingPopovers.emit(),this.removeSketchShortcuts(),this.setFocus()}closeSketchSnappingPopoversHandler(){this.sketchSnappingEl&&(document.body.removeChild(this.sketchSnappingEl),this.sketchSnappingEl=void 0,this.disableSketchPanel.emit(!1)),this.setFocus()}disableSketchPanelHandler(e){e.stopPropagation(),this.sketchFlowItemEl.disabled=e.detail}arcgisSketchActiveSymbolChangeHandler(){this.sketchContentReRender.emit()}sketchGraphicUpdatesHandler(e){var t,o,i;e.stopPropagation();const s=e.detail;if("symbol"===s.type&&s.symbolSwitchFromRecent){const e=null===(t=w(this.currentSketchInfo.symbol.clone()))||void 0===t?void 0:t.toHex();e&&this.arcgisRecentColorsUpdate.emit(e)}if("update"===this.sketchMode&&(null===(o=this.currentSketchInfo.graphics)||void 0===o?void 0:o.length)){const e=this.currentSketchInfo.graphics.length>1,t=this.currentSketchInfo.graphics[0].symbol.clone(),o=this.currentSketchInfo.symbol.clone(),i=this.getSymbolProps(t),l=this.getSymbolProps(o);this.currentSketchInfo.graphics.forEach(((t,o)=>{if("title"===s.type)t.attributes?this.currentSketchInfo.graphics[o].attributes.title=this.currentSketchInfo.title:this.currentSketchInfo.graphics[o].attributes={title:this.currentSketchInfo.title};else if("popup"===s.type)this.currentSketchInfo.graphics[o].popupTemplate=this.currentSketchInfo.popup;else if("symbol"===s.type)if(!e||s.symbolSwitchFromRecent){const e=this.currentSketchInfo.symbol.clone();"recent-text"===s.textProp&&(e.text=this.currentSketchInfo.graphics[o].symbol.clone().text),this.currentSketchInfo.graphics[o].symbol=e}else if(s.symbolSwitch){const e=this.currentSketchInfo.graphics[o].symbol.clone(),t=this.currentSketchInfo.symbol.clone(),i=this.getSymbolProps(e),s=this.getSymbolProps(t);(0,c.i)(i.size)&&(0,c.i)(s.size)&&E(t,i.size),(0,c.i)(i.rotation)&&(0,c.i)(s.rotation)&&T(t,i.rotation),this.currentSketchInfo.graphics[o].symbol=t}else{const e=this.currentSketchInfo.graphics[o].symbol.clone(),t=this.getSymbolProps(e);if(i.size!==l.size&&E(e,l.size),i.rotation!==l.rotation&&T(e,l.rotation),JSON.stringify(i.color)!==JSON.stringify(l.color)&&(i.color.a===l.color.a?(t.color.r=l.color.r,t.color.g=l.color.g,t.color.b=l.color.b):t.color.a=l.color.a,n=e,r=t.color,"picture-marker"!==n.type&&("cim"===n.type?a.e.cimSymbolUtils.applyCIMSymbolColor(n,r):"simple-marker"===n.type&&n.style&&["cross","x"].indexOf(n.style)>-1?(n.outline||(n.outline=new __esri.SimpleLineSymbol),n.outline.color=r):n.color=r)),(0,c.i)(i.outline)&&(0,c.i)(l.outline)&&JSON.stringify(i.outline)!==JSON.stringify(l.outline)){const o=i.outline.width===l.outline.width,s=i.outline.color.a===l.outline.color.a;o?s?(t.outline.color.r=l.outline.color.r,t.outline.color.g=l.outline.color.g,t.outline.color.b=l.outline.color.b):t.outline.color.a=l.outline.color.a:t.outline.width=l.outline.width,function(e,t){"cim"===e.type?e.data.symbol.symbolLayers.forEach(((o,i)=>{"CIMSolidStroke"===o.type&&(e.data.symbol.symbolLayers[i]=t)})):e.outline=t}(e,t.outline)}if(JSON.stringify(i.outlineStyle)!==JSON.stringify(l.outlineStyle)&&e.outline&&(e.outline.style=l.outlineStyle),JSON.stringify(i.strokeStyle)!==JSON.stringify(l.strokeStyle)&&(e.style=l.strokeStyle),JSON.stringify(i.marker)!==JSON.stringify(l.marker)&&(e.marker=l.marker),s.textProp){const t=this.currentSketchInfo.symbol.clone();switch(s.textProp){case"text":e.text=t.text;break;case"font":e.font.family=t.font.family,e.font.weight=t.font.weight,e.font.style=t.font.style;break;case"font-size":e.font.size=t.font.size;break;case"color":e.color.r=t.color.r,e.color.g=t.color.g,e.color.b=t.color.b;break;case"color-transparency":e.color.a=t.color.a;break;case"rotation":e.angle=t.angle;break;case"halo":e.haloColor=t.haloColor,e.haloSize=t.haloSize;break;case"halo-color":e.haloColor?(e.haloColor.r=t.haloColor.r,e.haloColor.g=t.haloColor.g,e.haloColor.b=t.haloColor.b):e.haloColor=t.haloColor;break;case"halo-color-transparency":e.haloColor&&(e.haloColor.a=t.haloColor.a);break;case"halo-size":e.haloSize=t.haloSize;break;case"background":e.backgroundColor=t.backgroundColor,e.borderLineColor=t.borderLineColor,e.borderLineSize=t.borderLineSize;break;case"background-color":e.backgroundColor?(e.backgroundColor.r=t.backgroundColor.r,e.backgroundColor.g=t.backgroundColor.g,e.backgroundColor.b=t.backgroundColor.b):e.backgroundColor=t.backgroundColor;break;case"background-color-transparency":e.backgroundColor&&(e.backgroundColor.a=t.backgroundColor.a);break;case"border-line-color":e.borderLineColor?(e.borderLineColor.r=t.borderLineColor.r,e.borderLineColor.g=t.borderLineColor.g,e.borderLineColor.b=t.borderLineColor.b):(e.backgroundColor=t.backgroundColor,e.borderLineColor=t.borderLineColor,e.borderLineSize=t.borderLineSize);break;case"border-line-color-transparency":e.borderLineColor&&(e.borderLineColor.a=t.borderLineColor.a);break;case"border-line-size":e.borderLineSize=t.borderLineSize}}this.currentSketchInfo.graphics[o].symbol=e}var n,r}))}else this.tempCreatedGraphic&&(this.tempCreatedGraphic.attributes?this.tempCreatedGraphic.attributes.title=this.currentSketchInfo.title:this.tempCreatedGraphic.attributes={title:this.currentSketchInfo.title},this.tempCreatedGraphic.popupTemplate=this.currentSketchInfo.popup,this.tempCreatedGraphic.symbol=this.currentSketchInfo.symbol);this.mapView.popup.features=[null===(i=this.currentSketchInfo.graphics)||void 0===i?void 0:i[0]],this.setCurrentSketchSymbol(),this.internalSketchUpdated.emit()}async sketchActionOnDrawFeaturesHandler({detail:{tool:e,sketchMessage:t}}){switch(this.clearHighlightAndPopup(),this.watchEscapeOnMapView(!0),this.watchDeleteOnMapView(!1),this.updateSketchMessage(t),"update"===this.sketchMode&&this.closeSketchPopovers.emit(),this.sketchMode="continuous",this.sketchLayerEditorSVModel.cancel(),this.sketchLayerEditorSVModel.updateOnGraphicClick(!1),this.tempCreatedGraphic=null,this.currentSketchInfo.graphics=null,this.currentSketchInfo.tool=e,e){case"point":this.sketchLayerEditorSVModel.setPoint(await async function(e,t,o){const i=await o.getBackgroundColorTheme(t);return new e({data:{type:"CIMSymbolReference",symbol:{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,colorLocked:!0,anchorPoint:{x:0,y:-1.75},anchorPointUnits:"Relative",size:5.7,frame:{xmin:0,ymin:0,xmax:84.3,ymax:84.3},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[83.2,32.5],[84.3,40.7],[83.8,48.9],[81.7,56.9],[78.1,64.3],[73,70.9],[66.9,76.4],[59.7,80.5],[51.9,83.2],[43.7,84.3],[35.4,83.8],[27.4,81.7],[20,78],[13.4,73],[7.9,66.8],[3.8,59.7],[1.1,51.9],[0,43.7],[.5,35.4],[2.6,27.4],[6.3,20],[11.3,13.4],[17.5,7.9],[24.7,3.8],[32.5,1.1],[39.8,.1],[47.1,.3],[54.3,1.8],[61.1,4.5],[67.4,8.4],[72.9,13.3],[77.4,19.1],[80.9,25.5],[83.2,32.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:"light"===i?[242,242,242,255]:[255,255,255,255]}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,rotation:0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-.5},anchorPointUnits:"Relative",size:15,frame:{xmin:0,ymin:0,xmax:197.7,ymax:294.7},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[98.9,0],[119.4,23.2],[139.4,49.3],[156.8,75.2],[171.2,100.8],[182.4,125.3],[190.6,148.8],[195.7,171.4],[197.7,192.9],[197.7,195.8],[197.7,200.3],[197.6,202.5],[197.5,204.8],[197.3,207.1],[197,209.4],[196.7,211.7],[196.4,214.1],[196,216.4],[195.5,218.7],[195,221.1],[194.4,223.4],[193.7,225.8],[193,228.1],[192.2,230.5],[191.4,232.8],[190.5,235.1],[189.5,237.5],[188.5,239.7],[187.4,242],[186.2,244.3],[185,246.5],[183.7,248.7],[182.4,250.9],[181,253.1],[179.5,255.2],[178,257.3],[176.4,259.4],[174.7,261.4],[173.1,263.3],[171.3,265.3],[169.5,267.2],[167.7,269],[165.8,270.8],[163.9,272.5],[161.9,274.2],[159.9,275.8],[157.8,277.4],[155.7,278.9],[153.6,280.4],[151.4,281.7],[149.2,283.1],[147,284.4],[144.8,285.6],[142.5,286.7],[140.3,287.8],[138,288.8],[135.7,289.8],[133.4,290.7],[131,291.5],[128.7,292.3],[126.4,293],[124,293.6],[121.7,294.2],[119.4,294.7],[117,295.2],[114.7,295.6],[112.4,296],[110.1,296.3],[107.8,296.5],[105.5,296.7],[103.3,296.8],[101.1,296.9],[98.8,296.9],[83.1,295.7],[67.8,292],[53.3,285.9],[39.9,277.5],[28.1,267.2],[18,255.1],[10,241.5],[4.2,226.9],[.9,211.5],[0,195.8],[.1,192.9],[2.1,171.4],[7.2,148.8],[15.4,125.3],[26.6,100.8],[41,75.2],[58.4,49.3],[78.4,23.2],[98.9,0]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:"light"===i?[17,26,40,255]:[186,186,186,255]}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,rotation:0}],scaleX:1,angleAlignment:"Display",angle:0}}})}(this.CIMSymbol,this.mapView,this.ColorUtils)),this.currentSketchInfo.symbol=this.sketchLayerEditorSVModel.getPoint(),this.sketchLayerEditorSVModel.createPoint();break;case"polyline":this.sketchLayerEditorSVModel.setLine(await async function(e,t){return{type:"simple-line",color:"light"===await t.getBackgroundColorTheme(e)?[0,0,0]:[255,255,255],width:.75}}(this.mapView,this.ColorUtils)),this.currentSketchInfo.symbol=this.sketchLayerEditorSVModel.getLine(),this.sketchLayerEditorSVModel.createLine();break;case"polygon":case"rectangle":case"circle":this.sketchLayerEditorSVModel.setPolygon(await async function(e,t){const o=await t.getBackgroundColorTheme(e);return{type:"simple-fill",color:"light"===o?[0,0,0,.25]:[255,255,255,.25],style:"solid",outline:{color:"light"===o?[0,0,0]:[255,255,255],width:.75}}}(this.mapView,this.ColorUtils)),this.currentSketchInfo.symbol=this.sketchLayerEditorSVModel.getPolygon(),this.sketchLayerEditorSVModel.createPolygon(e);break;case"text":this.sketchLayerEditorSVModel.setText(await async function(e,t,o,i){const s=await t.getBackgroundColor(e),l=await t.getBackgroundColorTheme(e);return new o({text:i,color:"light"===l?[0,0,0]:"dark"===l?[255,255,255]:s||[0,0,0],haloColor:null,haloSize:.75,font:{size:16.5,family:"Arial",weight:"bold"},lineWidth:512})}(this.mapView,this.ColorUtils,this.TextSymbol,this.strings.textContentPlaceholder)),this.currentSketchInfo.symbol=this.sketchLayerEditorSVModel.getText(),this.sketchLayerEditorSVModel.createText()}this.currentSketchInfo.popup=null,this.currentSketchInfo.title=this.getDefaultGraphicTitle(),this.sketchContentReRender.emit(e),this.showSketchContent=!0}async sketchActionOnSelectFeaturesHandler({detail:{sketchMessage:e,multipleSelectTool:t}}){const{sketchLayerEditorSVModel:o,currentSketchInfo:i,selectedSketchFeaturesFeatures:s,selectorOperation:l}=this;this.keepSelectionMessage=e,this.keepSelectionTool=t,this.clearHighlightAndPopup(),this.watchEscapeOnMapView(!1),this.closeSketchPopovers.emit(),this.updateSketchMessage(this.keepSelectionMessage),this.tempCreatedGraphic=null,i.graphics=null,i.symbol=null,i.tool=null,(null==s?void 0:s.length)||(this.watchDeleteOnMapView(!1),this.multipleSelectedGraphics=[]),this.sketchMode="update",o.cancel(),this.keepSelectionTool?this.actionOnMultipleSelections(this.keepSelectionTool):(null==l||l.cancel(),o.updateOnGraphicClick(!0)),this.sketchContentReRender.emit()}async setFocus(e){var t;"dismiss-button"!==e||null===(t=this.dismissButtonEl)||void 0===t||t.setFocus()}async done(){var e,t,o;this.removeHighlight(),(null===(e=this.snappingSessionStorageIds)||void 0===e?void 0:e.current)&&b(this.snappingOptions,this.snappingSessionStorageIds.current),(null===(t=this.sketchTooltipSessionStorageIds)||void 0===t?void 0:t.current)&&V(this.sketchTooltipOptions,this.sketchTooltipSessionStorageIds.current),this.closeSketchPopovers.emit(),this.sketchLayerEditorSVModel.destroy(),null===(o=this.sketchToolsEl)||void 0===o||o.remove(),this.sketchToolsEl=void 0,this.removeSketchShortcuts(),this.mapView.popupEnabled=!0}async activateLayer(e,t){var o,i;if(null===(o=this.sketchLayerEditorSVModel)||void 0===o||o.destroy(),null===(i=this.sketchLayerEditorSVModel)||void 0===i||i.updateOnGraphicClick(!1),this.layer=e,await this.initializeSessionStorageOptions(),this.initializeSVModel(),null==t?void 0:t.length){const e=t.map((e=>e.clone()));let o=[],i=[],s=[],l=[];e.forEach((e=>{switch(m(e)){case"point":e.layer=this.layer.pointLayer,o=[...o,e];break;case"polyline":e.layer=this.layer.polylineLayer,i=[...i,e];break;case"polygon":e.layer=this.layer.polygonLayer,s=[...s,e];break;default:e.layer=this.layer.textLayer,l=[...l,e]}})),this.currentSketchInfo.graphics=e,this.updateCurrentSketchInfo(),setTimeout((()=>{this.multipleSelectedGraphics=[...o,...i,...s,...l],o.length&&this.sketchLayerEditorSVModel.updatePoint(o),i.length&&this.sketchLayerEditorSVModel.updateLine(i),s.length&&this.sketchLayerEditorSVModel.updatePolygon(s),l.length&&this.sketchLayerEditorSVModel.updateText(l),this.sketchMode="update"}),300)}}async updateSketchTools(){this.sketchToolsEl&&(this.sketchToolsEl.sketchToolsToHide=this.sketchToolsToHide,this.sketchToolsEl.hideSelectionTools=this.hideSelectionTools,this.sketchToolsEl.activeSketchTool=this.activeSketchTool)}async componentWillLoad(){var e;[this.strings,this.currentLanguage]=await(0,s.g)(this.hostElement),await this.loadAllModules(),await this.initializeSessionStorageOptions(),this.initializeSVModel(),O.sketchLayerEditorSVModel=this.sketchLayerEditorSVModel,O.mapView=this.mapView,O.layer=this.layer,O.portal=this.portal,O.strings=this.strings,O.currentLanguage=this.currentLanguage,O.snappingOptions=this.snappingOptions,O.sketchTooltipOptions=this.sketchTooltipOptions,O.snappingSessionStorageIds=this.snappingSessionStorageIds,O.sketchTooltipSessionStorageIds=this.sketchTooltipSessionStorageIds,this.mapNotesFeature&&(this.selectedSketchFeaturesFeatures=[this.mapNotesFeature]),(null===(e=this.selectedSketchFeaturesFeatures)||void 0===e?void 0:e.length)&&(this.multipleSelectedGraphics=this.selectedSketchFeaturesFeatures.filter((e=>(0,c.i)(e))),this.currentSketchInfo.graphics=this.multipleSelectedGraphics,this.updateCurrentSketchInfo())}componentDidLoad(){this.needsMapViewHandles&&(this.mapView.focus(),this.watchDeleteOnMapView(!0),this.watchEscapeOnMapView(!0)),this.mapView.popupEnabled=!1,this.createSketchTools()}disconnectedCallback(){var e;this.watchEscapeOnMapView(!1),this.watchDeleteOnMapView(!1),this.removeSketchShortcuts(),this.removeSketchShortcutsTooltip(),null===(e=this.selectorOperation)||void 0===e||e.cancel(),this.sketchLayerEditorSVModel.updateOnGraphicClick(!1)}render(){const{showSketchToolsOnly:e}=this;return(0,i.h)(i.H,{key:"61a5aa3eb8914ed54fd18c7a48a4d3ca6d0dfb53",class:"calcite-match-height"},!e&&this.renderSketchFlowPanel())}renderSketchFlowPanel(){var e;const{strings:t,layer:o,currentSketchInfo:s,showSketchContent:n,dismissible:r}=this;return(0,i.h)("calcite-flow",{ref:e=>this.flowEl=e,dir:(0,l.g)(this.hostElement),class:"rtl"===(0,l.g)(this.hostElement)?l.C.rtl:""},(0,i.h)("calcite-flow-item",{ref:e=>this.sketchFlowItemEl=e,heading:t.sketch,disabled:!o.capabilities.operations.supportsMapNotesEditing},r&&this.renderDismissButton(),this.renderShortcutAndSnapping(),this.renderSketchMessage(),(null===(e=s.graphics)||void 0===e?void 0:e.length)?(0,i.h)("div",{class:"multiple-selection"},this.renderSelectionMultipleLabel(),(0,i.h)("div",{id:"multiple-selection-buttons",class:"buttons"},this.renderDuplicateMultiple(),this.renderCopyToNewSketchLayer(),this.renderDeleteMultiple())):null,n&&(0,i.h)("arcgis-sketch-layer-editor-content",{currentSketchInfo:s,flowEl:this.flowEl,symbolStylerRefElement:this.dismissButtonEl,hideSvgUploadSymbols:this.hideSvgUploadSymbols,hideAddStyles:this.hideAddStyles,ref:e=>this.sketchContentEl=e})))}renderDismissButton(){return(0,i.h)("calcite-action",{text:"close",icon:"x",slot:"header-actions-end",ref:e=>this.dismissButtonEl=e,onClick:e=>{e.stopPropagation(),this.updateSketchMessage(null),this.sketchLayerEditorSVModel.cancel(),this.clearHighlightAndPopup(),this.arcgisSketchDismissedChange.emit()}})}renderShortcutAndSnapping(){const{strings:e}=this;return(0,i.h)("div",{class:"snapping",ref:e=>this.shortcutSnappingEl=e},(0,i.h)("calcite-button",{alignment:"icon-end-space-between",appearance:"outline-fill",kind:"neutral",width:"full",iconStart:"gear",iconEnd:"chevron-down",label:e.sketchSettings,onClick:e=>{e.stopPropagation(),this.sketchSnappingEl||(this.sketchSnappingEl=document.createElement("arcgis-sketch-layer-editor-snapping"),this.sketchSnappingEl.refElement=this.shortcutSnappingEl,document.body.appendChild(this.sketchSnappingEl),this.disableSketchPanel.emit(!0))}},e.sketchSettings),(0,i.h)("calcite-button",{appearance:"outline-fill",class:"sketch-keyboard-button",kind:"neutral",iconStart:"keyboard",label:e.sketchShortcuts,onClick:()=>{this.removeSketchShortcutsTooltip(),this.arcgisSketchLayerEditorShortcutsEl||(this.arcgisSketchLayerEditorShortcutsEl=document.createElement("arcgis-sketch-layer-editor-shortcuts"),this.arcgisSketchLayerEditorShortcutsEl.refElement=this.shortcutSnappingEl,document.body.appendChild(this.arcgisSketchLayerEditorShortcutsEl),this.arcgisSketchLayerEditorShortcutsEl.addEventListener("arcgisSketchLayerEditorShortcutsDismissedChange",(()=>this.removeSketchShortcuts())))},onMouseOver:()=>this.addSketchShortcutsTooltip(),onMouseOut:()=>this.removeSketchShortcutsTooltip(),ref:e=>this.sketchShortcutsButtonEl=e}))}renderSketchMessage(){var e;const{sketchMessage:t}=O,{currentSketchInfo:o}=this;return!(!t||(null===(e=o.graphics)||void 0===e?void 0:e.length)>1)?(0,i.h)("div",{class:"sketch-message"},(0,i.h)("calcite-notice",{width:"full",open:!0},(0,i.h)("div",{slot:"message"},t))):null}renderSelectionMultipleLabel(){var e,t;const{strings:o,currentSketchInfo:s}=this;return(0,i.h)("calcite-label",{alignment:"center",for:"multiple-selection-buttons"},(null===(e=s.graphics)||void 0===e?void 0:e.length)<=1?o.singleFeatureSelected:o.featuresSelected.replace("${number}",null===(t=s.graphics)||void 0===t?void 0:t.length.toString()))}renderDuplicateMultiple(){const{strings:e}=this;return(0,i.h)("calcite-button",{appearance:"outline-fill",alignment:"center",iconStart:"duplicate",kind:"neutral",width:"full",onClick:e=>{e.stopPropagation(),this.sketchLayerEditorSVModel.duplicate(),this.offsetDuplicatedFeatures()}},e.duplicate)}renderCopyToNewSketchLayer(){const{strings:e}=this;return(0,i.h)("calcite-button",{appearance:"outline-fill",alignment:"center",iconStart:"copy",kind:"neutral",width:"full",onClick:e=>{e.stopPropagation();const t=this.currentSketchInfo.graphics.map((e=>e.clone()));this.arcgisSketchCopyToNewSketchLayer.emit({features:t})}},e.copyToNewSketchLayer)}renderDeleteMultiple(){const{strings:e}=this;return(0,i.h)("calcite-button",{appearance:"outline-fill",alignment:"center",iconStart:"trash",kind:"danger",width:"full",onClick:e=>{e.stopPropagation();const{sketchLayerEditorSVModel:t}=this;this.deleteInProgress=!0,t.delete(),this.deleteInProgress=!1,this.multipleSelectedGraphics=[],this.keepSelectToolSelection()}},e.delete)}async loadAllModules(){await a.e.load(),[this.SketchViewModel,this.TextSymbol,this.ColorUtils,this.CIMSymbol,this.SnappingOptions,this.SketchTooltipOptions,this.SelectionOperation,this.drawUtils]=await(0,n.l)(["esri/widgets/Sketch/SketchViewModel","esri/symbols/TextSymbol","esri/views/support/colorUtils","esri/symbols/CIMSymbol","esri/views/interactive/snapping/SnappingOptions","esri/views/interactive/sketch/SketchTooltipOptions","esri/widgets/support/Selector2D/SelectionOperation","esri/views/draw/support/drawUtils"])}async initializeSessionStorageOptions(){const{layer:e,mapView:t,SnappingOptions:o,snappingSessionStorageIds:i,SketchTooltipOptions:s,sketchTooltipSessionStorageIds:l}=this;this.snappingOptions=await S(i,e,t,o),this.sketchTooltipOptions=M(l,s)}initializeSVModel(){this.sketchLayerEditorSVModel=new f(this.layer,this.mapView,this.SketchViewModel,this.snappingOptions,this.sketchTooltipOptions,((e,t)=>this.onGraphicCreate(e,t)),this.onGraphicUpdate)}updateCurrentSketchInfo(){var e;this.currentSketchInfo.symbol=this.currentSketchInfo.graphics[0].symbol,this.currentSketchInfo.tool=m(this.currentSketchInfo.graphics[0]);const t=(null===(e=this.currentSketchInfo.graphics[0].attributes)||void 0===e?void 0:e.title)||this.getDefaultGraphicTitle(),o=this.currentSketchInfo.graphics.every((e=>{var o;return(null===(o=e.attributes)||void 0===o?void 0:o.title)===t})),i=this.currentSketchInfo.graphics[0].popupTemplate,s=this.currentSketchInfo.graphics.every((e=>JSON.stringify(e.popupTemplate)===JSON.stringify(i)));this.currentSketchInfo.title=o?t:null,this.currentSketchInfo.popup=s?i:null,this.showSketchContent=!0,this.sketchLayerEditorSVModel.updateOnGraphicClick(!0,this.onGraphicUpdate),this.needsMapViewHandles=!0}setCurrentSketchSymbol(){const{currentSketchInfo:e}=this;"point"===e.tool?this.sketchLayerEditorSVModel.setPoint(e.symbol):"polyline"===e.tool?this.sketchLayerEditorSVModel.setLine(e.symbol):["circle","polygon","rectangle"].indexOf(e.tool)>-1?this.sketchLayerEditorSVModel.setPolygon(e.symbol):"text"===e.tool&&this.sketchLayerEditorSVModel.setText(e.symbol)}getDefaultGraphicTitle(){const{strings:e,currentSketchInfo:t}=this;switch(t.tool){case"point":default:return e.point;case"polyline":return e.line;case"polygon":return e.polygon;case"rectangle":return e.rectangle;case"circle":return e.circle;case"text":return e.text}}createSketchTools(){var e;const{showSketchToolsOnly:t}=this;this.sketchToolsEl=document.createElement("arcgis-sketch-layer-editor-tools"),this.sketchToolsEl.sketchToolsToHide=this.sketchToolsToHide,this.sketchToolsEl.activeSketchTool=this.activeSketchTool,this.sketchToolsEl.hideSelectionTools=this.hideSelectionTools,this.sketchToolsEl.refElement=null!==(e=this.sketchToolsReferenceElement)&&void 0!==e?e:this.hostElement,this.selectedSketchFeaturesFeatures&&(this.sketchToolsEl.mapNotesFeatures=this.selectedSketchFeaturesFeatures,this.sketchToolsEl.activeSelectTool=1===this.multipleSelectedGraphics.length?"select":"rectangle"),t?document.body.appendChild(this.sketchToolsEl):this.hostElement.insertAdjacentElement("beforebegin",this.sketchToolsEl),this.sketchContentEl&&!this.sketchContentEl.symbolStylerRefElement&&(this.sketchContentEl.symbolStylerRefElement=this.dismissButtonEl)}clearHighlightAndPopup(){const{mapView:e}=this;this.removeHighlight(),e.closePopup()}highlightGraphic(e){var t;const{mapView:o}=this;this.removeHighlight();const i=null===(t=o.allLayerViews)||void 0===t?void 0:t.items.find((({layer:e})=>e===this.layer));this.createdGraphicHighlightHandle=null==i?void 0:i.highlight(e)}removeHighlight(){var e;null===(e=this.createdGraphicHighlightHandle)||void 0===e||e.remove(),this.createdGraphicHighlightHandle=void 0}watchEscapeOnMapView(e){var t;e&&!this.watchEscapeHandle?this.watchEscapeHandle=this.mapView.on("key-down",(e=>{"Escape"!==e.key||"active"!==this.sketchLayerEditorSVModel.getPointSVM().state&&"active"!==this.sketchLayerEditorSVModel.getLineSVM().state&&"active"!==this.sketchLayerEditorSVModel.getPolygonSVM().state&&"active"!==this.sketchLayerEditorSVModel.getTextSVM().state||(e.stopPropagation(),this.escKey=!0,this.sketchLayerEditorSVModel.cancel())})):(null===(t=this.watchEscapeHandle)||void 0===t||t.remove(),this.watchEscapeHandle=void 0)}watchDeleteOnMapView(e){var t;e&&!this.watchDeleteHandle?this.watchDeleteHandle=this.mapView.on("key-down",(e=>{"Delete"!==e.key&&"Backspace"!==e.key||(this.deleteInProgress=!0,this.sketchLayerEditorSVModel.delete(),this.deleteInProgress=!1,this.keepSelectToolSelection())})):(null===(t=this.watchDeleteHandle)||void 0===t||t.remove(),this.watchDeleteHandle=void 0)}onGraphicCreate(e,t){if("start"===e.state&&(this.tempCreatedGraphic=null,this.removeHighlight()),"cancel"===e.state&&this.escKey){this.escKey=!1;const e="text"===this.currentSketchInfo.tool?"point":this.currentSketchInfo.tool;t.create(e)}if("complete"===e.state){e.graphic&&(this.internalSketchUpdated.emit(),e.graphic.popupTemplate=this.currentSketchInfo.popup,e.graphic.attributes={title:this.currentSketchInfo.title},this.currentSketchInfo.graphics=[e.graphic],this.tempCreatedGraphic=e.graphic,this.highlightGraphic(e.graphic));const o="text"===this.currentSketchInfo.tool?"point":this.currentSketchInfo.tool;t.create(o)}}getSymbolProps(e){var t;return{size:C(e),rotation:P(e),color:w(e),outline:I(e),outlineStyle:null===(t=e.outline)||void 0===t?void 0:t.style,strokeStyle:e.style,marker:e.marker}}actionOnMultipleSelections(e){const{mapView:t}=this;this.selectedSketchFeaturesFeatures=null;const o=[this.layer.pointLayer,this.layer.polylineLayer,this.layer.polygonLayer,this.layer.textLayer],i="rectangle"===e?{createTool:"rectangle"}:{createTool:"polygon",mode:"freehand"};(this.selectorOperation=new this.SelectionOperation({view:t,sources:o,options:i})).once("complete",(e=>{const{selection:t}=e;if(this.clearHighlightAndPopup(),!e.aborted&&t.length){let e=[],o=[],i=[],s=[];t.forEach((t=>{switch(m(t)){case"point":default:e=[...e,t];break;case"polyline":o=[...o,t];break;case"polygon":i=[...i,t];break;case"text":s=[...s,t]}})),this.multipleSelectedGraphics=[...e,...o,...i,...s],e.length&&this.sketchLayerEditorSVModel.updatePoint(e),o.length&&this.sketchLayerEditorSVModel.updateLine(o),i.length&&this.sketchLayerEditorSVModel.updatePolygon(i),s.length&&this.sketchLayerEditorSVModel.updateText(s),this.watchDeleteOnMapView(!0)}})),this.sketchLayerEditorSVModel.updateOnGraphicClick(!1)}offsetDuplicatedFeatures(){const{drawUtils:e,mapView:t}=this;this.multipleSelectedGraphics.forEach((o=>e.move(o.geometry,15*t.resolution,15*t.resolution)));let o=[],i=[],s=[],l=[];this.selectedSketchFeaturesFeatures=this.multipleSelectedGraphics,this.multipleSelectedGraphics.forEach((e=>{switch(m(e)){case"polyline":i=[...i,e];break;case"polygon":s=[...s,e];break;case"text":l=[...l,e];break;default:o=[...o,e]}})),this.currentSketchInfo.graphics=this.multipleSelectedGraphics,o.length&&this.sketchLayerEditorSVModel.updatePoint(o),i.length&&this.sketchLayerEditorSVModel.updateLine(i),s.length&&this.sketchLayerEditorSVModel.updatePolygon(s),l.length&&this.sketchLayerEditorSVModel.updateText(l)}keepSelectToolSelection(){this.sketchToolsEl.activeSelectTool&&this.sketchActionOnSelectFeatures.emit({sketchMessage:this.keepSelectionMessage,multipleSelectTool:this.keepSelectionTool})}updateSketchMessage(e){O.sketchMessage=e}removeSketchShortcuts(){this.arcgisSketchLayerEditorShortcutsEl&&(this.arcgisSketchLayerEditorShortcutsEl.removeEventListener("arcgisSketchLayerEditorShortcutsDismissedChange",(()=>this.removeSketchShortcuts())),document.body.removeChild(this.arcgisSketchLayerEditorShortcutsEl),this.arcgisSketchLayerEditorShortcutsEl=void 0)}addSketchShortcutsTooltip(){const e=this.sketchShortcutsTooltipEl=document.createElement("calcite-tooltip");e.referenceElement=this.sketchShortcutsButtonEl,e.open=!0,e.innerHTML=this.strings.sketchShortcuts,document.body.append(e)}removeSketchShortcutsTooltip(){var e;this.sketchShortcutsTooltipEl&&(null===(e=this.sketchShortcutsTooltipEl.parentElement)||void 0===e||e.removeChild(this.sketchShortcutsTooltipEl),this.sketchShortcutsTooltipEl=void 0)}get hostElement(){return(0,i.d)(this)}};F.style=":host{display:flex;flex:1 1 auto;overflow:hidden}.sketch-delete-button{padding:var(--arcgis-app-cap-spacing-third)}.snapping{display:flex;padding:var(--arcgis-app-cap-spacing-half);background-color:var(--arcgis-app-background)}.sketch-message{padding:var(--arcgis-app-cap-spacing-half)}.sketch-keyboard-button{margin-left:0.3em}.multiple-selection{margin:1em}.multiple-selection calcite-button{margin-top:0.3em}.arcgis--rtl .sketch-keyboard-button{margin-left:unset;margin-right:0.3em}";const z=class{constructor(e){(0,i.r)(this,e),this.sketchGraphicUpdates=(0,i.c)(this,"sketchGraphicUpdates",7),this.arcgisSketchPanelLoader=(0,i.c)(this,"arcgisSketchPanelLoader",7),this.disableSketchPanel=(0,i.c)(this,"disableSketchPanel",7),this.arcgisSketchActiveSymbolChange=(0,i.c)(this,"arcgisSketchActiveSymbolChange",7),this.divNodes=[],this.symbolNodes=[],this.suggestedFillColors=[],this.savedColors=[],this.percentLabelFlip=!1,this.narrow=!1,this.resizeObserver=new ResizeObserver((e=>{const t=e.pop();this.narrow=t.contentRect.width<=275,(0,i.f)(this.hostElement)})),this.updateRotation=(0,c.d)((()=>{if(!this.rotationEl)return;clearTimeout(this.rotationValueHandle);const e=parseInt(this.rotationEl.value);!e||e<this.rotationEl.min||e>this.rotationEl.max?this.rotationValueHandle=setTimeout((()=>this.handleTextPropChange(this.rotationEl,"rotation")),3e3):this.handleTextPropChange(this.rotationEl,"rotation")}),500),this.flowEl=void 0,this.symbolStylerRefElement=void 0,this.currentSketchInfo=void 0,this.hideSvgUploadSymbols=!1,this.hideAddStyles=!1,this.reRender=!0}calciteFlowItemBackHandler(e){e.stopPropagation(),this.mapView.closePopup(),this.sketchPopupFlowItem=null}popupUpdatedHandler({detail:{mapNotesPopuptemplate:e}}){this.currentSketchInfo.popup=e,this.sketchGraphicUpdates.emit({type:"popup"})}sketchContentReRenderHandler(e){this.closeFontPopover(),e.stopPropagation(),(0,c.i)(e.detail)&&(this.storageId=this.currentSketchInfo.tool?["circle","rectangle"].indexOf(e.detail)>-1?"arcgis-sketch-recent-polygon-symbols":`arcgis-sketch-recent-${e.detail}-symbols`:"arcgis-sketch-recent-point-symbols",this.recentSymbols=(0,r.g)(this.storageId,!0)),this.reRender=!this.reRender,this.sketchPopupFlowItem&&(this.flowEl.back(),this.sketchPopupFlowItem=null);const{tool:t}=this.currentSketchInfo;"point"===t?this.startPointEdit():"polyline"===t?this.startPolylineEdit():["circle","polygon","rectangle"].includes(t)&&this.startPolygonEdit()}async componentWillLoad(){this.arcgisSketchPanelLoader.emit(!0),await this.loadAllModules(),g.forEach((e=>this.suggestedFillColors.push(new this.modules.Color(e)))),y.forEach((e=>this.savedColors.push(new this.modules.Color(e)))),this.mapView=O.mapView,this.strings=O.strings,this.currentLanguage=O.currentLanguage,this.portal=O.portal,this.flowEl||(this.flowEl=(0,p.q)(this.hostElement,"calcite-flow"));const e=this.currentSketchInfo.tool?["circle","rectangle"].indexOf(this.currentSketchInfo.tool)>-1?"arcgis-sketch-recent-polygon-symbols":`arcgis-sketch-recent-${this.currentSketchInfo.tool}-symbols`:"arcgis-sketch-recent-point-symbols",t=(0,r.g)(e,!0);t&&(this.recentSymbols=[...t]);const o=(0,l.g)(this.hostElement),i=new Intl.NumberFormat(this.currentLanguage,{style:"percent"}).format(0);this.percentLabelFlip="rtl"===o?i.endsWith("%"):i.startsWith("%")}componentDidLoad(){this.arcgisSketchPanelLoader.emit(!1),this.flowEl&&this.resizeObserver.observe(this.flowEl)}disconnectedCallback(){clearTimeout(this.fontSizeValueHandle),clearTimeout(this.rotationValueHandle),clearTimeout(this.haloSizeValueHandle),clearTimeout(this.borderLineSizeValueHandle),this.flowEl&&this.resizeObserver.unobserve(this.flowEl),this.removeResetTooltip()}render(){return this.divNodes=[],this.symbolNodes=[],(0,i.h)(i.H,{key:"fefc20c96b13ac6e0f96210953b88d42284e6a1b"},(0,i.h)("div",{key:"3a1ce1971827a96dd5e7cee98b7675654f503561",dir:(0,l.g)(this.hostElement)},this.renderFeatureInfoBlock(),this.renderStyleInfoBlock()))}renderFeatureInfoBlock(){const e=this.getFeatureInfoHeading();return(0,i.h)("calcite-block",{heading:e,open:!0,collapsible:!0},this.renderSketchTitle(),this.renderPopupBtn())}renderStyleInfoBlock(){var e,t,o,s,l;const{strings:n}=this,r=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1,c=null===(t=this.currentSketchInfo.graphics)||void 0===t?void 0:t[0].geometry.type,a=null===(o=this.currentSketchInfo.graphics)||void 0===o?void 0:o.every((e=>c===e.geometry.type)),h=(null===(s=this.currentSketchInfo.graphics)||void 0===s?void 0:s.some((e=>"text"===e.symbol.type)))&&!(null===(l=this.currentSketchInfo.graphics)||void 0===l?void 0:l.every((e=>"text"===e.symbol.type))),d=!r||a&&!h;return(0,i.h)("div",{class:"style-info-wrapper"},(0,i.h)("div",{class:"style-info-block"},(0,i.h)("calcite-label",{class:"style-title"},n.style),d&&this.renderRecentSymbols(),!d&&this.renderNoStyleMessage()),d&&this.renderSymbolStyler())}renderRecentSymbols(){var e;const{strings:t}=this;let o;switch(this.currentSketchInfo.tool){case"polyline":o=t.line;break;case"polygon":case"circle":case"rectangle":o=t.polygon;break;case"text":o=t.text;break;default:o=t.point}return o=o.toLocaleLowerCase(),(0,i.h)(i.F,null,(0,i.h)("calcite-label",null,t.recentSymbols.replace("${tool}",o)),(0,i.h)("div",{class:"recent-symbols-wrapper",ref:e=>this.recentSymbolsContainerEl=e},(null===(e=this.recentSymbols)||void 0===e?void 0:e.length)?(0,i.h)(i.F,null,(0,i.h)("div",{class:"recent-symbols-symbol-group"},this.recentSymbols.map(((e,t)=>e?(0,i.h)("div",{key:"symbol",class:"recent-symbol",tabindex:"0",onClick:()=>this.handleRecentSymbolSelect(t),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleRecentSymbolSelect(t))},ref:o=>{o&&(this.divNodes[t]=o,this.afterCreateRecentSymbolDiv(o,e,t))}}):null))),(0,i.h)("div",{class:"recent-symbols-divider-wrapper"},(0,i.h)("div",{class:"recent-symbols-divider"})),(0,i.h)("div",{class:"recent-symbols-reset-button-wrapper"},(0,i.h)("calcite-action",{scale:"s",icon:"reset",text:t.clearRecentSymbols,onClick:()=>{const e=this.currentSketchInfo.tool?["circle","rectangle"].indexOf(this.currentSketchInfo.tool)>-1?"arcgis-sketch-recent-polygon-symbols":`arcgis-sketch-recent-${this.currentSketchInfo.tool}-symbols`:"arcgis-sketch-recent-point-symbols";this.recentSymbols=[],(0,r.s)(e,this.recentSymbols,!0),(0,i.f)(this.hostElement)},onFocus:()=>this.addResetTooltip(),onFocusout:()=>this.removeResetTooltip(),onMouseOver:()=>this.addResetTooltip(),onMouseOut:()=>this.removeResetTooltip(),ref:e=>this.resetRecentSymbolsNode=e}))):(0,i.h)("div",{key:"no-recent-symbol",class:"no-recent-symbols"},t.noRecentSymbols.replace("${tool}",o))))}renderSymbolStyler(){switch(this.currentSketchInfo.tool){case"point":return this.renderPoint();case"polyline":return this.renderPolyline();case"polygon":case"rectangle":case"circle":return this.renderPolygon();case"text":return this.renderText();default:return null}}renderNoStyleMessage(){const{strings:e}=this;return(0,i.h)("calcite-label",null,e.noStyleMessage)}renderSketchTitle(){const{strings:e}=this;return(0,i.h)("calcite-label",null,e.featureName,(0,i.h)("calcite-input-text",{alignment:"start",placeholder:e.enterFeatureNamePlaceholder,value:this.currentSketchInfo.title,onBlur:e=>{this.currentSketchInfo.title=e.target.value,this.sketchGraphicUpdates.emit({type:"title"})}}))}renderPopupBtn(){var e;const{strings:t}=this,o="rtl"===(0,l.g)(this.hostElement),s=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1;return(0,i.h)("calcite-button",{alignment:"icon-end-space-between",appearance:"outline-fill",kind:"neutral",iconStart:"configure-popup",iconEnd:o?"chevron-left":"chevron-right",label:t.popup,width:"full",scale:"l",class:"sketch-popup-button",onClick:e=>{var o,i;if(e.stopPropagation(),!this.sketchPopupFlowItem){this.sketchPopupFlowItem=document.createElement("calcite-flow-item"),this.sketchPopupFlowItem.heading=t.sketch,this.sketchPopupFlowItem.description=t.popup;const e=document.createElement("calcite-fab");e.icon="plus",e.slot="fab",e.scale="s",e.appearance="outline-fill",e.kind="neutral",e.label=t.addContent,e.text=t.addContent,e.textEnabled=!0,this.sketchPopupFlowItem.appendChild(e);const l=document.createElement("arcgis-popup");if(l.lang=this.currentLanguage,l.mapView=this.mapView,l.layerDisplayType=d.l.mapNotes,l.mapNotesGraphic=null===(o=this.currentSketchInfo.graphics)||void 0===o?void 0:o[0],l.mapNotesPopupTemplate=this.currentSketchInfo.popup,l.calciteFlowProps={flow:this.flowEl,calciteFab:e,calciteFlowItem:this.sketchPopupFlowItem},this.sketchPopupFlowItem.appendChild(l),this.flowEl.appendChild(this.sketchPopupFlowItem),s){l.multiplePopupsSelected=!0,l.disableEditing=!0;const e=document.createElement("calcite-button");e.label=t.applyChanges,e.innerHTML=t.applyChanges,e.scale="l",e.slot="footer",this.sketchPopupFlowItem.append(e),e.addEventListener("click",(()=>{var o;this.alertEl&&(null===(o=this.alertEl.parentElement)||void 0===o||o.removeChild(this.alertEl),this.alertEl=void 0),l.disableEditing=!1,l.update(),e.kind="neutral",e.disabled=!0,this.alertEl=document.createElement("calcite-alert"),this.alertEl.kind="success",this.alertEl.icon="check-circle";const i=document.createElement("div");i.slot="message",i.innerHTML=t.changesApplied,this.alertEl.append(i),this.alertEl.open=!0,document.body.append(this.alertEl),this.alertEl.addEventListener("calciteAlertClose",(()=>{var e;null===(e=this.alertEl.parentElement)||void 0===e||e.removeChild(this.alertEl),this.alertEl=void 0}))})),l.addEventListener("bulkPopupUpdated",(()=>{e.kind="brand",e.disabled=!1}))}this.sketchPopupFlowItem.setFocus(),this.sketchPopupFlowItem.beforeBack=async()=>await l.done(),this.mapView.closePopup(),(null===(i=this.currentSketchInfo.graphics)||void 0===i?void 0:i.length)&&this.currentSketchInfo.popup&&this.mapView.openPopup({features:[this.currentSketchInfo.graphics[0]],location:(0,p.o)(this.currentSketchInfo.graphics[0].geometry)})}}},t.popup)}renderPoint(){var e,t,o,s,n;const r="rtl"===(0,l.g)(this.hostElement),c=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1,a=null===(t=this.currentSketchInfo.graphics)||void 0===t?void 0:t[0].geometry.type,h=null===(o=this.currentSketchInfo.graphics)||void 0===o?void 0:o.every((e=>a===e.geometry.type)),d=null===(s=this.currentSketchInfo.graphics)||void 0===s?void 0:s[0].symbol.type,p=null===(n=this.currentSketchInfo.graphics)||void 0===n?void 0:n.every((e=>d===e.symbol.type));return(0,i.h)("arcgis-symbol-styler",{class:"symbol-styler",displaySymbolsSelectionOnly:c&&h&&!p,mode:c?"minimal":"default",key:"point-styler",lang:this.currentLanguage,initialSourceId:this.currentSketchInfo.sourceIds.pointSourceId,hideSvgUploadSymbols:this.hideSvgUploadSymbols,hideAddStyles:this.hideAddStyles,ref:e=>{e&&this.currentSketchInfo.symbol&&(this.pointStyler=e,this.startPointEdit())},popoverProps:this.getPopoverProps(r),onArcgisSymbolStylerEdit:({detail:{symbol:e,symbolSwitch:t}})=>this.updateSymbol(e,t),onArcgisSymbolStylerSourceIdChange:({detail:e})=>this.currentSketchInfo.sourceIds.pointSourceId=e})}renderPolyline(){var e,t,o,s,n;const r="rtl"===(0,l.g)(this.hostElement),c=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1,a=null===(t=this.currentSketchInfo.graphics)||void 0===t?void 0:t[0].geometry.type,h=null===(o=this.currentSketchInfo.graphics)||void 0===o?void 0:o.every((e=>a===e.geometry.type)),d=null===(s=this.currentSketchInfo.graphics)||void 0===s?void 0:s[0].symbol.type,p=null===(n=this.currentSketchInfo.graphics)||void 0===n?void 0:n.every((e=>d===e.symbol.type));return(0,i.h)("arcgis-symbol-styler",{class:"symbol-styler",displaySymbolsSelectionOnly:c&&h&&!p,mode:c?"minimal":"default",key:"polyline-styler",lang:this.currentLanguage,initialSourceId:this.currentSketchInfo.sourceIds.polylineSourceId,hideSvgUploadSymbols:this.hideSvgUploadSymbols,hideAddStyles:this.hideAddStyles,ref:e=>{e&&this.currentSketchInfo.symbol&&(this.polylineStyler=e,this.startPolylineEdit())},popoverProps:this.getPopoverProps(r),onArcgisSymbolStylerEdit:({detail:{symbol:e,symbolSwitch:t}})=>this.updateSymbol(e,t),onArcgisSymbolStylerSourceIdChange:({detail:e})=>this.currentSketchInfo.sourceIds.polylineSourceId=e})}renderPolygon(){var e,t,o,s,n;const r="rtl"===(0,l.g)(this.hostElement),c=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1,a=null===(t=this.currentSketchInfo.graphics)||void 0===t?void 0:t[0].geometry.type,h=null===(o=this.currentSketchInfo.graphics)||void 0===o?void 0:o.every((e=>a===e.geometry.type)),d=null===(s=this.currentSketchInfo.graphics)||void 0===s?void 0:s[0].symbol.type,p=null===(n=this.currentSketchInfo.graphics)||void 0===n?void 0:n.every((e=>d===e.symbol.type));return(0,i.h)("arcgis-symbol-styler",{class:"symbol-styler",displaySymbolsSelectionOnly:c&&h&&!p,mode:c?"minimal":"default",key:"polygon-styler",lang:this.currentLanguage,initialSourceId:this.currentSketchInfo.sourceIds.polygonSourceId,hideSvgUploadSymbols:this.hideSvgUploadSymbols,hideAddStyles:this.hideAddStyles,ref:e=>{e&&this.currentSketchInfo.symbol&&(this.polygonStyler=e,this.startPolygonEdit())},popoverProps:this.getPopoverProps(r),onArcgisSymbolStylerEdit:({detail:{symbol:e,symbolSwitch:t}})=>this.updateSymbol(e,t),onArcgisSymbolStylerSourceIdChange:({detail:e})=>this.currentSketchInfo.sourceIds.polygonSourceId=e})}renderText(){return(0,i.h)("div",{class:"text-content"},this.renderTextContent(),this.renderFontFamilySelection(),this.renderTextFontSize(),this.renderTextColor(),this.renderTextRotation(),this.renderTextHaloBlock(),this.renderTextBackgroundColorBlock())}renderTextContent(){var e;const{strings:t}=this,o=this.currentSketchInfo.symbol;let s,l;return this.textContentEl&&(s=null==o?void 0:o.text,l=null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.every((e=>s===e.symbol.text))),(0,i.h)("calcite-label",null,t.content,(0,i.h)("calcite-text-area",{resize:"vertical",placeholder:t.textContentPlaceholder,value:l?null==o?void 0:o.text:"",onCalciteTextAreaInput:e=>{e.stopPropagation();const t=null==o?void 0:o.clone();t.text=e.target.value,this.updateSymbol(t,!1,!1,"text")},ref:e=>this.textContentEl=e}))}renderFontFamilySelection(){const{strings:e}=this,t=this.currentSketchInfo.symbol;return(0,i.h)("calcite-label",null,e.font,(0,i.h)("calcite-button",{alignment:"icon-end-space-between",appearance:"outline-fill",kind:"neutral",iconEnd:"chevron-down",label:(0,u.f)((null==t?void 0:t.font)||{family:"Arial",style:"normal",weight:"normal"}),width:"full",onClick:()=>this.openFontPopover()},(0,u.f)(null==t?void 0:t.font)))}renderTextFontSize(){var e;const{strings:t}=this,o=this.currentSketchInfo.symbol;return(0,i.h)("calcite-label",null,t.size,(0,i.h)("calcite-input-number",{scale:"s",inputMode:"decimal",min:5,max:125,value:`${(null===(e=null==o?void 0:o.font)||void 0===e?void 0:e.size)/.75||5}`,onCalciteInputNumberInput:e=>{clearTimeout(this.fontSizeValueHandle),e.stopPropagation();const t=parseInt(this.fontSizeEl.value);!t||t<this.fontSizeEl.min||t>this.fontSizeEl.max?this.fontSizeValueHandle=setTimeout((()=>this.handleTextPropChange(this.fontSizeEl,"font-size")),3e3):this.handleTextPropChange(this.fontSizeEl,"font-size")},ref:e=>this.fontSizeEl=e}))}renderTextColor(){var e,t,o;const{strings:s,modules:n}=this,r="rtl"===(0,l.g)(this.hostElement),c=this.currentSketchInfo.symbol;return(0,i.h)(i.F,null,(0,i.h)("calcite-label",null,s.color,(0,i.h)("arcgis-color-input",{color:(null===(e=null==c?void 0:c.color)||void 0===e?void 0:e.toHex())||"#ffffff",popoverProps:this.getPopoverProps(r),storageId:"arcgis-symbol-styler-storage-colors",onArcgisColorInputChange:e=>{var t,o;const i=null==c?void 0:c.clone(),s=null!==(o=null===(t=null==c?void 0:c.color)||void 0===t?void 0:t.a)&&void 0!==o?o:1;i.color=new n.Color(e.target.color),i.color.a=s,this.updateSymbol(i,!1,!1,"color",!1,!0)},onArcgisColorInputPopoverClose:e=>{var t,o;const i=e.detail;if(i){const e=null==c?void 0:c.clone(),s=null!==(o=null===(t=null==c?void 0:c.color)||void 0===t?void 0:t.a)&&void 0!==o?o:1;e.color=new n.Color(i),e.color.a=s,this.updateSymbol(e,!1,!1,"color")}},onArcgisColorInputSwatchUpdate:e=>{var t,o;const i=e.detail;if(i){const e=null==c?void 0:c.clone(),s=null!==(o=null===(t=null==c?void 0:c.color)||void 0===t?void 0:t.a)&&void 0!==o?o:1;e.color=new n.Color(i),e.color.a=s,this.updateSymbol(e,!1,!1,"color")}}})),(0,i.h)("calcite-label",null,s.transparency,(0,i.h)("arcgis-slider-input",{min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,p.a)(null!==(o=null===(t=null==c?void 0:c.color)||void 0===t?void 0:t.a)&&void 0!==o?o:1)),onArcgisSliderInputValueChange:e=>{const t=e.detail,o=(0,p.t)(t),i=null==c?void 0:c.clone();i.color.a=o,this.updateSymbol(i,!1,!1,"color-transparency")},withSteppers:!this.narrow,label:s.transparency})))}renderTextRotation(){const{strings:e}=this,t="rtl"===(0,l.g)(this.hostElement),o=this.currentSketchInfo.symbol;return(0,i.h)("calcite-label",null,e.rotation,(0,i.h)("div",{class:"rotation"},(0,i.h)("calcite-slider",{min:0,max:360,value:(null==o?void 0:o.angle)||0,step:1,onCalciteSliderInput:e=>this.handleTextRotationSliderValueChange(e.target.value,!0),onCalciteSliderChange:e=>this.handleTextRotationSliderValueChange(e.target.value,!1)}),(0,i.h)("calcite-input-number",{scale:"s",inputMode:"decimal",min:0,max:360,suffixText:t?"":"\xba",prefixText:t?"\xba":"",step:1,value:`${(null==o?void 0:o.angle)||0}`,onCalciteInputNumberInput:this.updateRotation,ref:e=>this.rotationEl=e})))}renderTextHaloBlock(){var e,t,o;const{strings:s,modules:n}=this,r="rtl"===(0,l.g)(this.hostElement),c=this.currentSketchInfo.symbol;return(0,i.h)("calcite-block-section",{ref:e=>this.haloBlockSectionEl=e,text:s.halo,toggleDisplay:"switch",open:!!(null==c?void 0:c.haloColor),onCalciteBlockSectionToggle:e=>{e.stopPropagation();const t=null==c?void 0:c.clone();this.haloBlockSectionEl.open?(t.haloColor=this.tempHaloColor||new n.Color("white"),t.haloSize=(null==t?void 0:t.haloSize)||.75):(this.tempHaloColor=t.haloColor,t.haloColor=null),this.updateSymbol(t,!1,!1,"halo")}},(0,i.h)("div",{class:"halo-block"},(0,i.h)("calcite-label",null,s.color,(0,i.h)("arcgis-color-input",{color:(null===(e=null==c?void 0:c.haloColor)||void 0===e?void 0:e.toHex())||"#ffffff",popoverProps:this.getPopoverProps(r),storageId:"arcgis-symbol-styler-storage-colors",onArcgisColorInputChange:e=>{var t,o;const i=null==c?void 0:c.clone(),s=null!==(o=null===(t=null==c?void 0:c.haloColor)||void 0===t?void 0:t.a)&&void 0!==o?o:1;i.haloColor=new n.Color(e.target.color),i.haloColor.a=s,this.updateSymbol(i,!1,!1,"halo-color")},onArcgisColorInputPopoverClose:e=>{var t,o;const i=e.detail;if(i){const e=null==c?void 0:c.clone(),s=null!==(o=null===(t=null==c?void 0:c.haloColor)||void 0===t?void 0:t.a)&&void 0!==o?o:1;e.haloColor=new n.Color(i),e.haloColor.a=s,this.updateSymbol(e,!1,!1,"halo-color")}},onArcgisColorInputSwatchUpdate:e=>{var t,o;const i=e.detail;if(i){const e=null==c?void 0:c.clone(),s=null!==(o=null===(t=null==c?void 0:c.haloColor)||void 0===t?void 0:t.a)&&void 0!==o?o:1;e.haloColor=new n.Color(i),e.haloColor.a=s,this.updateSymbol(e,!1,!1,"halo-color")}}})),(0,i.h)("calcite-label",null,s.transparency,(0,i.h)("arcgis-slider-input",{min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,p.a)(null!==(o=null===(t=null==c?void 0:c.haloColor)||void 0===t?void 0:t.a)&&void 0!==o?o:1)),onArcgisSliderInputValueChange:e=>{const t=e.detail,o=(0,p.t)(t),i=null==c?void 0:c.clone();i.haloColor.a=o,this.updateSymbol(i,!1,!1,"halo-color-transparency")},withSteppers:!this.narrow,label:s.transparency})),(0,i.h)("calcite-label",null,s.size,(0,i.h)("calcite-input-number",{scale:"s",inputMode:"decimal",min:1,max:10,value:`${(null==c?void 0:c.haloSize)/.75||0}`,onCalciteInputNumberInput:e=>{clearTimeout(this.haloSizeValueHandle),e.stopPropagation();const t=parseInt(this.haloSizeEl.value);!t||t<this.haloSizeEl.min||t>this.haloSizeEl.max?this.haloSizeValueHandle=setTimeout((()=>this.handleTextPropChange(this.haloSizeEl,"halo-size")),3e3):this.handleTextPropChange(this.haloSizeEl,"halo-size")},ref:e=>this.haloSizeEl=e}))))}renderTextBackgroundColorBlock(){var e,t,o,s,n,r;const{strings:a,modules:h}=this,d="rtl"===(0,l.g)(this.hostElement),u=this.currentSketchInfo.symbol;return(0,i.h)("calcite-block-section",{ref:e=>this.backgroundColorSectionEl=e,text:a.background,toggleDisplay:"switch",open:!!(null==u?void 0:u.backgroundColor),onCalciteBlockSectionToggle:e=>{var t;e.stopPropagation();const o=null==u?void 0:u.clone();this.backgroundColorSectionEl.open?(o.backgroundColor=this.tempBackgroundColor||new h.Color("white"),o.borderLineColor=this.tempBorderLineColor||new h.Color("white"),o.borderLineSize=null!==(t=this.tempBorderLineSize)&&void 0!==t?t:.75):(this.tempBackgroundColor=o.backgroundColor,this.tempBorderLineColor=o.borderLineColor,this.tempBorderLineSize=o.borderLineSize,o.backgroundColor=null,o.borderLineColor=null,o.borderLineSize=null),this.updateSymbol(o,!1,!1,"background")}},(0,i.h)("div",{class:"background-color-block"},(0,i.h)("calcite-label",null,a.color,(0,i.h)("arcgis-color-input",{color:(null===(e=null==u?void 0:u.backgroundColor)||void 0===e?void 0:e.toHex())||"#ffffff",popoverProps:this.getPopoverProps(d),storageId:"arcgis-symbol-styler-storage-colors",onArcgisColorInputChange:e=>{var t,o;const i=null==u?void 0:u.clone(),s=null!==(o=null===(t=null==u?void 0:u.backgroundColor)||void 0===t?void 0:t.a)&&void 0!==o?o:1;i.backgroundColor=new h.Color(e.target.color),i.backgroundColor.a=s,this.updateSymbol(i,!1,!1,"background-color",!1,!0)},onArcgisColorInputPopoverClose:e=>{var t,o;const i=e.detail;if(i){const e=null==u?void 0:u.clone(),s=null!==(o=null===(t=null==u?void 0:u.backgroundColor)||void 0===t?void 0:t.a)&&void 0!==o?o:1;e.backgroundColor=new h.Color(i),e.backgroundColor.a=s,this.updateSymbol(e,!1,!1,"background-color")}},onArcgisColorInputSwatchUpdate:e=>{var t,o;const i=e.detail;if(i){const e=null==u?void 0:u.clone(),s=null!==(o=null===(t=null==u?void 0:u.backgroundColor)||void 0===t?void 0:t.a)&&void 0!==o?o:1;e.backgroundColor=new h.Color(i),e.backgroundColor.a=s,this.updateSymbol(e,!1,!1,"background-color")}}})),(0,i.h)("calcite-label",null,a.transparency,(0,i.h)("arcgis-slider-input",{min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,p.a)(null!==(o=null===(t=null==u?void 0:u.backgroundColor)||void 0===t?void 0:t.a)&&void 0!==o?o:1)),onArcgisSliderInputValueChange:e=>{const t=e.detail,o=(0,p.t)(t),i=null==u?void 0:u.clone();i.backgroundColor.a=o,this.updateSymbol(i,!1,!1,"background-color-transparency")},withSteppers:!this.narrow,label:a.transparency})),(0,i.h)("calcite-label",null,a.outlineColor,(0,i.h)("arcgis-color-input",{color:(null===(s=null==u?void 0:u.borderLineColor)||void 0===s?void 0:s.toHex())||"#ffffff",popoverProps:this.getPopoverProps(d),storageId:"arcgis-symbol-styler-storage-colors",onArcgisColorInputChange:e=>{var t,o;const i=null==u?void 0:u.clone(),s=null!==(o=null===(t=null==u?void 0:u.borderLineColor)||void 0===t?void 0:t.a)&&void 0!==o?o:1;i.borderLineColor=new h.Color(e.target.color),i.borderLineColor.a=s,this.updateSymbol(i,!1,!1,"border-line-color",!1,!0)},onArcgisColorInputPopoverClose:e=>{var t,o;const i=e.detail;if(i){const e=null==u?void 0:u.clone(),s=null!==(o=null===(t=null==u?void 0:u.borderLineColor)||void 0===t?void 0:t.a)&&void 0!==o?o:1;e.borderLineColor=new h.Color(i),e.borderLineColor.a=s,this.updateSymbol(e,!1,!1,"border-line-color")}},onArcgisColorInputSwatchUpdate:e=>{var t,o;const i=e.detail;if(i){const e=null==u?void 0:u.clone(),s=null!==(o=null===(t=null==u?void 0:u.borderLineColor)||void 0===t?void 0:t.a)&&void 0!==o?o:1;e.borderLineColor=new h.Color(i),e.borderLineColor.a=s,this.updateSymbol(e,!1,!1,"border-line-color")}}})),(0,i.h)("calcite-label",null,a.outlineTransparency,(0,i.h)("arcgis-slider-input",{min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,p.a)(null!==(r=null===(n=null==u?void 0:u.borderLineColor)||void 0===n?void 0:n.a)&&void 0!==r?r:1)),onArcgisSliderInputValueChange:e=>{const t=e.detail,o=(0,p.t)(t),i=null==u?void 0:u.clone();i.borderLineColor.a=o,this.updateSymbol(i,!1,!1,"border-line-color-transparency")},withSteppers:!this.narrow,label:a.outlineTransparency})),(0,i.h)("calcite-label",null,a.outlineWidth,(0,i.h)("calcite-input-number",{scale:"s",inputMode:"decimal",min:0,max:18,value:""+((0,c.i)(null==u?void 0:u.borderLineSize)?u.borderLineSize/.75:1),onCalciteInputNumberInput:e=>{clearTimeout(this.borderLineSizeValueHandle),e.stopPropagation();const t=parseInt(this.borderLineSizeEl.value);isNaN(t)||t<this.borderLineSizeEl.min||t>this.borderLineSizeEl.max?this.borderLineSizeValueHandle=setTimeout((()=>this.handleTextPropChange(this.borderLineSizeEl,"border-line-size")),3e3):this.handleTextPropChange(this.borderLineSizeEl,"border-line-size")},ref:e=>this.borderLineSizeEl=e}))))}async loadAllModules(){const[e,t,o,i,s,l,r,c,a]=await(0,n.l)(["esri/Color","esri/symbols/support/cimSymbolUtils","esri/symbols/support/symbolUtils","esri/symbols/CIMSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/PictureMarkerSymbol","esri/symbols/PictureFillSymbol","esri/symbols/TextSymbol"]);this.modules={Color:e,cimSymbolUtils:t,symbolUtils:o,CIMSymbol:i,SimpleLineSymbol:s,SimpleFillSymbol:l,PictureMarkerSymbol:r,PictureFillSymbol:c,TextSymbol:a}}createPortalProp(){return{portal:this.portal,before:async(e,t)=>{await e.load(),t.originalStylesGroupQuery2d=e.stylesGroupQuery2d,e.stylesGroupQuery2d=e.sourceJSON["2DSketchStylesGroupQuery"]},after:async(e,t)=>{e.stylesGroupQuery2d=t.originalStylesGroupQuery2d}}}getFeatureInfoHeading(){var e,t,o,i,s,l;const{strings:n}=this,r=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1,c=null===(t=this.currentSketchInfo.graphics)||void 0===t?void 0:t[0].geometry.type,a=null===(o=this.currentSketchInfo.graphics)||void 0===o?void 0:o.every((e=>c===e.geometry.type)),h=(null===(i=this.currentSketchInfo.graphics)||void 0===i?void 0:i.some((e=>"text"===e.symbol.type)))&&!(null===(s=this.currentSketchInfo.graphics)||void 0===s?void 0:s.every((e=>"text"===e.symbol.type))),d=this.currentSketchInfo.tool;if(r){if(!a||h)return n.selectedFeatures;switch(c){case"polyline":return n.lineFeatures;case"polygon":return n.polygonFeatures;default:return"point"!==c||(null===(l=this.currentSketchInfo.graphics)||void 0===l?void 0:l.some((e=>"text"===e.symbol.type)))?n.textFeatures:n.pointFeatures}}else switch(d){case"point":return n.pointFeature;case"polyline":return n.lineFeature;case"text":return n.textFeature;default:return n.polygonFeature}}async afterCreateRecentSymbolDiv(e,t,o){const{strings:i,modules:s}=this;let l;if(["simple-line","simple-fill","picture-marker","picture-fill","text","cim"].indexOf(t.type)>-1)"text"===t.type&&(t.text=i.textPreview),l=t;else switch(t.type){case"CIMSymbolReference":l=s.CIMSymbol.fromJSON(t);break;case"esriSLS":l=s.SimpleLineSymbol.fromJSON(t);break;case"esriSFS":l=s.SimpleFillSymbol.fromJSON(t);break;case"esriPMS":l=s.PictureMarkerSymbol.fromJSON(t);break;case"esriPFS":l=s.PictureFillSymbol.fromJSON(t);break;case"esriTS":l=s.TextSymbol.fromJSON(t)}const n=l.clone();"text"===n.type&&(n.haloSize=Math.min(2,n.haloSize)),"simple-line"===n.type&&(n.width=Math.min(2,n.width));const r={maxSize:"text"===n.type?16:24,scale:!0,size:"simple-line"===n.type?{width:this.recentSymbolsContainerEl.clientWidth/9}:{width:"text"===n.type?16:24,height:"text"===n.type?16:24}};n&&await s.symbolUtils.renderPreviewHTML(n,r).then((t=>{t&&((e=>{for(var t;null===(t=null==e?void 0:e.childNodes)||void 0===t?void 0:t.length;)e.removeChild(e.childNodes[0])})(e),e.append(t),this.symbolNodes[o]=l)}))}handleRecentSymbolSelect(e){this.updateSymbol(this.symbolNodes[e],!0,!0,this.textContentEl?"recent-text":void 0),this.divNodes[0].focus()}getPopoverProps(e){var t;const o=null===(t=this.flowEl)||void 0===t?void 0:t.getBoundingClientRect();return{placement:e?"bottom-start":"bottom-end",offsetDistance:10,offsetSkidding:e?3:-3,overlayPositioning:"fixed",maxHeight:o&&o.height-65+"px",refElement:this.symbolStylerRefElement}}startPointEdit(){var e,t;const{modules:o}=this,i="cim"===this.currentSketchInfo.symbol.type,s=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1;null===(t=this.pointStyler)||void 0===t||t.edit(this.currentSketchInfo.symbol.clone(),{sections:{marker:{open:!0,symbolsOpen:!0,sizeOpen:!1,rotationOpen:!1,markerType:["cim:vector","custom"],keepChoice:!0,parts:{size:{autoSizeAdjust:!1},color:i&&s,transparency:i&&s}},fill:i&&{type:"color",optional:!0,suggestedColors:this.suggestedFillColors,savedColors:this.savedColors,open:!1,suggestedColorsOpen:!0},stroke:i&&{optional:!0,open:!1,type:"color",suggestedColors:this.suggestedFillColors,savedColors:this.savedColors}},marker:{size:i?o.cimSymbolUtils.getCIMSymbolSize(this.currentSketchInfo.symbol):"picture-marker"===this.currentSketchInfo.symbol.type?this.currentSketchInfo.symbol.width:25},fill:{color:i&&o.cimSymbolUtils.getCIMSymbolColor(this.currentSketchInfo.symbol)||this.suggestedFillColors[0]},stroke:i&&this.getCimOutlineProps(this.currentSketchInfo.symbol),fillEnabled:i,strokeEnabled:i,portal:this.createPortalProp()})}startPolylineEdit(){var e,t,o,i,s,l;const n="cim"===this.currentSketchInfo.symbol.type,r=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1;null===(t=this.polylineStyler)||void 0===t||t.edit(this.currentSketchInfo.symbol.clone(),{sections:{stroke:{type:"color",open:!0,suggestedColorsOpen:!0,suggestedColors:this.suggestedFillColors,extraParts:{width:!0,autoStrokeAdjust:!1}},marker:{parts:{size:{autoSizeAdjust:!1},color:n&&r,transparency:n&&r}}},stroke:{color:(null===(o=this.currentSketchInfo.symbol)||void 0===o?void 0:o.color)||this.savedColors[1],size:(null===(i=this.currentSketchInfo.symbol)||void 0===i?void 0:i.width)||10,style:(null===(s=this.currentSketchInfo.symbol)||void 0===s?void 0:s.style)||"solid",marker:null===(l=this.currentSketchInfo.symbol)||void 0===l?void 0:l.marker},portal:this.createPortalProp()})}getCimOutlineProps(e){var t;const{modules:o}=this,i=v(e);return{color:new o.Color(null==i?void 0:i.color),size:null!==(t=null==i?void 0:i.width)&&void 0!==t?t:1}}startPolygonEdit(){var e,t,o,i,s,l;const n="cim"===this.currentSketchInfo.symbol.type,r=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1,a=this.currentSketchInfo.graphics&&!this.currentSketchInfo.graphics.every((e=>(0,c.i)(I(e.symbol))));null===(t=this.polygonStyler)||void 0===t||t.edit(this.currentSketchInfo.symbol.clone(),{sections:{fill:{type:"color",open:!0,optional:!0,suggestedColorsOpen:!0,transparencyOpen:!1,suggestedColors:this.suggestedFillColors},stroke:{type:"color",open:!1,optional:!0,suggestedColorsOpen:!0,suggestedColors:this.suggestedFillColors,extraParts:{width:!a,autoStrokeAdjust:!1}},marker:{parts:{size:{autoSizeAdjust:!1},color:n&&r,transparency:n&&r}}},fill:{color:this.currentSketchInfo.symbol.color||this.suggestedFillColors[0]},stroke:{color:(null===(o=this.currentSketchInfo.symbol.outline)||void 0===o?void 0:o.color)||this.suggestedFillColors[0],size:(null===(i=this.currentSketchInfo.symbol.outline)||void 0===i?void 0:i.width)||10,style:(null===(s=this.currentSketchInfo.symbol.outline)||void 0===s?void 0:s.style)||"solid",autoAdjusted:!1},fillEnabled:!!this.currentSketchInfo.symbol.color,strokeEnabled:!!(null===(l=this.currentSketchInfo.symbol)||void 0===l?void 0:l.outline),portal:this.createPortalProp()})}async openFontPopover(){var e;this.arcgisFontPickerEl||(this.disableSketchPanel.emit(!0),this.arcgisFontPickerEl=document.createElement("arcgis-font-picker"),this.arcgisFontPickerEl.view=this.mapView,this.arcgisFontPickerEl.enableMapSpecificFontList=!0,this.arcgisFontPickerEl.fontMap=await(0,u.g)(this.portal),this.arcgisFontPickerEl.font=null===(e=this.currentSketchInfo.symbol)||void 0===e?void 0:e.font,this.arcgisFontPickerEl.popoverProps={refElement:this.hostElement},this.arcgisFontPickerEl.addEventListener("arcgisFontPickerDismissed",(()=>this.closeFontPopover())),this.arcgisFontPickerEl.addEventListener("arcgisFontPickerChange",(e=>this.changeFont(e))),document.body.appendChild(this.arcgisFontPickerEl))}closeFontPopover(){this.arcgisFontPickerEl&&(this.disableSketchPanel.emit(!1),document.body.removeChild(this.arcgisFontPickerEl),this.arcgisFontPickerEl=void 0)}changeFont(e){var t;const o=e.detail;if(o){const e=null===(t=this.currentSketchInfo.symbol)||void 0===t?void 0:t.clone();e.font.family=o.family,e.font.weight=o.weight,e.font.style=o.style,this.updateSymbol(e,!1,!1,"font"),(0,i.f)(this.hostElement)}}handleTextRotationSliderValueChange(e,t){var o;const i=null===(o=this.currentSketchInfo.symbol)||void 0===o?void 0:o.clone();i.angle=e,this.updateSymbol(i,!1,!1,"rotation",t)}handleTextPropChange(e,t){var o;if(!e)return;let s=parseInt(e.value);isNaN(s)||s<e.min?s=e.min:s>e.max&&(s=e.max),e.value=`${s}`;const l=null===(o=this.currentSketchInfo.symbol)||void 0===o?void 0:o.clone();switch(t){case"font-size":l.font.size=.75*s;break;case"halo-size":l.haloSize=.75*s;break;case"rotation":l.angle=s;break;default:l.borderLineSize=.75*s}this.updateSymbol(l,!1,!1,t,!1,"rotation"!==t),(0,i.f)(this.hostElement)}updateSymbol(e,t,o,i,s,l){var n;const{strings:a}=this,h=this.currentSketchInfo.symbol.clone(),d=e.clone(),p=C(this.currentSketchInfo.symbol)!==C(e);if(this.currentSketchInfo.symbol=e.clone(),"recent-text"===i&&(this.currentSketchInfo.symbol.text=h.text),this.sketchGraphicUpdates.emit({type:"symbol",symbolSwitch:t,symbolSwitchFromRecent:o,textProp:i}),s)this.arcgisSketchActiveSymbolChange.emit();else if((!p||t||o)&&!l){"text"===d.type&&(d.text=a.textPreview);const e=null===(n=this.recentSymbols)||void 0===n?void 0:n.filter((e=>JSON.stringify(e)!==JSON.stringify(d))),t=(0,c.i)(e)?[d,...e].slice(0,5):[d],o=this.currentSketchInfo.tool?["circle","rectangle"].indexOf(this.currentSketchInfo.tool)>-1?"arcgis-sketch-recent-polygon-symbols":`arcgis-sketch-recent-${this.currentSketchInfo.tool}-symbols`:"arcgis-sketch-recent-point-symbols";(0,r.s)(o,t,!0),this.recentSymbols=t,this.arcgisSketchActiveSymbolChange.emit()}}addResetTooltip(){const{strings:e}=this,t=document.createElement("calcite-tooltip");t.className="sketch-layer-editor-content-tooltip",t.referenceElement=this.resetRecentSymbolsNode,t.placement="left-start",t.open=!0,t.innerHTML=e.clearRecentSymbols,document.body.append(t)}removeResetTooltip(){document.querySelectorAll(".sketch-layer-editor-content-tooltip").forEach((e=>{var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}))}get hostElement(){return(0,i.d)(this)}};z.style=".style-info-wrapper{background-color:var(--arcgis-app-background)}.style-info-block{padding:var(--calcite-spacing-md) var(--calcite-spacing-md) var(--calcite-spacing-xxs)}.style-title{font-weight:var(--calcite-font-weight-medium)}.text-content{margin:12px}.rotation{display:flex;align-items:center;justify-content:space-between;position:relative}.rotation calcite-slider{width:50%}.rotation calcite-input-number{width:45%;font-size:var(--arcgis-app-font-size-0);font-family:var(--arcgis-app-font-family)}.sketch-popup-button{margin-bottom:0.4em}.recent-symbols-wrapper{background-color:var(--arcgis-app-background);border:1px solid var(--calcite-color-border-1);display:flex;align-items:center;justify-content:space-evenly}.recent-symbols-symbol-group{display:flex;flex-direction:row;padding:8px 0px;justify-content:space-evenly;width:100%}.recent-symbol{height:32px;display:flex;align-items:center;cursor:pointer}.recent-symbol:focus{outline:2px solid var(--calcite-ui-brand);outline-offset:2px}.recent-symbols-divider-wrapper{background-color:var(--arcgis-app-border-hover)}.recent-symbols-divider{margin-block:0.25rem;display:inline-block;inline-size:1px}.recent-symbols-reset-button-wrapper{display:flex;padding:8px 0px;justify-content:space-evenly;width:48px}.no-recent-symbols{min-height:32px;display:flex;align-items:center;padding:8px}.clear-recent-button{padding-top:8px;margin:auto}.symbol-styler{padding:0px 1px}.halo-block,.background-color-block{padding-top:6px}";const U=class{constructor(e){(0,i.r)(this,e),this.arcgisSketchLayerEditorShortcutsDismissedChange=(0,i.c)(this,"arcgisSketchLayerEditorShortcutsDismissedChange",7),this.refElement=void 0,this.isOpen=!1}async reposition(){var e;null===(e=this.sketchLayerEditorShortcutsPopover)||void 0===e||e.reposition()}componentWillLoad(){this.strings=O.strings}componentDidLoad(){this.isOpen=!0}render(){const{strings:e}=this,t="rtl"===(0,l.g)(this.hostElement)?"trailing-start":"leading-start";return(0,i.h)(i.H,{key:"74e71567e6663a45dd1bec2fcc074c0bbc1d7aab",class:"js-app-flyout"},(0,i.h)("calcite-popover",{key:"777269831d644c49c55867920b0d61ff88ad80d2",dir:(0,l.g)(this.hostElement),class:`popover ${"rtl"===(0,l.g)(this.hostElement)?l.C.rtl:""}`,ref:e=>this.sketchLayerEditorShortcutsPopover=e,placement:t,open:this.isOpen,pointerDisabled:!0,referenceElement:this.refElement,offsetDistance:-Math.round(this.refElement.getBoundingClientRect().width),offsetSkidding:0,label:e.sketchShortcuts},(0,i.h)("calcite-panel",{key:"0488d1712f442e8283b95551d3c13817620c1b13",heading:e.sketchShortcuts,closable:!0,style:{width:`${Math.max(this.refElement.getBoundingClientRect().width,375)}px`},onCalcitePanelClose:()=>this.arcgisSketchLayerEditorShortcutsDismissedChange.emit()},(0,i.h)("div",{key:"522c0ef46f95aeb4a54e3206d3779ff539cc04ac",class:"sketch-shortcut"},(0,i.h)("calcite-chip",{key:"eaf5beffa073e319babeedab30a5f0044cff965d",label:"Ctrl",class:"sketch-shortcut-chip",value:"Ctrl"},"Ctrl"),(0,i.h)("calcite-label",{key:"f0b9f75638cc968c475559cbfa7f6bddb0e6690f",class:"sketch-shortcut-label"},e.ctrlShortcut),(0,i.h)("calcite-chip",{key:"f3f36aa2dd19a5ec3338a5d553f1377478b8a4bb",label:"Enter",class:"sketch-shortcut-chip",value:"Enter"},"Enter"),(0,i.h)("calcite-label",{key:"ab16732a80a1c130c83980e13074584963ca7825",class:"sketch-shortcut-label"},e.cShortcut),(0,i.h)("calcite-chip",{key:"329d3204d8e0c3c5c80c1437a41e40f34fdc22a8",label:"Z",class:"sketch-shortcut-chip",value:"Z"},"Z"),(0,i.h)("calcite-label",{key:"bd94f8a8ca0e40f921d144e347a78a6ffa52c57b",class:"sketch-shortcut-label"},e.zShortcut),(0,i.h)("calcite-chip",{key:"f8cb21985c7351b30b5874f9896352dacb484aa1",label:"R",class:"sketch-shortcut-chip",value:"R"},"R"),(0,i.h)("calcite-label",{key:"18e0a661c6c1d24a0475270a0a8e83710505d4e2",class:"sketch-shortcut-label"},e.rShortcut),(0,i.h)("calcite-chip",{key:"64404cf0f3858d68a96d04758547824551436fb2",label:"Esc",class:"sketch-shortcut-chip",value:"Esc"},"Esc"),(0,i.h)("calcite-label",{key:"29a312d5d4c3ed09793b094e86722e0eba7f9cd4",class:"sketch-shortcut-label"},e.escShortcut),(0,i.h)("calcite-chip",{key:"4fbaf3039b032b48de73499f3307b684751d040b",label:"Tab",class:"sketch-shortcut-chip",value:"Tab"},"Tab"),(0,i.h)("calcite-label",{key:"f8f017fb0fea34cb4f2abc858be2517debd155a6",class:"sketch-shortcut-label"},e.tabShortcut)))))}get hostElement(){return(0,i.d)(this)}};U.style=".sketch-shortcut{background-color:var(--arcgis-app-background);display:grid;grid-template-columns:21% auto;row-gap:var(--arcgis-app-cap-spacing-half);padding:var(--arcgis-app-cap-spacing-half)}.sketch-shortcut-chip{margin-right:var(--arcgis-app-cap-spacing-half)}.sketch-shortcut-label{align-self:center}.popover{z-index:100}.arcgis--rtl .sketch-shortcut{max-height:40vh}.arcgis--rtl .sketch-shortcut-chip{margin-left:var(--arcgis-app-cap-spacing-half);margin-right:0}";const R=class{constructor(e){(0,i.r)(this,e),this.closeSketchSnappingPopovers=(0,i.c)(this,"closeSketchSnappingPopovers",7),this.refElement=void 0}async reposition(){var e;null===(e=this.sketchLayerEditorSnappingPopover)||void 0===e||e.reposition()}async componentWillLoad(){this.strings=O.strings,this.snappingOptions=O.snappingOptions,this.snappingSessionStorageIds=O.snappingSessionStorageIds,this.sketchTooltipOptions=O.sketchTooltipOptions,this.sketchTooltipSessionStorageIds=O.sketchTooltipSessionStorageIds,await this.loadAllModules(),this.addSnappingWidget(),this.addTooltipsWidget()}componentDidLoad(){this.snappingControls.container=this.snappingControlDiv,this.sketchTooltipControls.container=this.sketchTooltipControlDiv}disconnectedCallback(){var e,t;null===(e=this.snappingControls)||void 0===e||e.destroy(),null===(t=this.sketchTooltipControls)||void 0===t||t.destroy()}render(){const{strings:e}=this;return(0,i.h)(i.H,{key:"ae7308e1f158db2769276a6825d2532ed506331a",class:"js-app-flyout"},(0,i.h)("calcite-popover",{key:"511e105022ad3d9f207bce10143e3e86c3f3b394",dir:(0,l.g)(this.hostElement),placement:"leading-start",ref:e=>this.sketchLayerEditorSnappingPopover=e,open:!0,pointerDisabled:!0,referenceElement:this.refElement,offsetDistance:-Math.round(this.refElement.getBoundingClientRect().width),offsetSkidding:0,label:e.settings,style:{zIndex:"100"}},(0,i.h)("calcite-panel",{key:"d62b7b8b9f9a0f75ceedd9ad46747ec591086c26",closable:!0,headingLevel:2,heading:e.settings,style:{width:`${this.refElement.getBoundingClientRect().width}px`},onCalcitePanelClose:()=>{var e,t;(null===(e=this.snappingSessionStorageIds)||void 0===e?void 0:e.current)&&b(this.snappingOptions,this.snappingSessionStorageIds.current),(null===(t=this.sketchTooltipSessionStorageIds)||void 0===t?void 0:t.current)&&V(this.sketchTooltipOptions,this.sketchTooltipSessionStorageIds.current),this.closeSketchSnappingPopovers.emit()}},(0,i.h)("div",{key:"dadafbdacf5d92c30c2a06fcec983d06f6993146",class:"content"},(0,i.h)("div",{key:"dca412b67366fc11f630baf3db67c4031dedb1a7",ref:e=>this.sketchTooltipControlDiv=e}),(0,i.h)("div",{key:"0e52eea998f4f04896fbe226f5143d293fa18844",ref:e=>this.snappingControlDiv=e})))))}async loadAllModules(){const[e,t]=await(0,n.l)(["esri/widgets/support/SnappingControls","esri/widgets/support/SketchTooltipControls"]);this.SnappingControls=e,this.SketchTooltipControls=t}addSnappingWidget(){const{mapView:e}=O;this.snappingControls=new this.SnappingControls({view:e,snappingOptions:O.snappingOptions,visibleElements:{header:!1}})}addTooltipsWidget(){const{mapView:e}=O;this.sketchTooltipControls=new this.SketchTooltipControls({view:e,tooltipOptions:O.sketchTooltipOptions,visibleElements:{tooltipsToggle:!0,labelsToggle:!1}}),this.sketchTooltipControls.sketchOptions.tooltips=O.sketchTooltipOptions}get hostElement(){return(0,i.d)(this)}};R.style=".content{max-height:60vh}.content .esri-grid-controls__tile__content{padding:var(--calcite-spacing-sm)}";const N=class{constructor(e){(0,i.r)(this,e),this.sketchActionOnDrawFeatures=(0,i.c)(this,"sketchActionOnDrawFeatures",7),this.sketchActionOnSelectFeatures=(0,i.c)(this,"sketchActionOnSelectFeatures",7),this.refElement=void 0,this.mapNotesFeatures=null,this.sketchToolsToHide=[],this.activeSketchTool=void 0,this.hideSelectionTools=!1,this.activeSelectTool=void 0,this.isOpen=!1}async reposition(){var e;null===(e=this.sketchToolsPopoverElement)||void 0===e||e.reposition()}componentWillLoad(){this.strings=O.strings,this.sketchLayerEditorSVModel=O.sketchLayerEditorSVModel,this.isOpen=!0}componentDidLoad(){var e;const{strings:t}=this;if(null===(e=this.mapNotesFeatures)||void 0===e?void 0:e.length){let e=[],o=[],i=[],s=[];this.mapNotesFeatures.forEach((t=>{switch(m(t)){case"polyline":o=[...o,t];break;case"polygon":i=[...i,t];break;case"text":s=[...s,t];break;default:e=[...e,t]}})),this.activeSelectTool&&("select"===this.activeSelectTool?this.actionOnSelectFeatures(t.selectText,this.sketchSelectElement):this.actionOnSelectFeatures(t.rectangleLassoSelect,this.sketchRectangleSelectElement,"rectangle")),e.length&&this.sketchLayerEditorSVModel.updatePoint(e),o.length&&this.sketchLayerEditorSVModel.updateLine(o),i.length&&this.sketchLayerEditorSVModel.updatePolygon(i),s.length&&this.sketchLayerEditorSVModel.updateText(s)}else{const e={point:this.sketchPointElement,polygon:this.sketchPolygonElement,polyline:this.sketchPolyLineElement,circle:this.sketchCircleElement,rectangle:this.sketchRectangleElement,text:this.sketchTextElement};let o,i;if(this.activeSketchTool)o=this.activeSketchTool,i=e[o];else{let t=["point","polyline","polygon","rectangle","circle","text"];t=t.filter((e=>!this.sketchToolsToHide.includes(e))),o=t.length?t[0]:"point",i=e[o]}this.actionOnDrawFeatures(o,t.addStamp,i)}}render(){const{strings:e}=this;return(0,i.h)(i.H,{key:"87b3f91cc6f62884b6df1ce7cb20f66b177f3826",class:"js-app-flyout"},(0,i.h)("calcite-popover",{key:"68fa5f334fb21a56d5f542fd8b21706a79137e7e",dir:(0,l.g)(this.hostElement),ref:e=>this.sketchToolsPopoverElement=e,placement:"leading-start",open:this.isOpen,referenceElement:this.refElement,offsetDistance:15,pointerDisabled:!0,focusTrapDisabled:!0,triggerDisabled:!0,label:e.sketch,class:"popover",onCalcitePopoverBeforeClose:()=>this.sketchToolsPopoverElement.open=!0},(0,i.h)("calcite-action-pad",{key:"eb59406b9179e6093084e6ae9843c640199b5bf2",position:"start",layout:"vertical",expandDisabled:!0},this.renderDrawFeatures(),!this.hideSelectionTools&&this.renderSelectFeatures())))}renderDrawFeatures(){const{strings:e,sketchToolsToHide:t}=this;return(0,i.h)("calcite-action-group",{label:e.drawFeatures},!t.includes("point")&&(0,i.h)("calcite-action",{ref:e=>this.sketchPointElement=e,text:e.stamp,label:e.stamp,title:e.stamp,icon:"pin",alignment:"center",onClick:()=>this.actionOnDrawFeatures("point",e.addStamp,this.sketchPointElement)}),!t.includes("polyline")&&(0,i.h)("calcite-action",{ref:e=>this.sketchPolyLineElement=e,text:e.line,label:e.line,title:e.line,icon:"line",alignment:"center",onClick:()=>this.actionOnDrawFeatures("polyline",e.startFinishDrawing,this.sketchPolyLineElement)}),!t.includes("polygon")&&(0,i.h)("calcite-action",{ref:e=>this.sketchPolygonElement=e,text:e.polygon,label:e.polygon,title:e.polygon,icon:"polygon",alignment:"center",onClick:()=>this.actionOnDrawFeatures("polygon",e.startFinishDrawing,this.sketchPolygonElement)}),!t.includes("rectangle")&&(0,i.h)("calcite-action",{ref:e=>this.sketchRectangleElement=e,text:e.rectangle,label:e.rectangle,title:e.rectangle,icon:"rectangle",alignment:"center",onClick:()=>this.actionOnDrawFeatures("rectangle",e.addRectangle,this.sketchRectangleElement)}),!t.includes("circle")&&(0,i.h)("calcite-action",{ref:e=>this.sketchCircleElement=e,text:e.circle,label:e.circle,title:e.circle,icon:"circle",alignment:"center",onClick:()=>this.actionOnDrawFeatures("circle",e.addCircle,this.sketchCircleElement)}),!t.includes("text")&&(0,i.h)("calcite-action",{ref:e=>this.sketchTextElement=e,text:e.text,label:e.text,title:e.text,icon:"text",alignment:"center",onClick:async()=>this.actionOnDrawFeatures("text",e.addText,this.sketchTextElement)}))}renderSelectFeatures(){const{strings:e}=this;return(0,i.h)("calcite-action-group",{label:e.selectFeatures},(0,i.h)("calcite-action",{ref:e=>this.sketchSelectElement=e,text:e.select,label:e.select,title:e.select,icon:"cursor",alignment:"center",onClick:()=>this.actionOnSelectFeatures(e.selectText,this.sketchSelectElement)}),(0,i.h)("calcite-action",{ref:e=>this.sketchRectangleSelectElement=e,text:e.rectangleSelect,label:e.rectangleSelect,title:e.rectangleSelect,icon:"cursor-marquee",alignment:"center",onClick:()=>this.actionOnSelectFeatures(e.rectangleLassoSelect,this.sketchRectangleSelectElement,"rectangle")}),(0,i.h)("calcite-action",{ref:e=>this.sketchLassoSelectElement=e,text:e.lassoSelect,label:e.lassoSelect,title:e.lassoSelect,icon:"lasso",alignment:"center",onClick:()=>this.actionOnSelectFeatures(e.rectangleLassoSelect,this.sketchLassoSelectElement,"lasso")}))}actionOnDrawFeatures(e,t,o){this.clearActiveSelection(),this.activeSelectTool=null,o.active=!0,this.sketchActionOnDrawFeatures.emit({tool:e,sketchMessage:t})}actionOnSelectFeatures(e,t,o){const{active:i=!1}=t;this.clearActiveSelection(),t.active=!i,this.activeSelectTool=t.active?null!=o?o:"select":null,this.sketchLayerEditorSVModel.cancel(),this.sketchActionOnSelectFeatures.emit({sketchMessage:i?"":e,multipleSelectTool:!i&&o||null})}clearActiveSelection(){[this.sketchPointElement,this.sketchPolyLineElement,this.sketchPolygonElement,this.sketchRectangleElement,this.sketchCircleElement,this.sketchTextElement,this.sketchSelectElement,this.sketchRectangleSelectElement,this.sketchLassoSelectElement].forEach((e=>{e&&(e.active=!1)}))}get hostElement(){return(0,i.d)(this)}};N.style=".popover{z-index:100}"},91616:(e,t,o)=>{o.d(t,{a:()=>a,b:()=>p,c:()=>s,d:()=>i,e:()=>l,f:()=>h,g:()=>g,h:()=>u,i:()=>n,m:()=>r,t:()=>c,u:()=>d});const i=(e,t)=>{let o,i="idle";const s=(...s)=>new Promise((l=>{switch(i){case"flushed":i="idle",o?(clearTimeout(o),l(e(...s))):l(null);break;case"invoked":clearTimeout(o),i="idle",l(e(...s));break;case"cancelled":clearTimeout(o),i="idle",l(null);break;default:o&&clearTimeout(o),i="pending",o=setTimeout((()=>(i="idle",l(e(...s)))),t)}}));return s.flush=function(...e){return i="flushed",s(...e)},s.invoke=function(...e){return i="invoked",s(...e)},s.cancel=function(...e){return i="cancelled",s(...e)},s.getStatus=function(){return i},s},s=(e,t)=>{let o;return(...i)=>new Promise((s=>{o||(o=setTimeout((()=>{clearTimeout(o),o=void 0,s(e(...i))}),t))}))};function l(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function n(e){return null!=e}async function r(e,t){return await Promise.all([e,c(t)]),e}function c(e){return new Promise((t=>setTimeout(t,e)))}const a=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:o,data:i}=t(e);return[o,i]}))),h=(e,t)=>e.length===t.length&&e.reduce(((e,o)=>e&&t.indexOf(o)>-1),!0);function d(e,t){const o=[],i={};return e.forEach((e=>{const s=t(e);null==i[s]&&(i[s]=e,o.push(e))})),o}function p(e){const t={boolean:{},number:{},string:{}},o=[];return e.filter((e=>{let i=typeof e;return i in t?!t[i].hasOwnProperty(e)&&(t[i][e]=!0):!(o.indexOf(e)>=0)&&o.push(e)}))}const u=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((o,i)=>e.slice(t*i,t+t*i))),g=(e,t)=>e.includes(t)},10699:(e,t,o)=>{o.d(t,{c:()=>c});var i=o(20536);const s=e=>!("isConnected"in e)||e.isConnected,l=((e,t)=>{let o;return(...i)=>{o&&clearTimeout(o),o=setTimeout((()=>{o=0,e(...i)}),t)}})((e=>{for(let t of e.keys())e.set(t,e.get(t).filter(s))}),2e3),n=e=>"function"==typeof e?e():e,r=(e,t)=>{const o=e.indexOf(t);o>=0&&(e[o]=e[e.length-1],e.length--)},c=(e,t)=>{const o=((e,t=(e,t)=>e!==t)=>{const o=n(e);let i=new Map(Object.entries(null!=o?o:{}));const s={dispose:[],get:[],set:[],reset:[]},l=()=>{var t;i=new Map(Object.entries(null!==(t=n(e))&&void 0!==t?t:{})),s.reset.forEach((e=>e()))},c=e=>(s.get.forEach((t=>t(e))),i.get(e)),a=(e,o)=>{const l=i.get(e);t(o,l,e)&&(i.set(e,o),s.set.forEach((t=>t(e,o,l))))},h="undefined"==typeof Proxy?{}:new Proxy(o,{get:(e,t)=>c(t),ownKeys:e=>Array.from(i.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>i.has(t),set:(e,t,o)=>(a(t,o),!0)}),d=(e,t)=>(s[e].push(t),()=>{r(s[e],t)});return{state:h,get:c,set:a,on:d,onChange:(t,o)=>{const i=d("set",((e,i)=>{e===t&&o(i)})),s=d("reset",(()=>o(n(e)[t])));return()=>{i(),s()}},use:(...e)=>{const t=e.reduce(((e,t)=>(t.set&&e.push(d("set",t.set)),t.get&&e.push(d("get",t.get)),t.reset&&e.push(d("reset",t.reset)),t.dispose&&e.push(d("dispose",t.dispose)),e)),[]);return()=>t.forEach((e=>e()))},dispose:()=>{s.dispose.forEach((e=>e())),l()},reset:l,forceUpdate:e=>{const t=i.get(e);s.set.forEach((o=>o(e,t,t)))}}})(e,t);return o.use((()=>{if("function"!=typeof i.a)return{};const e=new Map;return{dispose:()=>e.clear(),get:t=>{const o=(0,i.a)();o&&((e,t,o)=>{const i=e.get(t);i?i.includes(o)||i.push(o):e.set(t,[o])})(e,t,o)},set:t=>{const o=e.get(t);o&&e.set(t,o.filter(i.f)),l(e)},reset:()=>{e.forEach((e=>e.forEach(i.f))),l(e)}}})()),o}},58151:(e,t,o)=>{o.d(t,{a:()=>h,b:()=>a,c:()=>d,d:()=>l,e:()=>s,g:()=>r,r:()=>c,s:()=>n,u:()=>p});var i=o(91616);function s(e,t,o,i){!function(e,t,o){o=o||{};let i=null==o?void 0:o.expires;if("number"==typeof i){const e=new Date,t=24*i*60*60*1e3;e.setTime(Date.now()+t),i=o.expires=e}"string"!=typeof i&&(null==i?void 0:i.toUTCString)&&(o.expires=i.toUTCString());let s,l=`${e}=${encodeURIComponent(t)}`;for(s in o){l+=`; ${s}`;const e=o[s];!0!==e&&(l+=`=${e}`)}document.cookie=l}(e,i?JSON.stringify(t):t,o)}function l(e,t){const o=function(e){const t=document.cookie,o=new RegExp(`(?:^|; )${(0,i.e)(e)}=([^;]*)`),s=t.match(o);return s?decodeURIComponent(s[1]):void 0}(e);return o&&t?JSON.parse(o):o}function n(e,t,o){window.localStorage.setItem(e,o?JSON.stringify(t):t)}function r(e,t){const o=window.localStorage.getItem(e);return o&&t?JSON.parse(o):o}function c(e){window.localStorage.removeItem(e)}function a(e,t,o){window.sessionStorage.setItem(e,o?JSON.stringify(t):t)}function h(e,t){const o=window.sessionStorage.getItem(e);return o&&t?JSON.parse(o):o}function d(e){window.sessionStorage.removeItem(e)}function p(e,t,o){const i=new Date(t);i.setFullYear(t.getFullYear()+1),s(e,o,{expires:i}),o?n(e,"true",!1):c(e)}},6589:(e,t,o)=>{o.d(t,{a:()=>r,b:()=>h,c:()=>a,d:()=>c,e:()=>l,f:()=>u,g:()=>s,h:()=>p,i:()=>n,j:()=>d});var i=o(98034);function s(e){return"cim"===e.type?"CIMLineSymbol"===e.data.symbol.type?"line":"CIMPolygonSymbol"===e.data.symbol.type?"polygon":"point":"simple-marker"===e.type||"picture-marker"===e.type?"point":"simple-line"===e.type?"line":"polygon"}const l={loaded:!1,async load(){if(this.loaded)return;const[e,t,o,s,l,n,r,c,a,h,d,p,u,g,y,m,S]=await(0,i.l)(["esri/core/screenUtils","esri/Color","esri/portal/Portal","esri/symbols/CIMSymbol","esri/symbols/WebStyleSymbol","esri/core/devEnvironmentUtils","esri/core/promiseUtils","esri/core/urlUtils","esri/portal/PortalItem","esri/symbols/support/previewSymbol2D","esri/symbols/support/gfxUtils","esri/symbols/support/jsonUtils","esri/symbols/support/styleUtils","esri/symbols/support/svgUtils","esri/symbols/support/symbolUtils","esri/symbols/support/cimSymbolUtils","esri/symbols/support/webStyleSymbolUtils"]);this.Color=t,this.Portal=o,this.CIMSymbol=s,this.WebStyleSymbol=l,this.devEnvironmentUtils=n,this.previewSymbol2D=h,this.promiseUtils=r,this.urlUtils=c,this.PortalItem=a,this.gfxUtils=d,this.jsonUtils=p,this.screenUtils=e,this.styleUtils=u,this.svgUtils=g,this.symbolUtils=y,this.cimSymbolUtils=m,this.webStyleSymbolUtils=S,this.loaded=!0}};function n(e){return"cim"===(null==e?void 0:e.type)}function r(e){return"simple-marker"===(null==e?void 0:e.type)}function c(e){return"picture-marker"===(null==e?void 0:e.type)}function a(e){return"simple-line"===(null==e?void 0:e.type)}function h(e){return"simple-fill"===(null==e?void 0:e.type)}function d(e){return"CIMPointSymbol"===e.data.symbol.type}function p(e){return"CIMLineSymbol"===e.data.symbol.type}function u(e){return"CIMPolygonSymbol"===e.data.symbol.type}}}]);