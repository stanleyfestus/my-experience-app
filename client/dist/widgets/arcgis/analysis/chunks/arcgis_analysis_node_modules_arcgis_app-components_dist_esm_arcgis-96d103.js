/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-96d103.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-96d103"],{93718:(e,t,i)=>{i.r(t),i.d(t,{arcgis_categories_picker:()=>f,arcgis_folder_picker:()=>w,arcgis_item_properties:()=>y,arcgis_summary_input:()=>x,arcgis_tags_picker:()=>k,arcgis_title_input:()=>E});var s=i(20536),r=i(86980),o=i(29259),a=i(44090),l=i(91616),n=i(37568),c=i(76776),d=i(30554),h=i(68537),u=i(7078),g=i(67914),v=i(81341),m=i(38973),p=i(25972),b=i(90230);i(59377),i(10699),i(91102),i(73807),i(34752),i(98034),i(99004),i(78231),i(369),i(1391),i(19832),i(34472);const f=class{constructor(e){(0,s.r)(this,e),this.arcgisCategoriesPickerChange=(0,s.c)(this,"arcgisCategoriesPickerChange",7),this.renderCombobox=()=>{const{i18n:e,scale:t,schema:i,label:r}=this;return(0,s.h)("calcite-combobox",{label:null!=r?r:e.categories,maxItems:5,selectionMode:"ancestors",placeholder:e.assignCategories,scale:t,ref:e=>this.combobox=e},this.renderNestedCategories(i))},this.api=void 0,this.portal=void 0,this.scale=void 0,this.label=void 0,this.hideLabel=void 0,this.categories=void 0,this.schema=[],this.rootCategoryPath=o.U}async componentWillLoad(){var e,t,i,s;const r=await(0,n.g)(this.el);this.i18n=r[0],null!==(e=this.portal)&&void 0!==e||(this.portal=a.c.portal),null!==(t=this.scale)&&void 0!==t||(this.scale=a.c.scale),null!==(i=this.api)&&void 0!==i||(this.api=a.c.api),null!==(s=this.categories)&&void 0!==s||(this.categories=c.i.categories),c.a.on("reset",(()=>{this.categories=c.i.categories}))}async componentDidLoad(){var e,t,i;const{portal:s,schema:a}=this;if(s&&!(null==a?void 0:a.length))if(s.categories)this.schema=null===(e=s.categories[0])||void 0===e?void 0:e.categories;else{const e=await(0,r.f)(s);this.schema=null===(i=null===(t=e.categorySchema)||void 0===t?void 0:t[0])||void 0===i?void 0:i.categories,this.rootCategoryPath=(0,o.g)(e.categorySchema)}}updateCategories(){this.arcgisCategoriesPickerChange.emit(this.categories)}categoriesPickerChangeHandler(e){var t;e.stopPropagation();const i=(null===(t=this.combobox)||void 0===t?void 0:t.value)||[],s=Array.isArray(i)?i:[i];(0,l.f)(s,this.categories)||(this.categories=s)}renderNestedCategories(e,t){return e.map((e=>{const i=t?`${t}/${e.title}`:`${this.rootCategoryPath}/${e.title}`;return(0,s.h)("calcite-combobox-item",{value:i,textLabel:e.title,selected:this.categories.some((e=>e===i||e.toLocaleLowerCase()===i.toLocaleLowerCase()))},e.categories&&this.renderNestedCategories(e.categories,i))}))}render(){const{i18n:e,scale:t,schema:i,hideLabel:r,label:o,renderCombobox:a}=this;return r?a():!!i&&(0,s.h)("calcite-label",{scale:t},(0,s.h)("p",{class:"label"},null!=o?o:e.categories),a())}get el(){return(0,s.d)(this)}static get watchers(){return{categories:["updateCategories"]}}};f.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}";const w=class{constructor(e){(0,s.r)(this,e),this.arcgisFolderPickerChange=(0,s.c)(this,"arcgisFolderPickerChange",7),this.arcgisFolderPickerLoad=(0,s.c)(this,"arcgisFolderPickerLoad",7),this.canCreateNewFolder=!1,this.capComboboxTagWidth=()=>{var e,t;const{comboboxElement:i,overlayPositioning:s}=this;if("fixed"!==s)return;const r=null!==(e=null==i?void 0:i.offsetWidth)&&void 0!==e?e:0,o=null===(t=i.shadowRoot)||void 0===t?void 0:t.querySelector(".list-container");o&&(o.style.maxWidth=`${r}px`)},this.isTitleValid=e=>{var t;const i=(0,u.g)(e,this.folders);if(i){const s=null!==(t=this.i18n.error[i.error])&&void 0!==t?t:this.newItemI18n.cloud.error.generic.message;return this.errorString="invalidCharacters"===i.error?s.replace("${invalidCharacters}",i.invalidCharacters.join(", ")):s.replace("${folder}",e),this.showError=!0,!1}return!0},this.renderItem=e=>{const{id:t,username:i,title:r}=e,{selectedFolder:o}=this,a=t===(null==o?void 0:o.id),l=(0,u.a)({folderId:t,currentUsername:i,selectedFolderId:null==o?void 0:o.id});return this.alwaysOpen?(0,s.h)("calcite-list-item",{key:t,value:t,selected:a,class:"list-item",label:r},(0,s.h)("calcite-icon",{slot:"content-start",scale:"s",icon:l})):(0,s.h)("calcite-combobox-item",{key:t,"data-id":t,value:t,textLabel:r,selected:a,icon:l})},this.api=void 0,this.portal=void 0,this.user=void 0,this.scale=void 0,this.label=void 0,this.folder=void 0,this.folders=[],this.alwaysOpen=void 0,this.disabled=!1,this.overlayPositioning=void 0,this.disallowFolderCreation=!1,this.selectedFolder=void 0,this.newFolderActive=!1,this.emptyFilterList=!1,this.filterText=void 0,this.newFolderInput=void 0,this.createFolderText=void 0,this.showError=!1,this.errorString=void 0,this.newFolderInputElement=void 0,this.loading=!1,this.homeFolder=void 0}async componentWillLoad(){var e,t,i,s,r,o,l,d,u,g,v,m,p;const[b,f]=await Promise.all([(0,n.g)(this.el),(0,n.g)(this.el,"arcgis-new-item")]);this.i18n=b[0],this.newItemI18n=f[0],null!==(e=this.portal)&&void 0!==e||(this.portal=a.c.portal),null!==(t=this.user)&&void 0!==t||(this.user=a.c.user),null!==(i=this.scale)&&void 0!==i||(this.scale=a.c.scale),null!==(s=this.api)&&void 0!==s||(this.api=a.c.api);const w=null===(r=this.folder)||void 0===r?void 0:r.id;null!==(o=this.selectedFolder)&&void 0!==o||(this.selectedFolder=null!==(u=null!==(d=null!==(l=this.folders.find((e=>e.id===w)))&&void 0!==l?l:c.i.folder)&&void 0!==d?d:a.c.initialFolder)&&void 0!==u?u:null===(g=this.folders)||void 0===g?void 0:g[0]),this.createFolderText=this.i18n.createNewFolder,this.canCreateNewFolder=!this.disallowFolderCreation&&((0,h.d)(null===(v=this.portal)||void 0===v?void 0:v.user)||this.user&&(null===(m=this.portal)||void 0===m?void 0:m.user.username)===(null===(p=this.user)||void 0===p?void 0:p.username)),c.a.on("reset",(()=>{var e,t,i;this.selectedFolder=null!==(t=null!==(e=c.i.folder)&&void 0!==e?e:a.c.initialFolder)&&void 0!==t?t:null===(i=this.folders)||void 0===i?void 0:i[0]}))}async componentDidLoad(){this.folders.length||await this.loadFolders(this.user),this.capComboboxTagWidth()}async handleUserChange(e,t){t&&e.username!==t.username&&(await this.loadFolders(e),this.selectedFolder=this.getHomeFolder())}handleFolderChange(){this.arcgisFolderPickerChange.emit(this.selectedFolder),this.folder=this.selectedFolder}async loadFolders(e){var t,i,s,r;this.loading=!0,this.folders=await(0,d.a)(e),this.arcgisFolderPickerLoad.emit([...this.folders]);const o=null!==(i=null===(t=this.selectedFolder)||void 0===t?void 0:t.id)&&void 0!==i?i:null===(s=this.folder)||void 0===s?void 0:s.id;this.selectedFolder=null!==(r=this.folders.find((e=>e.id===o)))&&void 0!==r?r:this.getHomeFolder(),this.loading=!1}getHomeFolder(){return this.folders.find((e=>e.title===e.id))}setNewFolderActive(){var e;null===(e=this.newFolderInputElement)||void 0===e||e.setFocus(),this.newFolderInputElement||(this.showError=!1,this.newFolderInput="")}checkForEmptySuggestions(e){var t,i;e.stopPropagation();const s=this.comboboxElement.shadowRoot.querySelector("input").value,{i18n:r}=this;this.emptyFilterList=(null===(t=this.comboboxElement.filteredItems)||void 0===t?void 0:t.length)<=1&&""!==s.trim(),this.createFolderText=this.emptyFilterList?r.noFoldersFoundCreate.replace("${folder}",s):r.createNewFolder,this.filterText=s,null===(i=this.createItem)||void 0===i||i.removeAttribute("hidden")}handleComboboxChange(e){var t,i,s;e.stopPropagation();const r=null===(t=this.comboboxElement)||void 0===t?void 0:t.value;if("create-folder"===r)return this.showError=!1,void(this.emptyFilterList?this.createNewFolder(this.filterText):this.newFolderActive=!0);this.selectedFolder=null!==(s=null!==(i=this.folders.find((e=>e.id===r)))&&void 0!==i?i:this.selectedFolder)&&void 0!==s?s:this.homeFolder}handleListChange(e){var t,i,s,r,o;e.stopPropagation();const a=null===(s=null===(i=null===(t=this.listElement)||void 0===t?void 0:t.selectedItems)||void 0===i?void 0:i[0])||void 0===s?void 0:s.value;this.selectedFolder=null!==(o=null!==(r=this.folders.find((e=>e.id===a)))&&void 0!==r?r:this.selectedFolder)&&void 0!==o?o:this.homeFolder}closeNewFolderInput(e){e.stopPropagation(),this.newFolderActive=!1}async saveActiveFolder(){if(!this.newFolderActive)return!0;try{await this.createNewFolder(this.newFolderInput)}catch(e){return this.errorString}return!this.showError}async setFocus(){this.comboboxElement&&(this.comboboxElement.setFocus(),this.comboboxElement.open=!0)}async createNewFolder(e){var t,i;const s=(null==e?void 0:e.trim())||"";if(!this.isTitleValid(s))throw new Error;try{const{result:e}=await(0,d.c)(s,this.user);this.selectedFolder=null==e?void 0:e.folder,this.folders=[this.selectedFolder,...this.folders],a.c.folders=this.folders,this.newFolderActive=!1,this.showError=!1,await(0,l.t)(100);const r=null===(t=this.el.shadowRoot)||void 0===t?void 0:t.querySelector(`calcite-combobox-item[data-id="${null===(i=this.selectedFolder)||void 0===i?void 0:i.id}"]`);r&&(this.createItem&&(this.createItem.selected=!1),r.selected=!0)}catch(e){throw this.errorString=e.message,this.showError=!0,e}}renderError(){const{scale:e}=this;return(0,s.h)("calcite-input-message",{status:"invalid",hidden:!this.showError,icon:this.showError,scale:e},this.errorString)}renderNewFolder(){const{i18n:e,scale:t}=this;return(0,s.h)("calcite-inline-editable",{controls:!0,"editing-enabled":!0,afterConfirm:async()=>{var e;try{await this.createNewFolder(this.newFolderInput),this.newFolderActive=!1}catch(t){throw null===(e=this.newFolderInputElement)||void 0===e||e.setFocus(),t}},scale:t},(0,s.h)("label",{slot:"label",htmlFor:"folderNameInput"},e.enterFolder),(0,s.h)("calcite-input",{id:"folderNameInput",placeholder:e.enterFolder,value:this.newFolderInput,maxLength:250,scale:t,onCalciteInputInput:e=>this.newFolderInput=e.target.value,onKeyDown:async e=>{var t;switch(e.stopPropagation(),this.showError=!1,e.key){case"Enter":try{await this.createNewFolder(this.newFolderInput),this.newFolderActive=!1}catch(e){null===(t=this.newFolderInputElement)||void 0===t||t.setFocus()}break;case"Escape":this.newFolderActive=!1,this.showError=!1}},ref:e=>this.newFolderInputElement=e,status:this.showError?"invalid":"idle"}))}renderCombobox(){var e;const{i18n:t,scale:i,overlayPositioning:r}=this;return(0,s.h)("calcite-label",{scale:i,class:"input-height"},(0,s.h)("p",{class:"label"},null!==(e=this.label)&&void 0!==e?e:t.folder),(0,s.h)("div",null,this.newFolderActive?this.renderNewFolder():(0,s.h)("div",{class:"combobox-wrapper"},this.loading&&(0,s.h)("calcite-progress",{type:"indeterminate",class:"progress"}),(0,s.h)("calcite-combobox",{label:t.folder,selectionMode:"single-persist",maxItems:5,placeholder:this.loading?t.loading:t.searchFolders,scale:i,overlayPositioning:r,ref:e=>this.comboboxElement=e,disabled:this.loading||this.disabled,clearDisabled:!0,onCalciteComboboxChange:e=>this.handleComboboxChange(e),onCalciteComboboxBeforeClose:()=>{var e;this.comboboxElement&&!(null===(e=this.comboboxElement.selectedItems)||void 0===e?void 0:e.length)&&(this.comboboxElement.value=this.selectedFolder.id)}},!this.loading&&(0,s.h)(s.F,null,this.user&&this.canCreateNewFolder&&(0,s.h)("calcite-combobox-item",{class:"create-folder",value:"create-folder",textLabel:this.createFolderText,selected:!1,icon:"folder-plus",filterDisabled:!0,key:"create",ref:e=>{this.createItem=e}}),this.folders.map(this.renderItem))))),this.renderError())}renderList(){const{i18n:e}=this;return(0,s.h)(s.F,null,(0,s.h)("calcite-list",{class:"list",selectionMode:"single-persist",selectionAppearance:"icon",ref:e=>this.listElement=e,onCalciteListChange:e=>{this.handleListChange(e)},filterPlaceholder:this.loading?e.loading:e.searchFolders,onCalciteListFilter:t=>{var i;const s=t.target;this.emptyFilterList=(null===(i=s.filteredItems)||void 0===i?void 0:i.length)<1,this.createFolderText=e.create.replace("${folder}",s.filterText),this.filterText=s.filterText},filterEnabled:!0},this.emptyFilterList&&(0,s.h)("div",{class:"no-folders-found"},e.noFoldersFound,this.user&&(0,s.h)("calcite-link",{class:"create-link",onClick:async()=>{this.showError=!1,await this.createNewFolder(this.filterText),this.listElement.filterText="",this.emptyFilterList=!1}},this.createFolderText)),this.folders.map(this.renderItem)),this.user&&this.canCreateNewFolder&&(0,s.h)("div",{class:"below"},this.newFolderActive?this.renderNewFolder():(0,s.h)("calcite-button",{iconStart:"folder-plus",appearance:"transparent",onClick:()=>{this.showError=!1,this.newFolderActive=!0}},e.createNewFolder),this.renderError()))}render(){return(0,s.h)(s.H,{key:"10387b960ef8b4bc9f3f13ced6551410e0524e14"},this.alwaysOpen?this.renderList():this.renderCombobox())}get el(){return(0,s.d)(this)}static get watchers(){return{user:["handleUserChange"],selectedFolder:["handleFolderChange"],newFolderInputElement:["setNewFolderActive"]}}};var F;w.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}.create-folder{--calcite-color-text-1:var(--calcite-color-text-link);--calcite-color-text-3:var(--calcite-color-text-link)}.create-link{margin-left:0.25rem;margin-right:0.25rem}.combobox-wrapper{position:relative}.progress{position:absolute;top:0px;z-index:1}.below{margin-top:1.25rem}.list{max-height:15rem;overflow:auto;--tw-shadow:0 2px 12px -4px rgba(0, 0, 0, 0.2), 0 2px 4px -2px rgba(0, 0, 0, 0.16);--tw-shadow-colored:0 2px 12px -4px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.list-item{min-width:0px;max-width:100%;text-overflow:ellipsis}.no-folders-found{padding-top:0.5rem;padding-bottom:0.5rem;padding-left:3.5rem;padding-right:3.5rem;font-size:0.75rem;color:var(--calcite-color-text-1)}",function(e){e.arcgisTitleInputChange="title",e.arcgisFolderPickerChange="folder",e.arcgisSummaryInputChange="snippet",e.arcgisTagsPickerChange="tags",e.arcgisCategoriesPickerChange="categories"}(F||(F={}));const y=class{constructor(e){(0,s.r)(this,e),this.arcgisItemPropertiesChange=(0,s.c)(this,"arcgisItemPropertiesChange",7),this.portal=void 0,this.user=void 0,this.api=void 0,this.config=void 0,this.itemId=void 0,this.type=void 0,this.scale=void 0,this.resetStoreOnUnmount=!0}async resetItemPropertiesStore(){c.a.reset()}handleItemPropertiesChange(e){const{detail:t,type:i}=e;c.i[F[i]]=t,this.arcgisItemPropertiesChange.emit(Object.assign({},c.i))}async componentWillLoad(){var e,t;this.portal&&(a.c.portal=this.portal),this.user&&(a.c.user=this.user),this.api&&(a.c.api=this.api),this.config&&(a.c.config=this.config),this.itemId&&({result:c.i.item}=await(0,g.a)(this.itemId,this.portal)),this.type&&(c.i.type=null!==(e=this.type)&&void 0!==e?e:null===(t=c.i.item)||void 0===t?void 0:t.type),this.scale&&(a.c.scale=this.scale)}render(){return(0,s.h)(s.H,{key:"2073f04cd80c4227d1bd8ca4217cba45ce3503bd"},(0,s.h)("slot",{key:"5ec6b4924b7838b5ba09094641e574b6e2278e3c"}))}disconnectedCallback(){this.resetStoreOnUnmount&&c.a.reset()}get el(){return(0,s.d)(this)}},x=class{constructor(e){(0,s.r)(this,e),this.arcgisSummaryInputChange=(0,s.c)(this,"arcgisSummaryInputChange",7),this.updateLiveRegion=(0,l.d)((e=>{this.liveRegionText=this.getCharactersText(e)}),1500),this.scale=void 0,this.label=void 0,this.summary=void 0,this.maxLength=2048,this.rows=2,this.minHeight=void 0,this.maxHeight=void 0,this.placeholder=void 0,this.trimInput=!0,this.liveRegionText=void 0,this.valid=!0}async focusMainInput(){var e,t;null===(t=(e=this.mainInputRef).setFocus)||void 0===t||t.call(e)}async getErrorMessage(){return this.valid?null:{code:"summaryInvalid",translatedMessage:this.i18n.invalid}}async componentWillLoad(){var e,t;const i=await(0,n.g)(this.el);this.i18n=i[0],null!==(e=this.scale)&&void 0!==e||(this.scale=a.c.scale),null!==(t=this.summary)&&void 0!==t||(this.summary=c.i.snippet),this.placeholder=this.placeholder||this.i18n.addSummary,this.liveRegionText=this.getCharactersText(this.summary),c.a.on("reset",(()=>{this.summary=c.i.snippet}))}componentDidRender(){var e;const{rows:t,minHeight:i,maxHeight:s}=this,r=null===(e=this.el.shadowRoot)||void 0===e?void 0:e.querySelector("calcite-text-area");r&&(r.style.minHeight=`${i}px`,r.style.maxHeight=`${s}px`,r.rows=t)}getCharactersText(e){return this.i18n.charactersLeft.replace("${num}",""+(this.maxLength-e.length))}validate(){this.valid=!/>|</.test(this.summary)}trimInputToMaxLength(e){return e.substring(0,this.maxLength)}render(){const{i18n:e,summary:t,label:i,maxLength:r,scale:o,liveRegionText:a,valid:l,placeholder:n,trimInput:c}=this;return(0,s.h)("div",{key:"56a68836a15125a73143d435ab0e76d3ce4866b0",class:`container-${o}`},(0,s.h)("calcite-label",{key:"dedb34708d07e545d3d3ec6b11bce48b009c9ee1",scale:o,class:"label"},(0,s.h)("p",{key:"4e423fe3b4d78cbe25685005fd102fd03253fd1c",class:"label-text"},null!=i?i:e.summary),(0,s.h)("calcite-text-area",{key:"302c857be1a38263521166e0bacffef7fe1c40b1",ref:e=>this.mainInputRef=e,id:"summary-input",resize:"vertical",placeholder:n,value:t,maxLength:r,scale:o,status:l?"idle":"invalid",onKeyDown:e=>{!c||this.summary.length!==r||"Space"!==e.code&&("Backspace"===e.key||"Delete"===e.key||"ArrowLeft"===e.key||"ArrowUp"===e.key||"ArrowRight"===e.key||"ArrowDown"===e.key||"Tab"===e.key||e.ctrlKey||e.metaKey)||e.preventDefault()},onCalciteTextAreaInput:e=>{e.stopPropagation();const t=e.target;let i=t.value;c&&i.length>r&&(i=this.trimInputToMaxLength(t.value)),this.summary=i,this.arcgisSummaryInputChange.emit(this.summary),this.updateLiveRegion(i),this.validate()}}),(0,s.h)("calcite-input-message",{key:"501a07848f4e7fb78ec6a70a94d25459140357ed",hidden:l,icon:!0,scale:o,status:l?"idle":"invalid"},e.invalid),(0,s.h)("span",{key:"895176c20db3b8b72d9e8352b7bcdfa4cf953802",class:"screen-readers-only","aria-live":"polite"},a)))}get el(){return(0,s.d)(this)}};function T(e){return null==e?void 0:e.includes("Photo locations")}x.style=":host{--arcgis-label-margin-bottom:1rem}.container-s{margin-bottom:0.5rem}.container-m{margin-bottom:0.75rem}.container-l{margin-bottom:1rem}.label{--calcite-label-margin-bottom:0}.label-text{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}calcite-input{--calcite-color-border-1:var(--calcite-color-border-input)}.count{font-size:0.75rem;color:var(--calcite-color-text-1);opacity:0.75}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}";async function C({portal:e,user:t,title:i,itemType:s,typeKeywords:r,folder:o,extension:a,enablePublishing:n=!1,update:c=!1}){if(!t||!e)return{code:"missingUserOrPortal"};if(!i||i.trim().length<=0)return{code:"titleRequired"};if("Data Store"===s&&(/[\s.@~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g.test(i)||i.length>90))return{code:"dataStoreTitleInvalid"};if(!n&&(/<|>/gi.test(i)||i.length>250))return{code:"titleInvalid"};if(n&&(/[.@~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g.test(i)||i.length>90))return{code:"serviceNameInvalid"};if((0,l.g)(["WFS","Scene Service"],s)&&i.match(/^\d/))return{code:"titleStartsWithNumber"};const d="Image Collection"===s&&!T(r),h=n?function(e,t){switch(e){case"Image Collection":return T(t)?"Feature Service":"Image Service";case"CSV":case"Microsoft Excel":case"GeoJson":case"Shapefile":case"File Geodatabase":case"GeoPackage":case"Service Definition":case"Feature Collection":return"Feature Service";case"Tile Package":return"Map Service";case"Vector Tile Package":return"Vector Tile Service";case"Scene Package":return"Scene Service";case"3DTiles Package":return"3DTiles Service"}return e}(s,r):d?"Image Service":s,{itemURLList:u}=await(0,g.s)(i,h,o,a,t,e)||{};if(u&&!c)return{code:"itemExists",itemUrl:u[0]};if(n){const t=await(0,p.r)(`${(0,m.g)(e)}portals/${e.id}/isServiceNameAvailable`,{name:i.replace(/\s/g,"_"),type:h});if(!(null==t?void 0:t.available))return{code:t.inRecycleBin?"itemInRecycleBin":"titleInUseService",layerName:i}}return null}async function I(e){null!=e||(e=a.c.user);const t=e.url+"/tags";try{return(await(0,p.r)(t)).tags}catch(e){console.error(e)}}const k=class{constructor(e){(0,s.r)(this,e),this.arcgisTagsPickerChange=(0,s.c)(this,"arcgisTagsPickerChange",7),this.isTag=e=>void 0!==e.tag&&void 0!==e.count,this.controlledTags=[],this.mapItemValue=e=>e.map((e=>e.value)),this.handleKeydown=e=>{var t;if(","===e.key){const i=e.target,s=null===(t=null==i?void 0:i.shadowRoot)||void 0===t?void 0:t.querySelector("input");if(null==s?void 0:s.value){e.preventDefault();const t=s.value.trim(),r=i.querySelector(`calcite-combobox-item[text-label="${t}"]`);if(r)r.selected=!0;else{const e=document.createElement("calcite-combobox-item");e.value=t,e.textLabel=t,e.selected=!0,null==i||i.appendChild(e)}s.value="";const o=new InputEvent("input",{data:""});s.dispatchEvent(o)}}},this.api=void 0,this.user=void 0,this.scale=void 0,this.activeTags=void 0,this.knownTags=[],this.label=void 0,this.placeholder=void 0,this.hideLabel=void 0}async componentWillLoad(){var e,t,i,s,r,o;const l=await(0,n.g)(this.el);this.i18n=l[0],null!==(e=this.user)&&void 0!==e||(this.user=a.c.user),null!==(t=this.scale)&&void 0!==t||(this.scale=a.c.scale),null!==(i=this.api)&&void 0!==i||(this.api=a.c.api),null!==(s=this.activeTags)&&void 0!==s||(this.activeTags=c.i.tags),this.activeTags=(0,v.f)(this.activeTags),this.knownTags=(0,v.f)([...null!==(r=this.knownTags)&&void 0!==r?r:[],...null!==(o=this.activeTags)&&void 0!==o?o:[]]),c.a.on("reset",(()=>{this.activeTags=c.i.tags}))}async componentDidLoad(){var e,t,i;const{user:s}=this;if(s){const r=null!==(e=s.contentTags)&&void 0!==e?e:s.tags;!(null==r?void 0:r.length)||(null==r?void 0:r.length)>0&&!this.isTag(r[0])?this.knownTags=[...this.knownTags,...(await I(s)).map((e=>e.tag))]:this.knownTags=[...this.knownTags,...r.map((e=>e.tag))],this.knownTags=(0,v.f)([...null!==(t=this.activeTags)&&void 0!==t?t:[],...null!==(i=this.knownTags)&&void 0!==i?i:[]])}}itemPropertiesTagsChangeHandler(e){var t;e.stopPropagation();const i=(null===(t=this.combobox)||void 0===t?void 0:t.value)||[],s=Array.isArray(i)?i:[i];this.arcgisTagsPickerChange.emit((0,v.f)(s));const r=Array.from(this.combobox.children),o=this.combobox.selectedItems;r.forEach((e=>{this.controlledTags.includes(e.value)||e.remove()})),this.knownTags=this.mapItemValue(r),this.activeTags=this.mapItemValue(o)}renderFormattedTags(){const{i18n:e,scale:t,handleKeydown:i,placeholder:r}=this;this.knownTags.forEach((e=>{this.controlledTags.includes(e)||this.controlledTags.push(e)}));const o=this.knownTags.map((e=>{var t;return(0,s.h)("calcite-combobox-item",{key:e,value:e,textLabel:e.length>36?`${e.slice(0,36)}...`:e,selected:(null===(t=this.activeTags)||void 0===t?void 0:t.indexOf(e))>=0})}));return(0,s.h)("calcite-combobox",{label:e.tags,maxItems:5,"allow-custom-values":!0,placeholder:null!=r?r:e.addTags,scale:t,onKeyDown:i,ref:e=>this.combobox=e},o)}async setFocus(){var e;null===(e=this.combobox)||void 0===e||e.setFocus()}render(){const{i18n:e,scale:t,hideLabel:i,label:r}=this;return(0,s.h)("calcite-label",{key:"3205e1dcc2fbf709db2d7f0c60c84888eb027429",scale:t},(0,s.h)("p",{key:"5ade4d820be3aeb44e2fe777a1fc4f36343624f6",class:{label:!0,"screen-reader-only":i}},null!=r?r:e.tags),this.renderFormattedTags())}get el(){return(0,s.d)(this)}};k.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}.screen-reader-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}";const E=class{constructor(e){(0,s.r)(this,e),this.arcgisTitleInputChange=(0,s.c)(this,"arcgisTitleInputChange",7),this.arcgisTitleInputValidation=(0,s.c)(this,"arcgisTitleInputValidation",7),this.debouncedInput=(0,l.d)((()=>this.handleTitleValidation()),400),this.api=void 0,this.portal=void 0,this.user=void 0,this.scale=void 0,this.label=void 0,this.itemTitle=void 0,this.currentFolder=void 0,this.type=void 0,this.typeKeywords=void 0,this.update=!1,this.enablePublishing=void 0,this.readOnly=!1,this.titleError=void 0}async focusMainInput(){var e,t;null===(t=(e=this.mainInputRef).setFocus)||void 0===t||t.call(e)}async validateTitle(){return this.debouncedInput.invoke()}async handleTitleValidation(){const{type:e,itemTitle:t,typeKeywords:i,enablePublishing:s,portal:r,user:o,update:a}=this,{extension:l}=(0,b.a)(t);if(e)return this.titleError=await C({portal:r,user:o,title:t,itemType:e,typeKeywords:i,folder:this.currentFolder,extension:l,enablePublishing:s,update:a}),this.arcgisTitleInputValidation.emit({valid:!this.titleError}),this.getErrorMessage();console.error("No item type found. Skipping title validation")}getErrorMessage(){const{itemTitle:e,titleError:t,i18n:i}=this;return e||(this.titleError={code:"titleRequired",translatedMessage:this.i18n.validation.titleRequired}),t&&(t.translatedMessage=i.validation[this.titleError.code].replace("${name}",e)),t}async componentWillLoad(){var e,t,i,s,r,o,l;const d=await(0,n.g)(this.el);this.i18n=d[0],null!==(e=this.portal)&&void 0!==e||(this.portal=a.c.portal),null!==(t=this.user)&&void 0!==t||(this.user=a.c.user),null!==(i=this.scale)&&void 0!==i||(this.scale=a.c.scale),null!==(s=this.api)&&void 0!==s||(this.api=a.c.api),null!==(r=this.type)&&void 0!==r||(this.type=c.i.type),null!==(o=this.itemTitle)&&void 0!==o||(this.itemTitle=c.i.title),null!==(l=this.currentFolder)&&void 0!==l||(this.currentFolder=c.i.folder),this.itemTitle&&this.handleTitleValidation(),c.i.title=this.itemTitle,c.a.on("reset",(()=>{this.itemTitle=c.i.title}))}render(){var e;const{i18n:t,itemTitle:i,scale:r,readOnly:o}=this,{translatedMessage:a,code:l}=this.titleError||{},n=!a;return(0,s.h)("calcite-label",{key:"630de8d54f4b9e1bdf861dad519b147f79b6fc88",scale:r},(0,s.h)("p",{key:"36b0723dbb757f524585c5894b619a35c4dfacf9",class:"label"},null!==(e=this.label)&&void 0!==e?e:t.title),(0,s.h)("calcite-input",{key:"a3c65a3efd398a7c8ddcabab4de425d158ce98d4",id:"item-properties-title",readOnly:o,disabled:o,placeholder:t.addTitle,value:i,scale:r,onInput:this.debouncedInput,max:250,ref:e=>this.mainInputRef=e,status:n?"idle":"invalid",onCalciteInputInput:e=>{e.stopPropagation(),this.itemTitle=e.target.value,this.arcgisTitleInputChange.emit(this.itemTitle)}}),(0,s.h)("calcite-input-message",{key:"4a7154031b9f0f1f4dbbd1f8b6e8be73d09fbf6e",icon:!0,hidden:n,status:n?"idle":"invalid"},a||t[l]||t.title))}get el(){return(0,s.d)(this)}static get watchers(){return{currentFolder:["handleTitleValidation"]}}};E.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}calcite-input{--calcite-color-border-1:var(--calcite-color-border-input)}"},90230:(e,t,i)=>{i.d(t,{a:()=>o,f:()=>c,g:()=>n,s:()=>a,v:()=>l});var s=i(34472),r=i(46227);function o(e,t){const i=/(?:\.([^.]+))?$/;let s=null==e?void 0:e.replace(/^.*(\\|\/|:)/,""),o=s&&i.exec(s)[1]?i.exec(s)[1].toLowerCase():"",a="";if((null==s?void 0:s.indexOf(".rft."))>-1){const[e,t]=s.split(".rft.");o=`rft.${t}`,a=e}return s&&!a&&(a=-1===s.lastIndexOf(".")?s:s.substring(0,s.lastIndexOf("."))),a=a.replace(/\.|-/g,"_"),t&&(a=function(e){return`${e}_${(0,r.g)()}`}(a),s=`${a}.${o}`),{title:a,fileName:s,extension:o}}function a(e,t){return o(e.name,!!t)}function l(e,t){let i=e;const s=e.lastIndexOf("\\");return s>-1&&(i=i.substring(s+1,i.length)),i.replace(/\ /g,"_")===t.replace(/\ /g,"_")}function n(e){return s.a[e]?s.a[e]:s.a[Object.keys(s.a).find((t=>s.a[t].type===e))]}function c(e){if(!e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,t))} ${["B","KB","MB","GB","TB"][t]}`}},46227:(e,t,i)=>{i.d(t,{g:()=>s});const s=()=>[2,1,1,1,3].map((e=>{let t="";for(let i=0;i<e;i++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t})).join("-")},7078:(e,t,i)=>{i.d(t,{a:()=>n,g:()=>r});var s=i(91616);function r(e,t){if(function(e,t){return null==t?void 0:t.some((t=>t.title===e))}(e,t))return{error:"folderAlreadyExists"};if(!e||0===e.trim().length)return{error:"noName"};const i=o(e);return(null==i?void 0:i.length)>0?{error:"invalidCharacters",invalidCharacters:(0,s.b)(o(e))}:null}const o=e=>{const t=a(e);if(t)return t;const i=l(e);return i||null},a=e=>e.match(/[<>]/g),l=e=>e.match(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F700}-\u{1F77F}]|[\u{1F780}-\u{1F7FF}]|[\u{1F800}-\u{1F8FF}]|[\u{1F900}-\u{1F9FF}]|[\u{1FA00}-\u{1FA6F}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/gu);function n(e){const{folderId:t,currentUsername:i,selectedFolderId:s}=e;switch(t){case"all":return"folders";case i:return"home";case"recycle":return"recycle-bin";default:return t===s?"folder-open":"folder"}}}}]);