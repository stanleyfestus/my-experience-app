/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_classi-e73313.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_classi-e73313"],{28250:(t,e,r)=>{r.d(e,{a:()=>s,b:()=>w,c:()=>h,d:()=>E,e:()=>p,f:()=>d,g:()=>m,h:()=>y,i:()=>k,j:()=>M,k:()=>_,l:()=>D,m:()=>J,n:()=>C,o:()=>I,p:()=>j,q:()=>N,r:()=>o,s:()=>c,t:()=>$,u:()=>S,v:()=>u,w:()=>f,x:()=>V,y:()=>b});var i=r(44090),n=r(98034),a=r(25972),l=r(10699);async function s(t){const e={};try{const r=await(0,a.r)(t);e.result=null==r?void 0:r.classification}catch(t){console.error(t),e.error=t}return e}async function o(t){const e={};try{const r=await(0,a.r)(t);e.result=r.classificationSchema}catch(t){console.error(t),e.error=t}return e}async function u(t){const e=`${i.c.config.restBaseUrl}portals/self/classification/validateClassification`,r={classificationValue:JSON.stringify(t)},n={};try{const t=await(0,a.r)(e,r,{},"post");n.result=t}catch(t){console.error(t),n.error=t}return n}async function c(t,e){const r={};try{const i={classification:JSON.stringify(e)},n=await(0,a.r)(t,i,{},"post");r.result=n}catch(t){console.error(t),r.error=t}return r}async function d(t,e){const r=Object.entries(null==t?void 0:t.attributes),i=[];for(let n in r){const a=r[n][0],l=r[n][1],s=null==l?void 0:l.attributeCategory;try{const r=await b(a,t,e);i.push({attributeId:a,attributeCategory:s,isEnabled:r})}catch(t){return console.error("error: ",t),t}}return i}async function b(t,e,r){var i;const n=null===(i=null==e?void 0:e.attributes)||void 0===i?void 0:i[t],a=null==n?void 0:n.isAttributeEnabled;if(!n)return!1;if(!a)return!0;const l={schemaJsonString:JSON.stringify(e),valueJsonString:JSON.stringify(r),attributeId:t};return(await v(a)).execute(l)}async function f(t,e,r){var i,n;const a=null===(i=null==e?void 0:e.attributes)||void 0===i?void 0:i[t],l=null==a?void 0:a.valueExpression,s=null==a?void 0:a.validValues,o=null==a?void 0:a.validValuesMap;if(!a)return null;if(null==s?void 0:s.length)return s;if(o&&(null===(n=Object.keys(o))||void 0===n?void 0:n.length))return o;if(!l)return null;const u={schemaJsonString:JSON.stringify(e),valueJsonString:JSON.stringify(r),attributeId:t};return(await v(l)).execute(u)}async function g(t,e,r,i=""){const n={schemaJsonString:e,valueJsonString:JSON.stringify(r),attributeId:i};return(await v(t)).execute(n)}async function v(t){const[e]=await(0,n.l)([3===(null===i.c||void 0===i.c?void 0:i.c.api)?"webpack-bundles/arcade":"esri/arcade"]);return e.createArcadeExecutor(t,{variables:[{name:"schemaJsonString",type:"text"},{name:"valueJsonString",type:"text"},{name:"attributeId",type:"text"}]})}async function y(t,e,r,i){var n;let a=structuredClone(r.conflictsError);const l=i,s=null===(n=t.attributes[l])||void 0===n?void 0:n.attributeValidation;if(s){const r=await g(s,t,e,l);if(r.length>0){const e=t.attributes[l].label;a.push({attributeId:l,attributeLabel:e,errorMessage:r})}else a=a.filter((({attributeId:t})=>t!==i))}return a}const h=(t,e)=>(null==e?void 0:e.classificationMetadata.classificationValueProperties.find((({value:e})=>e===t.value)))||{value:e.classificationMetadata.defaultValue},m=async(t,e)=>{const r=null==t?void 0:t.bannerExpression;if((null==r?void 0:r.length)>0){return await g(r,JSON.stringify(t),e)}return O("bannerOrder","bannerLabel",t,e)},p=async(t,e)=>{const r=null==t?void 0:t.selectionTextExpression;return(null==r?void 0:r.length)>0?await g(r,JSON.stringify(t),e):O("selectionDisplayOrder","selectionDisplayLabel",t,e)},E=(t,e,r)=>{let i=w(t,e,r);return i=C(r,i),i},S=t=>{const e=new Date,{type:r,defaultDateTimeline:i,defaultDateTimelineUnits:n}=t;if("date"===r&&i&&n)switch(n.toLowerCase()){case"years":e.setFullYear(e.getFullYear()+i);break;case"months":e.setMonth(e.getMonth()+i);break;case"days":e.setDate(e.getDate()+i)}const a=(e.getMonth()+1).toString(),l=(e.getDate()+1).toString();return`${e.getFullYear()}-${1===a.length?`0${a}`:a}-${1===l.length?`0${l}`:l}`},w=(t,e,r)=>{const i=r.classificationMetadata.defaultValue;let n=structuredClone(t);return n||(n={[e]:i}),(null==n?void 0:n[e])||(n[e]=i),n},C=(t,e)=>{const r=structuredClone(e);return Object.entries(t.attributes).forEach((([t,e])=>{if(r[t])return;const{uiElement:i}=e;if("date"===i)return void(r[t]=S(e));const{defaultValue:n}=e;n&&(["multi-select","multi-grouped-select-nested"].includes(i)?r[t]=[n]:"checkbox"===i?r[t]="true"===n:["single-select","text"].includes(i)&&(r[t]=n))})),r},D=async(t,e)=>{const r=structuredClone(e),i=Object.entries(t.attributes);for(let n in i){const a=i[n][0];await b(a,t,e)||delete r[a]}return r},O=(t,e,r,i)=>{const n=Object.entries(r.attributes).sort((([,e],[,r])=>e[t]||0-r[t]||0)),a=[],l=[];n.forEach((([r,n])=>{var s,o,u,c,d;const b=null==i?void 0:i[r];if(b&&n[t]){const t=null!==(s=n.uiElement)&&void 0!==s?s:"",r=null!==(o=n[e])&&void 0!==o?o:"",i=null!==(u=n.labelDelimiter)&&void 0!==u?u:"",f=null!==(c=n.valueDelimiter)&&void 0!==c?c:"";a.push(x({elementType:t,selectionDisplayLabel:r,labelDelimiter:i,classificationProp:b,valueDelimiter:f})),l.push(null!==(d=n.attributeDelimiter)&&void 0!==d?d:"")}}));return a.reduce(((t,e,r)=>`${t}${l[r]}${e}`))},x=({elementType:t,selectionDisplayLabel:e,labelDelimiter:r,classificationProp:i,valueDelimiter:n})=>{let a="";if(t.includes("multi")&&i)for(let t=0;t<i.length;t++)a+=i[t],t!==i.length-1&&(a+=n);else a=i;return e+r+a},J=(t,e,r)=>{const{createdUser:i,createdDate:n}=e;return e=Object.assign(Object.assign({[r]:t},i?{createdUser:i}:{}),n?{createdDate:n}:{})},$=(t,e)=>{const r=e.requiredError.find((e=>e.attributeId===t)),i=e.conflictsError.find((e=>e.attributeId===t)),n=((t,e)=>(null==t?void 0:t.errorMessage)||(null==e?void 0:e.errorMessage)||null)(r,i);return{invalid:!!r||!!i,errorMsg:n}},I=(t,e)=>{let r="";const{requiredError:i,conflictsError:n}=e,a=i.map((({attributeLabel:t})=>t));if(1===a.length)r=t.singleAttributeError.replace("${attributeName}",a[0]);else if(a.length>1){const e=a.slice(0,-1).reduce(((t,e)=>`${t}, ${e}`));r=t.multipleAttributeErrors.replace("${attributeString}",e).replace("${lastAttributeName}",a[a.length-1])}return 0!==n.length&&(r+=` ${n.map((({attributeLabel:t,errorMessage:e})=>`${t} - ${e}`)).join(",")} `),r},M=({isEnableAttribute:t,i18n:e,itemClassificationSchema:r,itemClassificationValue:i,classificationErrors:n,activeAttributeId:a})=>{let l=structuredClone(n.requiredError);if(!a)return l;if(N(a,t,r,i)){if(!l.some((({attributeId:t})=>t===a))){const t=r.attributes[a].label,i=r.attributes[a].attributeCategory;l.push({attributeId:a,attributeLabel:t,attributeCategory:i,errorMessage:e.fieldSelectionError})}}else l=l.filter((({attributeId:t})=>t!==a));return l},_=(t,e,r,i,n)=>{const a=[];return Object.entries(r.attributes).forEach((([n])=>{if(N(n,t,r,i)){const t=r.attributes[n].label,i=r.attributes[n].attributeCategory;a.push({attributeId:n,attributeLabel:t,attributeCategory:i,errorMessage:e.fieldSelectionError})}})),n.requiredError=a,0===a.length},N=(t,e,r,i)=>{const n=r.attributes[t],a=!!(null==n?void 0:n.isRequired),l=!!(null==i?void 0:i[t]),s=null==e?void 0:e.find((({attributeId:e})=>e===t));return(null==s?void 0:s.isEnabled)&&a&&!l},V=(t,e)=>{const{requiredError:r}=e;return r.some((({attributeCategory:e,errorMessage:r})=>e===t&&!!r))},j=(0,l.c)({itemClassificationSchema:null,itemClassificationValue:null,itemClassificationValueWithDefaults:null,isEnableAttribute:null,activeAttributeId:"",classificationErrors:{requiredError:[],conflictsError:[]},currSelectionText:""}),k=j.state}}]);