/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-927c7f.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-927c7f"],{1546:(e,t,i)=>{i.r(t),i.d(t,{arcgis_label:()=>m,arcgis_label_content:()=>w,arcgis_label_content_style:()=>L});var l=i(20536),s=i(37568),a=i(98034),o=i(46227),n=i(74129),r=i(98072),c=i(34752),d=i(1834),h=i(67911);i(91102),i(73807),i(99004),i(10699);const b="enable-label",p="label-switch",f="component-ul",m=class{constructor(e){(0,l.r)(this,e),this.labelUpdated=(0,l.c)(this,"labelUpdated",7),this.arcgisLabelDismissedChange=(0,l.c)(this,"arcgisLabelDismissedChange",7),this.internalLabelUpdated=(0,l.c)(this,"internalLabelUpdated",7),this.closeLabelPopovers=(0,l.c)(this,"closeLabelPopovers",7),this.arcgisFilterDone=(0,l.c)(this,"arcgisFilterDone",7),this.labelReRender=(0,l.c)(this,"labelReRender",7),this.labelComponent=(e,t,i)=>{var s;return(0,l.h)("div",{key:e,id:e},(0,l.h)("arcgis-label-content",{guid:e,labelClass:t,blockOpen:i,calciteFlowItem:(null===(s=this.calciteFlowProps)||void 0===s?void 0:s.calciteFlowItem)||this.hostElement.shadowRoot.getElementById("labelFlowItem_Id")}))},this.mapView=void 0,this.layer=void 0,this.portal=void 0,this.config=void 0,this.layerDisplayType=n.l.feature,this.dismissible=!1,this.hideLayerTitle=!1,this.calciteFlowProps=null,this.labelComponents=[],this.reRender=void 0}async componentWillLoad(){var e;[this.strings,this.currentLanguage]=await(0,s.g)(this.hostElement),this.layerGeometryType=await(0,r.j)(this.layer),this.serviceType=(0,r.d)(this.layer),d.l.layer=this.layer,d.l.mapView=this.mapView,d.l.portal=this.portal,d.l.config=this.config,d.l.strings=this.strings,d.l.currentLanguage=this.currentLanguage,d.l.layerGeometryType=this.layerGeometryType,d.l.serviceType=this.serviceType,d.l.layerDisplayType=this.layerDisplayType,this.labelingInfo=this.layerDisplayType===n.l.feature?this.layer.labelingInfo:this.layer.featureReduction.labelingInfo,this.layerDisplayType===n.l.feature?this.layer.labelsVisible=this.layer.labelsVisible||!1:this.layerDisplayType===n.l.cluster&&(this.layer.featureReduction.labelsVisible=this.layer.featureReduction.labelsVisible||!1),Array.isArray(this.labelingInfo)&&this.labelingInfo.forEach((e=>{this.addLabelClass(e,1===this.labelingInfo.length)})),(null===(e=this.calciteFlowProps)||void 0===e?void 0:e.calciteFab)&&!this.getLabelEnabledProp()&&(this.calciteFlowProps.calciteFab.hidden=!0)}componentDidLoad(){var e;this.sortableComponents=this.hostElement.shadowRoot.getElementById("SortableComponents_Id"),this.calciteFab=(null===(e=this.calciteFlowProps)||void 0===e?void 0:e.calciteFab)||this.hostElement.shadowRoot.getElementById("addComponentBtn_Id"),this.calciteFab.onclick=async e=>{e.stopPropagation(),this.closeLabelPopovers.emit();const t=await this.getLabelClass();this.labelingInfo?this.labelingInfo.push(t):this.labelingInfo=[t],this.addLabelClass(t,!0),this.focusLastLabelClass()},this.flowItemNode&&requestAnimationFrame((()=>this.flowItemNode.setFocus()))}componentDidUpdate(){this.internalLabelUpdated.emit()}mainPopupReRenderHandler(e){e.stopPropagation(),this.reRender=!this.reRender}deleteComponentHandler(e){e.stopPropagation(),this.closeLabelPopovers.emit();const t=this.sortableComponents.getElementsByTagName("div");for(let i=0;i<t.length;i++)if(t[i].id===e.detail){this.labelingInfo.splice(i,1),this.labelComponents.splice(i,1);break}this.labelReRender.emit(),this.calciteFab.setFocus()}duplicateComponentHandler(e){e.stopPropagation(),this.closeLabelPopovers.emit();const t=this.sortableComponents.getElementsByTagName("div");for(let i=0;i<t.length;i++)if(t[i].id===e.detail){const e=this.labelingInfo[i].clone();this.labelingInfo.push(e),this.addLabelClass(e,!0),this.focusLastLabelClass();break}}internalLabelUpdatedHandler(e){e.stopPropagation(),this.labelingInfo&&!e.detail&&(this.layerDisplayType===n.l.feature?this.layer.labelingInfo=[...this.labelingInfo]:this.layer.featureReduction.labelingInfo=[...this.labelingInfo]),this.labelUpdated.emit()}disableLabelPanelHandler(e){var t;e.stopPropagation();((null===(t=this.calciteFlowProps)||void 0===t?void 0:t.calciteFlowItem)||this.hostElement.shadowRoot.getElementById("labelFlowItem_Id")).disabled=e.detail}async done(){this.arcgisFilterDone.emit(),this.closeLabelPopovers.emit()}async setFocus(){var e;this.flowItemNode?this.flowItemNode.setFocus():null===(e=this.labelSwitch)||void 0===e||e.focus()}enableDisableLabel(e){this.hostElement.shadowRoot.getElementById("labelDiv_Id").style.display=e?"block":"none",this.calciteFab.style.display=e?"block":"none",this.closeLabelPopovers.emit()}getLabelEnabledProp(){switch(this.layerDisplayType){case n.l.feature:return this.layer.labelsVisible;case n.l.cluster:return this.layer.featureReduction.labelsVisible;default:return this.layer.labelsVisible}}addLabelClass(e,t=!1){this.labelComponents=[...this.labelComponents,this.labelComponent((0,o.g)(),e,t)]}async getLabelClass(){var e,t,i,l,s,o;const[r,c,d,h]=await(0,a.l)(["esri/layers/support/LabelClass","esri/views/support/colorUtils","esri/smartMapping/labels/clusters","esri/smartMapping/labels/bins"]);return this.layerDisplayType===n.l.feature?new r(this.defaultLabelProps(this.defaultSymbolProps(await c.getBackgroundColor(this.mapView),await c.getBackgroundColorTheme(this.mapView)))):"binning"===(null===(e=this.layer.featureReduction)||void 0===e?void 0:e.type)?(null===(i=null===(t=await h.getLabelSchemes({layer:this.layer}))||void 0===t?void 0:t.primaryScheme)||void 0===i?void 0:i.labelingInfo[0])||null:(null===(o=null===(s=await d.getLabelSchemes({layer:this.layer,renderer:null===(l=this.layer)||void 0===l?void 0:l.renderer,view:this.mapView}))||void 0===s?void 0:s.primaryScheme)||void 0===o?void 0:o.labelingInfo[0])||null}defaultLabelProps(e){const t=this.defaultLabelField();return{symbol:{type:"text",color:e.fontColor,haloColor:e.haloColor,haloSize:e.haloSize,font:{family:e.fontFamily,size:e.fontSize}},labelExpressionInfo:this.layerDisplayType===n.l.cluster?{expression:`$feature["${t}"]`}:this.serviceType!==n.s.mapImage?{expression:t?this.layer.fields.some((e=>{var i;if(e.name===t)return"coded-value"===(null===(i=null==e?void 0:e.domain)||void 0===i?void 0:i.type)}))?`$feature["${t}"]\nDomainName($feature, "${t}")`:`$feature["${t}"]`:null}:null,labelExpression:this.serviceType===n.s.mapImage?`[${t}]`:null,labelPlacement:this.defaultPlacement(),maxScale:this.layer.maxScale||0,minScale:this.layer.minScale||0}}defaultLabelField(){let e=null;return this.layerDisplayType===n.l.cluster?e=this.layer.featureReduction.fields[0].name:"displayField"in this.layer&&"fieldsIndex"in this.layer&&this.layer.displayField&&this.layer.fieldsIndex.get(this.layer.displayField)?e=this.layer.displayField:this.layer.fields.find((t=>{if(t.type.toLowerCase().includes("string"))return e=t.name})),e||this.layer.fields[0].name}defaultSymbolProps(e,t){return"light"===t?{fontFamily:"Arial",fontSize:9.75,fontColor:"#262626",haloColor:"#f7f7f7",haloSize:1}:"dark"===t?{fontFamily:"Arial",fontSize:9.75,fontColor:"#f7f7f7",haloColor:"#262626",haloSize:1}:{fontFamily:"Arial",fontSize:9.75,fontColor:e||"#262626",haloColor:"#f7f7f7",haloSize:.75}}defaultPlacement(){var e;return this.layerDisplayType===n.l.cluster&&"binning"===(null===(e=this.layer.featureReduction)||void 0===e?void 0:e.type)?"always-horizontal":"point"===this.layerGeometryType||"multipoint"===this.layerGeometryType?"above-center":"polyline"===this.layerGeometryType?"center-along":"polygon"===this.layerGeometryType?"always-horizontal":null}focusLastLabelClass(){setTimeout((()=>requestAnimationFrame((()=>{const e=this.hostElement.shadowRoot.querySelectorAll("arcgis-label-content");(null==e?void 0:e.length)&&e[e.length-1].setFocus()}))),200)}labelSwitchAndContent(){return(0,l.h)("div",null,(0,l.h)("calcite-label",{class:b,alignment:"start",layout:"inline-space-between"},this.strings.enableLabels,(0,l.h)("calcite-switch",{ref:e=>this.labelSwitch=e,scale:"s",class:p,checked:this.getLabelEnabledProp(),onCalciteSwitchChange:e=>{const t=e.target.checked;switch(this.layerDisplayType){case n.l.feature:this.layer.labelsVisible=t;break;case n.l.cluster:this.layer.featureReduction.labelsVisible=t;break;default:this.layer.labelsVisible=t}this.enableDisableLabel(t),this.internalLabelUpdated.emit(!0)}})),(0,l.h)("div",{id:"labelDiv_Id",hidden:!this.getLabelEnabledProp()},(0,l.h)("div",{id:"SortableComponents_Id",class:f},this.labelComponents)))}render(){const e=(0,l.h)("calcite-fab",{key:"e6de223d27664d8af1addaf9d819b1f31172a5ea",hidden:!this.getLabelEnabledProp(),id:"addComponentBtn_Id",icon:"plus",slot:"fab",scale:"s",appearance:"outline-fill",kind:"neutral",label:this.strings.addLabel,text:this.strings.addLabel,"text-enabled":!0});return(0,l.h)(l.H,{key:"6433980b00bfdd2ca7cfe96d48518f229803f2fe",style:this.calciteFlowProps?{}:{display:"flex",flex:"1 1 auto",overflow:"hidden"}},this.calciteFlowProps?(0,l.h)("div",{dir:(0,c.g)(this.hostElement)},this.labelSwitchAndContent()):(0,l.h)("calcite-flow",{dir:(0,c.g)(this.hostElement)},(0,l.h)("calcite-flow-item",{id:"labelFlowItem_Id",heading:this.strings.labelFeatures,description:this.hideLayerTitle?void 0:this.layer.title,closable:this.dismissible,onCalciteFlowItemClose:e=>{e.stopPropagation(),this.flowItemNode.closed=!0,this.closeLabelPopovers.emit(),this.arcgisLabelDismissedChange.emit(),setTimeout((()=>this.flowItemNode.closed=!1),300)},ref:e=>this.flowItemNode=e},this.labelSwitchAndContent(),e)))}get hostElement(){return(0,l.d)(this)}};m.style=".enable-label{background-color:var(--arcgis-app-background);display:flex;padding:var(--arcgis-app-cap-spacing) var(--arcgis-app-cap-spacing-half) var(--arcgis-app-cap-spacing-quarter);border-bottom:solid 1px var(--arcgis-app-border)}.enable-label-label{display:flex;flex-flow:column nowrap;flex:1 0 0%;overflow:hidden}.label-switch{margin:0;flex:0 0 0%;justify-self:flex-end}.component-ul{margin:0 0 var(--arcgis-app-cap-spacing);padding:0}";const y="label-content-btn-section",g="label-content-btn-exp",u="label-content-btn",v="label-content-btn-text",C="label-content-btn-icon",k="field-expression-div",w=class{constructor(e){(0,l.r)(this,e),this.closeLabelPopovers=(0,l.c)(this,"closeLabelPopovers",7),this.internalLabelUpdated=(0,l.c)(this,"internalLabelUpdated",7),this.labelContentReRender=(0,l.c)(this,"labelContentReRender",7),this.disableLabelPanel=(0,l.c)(this,"disableLabelPanel",7),this.aggregationExpressionMapping=new Map,this.fieldPickListChanges=async e=>{var t,i;e.stopPropagation();const l=null===(i=null===(t=e.detail)||void 0===t?void 0:t.selectedFields)||void 0===i?void 0:i[0];if(l){if(this.serviceType===n.s.mapImage)this.labelClass.labelExpression=`[${l}]`;else if(this.layerDisplayType===n.l.cluster)if(this.aggregationExpressionMapping.has(l))this.labelClass.labelExpressionInfo.expression=this.aggregationExpressionMapping.get(l);else for(const[e,t]of this.aggregationExpressionMapping)e===l&&(this.labelClass.labelExpressionInfo.expression=t);else this.labelClass.labelExpressionInfo=this.layer.fields.some((e=>{var t;if(e.name===l)return"coded-value"===(null===(t=null==e?void 0:e.domain)||void 0===t?void 0:t.type)}))?{expression:`$feature["${l}"]\nDomainName($feature, "${l}")`}:{expression:`$feature["${l}"]`};this.labelContentReRender.emit()}this.closeLabelPopovers.emit()},this.guid=void 0,this.blockOpen=!1,this.labelClass=void 0,this.calciteFlowItem=void 0,this.reRender=void 0}async componentWillLoad(){if(this.layer=d.l.layer,this.mapView=d.l.mapView,this.portal=d.l.portal,this.config=d.l.config,this.strings=d.l.strings,this.currentLanguage=d.l.currentLanguage,this.layerDisplayType=d.l.layerDisplayType,this.serviceType=d.l.serviceType,this.popupTemplate=this.layerDisplayType===n.l.feature?this.layer.popupTemplate:this.layer.featureReduction.popupTemplate,this.labelFields=await this.getFieldsForLabeling(),this.calciteFlowItem||(this.calciteFlowItem=this.hostElement.closest("#labelFlowItem_Id")),this.layerDisplayType===n.l.cluster){[this.binLabelCreator,this.clusterLabelCreator]=await(0,a.l)(["esri/smartMapping/labels/bins","esri/smartMapping/labels/clusters"]);const e=async e=>{var t,i;let l;l="binning"===(null===(t=this.layer.featureReduction)||void 0===t?void 0:t.type)?await this.binLabelCreator.getLabelSchemes({layer:this.layer,field:e}):await this.clusterLabelCreator.getLabelSchemes({layer:this.layer,renderer:null===(i=this.layer)||void 0===i?void 0:i.renderer,view:this.mapView,field:e});[null==l?void 0:l.primaryScheme,...null==l?void 0:l.secondarySchemes].forEach((e=>{var t,i,l;this.aggregationExpressionMapping.set(null==e?void 0:e.fieldName,null===(l=null===(i=null===(t=null==e?void 0:e.labelingInfo)||void 0===t?void 0:t[0])||void 0===i?void 0:i.labelExpressionInfo)||void 0===l?void 0:l.expression)}))},t=[];this.labelFields.forEach((i=>{t.push(e(i.name))})),await Promise.all(t)}}componentDidLoad(){this.addScaleRangeSlider()}componentDidUpdate(){this.internalLabelUpdated.emit()}disconnectedCallback(){this.arcgisFieldPickList&&document.body.removeChild(this.arcgisFieldPickList),this.labelStyle&&document.body.removeChild(this.labelStyle),this.popoverRenameForm&&document.body.removeChild(this.popoverRenameForm),this.labelFilter&&document.body.removeChild(this.labelFilter)}async setFocus(){this.blockOpen&&(this.blockOptions.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),this.blockOptions.setFocus())}calciteBlockToggleHandler(){this.closeLabelPopovers.emit()}labelContentReRenderHandler(e){e.stopPropagation(),this.reRender=!this.reRender}closeLabelPopoversHandler(){this.arcgisFieldPickList&&(document.body.removeChild(this.arcgisFieldPickList),this.arcgisFieldPickList=null,this.attributesBtn.focus()),this.labelStyle&&(document.body.removeChild(this.labelStyle),this.labelStyle=null,this.styleBtn.focus()),this.popoverRenameForm&&(document.body.removeChild(this.popoverRenameForm),this.popoverRenameForm=null,this.blockOptions.setFocus()),this.labelFilter&&(document.body.removeChild(this.labelFilter),this.labelFilter=null,this.filterBtn.focus()),this.disableLabelPanel.emit(!1)}notifySymbolChangesHandler(e){this.guid===e.detail&&(e.stopPropagation(),this.labelContentReRender.emit())}notifyFilterUpdatedHandler(e){this.guid===e.detail&&(e.stopPropagation(),this.labelContentReRender.emit())}renameComponentHandler(e){this.guid===e.detail&&(this.closeLabelPopovers.emit(),e.stopPropagation(),this.popoverRenameForm||(this.popoverRenameForm=document.createElement("arcgis-popover-rename-form"),this.popoverRenameForm.guid=this.guid,this.popoverRenameForm.refElement=this.hostElement,this.popoverRenameForm.popoverPanelWidth=this.hostElement.getBoundingClientRect().width,this.popoverRenameForm.intlRenameHeader=this.strings.popoverRenameHeader,this.popoverRenameForm.intlOk=this.strings.ok,this.popoverRenameForm.intlCancel=this.strings.cancel,this.popoverRenameForm.intlClose=this.strings.close,this.popoverRenameForm.inputValue=this.labelClass.name||this.getDisplayFieldName()||this.strings.label,document.body.appendChild(this.popoverRenameForm),this.disableLabelPanel.emit(!0)))}popoverRenameFormEventHandler(e){this.guid===e.detail[0]&&(e.stopPropagation(),this.closeLabelPopovers.emit(),e.detail[1]&&(this.labelClass.name=e.detail[1],this.labelContentReRender.emit()))}async getFieldsForLabeling(){var e;if(this.layerDisplayType===n.l.feature){const t=await(0,r.k)(this.layer);if(null===(e=this.popupTemplate)||void 0===e?void 0:e.fieldInfos){let e=[];return t.filter((e=>["string","small-integer","big-integer","integer","single","double","long","date","date-only","time-only","timestamp-offset","oid","guid","global-id"].indexOf(e.type)>-1)).forEach((t=>{e=[...e,t.clone()],this.popupTemplate.fieldInfos.find((i=>{i.fieldName===t.name&&(e[e.length-1].alias=i.label)}))})),e}return t}return(0,r.l)(this.popupTemplate,!1)}async openAttributesList(){if(this.closeLabelPopovers.emit(),this.calciteFlowItem.loading=!0,!this.arcgisFieldPickList){this.arcgisFieldPickList=document.createElement("arcgis-field-pick-list"),this.arcgisFieldPickList.popoverProps={refElement:this.calciteFlowItem,offsetSkidding:50},this.arcgisFieldPickList.fields=this.labelFields,this.arcgisFieldPickList.layer=this.layer,this.arcgisFieldPickList.mapView=this.mapView,this.arcgisFieldPickList.showFieldInfo=this.layerDisplayType===n.l.feature;const e=this.labelClass.getLabelExpressionSingleField()||this.getFieldNameFromAggregationExpression();this.arcgisFieldPickList.selectedFields=e?[e]:[],this.arcgisFieldPickList.addEventListener("arcgisFieldPickListDismissed",this.fieldPickListChanges),document.body.appendChild(this.arcgisFieldPickList),this.disableLabelPanel.emit(!0)}this.calciteFlowItem.loading=!1}getFieldNameFromAggregationExpression(){var e,t;if(this.layerDisplayType===n.l.cluster)for(const[i,l]of this.aggregationExpressionMapping)if(l===(null===(t=null===(e=this.labelClass)||void 0===e?void 0:e.labelExpressionInfo)||void 0===t?void 0:t.expression))return i}openLabelStyle(){this.closeLabelPopovers.emit(),this.labelStyle||(this.labelStyle=document.createElement("arcgis-label-content-style"),this.labelStyle.view=this.mapView,this.labelStyle.guid=this.guid,this.labelStyle.labelContentRefElement=this.calciteFlowItem,this.labelStyle.labelClass=this.labelClass,document.body.appendChild(this.labelStyle),this.disableLabelPanel.emit(!0))}async openArcadeEditor(){var e,t,i;this.closeLabelPopovers.emit(),this.arcadeEditor||(this.calciteFlowItem.disabled=!0,this.arcadeEditor=document.createElement("arcgis-modal-arcade"),this.arcadeEditor.arcadeScript=(null===(e=this.labelClass.labelExpressionInfo)||void 0===e?void 0:e.expression)||"",this.arcadeEditor.arcadeProfile=this.getArcadeProfile(),this.arcadeEditor.testData=await this.getArcadeTestData(),this.arcadeEditor.addExistingExpressions=!0,this.arcadeEditor.layer=this.layer,this.arcadeEditor.arcadeTitle=(null===(t=this.labelClass.labelExpressionInfo)||void 0===t?void 0:t.title)||this.strings.newExpression,this.arcadeEditor.arcadeTitleEditable=!0,this.arcadeEditor.returnPredictOutputType=!1,this.arcadeEditor.arcadeTitleEditingEnabled=!(null===(i=this.labelClass.labelExpressionInfo)||void 0===i?void 0:i.title),document.body.appendChild(this.arcadeEditor),this.arcadeEditor.addEventListener("arcgisModalArcadeClose",(e=>this.arcadeSetup(e.detail))))}async arcadeSetup(e){var t;e&&((null===(t=this.labelClass.labelExpressionInfo)||void 0===t?void 0:t.expression)?(this.labelClass.labelExpressionInfo.expression=e.script,this.labelClass.labelExpressionInfo.title=e.title):this.labelClass.labelExpressionInfo={expression:e.script,title:e.title},this.labelContentReRender.emit()),this.calciteFlowItem.disabled=!1,document.body.removeChild(this.arcadeEditor),this.arcadeEditor=null,this.arcadeBtn.setFocus()}getArcadeProfile(){return{id:"labeling",definitions:{$feature:this.layerDisplayType===n.l.cluster?{fields:(0,r.l)(this.popupTemplate,!1)}:"knowledge-graph-sublayer"===this.layer.type?void 0:this.layer}}}async getArcadeTestData(){try{if(this.layerDisplayType===n.l.cluster)return{profileVariableInstances:{$feature:await(0,r.m)(this.mapView,this.layer,this.popupTemplate)},spatialReference:this.mapView.spatialReference,timeZone:this.mapView.timeZone};let e;return e="subtype-sublayer"===this.layer.type?this.layer.parent.url:this.layer.url,{profileVariableInstances:{$feature:(await(0,r.n)(this.layer,this.mapView)).features[0],$layer:this.layer,$map:this.mapView.map,$datastore:e},spatialReference:this.mapView.spatialReference,timeZone:this.mapView.timeZone}}catch(e){console.log(e)}}getDisplayFieldName(){const e=this.layerDisplayType===n.l.cluster?this.getFieldNameFromAggregationExpression():this.labelClass.getLabelExpressionSingleField(),t=this.labelFields.find((t=>{if(t.name===e)return t}));return(null==t?void 0:t.alias)||e}addScaleRangeSlider(){const{labelClass:e}=this;(0,a.l)(["esri/widgets/ScaleRangeSlider"]).then((([t])=>{var i,l;const s=this.hostElement.shadowRoot.getElementById("slider_Id"),a=new t({view:this.mapView,region:(null===(i=this.portal)||void 0===i?void 0:i.region)||(null===(l=this.portal)||void 0===l?void 0:l.getRegion().toLowerCase())||"wo",minScale:e.minScale||0,maxScale:e.maxScale||0},s);s.insertAdjacentHTML("afterbegin",`<link rel="stylesheet" href="${this.config.jsapiUrl}/themes/light/main.css" />`),a.watch(["minScale","maxScale"],((t,i,l)=>{"minScale"===l?e.minScale=t:"maxScale"===l&&(e.maxScale=t),this.closeLabelPopovers.emit(),this.labelContentReRender.emit()}))}))}render(){var e,t,i;const{blockOpen:s,guid:a,strings:o}=this,r=this.serviceType===n.s.feature||this.serviceType===n.s.stream||this.serviceType===n.s.subtype||this.serviceType===n.s.orientedImagery||this.serviceType===n.s.wfs||this.serviceType===n.s.geojson||this.serviceType===n.s.csv||this.serviceType===n.s.mapImage&&(null===(t=null===(e=this.layer.layer.capabilities)||void 0===e?void 0:e.exportMap)||void 0===t?void 0:t.supportsArcadeExpressionForLabeling),d=(0,l.h)("calcite-label",{key:"14601078ba762f16475339b79ec245843c29dff1"},o.labelAttribute,(0,l.h)("div",{key:"d3f50bb8c0f0b3668c572c7c80fce138316b7377",class:k},(0,l.h)("div",{key:"fbaf310c798777024eb2b2041f8551196141c16e",class:r?g:y},(0,l.h)("button",{key:"500c53610af14f3bc5d7d7ded0623339a308b1f7",ref:e=>this.attributesBtn=e,class:u,title:o.field,onClick:e=>{e.stopPropagation(),this.openAttributesList()}},(0,l.h)("span",{key:"77132e30d5377085c08cc708431dbfa91accf054",class:v},this.getDisplayFieldName()||(null===(i=this.labelClass.labelExpressionInfo)||void 0===i?void 0:i.title)||o.newExpression),(0,l.h)("span",{key:"6a6ae17dd39e910e9e71cb844a891f3c64f7df9f",class:C},(0,l.h)("calcite-icon",{key:"9b76941f402b645d297942ee3484f474be5da49c",scale:"s",icon:"chevron-down"})))),r&&(0,l.h)("calcite-action",{key:"b4c85dd69b51322263f11ef52b4c7343f85909ae",ref:e=>this.arcadeBtn=e,scale:"s",text:o.expression,onClick:e=>{e.stopPropagation(),this.openArcadeEditor()}},(0,l.h)("calcite-icon",{key:"5d3322e96ead35d1e4990d6cd8bd2bd3d4551121",scale:"s",icon:"code"})))),h=(0,l.h)("calcite-label",{key:"452fe5d3533651f030d04167b752dea7ecce0407"},o.filter,(0,l.h)("div",{key:"b3c6d1701d8bf970a5c1a50e46180ce30b4b8bec",class:y},(0,l.h)("button",{key:"026ee61e2179d1691f802e53717172827dfe6dee",ref:e=>this.filterBtn=e,class:u,title:o.editLabelFilter,onClick:e=>{e.stopPropagation(),this.closeLabelPopovers.emit(),this.labelFilter||(this.labelFilter=document.createElement("arcgis-label-content-filter"),this.labelFilter.guid=this.guid,this.labelFilter.labelFilterRefElement=this.calciteFlowItem,this.labelFilter.labelClass=this.labelClass,document.body.appendChild(this.labelFilter),this.disableLabelPanel.emit(!0))}},(0,l.h)("span",{key:"f005c50929823467f497f8ddaa2c97e973a9e4e8",class:v},o.editLabelFilter),(0,l.h)("span",{key:"75a5849bbd38df414abbe979f16f19bdd7235e3e",class:C},(0,l.h)("calcite-icon",{key:"91f9f25e67a1e21b034cbf0402be9b0118ec5e8a",scale:"s",icon:"chevron-down"}))))),b=(0,l.h)("calcite-label",{key:"1e407cf4a6309feea366f176d6127f02421fc12c"},o.labelStyle,(0,l.h)("div",{key:"d0a45ecf7f1302a0a3ebf79ff3f2079f2ad2839a",class:y},(0,l.h)("button",{key:"c1d94a0656af4bad2046e63aec13701bf3d0d092",ref:e=>this.styleBtn=e,class:u,title:o.editLabelStyle,onClick:e=>{e.stopPropagation(),this.openLabelStyle()}},(0,l.h)("span",{key:"c2b0ced7b612d554e3307bf8894383ce6d90f255",class:v},o.editLabelStyle),(0,l.h)("span",{key:"f14775d1606b80922b60de4ce069a55091424ba3",class:C},(0,l.h)("calcite-icon",{key:"120129d49ffca53e638655e53cb49df231f023c6",scale:"s",icon:"chevron-down"}))))),p=(0,l.h)("calcite-label",{key:"58a49f5e2e8d42f17fb432db1693b1dcc00dfb16"},o.visibleRange,(0,l.h)("div",{key:"e66cedd9f2f95f40e54a99488004b3321f6d92be",id:"slider_Id"}));return(0,l.h)(l.H,{key:"aca473753a019b234fc99f05f475529c75184a0e"},(0,l.h)("calcite-block",{key:"067ba8d3b3d5cc16847792b0dd896613f2d27907",dir:(0,c.g)(this.hostElement),heading:this.labelClass.name||this.getDisplayFieldName()||this.strings.label,collapsible:!0,open:s},(0,l.h)("div",{key:"20cd9339f9ec77bf4bda135f4f67018d3ba79648",slot:"control"},(0,l.h)("arcgis-calcite-block-options",{key:"c9d83cb041d7980ee0303d3807224e9fca784069",ref:e=>this.blockOptions=e,guid:a,intlOptions:o.options,intlDelete:o.delete,intlDuplicate:o.duplicate,intlRename:o.rename,calciteBlockOptions:{hasDelete:!0,hasDuplicate:!0,hasRename:!0}})),(0,l.h)("div",{key:"53bc08e318d52a8c638315b41115b433187290ec",slot:"icon"},(0,l.h)("calcite-icon",{key:"e716f9f00045eb5abb73859a3d77e428b4493158",scale:"m",icon:"label"})),d,this.serviceType===n.s.ogcFeature||this.serviceType===n.s.wfs||this.serviceType===n.s.subtype?null:h,b,p))}get hostElement(){return(0,l.d)(this)}};w.style=".label-content-btn-section{background-color:var(--arcgis-app-background);min-width:100%}.label-content-btn{background:var(--arcgis-app-background-clear);border:1px solid var(--arcgis-app-border);border-radius:var(--arcgis-app-border-radius);display:flex;align-items:center;justify-content:space-between;padding:var(--arcgis-app-cap-spacing-half) var(--arcgis-app-side-spacing-quarter);cursor:pointer;width:100%;text-align:unset;transition:background-color var(--arcgis-app-animation-time-fast) var(--arcgis-app-easing-function), border-color var(--arcgis-app-animation-time-fast) var(--arcgis-app-easing-function)}.label-content-btn:hover{background-color:var(--arcgis-app-background-hover);border-color:var(--arcgis-app-border-hover)}.label-content-btn-exp{width:calc(100% - 32px)}.label-content-btn-exp .label-content-btn{border:none;border-radius:0;border-right:1px solid var(--arcgis-app-border)}.label-content-btn-text{font-family:var(--arcgis-app-font-family);font-size:var(--arcgis-app-font-size-0);flex:0 1 auto;overflow:hidden;padding:0 var(--arcgis-app-side-spacing-eighth);text-overflow:ellipsis;white-space:nowrap}.label-content-btn-icon{flex:0 0 0%;padding:0 var(--arcgis-app-side-spacing-half)}.field-expression-div{align-items:center;display:flex;justify-content:space-between;width:100%;border:1px solid var(--arcgis-app-border);border-radius:var(--arcgis-app-border-radius)}.field-expression-div calcite-action{flex:0 0 auto}#slider_Id{min-width:100%}";const L=class{constructor(e){(0,l.r)(this,e),this.closeLabelPopovers=(0,l.c)(this,"closeLabelPopovers",7),this.notifySymbolChanges=(0,l.c)(this,"notifySymbolChanges",7),this.resizeObserver=new ResizeObserver((e=>{const t=e.pop();this.narrow=t.contentRect.width<=275,this.reRender=!this.reRender})),this.minMaxOffset={minOffsetX:-20,minOffsetY:-20,maxOffsetX:20,maxOffsetY:20},this.percentLabelFlip=!1,this.narrow=!1,this.openFontPopover=()=>{var e,t;if(!this.arcgisFontPicker){this.panelElement.disabled=!0,this.arcgisFontPicker=document.createElement("arcgis-font-picker"),this.arcgisFontPicker.enableMapSpecificFontList=!0,this.arcgisFontPicker.view=this.view,this.arcgisFontPicker.fontMap=this.fontMap,this.arcgisFontPicker.font=null===(t=null===(e=this.labelClass)||void 0===e?void 0:e.symbol)||void 0===t?void 0:t.font;const i=this.labelContentRefElement.getBoundingClientRect();this.arcgisFontPicker.popoverProps={refElement:this.labelContentRefElement,offsetSkidding:50,overlayPositioning:"fixed",maxHeight:.8*i.height+"px"},this.arcgisFontPicker.addEventListener("arcgisFontPickerDismissed",this.closeFontPopver),this.arcgisFontPicker.addEventListener("arcgisFontPickerChange",this.changeFont),document.body.appendChild(this.arcgisFontPicker)}},this.closeFontPopver=()=>{this.arcgisFontPicker&&(this.panelElement.disabled=!1,document.body.removeChild(this.arcgisFontPicker),this.arcgisFontPicker=null,setTimeout((()=>{this.panelElement.setFocus()}),100))},this.changeFont=e=>{var t,i;const l=null==e?void 0:e.detail,s=null===(i=null===(t=this.labelClass)||void 0===t?void 0:t.symbol)||void 0===i?void 0:i.font;l&&s&&(s.family=l.family,s.weight=l.weight,s.style=l.style),this.reRender=!this.reRender,this.notifySymbolChanges.emit(this.guid)},this.guid=void 0,this.labelContentRefElement=void 0,this.labelClass=void 0,this.view=void 0,this.isOpen=!1,this.reRender=!1}async componentWillLoad(){this.layer=d.l.layer,this.portal=d.l.portal,this.strings=d.l.strings,this.layerGeometryType=d.l.layerGeometryType,this.serviceType=d.l.serviceType,this.layerDisplayType=d.l.layerDisplayType,this.fontMap=this.serviceType===n.s.mapImage?h.m:await(0,h.g)(this.portal);const e=(0,c.g)(this.hostElement),t=new Intl.NumberFormat(d.l.currentLanguage,{style:"percent"}).format(0);this.percentLabelFlip="rtl"===e?t.endsWith("%"):t.startsWith("%")}componentDidLoad(){this.isOpen=!0,setTimeout((()=>requestAnimationFrame((()=>this.panelElement.setFocus()))),200),this.resizeObserver.observe(this.labelContentRefElement)}disconnectedCallback(){this.resizeObserver.unobserve(this.labelContentRefElement)}async reposition(){var e;null===(e=this.popoverNode)||void 0===e||e.reposition()}async calciteBlockSectionToggleHandler(e){e.stopPropagation();const t=e.composedPath();"haloBlock_Id"===(null==t?void 0:t[0].id)?this.labelClass.symbol.haloColor?(this.tempHaloColor=this.labelClass.symbol.haloColor,this.labelClass.symbol.haloColor=null):await(0,a.l)(["esri/Color"]).then((async([e])=>{var t;this.labelClass.symbol.haloColor=this.tempHaloColor||new e("white"),this.labelClass.symbol.haloSize=this.labelClass.symbol.haloSize||.75;this.hostElement.shadowRoot.getElementById("haloColorPicker_Id").color=(null===(t=this.labelClass.symbol.haloColor)||void 0===t?void 0:t.toHex())||"#ffffff"})):"backgroundBlock_Id"===(null==t?void 0:t[0].id)&&(this.labelClass.symbol.backgroundColor?(this.tempBackgroundColor=this.labelClass.symbol.backgroundColor,this.tempBorderLineColor=this.labelClass.symbol.borderLineColor,this.tempBorderLineSize=this.labelClass.symbol.borderLineSize,this.labelClass.symbol.backgroundColor=null,this.labelClass.symbol.borderLineColor=null,this.labelClass.symbol.borderLineSize=null):await(0,a.l)(["esri/Color"]).then((async([e])=>{var t,i,l,s;this.labelClass.symbol.backgroundColor=this.tempBackgroundColor||new e("white");this.hostElement.shadowRoot.getElementById("backgroundColorPicker_Id").color=(null===(t=this.labelClass.symbol.backgroundColor)||void 0===t?void 0:t.toHex())||"#ffffff",this.labelClass.symbol.borderLineColor=this.tempBorderLineColor||new e("white");this.hostElement.shadowRoot.getElementById("borderLineColorPicker_Id").color=(null===(i=this.labelClass.symbol.borderLineColor)||void 0===i?void 0:i.toHex())||"#ffffff",this.labelClass.symbol.borderLineSize=null!==(l=this.tempBorderLineSize)&&void 0!==l?l:.75;this.hostElement.shadowRoot.getElementById("borderLineSizePicker_Id").value=`${null!==(s=this.labelClass.symbol.borderLineSize/.75)&&void 0!==s?s:1}`}))),this.notifySymbolChanges.emit(this.guid),this.hostElement.shadowRoot.getElementById("managePopover_Id").reposition()}getPlacementArray(e){var t;return this.layerDisplayType===n.l.cluster&&"binning"===(null===(t=this.layer.featureReduction)||void 0===t?void 0:t.type)?[]:"point"===e||"multipoint"===e?h.p:"polyline"===e?h.a:[]}changeOffset(e){this.labelClass.symbol.xoffset=e.x,this.offsetXElement.value=this.labelClass.symbol.xoffset,this.offsetXYSlider.x=e.x,this.labelClass.symbol.yoffset=e.y,this.offsetYElement.value=this.labelClass.symbol.yoffset,this.offsetXYSlider.y=-e.y,this.notifySymbolChanges.emit(this.guid)}placementSelection(){var e;return this.layerDisplayType===n.l.cluster&&"binning"===(null===(e=this.layer.featureReduction)||void 0===e?void 0:e.type)||!([n.s.feature,n.s.csv,n.s.geojson,n.s.ogcFeature].indexOf(this.serviceType)>-1&&("point"===this.layerGeometryType||"multipoint"===this.layerGeometryType||"polyline"===this.layerGeometryType)||this.serviceType===n.s.mapImage&&("point"===this.layerGeometryType||"multipoint"===this.layerGeometryType||"polyline"===this.layerGeometryType))?null:(0,l.h)("calcite-label",{class:"placement-label"},this.strings.placement,(0,l.h)("calcite-select",{label:this.strings.placement,onCalciteSelectChange:e=>{this.labelClass.labelPlacement=e.currentTarget.selectedOption.value,this.notifySymbolChanges.emit(this.guid)},ref:e=>this.placementNode=e},this.getPlacementArray(this.layerGeometryType).map((e=>(0,l.h)("calcite-option",{value:e,selected:this.labelClass.labelPlacement===e},this.strings[e]||e)))))}render(){var e,t,i,s,o,d,b,p,f,m,y,g,u,v,C,k,w,L;const F=this.layerDisplayType===n.l.cluster&&"binning"===(null===(e=this.layer.featureReduction)||void 0===e?void 0:e.type),E=(0,l.h)("calcite-label",{key:"a6ceca97d2048d0eaad4be18ef4f34d8d9a7a6c4"},this.strings.font,(0,l.h)("calcite-button",{key:"54dfae2a8d8af3e0d2a2d879e19fd8f5ac1db07b",alignment:"icon-end-space-between",appearance:"outline-fill",kind:"neutral",iconEnd:"chevron-down",label:(0,h.f)(null===(i=null===(t=this.labelClass)||void 0===t?void 0:t.symbol)||void 0===i?void 0:i.font),width:"full",scale:"m",onClick:this.openFontPopover,ref:e=>this.fontNode=e},(0,h.f)(null===(o=null===(s=this.labelClass)||void 0===s?void 0:s.symbol)||void 0===o?void 0:o.font))),x=(0,l.h)("calcite-label",{key:"60a3a606ee4ad299f0e31b8b0ebd9ee33433d971"},this.strings.size,(0,l.h)("calcite-input-number",{key:"7d5d9b18471029a1a24f62189dcd9479235dc8b9",scale:"s",inputMode:"decimal",min:5,max:125,value:`${this.labelClass.symbol.font.size/.75||5}`,onCalciteInputNumberInput:e=>{this.waitOnUser(e,(e=>{this.labelClass.symbol.font.size=.75*Number(e.value),this.notifySymbolChanges.emit(this.guid)}),5)}})),P=(0,l.h)("div",{key:"b6e071a36e838e5d16f0c9f57f219439781c2cf5",class:"offset-div"},(0,l.h)("calcite-label",{key:"31cecf2a35db3523b6b9ba03cdbe0fac093859a2"},this.strings.offset,(0,l.h)("arcgis-xy-slider",{key:"8cf8838942ec71a245b70c6df294253374caeea8",ref:e=>{this.offsetXYSlider=e},x:this.labelClass.symbol.xoffset||0,y:-this.labelClass.symbol.yoffset||0,minX:this.minMaxOffset.minOffsetX,minY:this.minMaxOffset.minOffsetY,maxX:this.minMaxOffset.maxOffsetX,maxY:this.minMaxOffset.maxOffsetY,step:1,snappable:!0,onArcgisXYSliderInput:e=>{e.stopPropagation();const t=e.currentTarget;this.changeOffset({x:t.x||0,y:-t.y||0})}})),(0,l.h)("div",{key:"420125067eb23bc0b1264dc0bcc69eb3ef791fa2"},(0,l.h)("calcite-label",{key:"f536e1c1a22fb6a11d01ff43f6c2798eea6fc6b4",scale:"s"},this.strings.offsetX,(0,l.h)("calcite-input-number",{key:"17b9e1f18b9805f0b2fc206ac595c3b5a87d0949",scale:"s",placeholder:this.strings.offsetX,value:`${this.labelClass.symbol.xoffset||0}`,inputMode:"decimal",min:this.minMaxOffset.minOffsetX,max:this.minMaxOffset.maxOffsetX,ref:e=>{this.offsetXElement=e},onCalciteInputNumberInput:e=>{this.waitOnUser(e,(()=>{this.changeOffset({x:Number(this.offsetXElement.value)||0,y:Number(this.offsetYElement.value)||0})}),0)}})),(0,l.h)("calcite-label",{key:"a7be1377695a46216ce27af47d79eef00d20ec99",scale:"s"},this.strings.offsetY,(0,l.h)("calcite-input-number",{key:"3d17cb7f9d342eabb62c09c2e1b91f7d00645f84",scale:"s",placeholder:this.strings.offsetY,value:`${this.labelClass.symbol.yoffset||0}`,inputMode:"decimal",min:this.minMaxOffset.minOffsetY,max:this.minMaxOffset.maxOffsetY,ref:e=>{this.offsetYElement=e},onCalciteInputNumberInput:e=>{this.waitOnUser(e,(()=>{this.changeOffset({x:Number(this.offsetXElement.value)||0,y:Number(this.offsetYElement.value)||0})}),0)}})))),I=(0,l.h)("calcite-label",{key:"614c630e021a63b9eaa9244dc836ae240ea545a8",alignment:"start",layout:"inline-space-between"},this.strings.allowOverrun,(0,l.h)("calcite-switch",{key:"c32f8ae60ac57d46bf022d8f520576efbecb9226",scale:"s",checked:this.labelClass.allowOverrun,onCalciteSwitchChange:e=>{this.labelClass.allowOverrun=e.target.checked,this.notifySymbolChanges.emit(this.guid)}})),S=(0,l.h)("calcite-label",{key:"9ba098323de2e1bd5d06d81cd6138ab9bf3d60c4",alignment:"start",layout:"inline-space-between"},this.strings.repeatLabel,(0,l.h)("calcite-switch",{key:"c7bbc8388442fcc283e5291e364e128428e27b0c",scale:"s",checked:this.labelClass.repeatLabel,onCalciteSwitchChange:e=>{this.labelClass.repeatLabel=e.target.checked,this.reRender=!this.reRender,this.notifySymbolChanges.emit(this.guid)}})),R=(0,l.h)("calcite-label",{key:"e827c40cee226d8c9faf7b32e465d9ed4f9117d3"},this.strings.labelRepeat,(0,l.h)("calcite-input-number",{key:"faeb59558cc381115d3164ee92a542f5ddc1484a",disabled:!this.labelClass.repeatLabel,scale:"s",inputMode:"decimal",min:0,value:`${this.labelClass.repeatLabelDistance||0}`,onCalciteInputNumberInput:e=>{this.waitOnUser(e,(e=>{this.labelClass.repeatLabelDistance=Number(e.value),this.notifySymbolChanges.emit(this.guid)}),0)}})),T=this.panelElement&&(0,l.h)("calcite-block-section",{key:"7712e08f010465496893a095b7a390bc214f6ef5",id:"haloBlock_Id",text:this.strings.halo,toggleDisplay:"switch",open:!!this.labelClass.symbol.haloColor},(0,l.h)("calcite-label",{key:"a2b6d44029c248f6f27d24eaef08b5ab51431d58"},this.strings.color,(0,l.h)("arcgis-color-input",{key:"410a177a5cb94843c1654715036e924de20abbfc",id:"haloColorPicker_Id",color:(null===(d=this.labelClass.symbol.haloColor)||void 0===d?void 0:d.toHex())||"#ffffff",storageId:"arcgis-symbol-styler-storage-colors",popoverProps:{refElement:this.panelElement,placement:"leading-start",offsetDistance:-Math.round(this.panelElement.getBoundingClientRect().width),offsetSkidding:50},onArcgisColorInputChange:async e=>{const t=e.target.color;await(0,a.l)(["esri/Color"]).then((([e])=>{const i=this.labelClass.symbol.haloColor.a;this.labelClass.symbol.haloColor=new e(t),this.labelClass.symbol.haloColor.a=i,this.notifySymbolChanges.emit(this.guid)}))},onArcgisColorInputPopoverOpen:()=>{setTimeout((()=>{this.fontNode.disabled=!0,this.placementNode&&(this.placementNode.disabled=!0)}),200)},onArcgisColorInputPopoverClose:()=>{this.fontNode.disabled=!1,this.placementNode&&(this.placementNode.disabled=!1)}})),(0,l.h)("calcite-label",{key:"b2b3a5039961ce8934ede269f60f88b9d1bc58c0"},this.strings.transparency,(0,l.h)("arcgis-slider-input",{key:"fe3cc12bbc32192df28ced333cc66dc9f85aa6cc",min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,r.a)(null!==(p=null===(b=this.labelClass.symbol.haloColor)||void 0===b?void 0:b.a)&&void 0!==p?p:1)),onArcgisSliderInputValueChange:e=>{const t=e.detail,i=(0,r.t)(t);this.labelClass.symbol.haloColor.a=i,this.notifySymbolChanges.emit(this.guid),(0,l.f)(this.hostElement)},withSteppers:!this.narrow,label:this.strings.transparency})),(0,l.h)("calcite-label",{key:"bf7c605b4a9685af32cef2496c89e2632eb420f4"},this.strings.size,(0,l.h)("calcite-input-number",{key:"587a88264618f4921635c36c7c9a624603016557",scale:"s",inputMode:"decimal",min:1,max:10,value:`${Math.round(this.labelClass.symbol.haloSize/.75||1)}`,onCalciteInputNumberInput:e=>{this.waitOnUser(e,(e=>{this.labelClass.symbol.haloSize=.75*Number(e.value),this.notifySymbolChanges.emit(this.guid)}),1)}}))),D=this.panelElement&&(0,l.h)("calcite-block-section",{key:"392d708b3db916523d0db948204817b6e269cef6",id:"backgroundBlock_Id",text:this.strings.background,toggleDisplay:"switch",open:!!this.labelClass.symbol.backgroundColor},(0,l.h)("calcite-label",{key:"0081c7ae04cae29ab4071ecdb3337a90c479afb4"},this.strings.color,(0,l.h)("arcgis-color-input",{key:"595cfd932e9c5437dd6d6eb92e98c78d2ea4e27e",id:"backgroundColorPicker_Id",color:(null===(f=this.labelClass.symbol.backgroundColor)||void 0===f?void 0:f.toHex())||"#ffffff",storageId:"arcgis-symbol-styler-storage-colors",popoverProps:{refElement:this.panelElement,placement:"leading-start",offsetDistance:-Math.round(this.panelElement.getBoundingClientRect().width),offsetSkidding:50},onArcgisColorInputChange:async e=>{const t=e.target.color;await(0,a.l)(["esri/Color"]).then((([e])=>{const i=this.labelClass.symbol.backgroundColor.a;this.labelClass.symbol.backgroundColor=new e(t),this.labelClass.symbol.backgroundColor.a=i,this.notifySymbolChanges.emit(this.guid)}))},onArcgisColorInputPopoverOpen:()=>{setTimeout((()=>{this.fontNode.disabled=!0,this.placementNode&&(this.placementNode.disabled=!0)}),200)},onArcgisColorInputPopoverClose:()=>{this.fontNode.disabled=!1,this.placementNode&&(this.placementNode.disabled=!1)}})),(0,l.h)("calcite-label",{key:"71584d52ddae309c31a6e2fbb618bad2eec347b3"},this.strings.transparency,(0,l.h)("arcgis-slider-input",{key:"1c1b798c669c3ddcf6e28d20e4af2e1107ab0a4a",min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,r.a)(null!==(y=null===(m=this.labelClass.symbol.backgroundColor)||void 0===m?void 0:m.a)&&void 0!==y?y:1)),onArcgisSliderInputValueChange:e=>{const t=e.detail,i=(0,r.t)(t);this.labelClass.symbol.backgroundColor.a=i,this.notifySymbolChanges.emit(this.guid),(0,l.f)(this.hostElement)},withSteppers:!this.narrow,label:this.strings.transparency})),(0,l.h)("calcite-label",{key:"a953832d6f7f09f915a3c9a2c3b78847d7a16680"},this.strings.outlineColor,(0,l.h)("arcgis-color-input",{key:"870b4cc87f5101345e602cdb76b777d1a44b8f83",id:"borderLineColorPicker_Id",color:(null===(g=this.labelClass.symbol.borderLineColor)||void 0===g?void 0:g.toHex())||"#ffffff",storageId:"arcgis-symbol-styler-storage-colors",popoverProps:{refElement:this.panelElement,placement:"leading-start",offsetDistance:-Math.round(this.panelElement.getBoundingClientRect().width),offsetSkidding:50},onArcgisColorInputChange:async e=>{const t=e.target.color;await(0,a.l)(["esri/Color"]).then((([e])=>{const i=this.labelClass.symbol.borderLineColor.a;this.labelClass.symbol.borderLineColor=new e(t),this.labelClass.symbol.borderLineColor.a=i,this.notifySymbolChanges.emit(this.guid)}))},onArcgisColorInputPopoverOpen:()=>{setTimeout((()=>{this.fontNode.disabled=!0,this.placementNode&&(this.placementNode.disabled=!0)}),200)},onArcgisColorInputPopoverClose:()=>{this.fontNode.disabled=!1,this.placementNode&&(this.placementNode.disabled=!1)}})),(0,l.h)("calcite-label",{key:"b3b42580fc34aeafee0dbef574ddbcb01d27597b"},this.strings.outlineTransparency,(0,l.h)("arcgis-slider-input",{key:"6a5276636f104c1a23b9ad0deb9f0dd2b6c5e770",min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,r.a)(null!==(v=null===(u=this.labelClass.symbol.borderLineColor)||void 0===u?void 0:u.a)&&void 0!==v?v:1)),onArcgisSliderInputValueChange:e=>{const t=e.detail,i=(0,r.t)(t);this.labelClass.symbol.borderLineColor.a=i,this.notifySymbolChanges.emit(this.guid),(0,l.f)(this.hostElement)},withSteppers:!this.narrow,label:this.strings.transparency})),(0,l.h)("calcite-label",{key:"20778f0cdab9e26a46295ff50d649599fe752004"},this.strings.outlineWidth,(0,l.h)("calcite-input-number",{key:"62a3000cf4758d15a8ab0472bef453956638db2e",id:"borderLineSizePicker_Id",scale:"s",inputMode:"decimal",min:0,max:18,value:`${null!==(C=this.labelClass.symbol.borderLineSize/.75)&&void 0!==C?C:1}`,onCalciteInputNumberInput:e=>{this.waitOnUser(e,(e=>{this.labelClass.symbol.borderLineSize=.75*Number(e.value),this.notifySymbolChanges.emit(this.guid)}),5)}}))),N=this.labelContentRefElement.getBoundingClientRect();return(0,l.h)(l.H,{key:"d808f3688e60bb8b472711ecb6c93a665f678252",class:"js-app-flyout"},(0,l.h)("calcite-popover",{key:"9ec6f25308397d81d3fa4e16b0a9cd8f7e84e279",dir:(0,c.g)(this.hostElement),id:"managePopover_Id",placement:"leading-start",open:this.isOpen,pointerDisabled:!0,referenceElement:this.labelContentRefElement,offsetDistance:-Math.round(this.labelContentRefElement.getBoundingClientRect().width),offsetSkidding:50,label:this.strings.labelStyle,style:{zIndex:"100"},triggerDisabled:!0,ref:e=>this.popoverNode=e},(0,l.h)("calcite-panel",{key:"4d90a39b02bb4933914231e66eae236e2ecba580",ref:e=>this.panelElement=e,closable:!0,class:"panel",style:{width:`${N.width}px`,maxHeight:.8*N.height+"px"},onCalcitePanelClose:()=>this.closeLabelPopovers.emit()},(0,l.h)("div",{key:"8b768717bd721fc2d440b60a47033652d6bd6245",slot:"header-content"},this.strings.labelStyle),(0,l.h)("calcite-block",{key:"f9a7c567aeecf3e5dfb6199f8000f084b0672a80",heading:"",collapsible:!1,open:!0},E," ",x,(0,l.h)("calcite-label",{key:"0e11afd364ed7405547297a4cca0ce7d97a76e19"},this.strings.color,this.panelElement&&(0,l.h)("arcgis-color-input",{key:"64d8cbeaa616a0cae458251dd2cfec3bf4e0b715",color:(null===(k=this.labelClass.symbol.color)||void 0===k?void 0:k.toHex())||"#ffffff",storageId:"arcgis-symbol-styler-storage-colors",popoverProps:{refElement:this.panelElement,placement:"leading-start",offsetDistance:-Math.round(this.panelElement.getBoundingClientRect().width),offsetSkidding:50,maxHeight:.8*N.height-52+"px"},onArcgisColorInputChange:async e=>{const t=e.target.color;await(0,a.l)(["esri/Color"]).then((([e])=>{const i=this.labelClass.symbol.color.a;this.labelClass.symbol.color=new e(t),this.labelClass.symbol.color.a=i,this.notifySymbolChanges.emit(this.guid)}))},onArcgisColorInputPopoverOpen:()=>{setTimeout((()=>{this.fontNode.disabled=!0,this.placementNode&&(this.placementNode.disabled=!0)}),200)},onArcgisColorInputPopoverClose:()=>{this.fontNode.disabled=!1,this.placementNode&&(this.placementNode.disabled=!1)}})),(0,l.h)("calcite-label",{key:"83d49062150c0bbd0383c0da94e444029efafc7a"},this.strings.transparency,(0,l.h)("arcgis-slider-input",{key:"ce77ed63db33a608174e2d14065bdc9e6e80434b",min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,r.a)(null!==(L=null===(w=this.labelClass.symbol.color)||void 0===w?void 0:w.a)&&void 0!==L?L:1)),onArcgisSliderInputValueChange:e=>{const t=e.detail,i=(0,r.t)(t);this.labelClass.symbol.color.a=i,this.notifySymbolChanges.emit(this.guid),(0,l.f)(this.hostElement)},withSteppers:!this.narrow,label:this.strings.transparency})),T,"polyline"!==this.layerGeometryType&&D,this.placementSelection(),F||"polyline"!==this.layerGeometryType?P:null,F||"polyline"!==this.layerGeometryType?null:(0,l.h)("div",null,I," ",S," ",R)))))}waitOnUser(e,t,i){const l=e.target;this.typingHndl&&(clearTimeout(this.typingHndl),this.typingHndl=void 0);const s=l.value,a=parseFloat(s);s?(0,r.i)(l.min)&&(0,r.i)(l.max)&&(l.min>a||l.max<a)?this.typingHndl=setTimeout((()=>{this.typingHndl=void 0,l.min>a?(l.value=`${l.min}`,t(l)):l.max<a&&(l.value=`${l.max}`,t(l))}),750):("-"!==s[0]||0!==a&&!isNaN(a))&&t(l):this.typingHndl=setTimeout((()=>{this.typingHndl=void 0,l.value=`${i}`,t(l)}),2e3)}get hostElement(){return(0,l.d)(this)}};L.style=".offset-div{align-items:center;display:flex;justify-content:space-between;gap:16px}.placement-label{margin-top:12px}"},46227:(e,t,i)=>{i.d(t,{g:()=>l});const l=()=>[2,1,1,1,3].map((e=>{let t="";for(let i=0;i<e;i++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t})).join("-")},10699:(e,t,i)=>{i.d(t,{c:()=>r});var l=i(20536);const s=e=>!("isConnected"in e)||e.isConnected,a=((e,t)=>{let i;return(...l)=>{i&&clearTimeout(i),i=setTimeout((()=>{i=0,e(...l)}),t)}})((e=>{for(let t of e.keys())e.set(t,e.get(t).filter(s))}),2e3),o=e=>"function"==typeof e?e():e,n=(e,t)=>{const i=e.indexOf(t);i>=0&&(e[i]=e[e.length-1],e.length--)},r=(e,t)=>{const i=((e,t=(e,t)=>e!==t)=>{const i=o(e);let l=new Map(Object.entries(null!=i?i:{}));const s={dispose:[],get:[],set:[],reset:[]},a=()=>{var t;l=new Map(Object.entries(null!==(t=o(e))&&void 0!==t?t:{})),s.reset.forEach((e=>e()))},r=e=>(s.get.forEach((t=>t(e))),l.get(e)),c=(e,i)=>{const a=l.get(e);t(i,a,e)&&(l.set(e,i),s.set.forEach((t=>t(e,i,a))))},d="undefined"==typeof Proxy?{}:new Proxy(i,{get:(e,t)=>r(t),ownKeys:e=>Array.from(l.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>l.has(t),set:(e,t,i)=>(c(t,i),!0)}),h=(e,t)=>(s[e].push(t),()=>{n(s[e],t)});return{state:d,get:r,set:c,on:h,onChange:(t,i)=>{const l=h("set",((e,l)=>{e===t&&i(l)})),s=h("reset",(()=>i(o(e)[t])));return()=>{l(),s()}},use:(...e)=>{const t=e.reduce(((e,t)=>(t.set&&e.push(h("set",t.set)),t.get&&e.push(h("get",t.get)),t.reset&&e.push(h("reset",t.reset)),t.dispose&&e.push(h("dispose",t.dispose)),e)),[]);return()=>t.forEach((e=>e()))},dispose:()=>{s.dispose.forEach((e=>e())),a()},reset:a,forceUpdate:e=>{const t=l.get(e);s.set.forEach((i=>i(e,t,t)))}}})(e,t);return i.use((()=>{if("function"!=typeof l.a)return{};const e=new Map;return{dispose:()=>e.clear(),get:t=>{const i=(0,l.a)();i&&((e,t,i)=>{const l=e.get(t);l?l.includes(i)||l.push(i):e.set(t,[i])})(e,t,i)},set:t=>{const i=e.get(t);i&&e.set(t,i.filter(l.f)),a(e)},reset:()=>{e.forEach((e=>e.forEach(l.f))),a(e)}}})()),i}},1834:(e,t,i)=>{i.d(t,{l:()=>l});const l=(0,i(10699).c)({layer:null,mapView:null,portal:null,config:null,strings:null,currentLanguage:null,layerGeometryType:null,serviceType:null,layerDisplayType:null}).state}}]);