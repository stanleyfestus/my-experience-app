/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-modal-a-9f96b7.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-modal-a-9f96b7"],{75608:(e,t,i)=>{i.r(t),i.d(t,{arcgis_modal_arcade:()=>n});var s=i(20536),a=i(98034),r=i(37568);i(99004),i(91102),i(73807),i(34752);const n=class{constructor(e){(0,s.r)(this,e),this.arcgisModalArcadeClose=(0,s.c)(this,"arcgisModalArcadeClose",7),this.hideDocumentationActions=!1,this.arcadeScript=void 0,this.arcadeProfile=void 0,this.testData=void 0,this.suggestions=void 0,this.returnPredictOutputType=!0,this.arcadeTitle=void 0,this.arcadeTitleEditable=!1,this.arcadeTitleEditingEnabled=!1,this.addExistingExpressions=!1,this.layer=void 0,this.scriptInvalid=!0,this.hasChanges=!1}async componentWillLoad(){var e;if(console.warn("%capp-components","background: #007AC2; color: #fff; border-radius: 4px; padding: 2px 4px;",'[arcgis-modal-arcade] component in @arcgis/app-components is deprecated and will be removed in a future version. Use "arcgis-modal-arcade" from @arcgis/map-config-components instead.'),[this.strings,this.currentLanguage]=await(0,r.g)(this.hostElement),await this.loadAllModules(),this.addExistingExpressions&&this.layer){const t=this.getExistingExpressions();t&&((null===(e=this.suggestions)||void 0===e?void 0:e.length)?this.suggestions.push(t):this.suggestions=[t])}this.arcadeScript.length&&(this.scriptInvalid=!1)}async loadAllModules(){[this.arcade,this.arcadeUtils]=await(0,a.l)(["esri/arcade","esri/layers/support/arcadeUtils"])}async getOutputType(){try{const e=await this.arcadeEditor.getTestResult();switch(null==e?void 0:e.type){case"boolean":case"date":case"time":case"dateOnly":case"dictionary":case"number":return e.type;case"text":return"string";default:return null}}catch(e){return null}}getExistingExpressions(){if("subtype-sublayer"===this.layer.type)return{label:this.strings.existing,suggestions:[]};const e=this.arcadeUtils.getExpressionsFromLayer(this.layer).map((e=>{var t;return{label:(null==e?void 0:e.title)||(null==e?void 0:e.name)||this.strings.newExpression,description:this.getStringFromProfileName(null===(t=e.profileInfo)||void 0===t?void 0:t.name),code:e.expression}}));return{label:this.strings.existing,suggestions:(null==e?void 0:e.length)?e:[]}}getStringFromProfileName(e){switch(e){case"form-constraint":return this.strings.constraint;case"feature-z":return this.strings.featureZ;case"form-calculation":return this.strings.formCalculation;case"labeling":return this.strings.labeling;case"popup":return this.strings.popup;case"popup-element":return this.strings.popupElement;case"feature-reduction-popup":return this.strings.featureReductionPopup;case"feature-reduction-popup-element":return this.strings.featureReductionPopupElement;case"visualization":return this.strings.visualization;case"field-calculation":return this.strings.fieldCalculation;case"aggregate-field":return this.strings.aggregateField;default:return this.strings.unknown}}render(){return(0,s.h)(s.H,{key:"675b5752f2b2a299ebb92affd66fbbe7b9bc6310"},(0,s.h)("calcite-dialog",{key:"14b60f2d45121662670e2274a3299f0e6cdd5f72",class:"arcade-dialog",open:!0,modal:!0,scale:"l",escapeDisabled:!0,outsideCloseDisabled:!0,onCalciteDialogClose:()=>this.arcgisModalArcadeClose.emit()},(0,s.h)("div",{key:"1bc96b31fe4b2a9e83ae188f7d4ef8c30f1de1c1",slot:"header-content",class:"header"},this.arcadeTitle&&this.arcadeTitleEditable?(0,s.h)("calcite-inline-editable",{scale:"l",editingEnabled:this.arcadeTitleEditingEnabled,messageOverrides:{cancelEditing:this.strings.cancel,enableEditing:this.strings.edit,confirmChanges:this.strings.done}},(0,s.h)("calcite-input",{ref:e=>this.arcadeTitleInput=e,alignment:"start",placeholder:this.strings.titlePlaceHolder,scale:"l",type:"text",value:this.arcadeTitle||this.strings.newExpression,onCalciteInputInput:()=>this.hasChanges=!0})):this.arcadeTitle||this.strings.newExpression),(0,s.h)("arcgis-arcade-editor",{key:"f7454a91eace9ccab0c32896b93cc28e0745f8ff",class:"arcade-editor",ref:e=>this.arcadeEditor=e,hideDocumentationActions:this.hideDocumentationActions,script:this.arcadeScript,profile:this.arcadeProfile,testData:this.testData,suggestions:this.suggestions,onArcgisDiagnosticsChange:async e=>{var t;const i=e.detail;if(null==i?void 0:i.length){for(let e=0;e<i.length;e++)if(1===(null===(t=i[e])||void 0===t?void 0:t.severity))return this.scriptInvalid=!0,void(this.hasChanges=!0);this.scriptInvalid=!1}else this.scriptInvalid=!1;if(!this.hasChanges){const e=await this.arcadeEditor.getScript();this.hasChanges=this.arcadeScript!==e}}}),(0,s.h)("calcite-button",{key:"ecc94e8e3770cf65ae2ab961786f67dab07b204a",slot:"footer-end",appearance:"outline-fill",alignment:"center",scale:"m",onClick:()=>this.arcgisModalArcadeClose.emit()},this.strings.cancel),(0,s.h)("calcite-button",{key:"42f81c7f914f8493bc1ac84a2c771eabe55d4e1a",slot:"footer-end",alignment:"center",appearance:"solid",scale:"m",disabled:this.scriptInvalid||!this.hasChanges,onClick:async()=>{var e;this.arcgisModalArcadeClose.emit(Object.assign(Object.assign({script:await this.arcadeEditor.getScript()},this.arcadeTitle&&{title:(null===(e=this.arcadeTitleInput.value)||void 0===e?void 0:e.trim())||this.strings.newExpression}),this.returnPredictOutputType&&{predictOutputType:await this.getOutputType()}))}},this.strings.done)))}get hostElement(){return(0,s.d)(this)}};n.style=".arcade-dialog.sc-arcgis-modal-arcade{top:7.5%;left:7.5%;right:7.5%;--calcite-dialog-size-x:85%;--calcite-dialog-size-y:85%}.header.sc-arcgis-modal-arcade{width:55%}.arcade-editor.sc-arcgis-modal-arcade{width:100%;height:100%}arcgis-arcade-editor.sc-arcgis-modal-arcade{z-index:var(--calcite-z-index-header)1}"}}]);