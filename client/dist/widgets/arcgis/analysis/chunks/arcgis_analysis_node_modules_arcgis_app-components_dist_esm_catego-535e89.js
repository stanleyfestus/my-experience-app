/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_catego-535e89.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_catego-535e89"],{29259:(e,r,n)=>{n.d(r,{U:()=>t,a:()=>l,b:()=>o,g:()=>i});const t="/Categories",o=(e,r,n=!0)=>{const t=null!=e?e:"";return`${t}${t.endsWith("/")?"":"/"}${n?r.title.toLocaleLowerCase():r.title}`};function i(e){var r;let n=null===(r=null==e?void 0:e[0])||void 0===r?void 0:r.title;return n&&"/"!==n.charAt(0)&&(n=`/${n}`),n||t}const l=(e,r)=>`${e.replace(/\/([^\/]+)$/,`/${r}`)}`},86980:(e,r,n)=>{n.d(r,{a:()=>v,b:()=>d,c:()=>p,d:()=>m,f:()=>c,g:()=>s,u:()=>g});var t=n(25972),o=n(29259),i=n(44090),l=n(59377),u=n(68537),a=n(38973);const s=async({portal:e,user:r,group:n,useCache:t=!1})=>{var o;try{const i=await(n?d(n.id,e,t):c(e,r,t));return{result:null!==(o=null==i?void 0:i.categorySchema)&&void 0!==o?o:null}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}};async function c(e,r,n=!0){if(null!=e||(e=i.c.portal),null!=r||(r=i.c.user),!(null==e?void 0:e.id)||r&&(0,u.b)(r))return null;const o=()=>(0,t.r)(`${(0,a.g)(e)}portals/${e.id}/categorySchema`);return n?(0,t.f)(o,"categorySchema",e.id):o()}async function d(e,r,n=!0){if(null!=r||(r=null===i.c||void 0===i.c?void 0:i.c.portal),!e||!r)return null;const o=()=>(0,t.r)(`${(0,l.a)(r,{id:e})}categorySchema`);return n?(0,t.f)(o,"categorySchema",e):o()}async function p(e,r,n=!0){if(null!=e||(e=i.c.portal),null!=r||(r=i.c.user),!(null==e?void 0:e.id)||r&&(0,u.b)(r))return null;const o=()=>(0,t.r)(`${(0,a.g)(e)}portals/${e.id}/memberCategorySchema`);return n?(0,t.f)(o,"memberCategorySchema",e.id):o()}async function v(e,r,n=!0){const o=()=>async function(e,r){var n;const o=(0,a.g)(e),i=(0,a.e)(e),u=await(0,t.r)(`${o}portals/self?culture=${i}`),s=await(0,t.r)(`${o}community/groups?q=${u.contentCategorySetsGroupQuery}`),c=null===(n=null==s?void 0:s.results)||void 0===n?void 0:n[0],d=(await(0,t.r)((0,l.g)(e,c),{q:`typekeywords: ${r}`})).results[0];return(0,t.r)(`${o}content/items/${d.id}/data`)}(e,r);return n?(0,t.f)(o,"categorySchema",r):o()}async function g({categories:e,itemIds:r,portal:n}){try{const o=`${(0,a.g)(n)}/content/updateItems`,i=JSON.stringify(r.map((r=>({[r]:{categories:Array.isArray(e)?e:e[r]}}))));return{result:await(0,t.r)(o,{items:i},{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}const m=async({path:e,portal:r,group:n,updateInfo:t})=>{try{const i=(await f({category:e,portal:r,group:n,num:1})).total;if(0===i)return console.warn(`No items found with category ${e} when updating schema`),{};const l=100,u=Math.ceil(i/l),a=[];for(let i=0;i<u;i++)a.push(f({category:e,portal:r,group:n,start:i*l,num:l}).then((({results:r})=>{const n={};return r.forEach((r=>{const i="change-title"===t.type?r.categories.map((r=>{const n=(0,o.a)(e,t.newTitle);return r===e?n:r.replace(`${e}/`,`${n}/`)})):r.categories.filter((r=>!r.startsWith(e)));n[r.id]=i})),n})));const s=await Promise.all(a);return await Promise.all(s.map((e=>g({categories:e,itemIds:Object.keys(e),portal:r})))),{}}catch(r){return console.error(`Error ${t.type} items schema from path ${e}:`,r),{error:{code:"unhandledError"}}}},f=({category:e,num:r=100,start:n=0,portal:o,group:i})=>{const u={start:n,num:r,categories:JSON.stringify([e])},s=i?(0,l.g)(o,i):`${(0,a.g)(o)}search`;return(0,t.r)(s,Object.assign(Object.assign({},u),{q:i?void 0:`orgid: ${o.id}`}))}},59377:(e,r,n)=>{n.d(r,{a:()=>o,g:()=>i});var t=n(38973);const o=(e,r)=>(0,t.a)(`${(0,t.g)(e)}community/groups/${r.id}`),i=(e,r)=>`${((e,r)=>(0,t.a)(`${(0,t.g)(e)}content/groups/${r.id}`))(e,r)}search`},68537:(e,r,n)=>{n.d(r,{a:()=>u,b:()=>i,c:()=>l,d:()=>g,e:()=>v,f:()=>p,g:()=>m,h:()=>h,i:()=>s,j:()=>f,k:()=>C,l:()=>a,m:()=>y,n:()=>d,o:()=>k,p:()=>b,q:()=>w,r:()=>T,s:()=>S,t:()=>I,u:()=>_,v:()=>E,w:()=>c,x:()=>P});var t=n(78231);const o=e=>{var r,n,t;return"string"==typeof(null==e?void 0:e.role)&&(null==e?void 0:e.role)?null==e?void 0:e.role:null!==(n=null!==(r=null==e?void 0:e.roleId)&&void 0!==r?r:null==e?void 0:e.id)&&void 0!==n?n:null===(t=null==e?void 0:e.sourceJSON)||void 0===t?void 0:t.id};function i(e){return e&&!e.orgId}function l(e,r){return(0,t.u)(e,r)||"update"===e.itemControl||(0,t.c)([e],r)&&v(r)}function u(e,r){const n=(0,t.c)([e],r),o=(0,t.u)(e,r)||v(r)&&n,i=m(r)&&$(r);return!!(o||n&&i)}const a=e=>{var r;return!!(null===(r=null==e?void 0:e.privileges)||void 0===r?void 0:r.includes("portal:admin:manageLicenses"))};function s(e){return["Trial Developer","Developer","Developer Subscription"].includes(null==e?void 0:e.type)}function c(e){return["Developer Subscription"].includes(null==e?void 0:e.type)}function d(e){return["Geoanalytics Engine","GeoAnalytics MS Fabric"].includes(null==e?void 0:e.type)}const p=e=>{var r;return null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.includes("Developer")};function v(e){return"org_admin"===o(e)||"account_admin"===o(e)}function g(e){return["org_admin","account_admin"].includes(o(e))&&!(null==e?void 0:e.roleId)}function m(e){return!!(null==e?void 0:e.roleId)&&e.roleId.length>0}function f(e){var r;return!!(null===(r=null==e?void 0:e.privileges)||void 0===r?void 0:r.includes("portal:admin:updateItemCategorySchema"))}function h(e){var r;return!!(null===(r=null==e?void 0:e.privileges)||void 0===r?void 0:r.includes("portal:admin:updateGroups"))}function y(e){var r;return!!(null===(r=null==e?void 0:e.privileges)||void 0===r?void 0:r.includes("portal:admin:assignToGroups"))}const $=e=>{var r;return!!(null===(r=null==e?void 0:e.privileges)||void 0===r?void 0:r.includes("portal:admin:deleteItems"))};function b(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToGroup")}function w(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToOrg")}function I(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToPublic")}function S(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToOrg")}function _(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToPublic")}function T(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToGroup")}function C(e,r,n,t){const o=t&&!["Trial","Trial Press","Trial Developer","Developer Subscription","Evaluation"].includes(t.type),i=((null==r?void 0:r.privileges)||[]).includes("portal:admin:manageCollaborations");return!(!(null==e?void 0:e.collaborationsEnabled)||!r||!v(r)&&!i||!(null==n?void 0:n.isPortal)&&!o)}function P(e){return!!e&&(!m(e)||m(e)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:viewItems")}(e))}const E=({items:e,user:r,portal:n})=>{const o=e[0],i=o.owner;if(n.isPortal&&i!==r.username&&i.includes("esri_")&&!["esri_livingatlas"].includes(i))return!1;const u=(0,t.u)(o,r),a=m(r),s=O(r),c=l(o,r)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:updateItems")}(r)&&!a&&(function(e,r){return!function(e){return!(!e.urlKey||!e.customBaseUrl)||!!e.isPortal}(r)||b(e)||w(e)||!!r.canSharePublic&&I(e)}(r,n)||O(r));return u||c||(0,t.c)(e,r)&&s};function O(e){return T(e)||S(e)||_(e)}function k(e){const r=["portal:user:createItem","portal:user:viewOrgItems","premium:publisher:createNotebooks","portal:publisher:createDataPipelines","features:user:edit","features:user:fullEdit","portal:admin:viewItems","portal:admin:updateItems","portal:admin:deleteItems"];return e.some((e=>r.includes(e)))}}}]);