/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.2
 */
import{r as t,c as e,h as s,H as i,g as n}from"./p-67e556ed.js";import{c as a,d as o}from"./p-7d12dfb4.js";import{u as r,I as c}from"./p-49632699.js";import{f as h,c as l,d}from"./p-bf4dc8d8.js";import{u,c as f,d as m,s as p}from"./p-3a1a720c.js";import{c as b,s as g,a as y}from"./p-1f5a7c5e.js";import{c as C,d as w,a as I,H as v}from"./p-ba8765a4.js";import"./p-0fb1c54a.js";import"./p-57e1e048.js";import"./p-7f97e86a.js";import"./p-d2b212f4.js";import"./p-cfc4daa3.js";import"./p-06c0de26.js";import"./p-4dd99f61.js";const j={offset:"offset"};const T=60;function Z(t){const e="âˆ’";const s="-";return t.replace(":15",".25").replace(":30",".5").replace(":45",".75").replace(e,s)}function x(t,e){const s=R(t,"en-US",e).replace("GMT","");if(s===""){return 0}return Number(Z(s))*T}function D(){const t=new Date;return t.getTimezoneOffset()*-1}function k(){const t=new Intl.DateTimeFormat;return t.resolvedOptions().timeZone}async function L(t){if(t==="offset"){return t=>t}const{normalize:e}=await import("./p-74ed8773.js");return e}async function B(t,e,s,i,n){if(s==="name"){const{groupByName:t}=await import("./p-bd5fa183.js");const e=await t();return e.map((({label:t})=>{const e=E(t);const s=t;return{label:e,value:s,metadata:{filterValue:t}}})).filter((t=>!!t)).sort()}const a=n==="user"?t:n==="utc"?"fr":"en-GB";const o=i.getTime();if(s==="region"){const[{groupByRegion:t},{getCountry:s,global:i}]=await Promise.all([import("./p-4d856eef.js"),import("./p-0bad7059.js")]);const n=await t();return n.map((({label:t,tzs:n})=>{n.sort(((t,s)=>{const i=M(t,e);const n=M(s,e);const a="Etc/GMT";if(t.startsWith(a)&&s.startsWith(a)){const e=t.substring(a.length);const i=s.substring(a.length);const n=e===""?0:parseInt(e);const o=i===""?0:parseInt(i);return o-n}return i.localeCompare(n)}));return{label:P(e,t),items:n.map((n=>{const r=Z(R(n,a,o));const c=M(n,e);const h=t===i?`${M(i,e)} Etc`:E(n);const l=s(n);const d=P(e,l);return{label:c,value:n,metadata:{country:d===c?undefined:d,filterValue:h,offset:r}}}))}})).sort(((t,e)=>t.label===i?-1:e.label===i?1:t.label.localeCompare(e.label)))}const[{groupByOffset:r},{DateEngine:c}]=await Promise.all([import("./p-56652f71.js"),import("./p-adcebd2c.js")]);const h=await r({dateEngine:new c,groupDateRange:1,startDate:new Date(o).toISOString()});const l=new Intl.ListFormat(t,{style:"long",type:"conjunction"});const d=["Factory","Etc/UTC"];h.forEach((t=>{const e=[];let s=0;t.tzs.forEach(((t,i)=>{if(d.includes(t)){s++}e[i]=s}));t.tzs=t.tzs.filter((t=>!d.includes(t)));t.labelTzIdx=t.labelTzIdx.map((t=>t-e[t])).filter((e=>e>=0&&e<t.tzs.length))}));return h.map((({labelTzIdx:t,tzs:s})=>{const i=s[0];const n=Z(R(i,a,o));const r=x(i,o);const c=t.map((t=>M(s[t],e)));const h=V(e,n,l.format(c));return{label:h,value:r,metadata:{filterValue:s.map((t=>E(t)))}}})).filter((t=>!!t)).sort(((t,e)=>t.value-e.value))}function M(t,e){return e[t]||z(t)}function O(t,e,s){const i=s.timeZoneRegionLabel;return i.replace("{city}",t).replace("{country}",P(s,e))}function P(t,e){return t[e]||e}function z(t){return t.split("/").pop()}function E(t){return t.replace(/_/g," ")}function V(t,e,s){return t.timeZoneLabel.replace("{offset}",e).replace("{cities}",s)}function R(t,e,s=Date.now()){const i=h(e,{timeZone:t,timeZoneName:"shortOffset"});const n=i.formatToParts(s);return n.find((({type:t})=>t==="timeZoneName")).value}function F(t){return t.items!==undefined}function N(t){return F(t[0])?t.flatMap((t=>t.items)):t}function S(t,e,s){return s==null?null:N(t).find((t=>t[e]==s))}const _=":host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:block}.offset{white-space:nowrap}:host([hidden]){display:none}[hidden]{display:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}::slotted(input[slot=hidden-form-input]){margin:0 !important;opacity:0 !important;outline:none !important;padding:0 !important;position:absolute !important;inset:0 !important;transform:none !important;-webkit-appearance:none !important;z-index:-1 !important}";const G=_;const U=class{constructor(s){t(this,s);this.calciteInputTimeZoneBeforeClose=e(this,"calciteInputTimeZoneBeforeClose",6);this.calciteInputTimeZoneBeforeOpen=e(this,"calciteInputTimeZoneBeforeOpen",6);this.calciteInputTimeZoneChange=e(this,"calciteInputTimeZoneChange",6);this.calciteInputTimeZoneClose=e(this,"calciteInputTimeZoneClose",6);this.calciteInputTimeZoneOpen=e(this,"calciteInputTimeZoneOpen",6);this.setComboboxRef=t=>{this.comboboxEl=t};this.onComboboxBeforeClose=t=>{t.stopPropagation();this.overrideSelectedLabelForRegion(false);this.calciteInputTimeZoneBeforeClose.emit()};this.onComboboxBeforeOpen=t=>{t.stopPropagation();this.overrideSelectedLabelForRegion(true);this.calciteInputTimeZoneBeforeOpen.emit()};this.onComboboxChange=t=>{t.stopPropagation();const e=t.target;const s=e.selectedItems[0];if(!s){this.value=null;this.selectedTimeZoneItem=null;this.calciteInputTimeZoneChange.emit();return}const i=this.findTimeZoneItemByLabel(s.getAttribute("data-label"));const n=`${i.value}`;if(this.value===n&&i.label===this.selectedTimeZoneItem.label){return}this.value=n;this.selectedTimeZoneItem=i;this.calciteInputTimeZoneChange.emit()};this.onComboboxClose=t=>{t.stopPropagation();this.open=false;this.calciteInputTimeZoneClose.emit()};this.onComboboxOpen=t=>{this.open=true;t.stopPropagation();this.calciteInputTimeZoneOpen.emit()};this.clearable=false;this.disabled=false;this.form=undefined;this.maxItems=0;this.messages=undefined;this.messageOverrides=undefined;this.mode="offset";this.offsetStyle="user";this.validationMessage=undefined;this.validationIcon=undefined;this.validity={valid:false,badInput:false,customError:false,patternMismatch:false,rangeOverflow:false,rangeUnderflow:false,stepMismatch:false,tooLong:false,tooShort:false,typeMismatch:false,valueMissing:false};this.name=undefined;this.open=false;this.overlayPositioning="absolute";this.referenceDate=undefined;this.required=false;this.scale="m";this.status="idle";this.value=undefined;this.readOnly=false;this.defaultMessages=undefined;this.effectiveLocale=""}onMessagesChange(){}handleTimeZoneItemPropsChange(){if(!this.timeZoneItems){return}this.updateTimeZoneItems();this.updateTimeZoneSelection()}openChanged(){this.comboboxEl.open=this.open}handleValueChange(t,e){t=this.normalizeValue(t);if(!t){if(this.clearable){this.value=t;this.selectedTimeZoneItem=null;return}this.value=e;this.selectedTimeZoneItem=this.findTimeZoneItem(e);return}const s=this.findTimeZoneItem(t);if(!s){this.value=e;return}this.selectedTimeZoneItem=s}async setFocus(){await b(this);await this.comboboxEl.setFocus()}effectiveLocaleWatcher(){u(this,this.effectiveLocale)}onLabelClick(){this.setFocus()}overrideSelectedLabelForRegion(t){if(this.mode!=="region"||!this.selectedTimeZoneItem){return}const{label:e,metadata:s}=this.selectedTimeZoneItem;this.comboboxEl.selectedItems[0].textLabel=!s.country||t?e:O(e,s.country,this.messages)}findTimeZoneItem(t){return S(this.timeZoneItems,"value",t)}findTimeZoneItemByLabel(t){return S(this.timeZoneItems,"label",t)}async updateTimeZoneItems(){this.timeZoneItems=await this.createTimeZoneItems()}async updateTimeZoneSelection(){if(this.value===""&&this.clearable){this.selectedTimeZoneItem=null;return}const t=this.mode==="offset"?D():k();const e=this.value??t;this.selectedTimeZoneItem=this.findTimeZoneItem(e)||this.findTimeZoneItem(t)}async createTimeZoneItems(){if(!this.effectiveLocale||!this.messages){return[]}return B(this.effectiveLocale,this.messages,this.mode,this.referenceDate instanceof Date?this.referenceDate:new Date(this.referenceDate??Date.now()),this.offsetStyle)}connectedCallback(){C(this);a(this);l(this);f(this)}disconnectedCallback(){w(this);o(this);d(this);m(this)}normalizeValue(t){t=t===null?"":t;return t?this.normalizer(t):t}async componentWillLoad(){g(this);const[,t]=await Promise.all([p(this),L(this.mode)]);this.normalizer=t;await this.updateTimeZoneItems();this.value=this.normalizeValue(this.value);await this.updateTimeZoneSelection();const e=this.selectedTimeZoneItem?`${this.selectedTimeZoneItem.value}`:null;I(this,e);this.value=e}componentDidLoad(){y(this);this.openChanged()}componentDidRender(){r(this);this.overrideSelectedLabelForRegion(this.open)}render(){return s(i,{key:"b94fb2d93cdcaf0c44bbd2a0c7deaf59701078bf"},s(c,{key:"45246bbab441e9daf0e372832e74d7660039c770",disabled:this.disabled},s("calcite-combobox",{key:"294e44d8ab01079651c417f7808348e584f135b7",clearDisabled:!this.clearable,disabled:this.disabled,label:this.messages.chooseTimeZone,lang:this.effectiveLocale,maxItems:this.maxItems,onCalciteComboboxBeforeClose:this.onComboboxBeforeClose,onCalciteComboboxBeforeOpen:this.onComboboxBeforeOpen,onCalciteComboboxChange:this.onComboboxChange,onCalciteComboboxClose:this.onComboboxClose,onCalciteComboboxOpen:this.onComboboxOpen,overlayPositioning:this.overlayPositioning,placeholder:this.mode==="name"?this.messages.namePlaceholder:this.mode==="offset"?this.messages.offsetPlaceholder:this.messages.regionPlaceholder,placeholderIcon:"search",readOnly:this.readOnly,ref:this.setComboboxRef,scale:this.scale,selectionMode:this.clearable?"single":"single-persist",status:this.status,"validation-icon":this.validationIcon,"validation-message":this.validationMessage},this.renderItems()),s(v,{key:"0b7a0694166f1d5b36b780d3436dad15d466bc3c",component:this})))}renderItems(){if(this.mode==="region"){return this.renderRegionItems()}return this.timeZoneItems.map((t=>{const e=this.selectedTimeZoneItem===t;const{label:i,metadata:n,value:a}=t;return s("calcite-combobox-item",{"data-label":i,key:i,metadata:n,selected:e,textLabel:i,value:a})}))}renderRegionItems(){return this.timeZoneItems.flatMap((({label:t,items:e})=>s("calcite-combobox-item-group",{key:t,label:t},e.map((t=>{const e=this.selectedTimeZoneItem===t;const{label:i,metadata:n,value:a}=t;return s("calcite-combobox-item",{"data-label":i,description:n.country,key:i,metadata:n,selected:e,textLabel:i,value:a},s("span",{class:j.offset,slot:"content-end"},n.offset))})))))}static get delegatesFocus(){return true}static get assetsDirs(){return["assets"]}get el(){return n(this)}static get watchers(){return{messageOverrides:["onMessagesChange"],messages:["handleTimeZoneItemPropsChange"],mode:["handleTimeZoneItemPropsChange"],referenceDate:["handleTimeZoneItemPropsChange"],open:["openChanged"],value:["handleValueChange"],effectiveLocale:["effectiveLocaleWatcher"]}}};U.style=G;export{U as calcite_input_time_zone};
//# sourceMappingURL=p-f0abbe8c.entry.js.map