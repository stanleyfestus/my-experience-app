{"version":3,"file":"applyEdits.js","sourceRoot":"","sources":["../../src/applyEdits.ts"],"names":[],"mappings":";AAAA;gBACgB;;;AAEhB,mEAKmC;AA6CnC;;;;;;;;;;;;;;;;;;;;;;GAsBG;AACH,SAAgB,UAAU,CACxB,cAAkC;IAElC,MAAM,GAAG,GAAG,GAAG,IAAA,8BAAQ,EAAC,cAAc,CAAC,GAAG,CAAC,aAAa,CAAC;IAEzD,gCAAgC;IAChC,MAAM,OAAO,GAAG,IAAA,wCAAkB,EAChC,cAAc,EACd;QACE,MAAM;QACN,SAAS;QACT,SAAS;QACT,cAAc;QACd,aAAa;QACb,YAAY;QACZ,kBAAkB;QAClB,mBAAmB;QACnB,iBAAiB;KAClB,EACD,EAAE,MAAM,oBAAO,cAAc,CAAC,MAAM,CAAE,EAAE,CACzC,CAAC;IAEF,OAAO,IAAA,6BAAO,EAAC,GAAG,EAAE,OAAO,CAAC,CAAC;AAC/B,CAAC;AAvBD,gCAuBC","sourcesContent":["/* Copyright (c) 2017-2019 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n\nimport {\n  request,\n  cleanUrl,\n  appendCustomParams,\n  IFeature\n} from \"@esri/arcgis-rest-request\";\n\nimport {\n  ISharedEditOptions,\n  IApplyEditsResult,\n  IApplyEditsAddAttachmentOptions,\n  IApplyEditsUpdateAttachmentOptions\n} from \"./helpers.js\";\n\n/**\n * Apply edits request options. See the [REST Documentation](https://developers.arcgis.com/rest/services-reference/apply-edits-feature-service-layer-.htm) for more information.\n *\n */\nexport interface IApplyEditsOptions extends ISharedEditOptions {\n  /**\n   * Array of JSON features to add.\n   */\n  adds?: IFeature[];\n  /**\n   * Array of JSON features to update.\n   */\n  updates?: IFeature[];\n  /**\n   * Array of objectIds or globalIds to delete.\n   */\n  deletes?: number[] | string[];\n  /**\n   * When set to true, the features and attachments in the adds, updates, deletes, and attachments parameters are identified by their globalIds.\n   */\n  useGlobalIds?: boolean;\n  /**\n   * Optional parameter which is false by default is set by client to indicate to the server that client in true curve capable.\n   */\n  trueCurveClient?: boolean;\n  /**\n   * Use the attachments parameter to add, update or delete attachments. Applies only when the useGlobalIds parameter is set to true.\n   * See [attachment](https://developers.arcgis.com/rest/services-reference/apply-edits-feature-service-layer-.htm) param details.\n   */\n  attachments?: {\n    adds?: IApplyEditsAddAttachmentOptions[];\n    updates?: IApplyEditsUpdateAttachmentOptions[];\n    deletes?: string[];\n  };\n}\n\n/**\n * Apply edits request. See the [REST Documentation](https://developers.arcgis.com/rest/services-reference/apply-edits-feature-service-layer-.htm) for more information.\n *\n * ```js\n * import { applyEdits } from '@esri/arcgis-rest-feature-service';\n * //\n * applyEdits({\n *   url: \"https://sampleserver6.arcgisonline.com/arcgis/rest/services/ServiceRequest/FeatureServer/0\",\n *   adds: [{\n *     geometry: { x: -120, y: 45, spatialReference: { wkid: 4326 } },\n *     attributes: { status: \"alive\" }\n *   }],\n *   updates: [{\n *     attributes: { OBJECTID: 1004, status: \"alive\" }\n *   }],\n *   deletes: [862, 1548]\n * })\n *   .then(response)\n * ```\n *\n * @param requestOptions - Options for the request.\n * @returns A Promise that will resolve with the applyEdits response.\n */\nexport function applyEdits(\n  requestOptions: IApplyEditsOptions\n): Promise<IApplyEditsResult> {\n  const url = `${cleanUrl(requestOptions.url)}/applyEdits`;\n\n  // edit operations are POST only\n  const options = appendCustomParams<IApplyEditsOptions>(\n    requestOptions,\n    [\n      \"adds\",\n      \"updates\",\n      \"deletes\",\n      \"useGlobalIds\",\n      \"attachments\",\n      \"gdbVersion\",\n      \"returnEditMoment\",\n      \"rollbackOnFailure\",\n      \"trueCurveClient\"\n    ],\n    { params: { ...requestOptions.params } }\n  );\n\n  return request(url, options);\n}\n"]}