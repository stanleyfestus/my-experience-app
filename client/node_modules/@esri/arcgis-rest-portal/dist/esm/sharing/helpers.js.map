{"version":3,"file":"helpers.js","sourceRoot":"","sources":["../../../src/sharing/helpers.ts"],"names":[],"mappings":"AAAA;gBACgB;AAQhB,OAAO,EAAE,YAAY,EAAE,MAAM,2BAA2B,CAAC;AACzD,OAAO,EAAE,QAAQ,EAAE,MAAM,kBAAkB,CAAC;AAmB5C,MAAM,UAAU,aAAa,CAAC,cAA+B;IAC3D,MAAM,QAAQ,GAAG,cAAc,CAAC,cAAc,CAAC,QAAQ,CAAC;IACxD,MAAM,KAAK,GAAG,cAAc,CAAC,KAAK,IAAI,QAAQ,CAAC;IAC/C,OAAO,GAAG,YAAY,CAAC,cAAc,CAAC,kBAAkB,kBAAkB,CACxE,KAAK,CACN,UAAU,cAAc,CAAC,EAAE,QAAQ,CAAC;AACvC,CAAC;AAED,MAAM,UAAU,WAAW,CAAC,cAA+B;IACzD,MAAM,QAAQ,GAAG,cAAc,CAAC,cAAc,CAAC,QAAQ,CAAC;IACxD,MAAM,KAAK,GAAG,cAAc,CAAC,KAAK,IAAI,QAAQ,CAAC;IAC/C,OAAO,KAAK,KAAK,QAAQ,CAAC;AAC5B,CAAC;AAED;;;;GAIG;AACH,MAAM,UAAU,UAAU,CACxB,cAAmC;IAEnC,MAAM,OAAO,GAAG,cAAc,CAAC,cAAc,CAAC;IAE9C,OAAO,OAAO,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,CAAC,IAAW,EAAE,EAAE;QAC1D,OAAO,IAAI,IAAI,IAAI,CAAC,IAAI,KAAK,WAAW,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;IAC3D,CAAC,CAAC,CAAC;AACL,CAAC;AAED;;;;;;GAMG;AACH,MAAM,UAAU,iBAAiB,CAC/B,cAAoC;IAEpC,qBAAqB;IACrB,OAAO,QAAQ,CAAC,cAAc,CAAC,OAAO,EAAE,cAAc,CAAC;SACpD,IAAI,CAAC,CAAC,KAAa,EAAE,EAAE;QACtB,OAAO,KAAK,CAAC,cAAc,CAAC,UAAU,CAAC;IACzC,CAAC,CAAC;SACD,KAAK,CAAC,GAAG,EAAE;QACV,OAAO,MAAyB,CAAC;IACnC,CAAC,CAAC,CAAC;AACP,CAAC","sourcesContent":["/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n\nimport {\n  IUserRequestOptions,\n  IGroup,\n  IUser,\n  GroupMembership\n} from \"@esri/arcgis-rest-request\";\nimport { getPortalUrl } from \"../util/get-portal-url.js\";\nimport { getGroup } from \"../groups/get.js\";\n\nexport interface ISharingOptions extends IUserRequestOptions {\n  /**\n   * Unique identifier for the item.\n   */\n  id: string;\n  /**\n   * Item owner, if different from the authenticated user.\n   */\n  owner?: string;\n}\n\nexport interface ISharingResponse {\n  notSharedWith?: string[];\n  notUnsharedFrom?: string[];\n  itemId: string;\n}\n\nexport function getSharingUrl(requestOptions: ISharingOptions): string {\n  const username = requestOptions.authentication.username;\n  const owner = requestOptions.owner || username;\n  return `${getPortalUrl(requestOptions)}/content/users/${encodeURIComponent(\n    owner\n  )}/items/${requestOptions.id}/share`;\n}\n\nexport function isItemOwner(requestOptions: ISharingOptions): boolean {\n  const username = requestOptions.authentication.username;\n  const owner = requestOptions.owner || username;\n  return owner === username;\n}\n\n/**\n * Check it the user is a full org_admin\n * @param requestOptions\n * @returns Promise resolving in a boolean indicating if the user is an ArcGIS Organization administrator\n */\nexport function isOrgAdmin(\n  requestOptions: IUserRequestOptions\n): Promise<boolean> {\n  const session = requestOptions.authentication;\n\n  return session.getUser(requestOptions).then((user: IUser) => {\n    return user && user.role === \"org_admin\" && !user.roleId;\n  });\n}\n\n/**\n * Get the User Membership for a particular group. Use this if all you have is the groupId.\n * If you have the group object, check the `userMembership.memberType` property instead of calling this method.\n *\n * @param requestOptions\n * @returns A Promise that resolves with \"owner\" | \"admin\" | \"member\" | \"nonmember\"\n */\nexport function getUserMembership(\n  requestOptions: IGroupSharingOptions\n): Promise<GroupMembership> {\n  // fetch the group...\n  return getGroup(requestOptions.groupId, requestOptions)\n    .then((group: IGroup) => {\n      return group.userMembership.memberType;\n    })\n    .catch(() => {\n      return \"none\" as GroupMembership;\n    });\n}\n\nexport interface IGroupSharingOptions extends ISharingOptions {\n  /**\n   * Group identifier\n   */\n  groupId: string;\n  confirmItemControl?: boolean;\n}\n"]}