/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import o from"./Collection.js";import{sync as e}from"./reactiveUtils.js";import{property as s}from"./accessorSupport/decorators/property.js";import{subclass as i}from"./accessorSupport/decorators/subclass.js";import{autorun as r}from"./accessorSupport/trackingUtils.js";let l=class extends o{constructor(t){super(t),this.getCollections=null}initialize(){this.addHandles(r((()=>this._refresh()),e))}destroy(){this.getCollections=null}_refresh(){const t=null!=this.getCollections?this.getCollections():null;if(null==t)return void this.removeAll();let o=0;for(const e of t)null!=e&&(o=this._processCollection(o,e));this.splice(o,this.length)}_createNewInstance(t){return new o(t)}_processCollection(t,o){if(!o)return t;const e=this.itemFilterFunction??(t=>!!t);for(const s of o)if(s){if(e(s)){const o=this.indexOf(s,t);o>=0?o!==t&&this.reorder(s,t):this.add(s,t),++t}if(this.getChildrenFunction){const o=this.getChildrenFunction(s);if(Array.isArray(o))for(const e of o)t=this._processCollection(t,e);else t=this._processCollection(t,o)}}return t}};t([s()],l.prototype,"getCollections",void 0),t([s()],l.prototype,"getChildrenFunction",void 0),t([s()],l.prototype,"itemFilterFunction",void 0),l=t([i("esri.core.CollectionFlattener")],l);const n=l;export{n as default};
