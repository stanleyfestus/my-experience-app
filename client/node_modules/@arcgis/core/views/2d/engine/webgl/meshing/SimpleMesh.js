/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import{dataSizeInBytes as t}from"./definitions.js";import{Mesh as e}from"./Mesh.js";import{DataType as i,PrimitiveType as r}from"../../../../webgl/enums.js";const n={position:{type:i.SHORT,count:2}};class o extends e{static create(e,i,r){const n=[];let{stride:s}=i;if(null==s){s=0;for(const[e,{count:r,type:n,offset:o}]of Object.entries(i.layout)){if(null!=o)throw new Error("Stride cannot be computed automatically when attribute offsets are supplied explicitly.");s+=r*t[n]}}let a=0;for(const[o,{count:f,offset:d,type:m,normalized:x}]of Object.entries(i.layout)){null!=d&&(a=d);const e=r.get(o);if(null==e)throw new Error("Locations must be specified at mesh initialization.");const i={name:o,location:e,vertex:"vertexData",count:f,type:m,offset:a,stride:s,divisor:0,normalized:null!=x&&x};n.push(i),a+=f*t[m]}const l={attributes:n,primitive:i.primitive};null!=i.index&&(l.index="indexData");let{count:u}=i;if(null==u&&(u=i.index?i.index.length:i.vertex.byteLength/s,Math.floor(u)!==u))throw new Error(`The byte length of vertex data must be an exact multiple of the stride, which is ${s}.`);const c={start:0,count:u,group:0,primitive:i.primitive},p={vertex:{vertexData:i.vertex},parts:[c],groups:[l]};return null!=i.index&&(p.index={indexData:i.index}),new o(e,p,i.layout)}static fromVertexStream(t,e){return o.create(t,{primitive:r.TRIANGLE_STRIP,vertex:new Uint16Array(e),layout:n},new Map([["position",0]]))}constructor(t,e,i){super(t,e),this._spec=i}bind(t,e=0){super.bind(t,e)}}export{o as SimpleMesh};
