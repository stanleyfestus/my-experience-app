/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import"../../../geometry.js";import{getMetersPerUnitForSR as e}from"../../../core/unitUtils.js";import{isSupported as t,geodesicLengths as r}from"../../../geometry/support/geodesicUtils.js";import{straightLineDensify as o}from"../../../geometry/support/normalizeUtils.js";import{isValid as s}from"../../../geometry/support/spatialReferenceUtils.js";import{webMercatorToGeographic as n}from"../../../geometry/support/webMercatorUtils.js";import{pixelsPerCell as i}from"./constants.js";import m from"../../../geometry/SpatialReference.js";import p from"../../../geometry/Point.js";import c from"../../../geometry/Polyline.js";function a(e,t){return Math.log(e)/Math.log(t)}function l(e,t,r){const o=1===e?10:e;return o**(r?Math.round(a(i/t,o)):0)}function f(e){const{isGeographic:t,isWebMercator:r}=e;return!t&&!r}function u(i,a,l){const u="number"==typeof i?null:i,y=l??u?.spatialReference;if(null==y||!s(y)||f(y))return e(y);let g=u?.x??i,j=u?.y??a;const h=1/Math.sqrt(2);let M=g+h,x=j+h;const{isWebMercator:R,isGeographic:U}=y;let b=U&&!t(y)?m.WGS84:y;if(R){let e=new p({x:g,y:j,spatialReference:y});n(e,!0,e),g=e.x,j=e.y,e=new p({x:M,y:x,spatialReference:y}),n(e,!0,e),M=e.x,x=e.y,b=m.WGS84}const w=new c({paths:[[[g,j],[M,x]]],spatialReference:b}),G=o(w,10);let W;try{[W]=r([G],"meters")}catch{return e(y)}return W}export{l as getScaleFactor,u as measureMetersPerUnitAtReferencePoint,f as shouldUsePlanar};
