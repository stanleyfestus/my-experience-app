/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import{invertOrIdentity as e}from"../../../../core/libs/gl-matrix-2/math/mat4.js";import{create as r}from"../../../../core/libs/gl-matrix-2/factories/mat4f64.js";import{glsl as i,If as o}from"../core/shaderModules/interfaces.js";import{Matrix4PassUniform as t}from"../core/shaderModules/Matrix4PassUniform.js";import{VertexAttribute as a}from"../lib/VertexAttribute.js";function s(r,s={needUVs:!0,needEyeDirection:!0}){r.attributes.add(a.POSITION,"vec2"),r.varyings.add("worldRay","vec3");const{needUVs:c,needEyeDirection:d}=s;c&&r.varyings.add("uv","vec2"),d&&r.varyings.add("eyeDir","vec3"),r.vertex.uniforms.add(new t("inverseProjectionMatrix",((e,r)=>r.camera.inverseProjectionMatrix)),new t("inverseViewMatrix",((r,i)=>e(n,i.camera.viewMatrix)))),r.vertex.main.add(i`
    vec3 posViewNear = (inverseProjectionMatrix * vec4(position, -1.0, 1.0)).xyz;
    ${o(d,"eyeDir = posViewNear;")}
    worldRay = (inverseViewMatrix * vec4(posViewNear, 0)).xyz;
    ${o(c,"uv = position * 0.5 + vec2(0.5);")}
    gl_Position = vec4(position, 1, 1);
  `)}const n=r();export{s as ScreenSpacePassAtmosphere};
