/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import{JSONMap as e}from"../../core/jsonMap.js";import{inferLocationInfo as t}from"./locationUtils.js";import{ParquetMetadata as o}from"../../libs/parquet/parquet.js";const n=new e({esriGeometryPoint:"point"});async function i(e){const t=await o.create(e,(()=>null));return{objectIdField:null,url:e,geometrySourceInfo:r(t),metadata:t}}function r(e){const o=e.tryReadGeoMetadata();if(null!=o){const e=o.primary_column,t=o.columns[e],{geometry_types:n,encoding:i,orientation:r,crs:a}=t,l=1===n.length&&"Point"===n[0]?"point":null,m=a?.id?.code;return{type:"geometry",format:i,geometryType:l,orientation:r??null,primaryFieldName:e,spatialReference:m&&"number"==typeof m?{wkid:m}:null}}const n=t(e.fields.map((e=>e.name)));return{type:"location",latitudeFieldName:n.latitudeFieldName,longitudeFieldName:n.longitudeFieldName,spatialReference:{wkid:4326}}}export{r as inferGeometrySource,i as inferParquetLoadOptions,n as parquetGeometryTypeKebabDict};
