/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import"../geometry.js";import{rad2deg as e,deg2rad as t}from"../core/mathUtils.js";import{fromZRotation as r,rotateX as o}from"../core/libs/gl-matrix-2/math/mat4.js";import{create as i}from"../core/libs/gl-matrix-2/factories/mat4f64.js";import{fromValues as n}from"../core/libs/gl-matrix-2/factories/vec2f64.js";import{t as s,h as a,g as m,b as c,i as p}from"./vec32.js";import{create as l,fromValues as f}from"../core/libs/gl-matrix-2/factories/vec3f64.js";import u from"../geometry/Extent.js";import{projectPointToVector as g}from"../geometry/projection/projectPointToVector.js";import{projectVectorToVector as d}from"../geometry/projection/projectVectorToVector.js";import{isClockwise as j}from"../geometry/support/coordsUtils.js";import{PlaneIndex as y}from"../geometry/support/frustum.js";import{clipPolygonToExtent as T}from"../geometry/support/polygonExtentClipping.js";import{wrap as x}from"../geometry/support/ray.js";import{LineIndex as h}from"../views/3d/state/Frustum.js";import{createDirectionUp as R,directionToHeadingTilt as b,clampLineSegmentToPlane as v}from"../views/3d/support/cameraUtilsInternal.js";import A from"../geometry/Polygon.js";const w=f(0,1,0),E=f(0,0,1),F=i(),_=l(),C=l();function H(e,i,n,m=R()){const{direction:c,up:p}=m;return r(F,-t(i)),o(F,F,t(n)),s(c,E,F),a(c,c,-1),s(p,w,F),m}function U(e,t,r,o){return b(t,r,o,E,w)}function V(e,t,r,o){const i=H(e,r,o),n=l();return a(n,i.direction,-t),m(n,n,e),{up:i.up,eye:n,heading:r,tilt:o}}function P(t){return e(t)}function S(e){return t(e)}function k(e,t,r,o,i){const n=e.renderSpatialReference,s=e.spatialReference??t.spatialReference;return g(t,_,n),g(t,C,n),_[0]-=r/2,C[0]+=r/2,_[1]-=o/2,C[1]+=o/2,d(_,n,_,s),d(C,n,C,s),i?(i.xmin=_[0],i.ymin=_[1],i.xmax=C[0],i.ymax=C[1],i.spatialReference=s):i=new u(_[0],_[1],C[0],C[1],s),i}function I(e,t){const r=e.frustum,{renderCoordsHelper:o}=e,i=o.getAltitude(t),s=e.spatialReference,a=e.state.camera.eye,m=[],c=r.planes[y.FAR];for(let p=0;p<4;p++){const e=r.lines[p];o.intersectInfiniteManifold(x(e.origin,e.direction),i,O)||L(O,r,o,e.endpoint,i),v(O,a,O,c),m.push(n(O[0],O[1]))}return M(T(m,o.extent),o,s)}function L(e,t,r,o,i){const n=t.lines[h.FAR_LEFT].direction,s=(i-r.getAltitude(o))/n[2];c(e,o,n,s)}function M(e,t,r){const o=e.map((e=>(p(O,e[0],e[1],0),t.fromRenderCoords(O,O,r),[O[0],O[1]])));return o.length<=2?new A({spatialReference:r}):(o.push(o[0].slice()),j(o)||o.reverse(),new A({rings:[o],spatialReference:r}))}const O=l(),z=Object.freeze(Object.defineProperty({__proto__:null,directionToHeadingTilt:U,eyeForCenterWithHeadingTilt:V,eyeTiltToLookAtTilt:S,headingTiltToDirectionUp:H,lookAtTiltToEyeTilt:P,toArea:I,toExtent:k},Symbol.toStringTag,{value:"Module"}));export{S as a,I as b,z as c,U as d,V as e,H as h,P as l,k as t};
