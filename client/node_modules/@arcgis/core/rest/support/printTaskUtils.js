/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import e from"../../Color.js";import r from"../../symbols/SimpleFillSymbol.js";import n from"../../symbols/SimpleLineSymbol.js";import t from"../../symbols/SimpleMarkerSymbol.js";import{isInEffectiveScaleRange as o}from"../../views/support/layerViewUtils.js";function i(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}}function l(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}}function f(){return{layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}}function a(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}}function y(e,r=15){const n=e.canvas.width,t=e.canvas.height,o=e.getImageData(0,0,n,t).data;let i,l,f,a,y,u;e:for(l=t;l--;)for(i=n;i--;)if(o[4*(n*l+i)+3]>r){u=l;break e}if(!u)return null;e:for(i=n;i--;)for(l=u+1;l--;)if(o[4*(n*l+i)+3]>r){y=i;break e}e:for(i=0;i<=y;++i)for(l=u+1;l--;)if(o[4*(n*l+i)+3]>r){f=i;break e}e:for(l=0;l<=u;++l)for(i=f;i<=y;++i)if(o[4*(n*l+i)+3]>r){a=l;break e}return{x:f,y:a,width:y-f,height:u-a}}function u(o,i){const l=i.color?.clone()??new e([0,255,255]),f=i.haloColor?.clone()??l.clone();switch(o){case"envelope":case"polygon":return l.a*=i.fillOpacity??.25,new r({color:l,outline:new n({color:f}),style:"solid"});case"polyline":return new n({color:f});default:return f.a=1,new t({color:f,outline:null})}}function s(e,r){const n=e.allLayerViews.items;if(r===e.scale)return n.filter((e=>!e.suspended));const t=new Array;for(const i of n){const e=i.parent;e&&e!==i.view&&(p(e)||g(e))&&!t.includes(e)||i.visible&&i.visibleAtCurrentTimeExtent&&o(i.layer.effectiveScaleRange,r)&&t.push(i)}return t}function m(e){return"bing-maps"===e?.type}function c(e){return e&&"blendMode"in e&&"effect"in e}function p(e){return"catalog"===e.layer.type}function g(e){return"group"===e.layer.type}function d(e){const r=e.layer;if(c(r)){const n=r.blendMode;if((!n||"normal"===n)&&(r.effect||"featureEffect"in e&&e.featureEffect))return!0}return!1}export{i as createMultipointLayer,f as createPointLayer,l as createPolygonLayer,a as createPolylineLayer,y as getContextBoundingBox,u as getSelectionSymbol,s as getVisibleLayerViews,m as isBingMapsLayer,c as isBlendLayer,d as isScreenshotRequired};
