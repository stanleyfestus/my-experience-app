/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import{readSymbol as e}from"../../symbols.js";import o from"../../core/Error.js";import{isSceneServiceLayer as n}from"../../layers/support/layerUtils.js";import t from"../Symbol3D.js";import{to3D as s}from"./symbolConversion.js";import r from"../WebStyleSymbol.js";function l(e,o,n,t){const s=y(e,{},{context:t,isLabelSymbol:!1});null!=s&&(o[n]=s)}function i(e,o,n,t){const s=y(e,{},{context:t,isLabelSymbol:!0});null!=s&&(o[n]=s)}function m(e){return e instanceof t||e instanceof r}function a(e){return e instanceof t&&("polygon-3d"===e.type||"line-3d"===e.type)}function y(e,t,r){if(null==e)return null;const{context:l,isLabelSymbol:i}=r,y=l?.origin,p=l?.messages;if("web-scene"===y&&!m(e)){const n=s(e,{retainCIM:!0,hasLabelingContext:i});return null!=n.symbol?n.symbol.write(t,l):(p?.push(new o("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:l,error:n.error})),null)}return n(l?.layer)&&a(e)?(p?.push(new o("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported on layers of type '${l?.layer?.declaredClass}'.`,{symbol:e,context:l})),null):("web-map"===y||"portal-item"===y&&!n(l?.layer))&&m(e)?(p?.push(new o("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:e,context:l})),null):e.write(t,l)}function p(o,n){return e(o,null,n)}export{p as fromJSON,l as write,i as writeLabelSymbol};
