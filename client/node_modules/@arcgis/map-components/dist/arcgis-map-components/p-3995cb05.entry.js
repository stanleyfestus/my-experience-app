/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.31/esri/copyright.txt for details.
 * v4.31.0-next.58
 */
import{r as t,c as s,f as i,h as e,g as a}from"./p-8305d662.js";import{g as r}from"./p-41348fc4.js";import{u as n,m as o}from"./p-79d1b680.js";import{h as l,a2 as h,a3 as c,q as d,a4 as b}from"./p-3c121fb0.js";import{l as u}from"./p-c956d5f4.js";import{u as _,g as p}from"./p-5bfa67be.js";import"./p-cf4815f5.js";const m="esri-scale-bar",f={base:m,labelContainer:`${m}__label-container`,rulerLabelContainer:`${m}__label-container--ruler`,lineLabelContainer:`${m}__label-container--line`,topLabelContainer:`${m}__label-container--top`,bottomLabelContainer:`${m}__label-container--bottom`,label:`${m}__label`,line:`${m}__line`,topLine:`${m}__line--top`,bottomLine:`${m}__line--bottom`,ruler:`${m}__ruler`,rulerBlock:`${m}__ruler-block`,barContainer:`${m}__bar-container`,rulerBarContainer:`${m}__bar-container--ruler`,lineBarContainer:`${m}__bar-container--line`};function v(t=0,s=0){return{x:t,y:s}}const $=o(b),y=class{constructor(i){t(this,i),this.arcgisReady=s(this,"arcgisReady",7),this.manager=_(this),this.messages=n(),this.reactiveUtils=u(l),this.intlUtils=u(h),this.unitUtils=u(c),this.viewModel=$(this),this._scaleComputedFrom=v(),this.autoDestroyDisabled=!1,this.icon="actual-size",this.label=void 0,this.position="top-left",this.referenceElement=void 0,this.barStyle="line",this.unit=p(void 0,{set:t=>t??this._defaultUnit})}componentDidLoad(){this._defaultUnit=this.unitUtils.getDefaultUnitForView(this.viewModel.view),this.unit||(this.unit=this._defaultUnit),this.manager.onLifecycle((()=>this.reactiveUtils.watch((()=>{const t=this.viewModel.view;return[t?.stationary,t?.center,t?.scale,t?.zoom]}),(([t])=>{t&&i(this)}))))}async destroy(){await this.manager.destroy()}componentDidRender(){this._handleRootCreateOrUpdate()}render(){const t="disabled"===this.viewModel.state,s={[r.disabled]:t};let i,a;if(!t){const{unit:t,barStyle:s}=this,e="metric"===t||"dual"===t,r=100,n="dual"===t?"line":s;if("imperial"===t||"dual"===t){const t=this.viewModel.getScaleBarProperties(r,"imperial");t&&(a="ruler"===n?this._renderRuler(t):this._renderLine(t,"bottom"))}if(e){const t=this.viewModel.getScaleBarProperties(r,"metric");t&&(i="ruler"===n?this._renderRuler(t):this._renderLine(t,"top"))}}return e("div",{key:"8224f987c000c7263570091b725bad517f11bbf3",ref:t=>t?this._handleRootCreateOrUpdate():void 0,class:d(f.base,r.widget,s)},i,a)}_renderRuler(t){const{length:s,unit:i,value:a}=t,r=Math.round(s),n=this._formatDistance(a,i);return e("div",{class:d(f.barContainer,f.rulerBarContainer)},e("div",{class:f.ruler,style:{width:`${r}px`}},e("div",{class:f.rulerBlock}),e("div",{class:f.rulerBlock}),e("div",{class:f.rulerBlock}),e("div",{class:f.rulerBlock})),e("div",{class:d(f.labelContainer,f.rulerLabelContainer)},e("div",{class:f.label},"0"),e("div",{class:f.label},n)))}_renderLine(t,s){const{length:i,unit:a,value:r}=t,n=Math.round(i),o=this._formatDistance(r,a),l=e("div",{class:d(f.labelContainer,f.lineLabelContainer,{[f.topLabelContainer]:"top"===s,[f.bottomLabelContainer]:"bottom"===s})},e("div",{class:f.label},o)),h=e("div",{class:d(f.line,{[f.topLine]:"top"===s,[f.bottomLine]:"bottom"===s}),style:{width:`${n}px`}});return e("div",{class:d(f.barContainer,f.lineBarContainer)},[h,l])}_handleRootCreateOrUpdate(){if(!this.viewModel)return;const t=this._scaleComputedFrom,s=this.el.getBoundingClientRect(),i=v(s.left+window.pageXOffset,s.top+window.pageYOffset);(i.x!==t.x||i.y!==t.y)&&(this._scaleComputedFrom=i)}_formatDistance(t,s){return this.intlUtils.formatNumber(t,{style:"unit",unit:s,unitDisplay:"short"})}static get assetsDirs(){return["assets"]}get el(){return a(this)}};export{y as arcgis_scale_bar}